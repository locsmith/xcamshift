<!-- Generated by Cython 0.18 on Tue Sep  3 15:50:10 2013 -->
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style type="text/css">

body { font-family: courier; font-size: 12; }

.code  { font-size: 9; color: #444444; display: none; margin-left: 20px; }
.py_c_api  { color: red; }
.py_macro_api  { color: #FF7000; }
.pyx_c_api  { color: #FF3000; }
.pyx_macro_api  { color: #FF7000; }
.refnanny  { color: #FFA000; }

.error_goto  { color: #FFA000; }

.tag  {  }

.coerce  { color: #008000; border: 1px dotted #008000 }

.py_attr { color: #FF0000; font-weight: bold; }
.c_attr  { color: #0000FF; }

.py_call { color: #FF0000; font-weight: bold; }
.c_call  { color: #0000FF; }

.line { margin: 0em }

</style>
<script>
function toggleDiv(id) {
    theDiv = document.getElementById(id);
    if (theDiv.style.display == 'none') theDiv.style.display = 'block';
    else theDiv.style.display = 'none';
}
</script>
</head>
        <body>
<p>Generated by Cython 0.18 on Tue Sep  3 15:50:10 2013
<p>Raw output: <a href="Cython_shift_calculator.cpp">Cython_shift_calculator.cpp</a>
<pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line1")'> 1: #-------------------------------------------------------------------------------</pre>
<pre id='line1' class='code' style='background-color: #FFFF79'>
  /* "Cython_shift_calculator.pyx":1
 * #-------------------------------------------------------------------------------             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * # Copyright (c) 2013 Gary Thompson & The University of Leeds.
 * # All rights reserved. This program and the accompanying materials
 */
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s____test__, ((PyObject *)__pyx_t_2)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2")'> 2: # Copyright (c) 2013 Gary Thompson &amp; The University of Leeds.</pre>
<pre id='line2' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line3")'> 3: # All rights reserved. This program and the accompanying materials</pre>
<pre id='line3' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line4")'> 4: # are made available under the terms of the GNU Lesser Public License v3.0</pre>
<pre id='line4' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line5")'> 5: # which accompanies this distribution, and is available at</pre>
<pre id='line5' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line6")'> 6: # http://www.gnu.org/licenses/lgpl-3.0.html</pre>
<pre id='line6' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line7")'> 7: #</pre>
<pre id='line7' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line8")'> 8: # Contributors:</pre>
<pre id='line8' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line9")'> 9: #     gary thompson - initial API and implementation</pre>
<pre id='line9' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line10")'> 10: #-------------------------------------------------------------------------------</pre>
<pre id='line10' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line11")'> 11: # cython: profile=False</pre>
<pre id='line11' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line12")'> 12: # cython: boundscheck=False</pre>
<pre id='line12' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line13")'> 13: # cython: wraparound=False</pre>
<pre id='line13' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line14")'> 14: # cython: cdivision=True</pre>
<pre id='line14' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line15")'> 15: </pre>
<pre id='line15' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line16")'> 16: '''</pre>
<pre id='line16' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line17")'> 17: Created on 31 Jul 2012</pre>
<pre id='line17' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line18")'> 18: </pre>
<pre id='line18' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line19")'> 19: @author: garyt</pre>
<pre id='line19' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line20")'> 20: </pre>
<pre id='line20' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line21")'> 21: '''</pre>
<pre id='line21' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line22")'> 22: </pre>
<pre id='line22' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line23")'> 23: cdef extern from "instantiate.hh":</pre>
<pre id='line23' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line24")'> 24:     pass</pre>
<pre id='line24' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line25")'> 25: </pre>
<pre id='line25' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line26")'> 26: </pre>
<pre id='line26' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line27")'> 27: from shift_calculators cimport Fast_energy_calculator, Constant_cache</pre>
<pre id='line27' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line28")'> 28: from math import ceil</pre>
<pre id='line28' class='code' style='background-color: #FFFF41'>
  /* "Cython_shift_calculator.pyx":28
 * 
 * from shift_calculators cimport Fast_energy_calculator, Constant_cache
 * from math import ceil             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * cimport cython
 * from vec3 import Vec3 as python_vec3
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__ceil));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_n_s__ceil));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__ceil));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__math), ((PyObject *)__pyx_t_1), -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__ceil);
  if (__pyx_t_1 == NULL) {
    if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseImportError</span>(__pyx_n_s__ceil);
    if (unlikely(!__pyx_t_1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__ceil, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line29")'> 29: cimport cython</pre>
<pre id='line29' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line30")'> 30: from vec3 import Vec3 as python_vec3</pre>
<pre id='line30' class='code' style='background-color: #FFFF41'>
  /* "Cython_shift_calculator.pyx":30
 * from math import ceil
 * cimport cython
 * from vec3 import Vec3 as python_vec3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * from common_constants import TARGET_ATOM_IDS_CHANGED, STRUCTURE_CHANGED
 * from  xplor_access cimport norm,Vec3, Dihedral, Atom,  dot,  cross,  Simulation, CDSVector, DerivList, clearVector, EnsembleSimulation, createSharedVec
 */
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__Vec3));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_n_s__Vec3));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__Vec3));
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__vec3), ((PyObject *)__pyx_t_2), -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__Vec3);
  if (__pyx_t_2 == NULL) {
    if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseImportError</span>(__pyx_n_s__Vec3);
    if (unlikely(!__pyx_t_2))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__python_vec3, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 30; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF2b' onclick='toggleDiv("line31")'> 31: from common_constants import TARGET_ATOM_IDS_CHANGED, STRUCTURE_CHANGED</pre>
<pre id='line31' class='code' style='background-color: #FFFF2b'>
  /* "Cython_shift_calculator.pyx":31
 * cimport cython
 * from vec3 import Vec3 as python_vec3
 * from common_constants import TARGET_ATOM_IDS_CHANGED, STRUCTURE_CHANGED             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * from  xplor_access cimport norm,Vec3, Dihedral, Atom,  dot,  cross,  Simulation, CDSVector, DerivList, clearVector, EnsembleSimulation, createSharedVec
 * from libc.math cimport cos,sin,  fabs, tanh, pow, cosh
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s_81));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_n_s_81));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s_81));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__STRUCTURE_CHANGED));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_n_s__STRUCTURE_CHANGED));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__STRUCTURE_CHANGED));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__common_constants), ((PyObject *)__pyx_t_1), -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s_81);
  if (__pyx_t_1 == NULL) {
    if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseImportError</span>(__pyx_n_s_81);
    if (unlikely(!__pyx_t_1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s_81, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__STRUCTURE_CHANGED);
  if (__pyx_t_1 == NULL) {
    if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseImportError</span>(__pyx_n_s__STRUCTURE_CHANGED);
    if (unlikely(!__pyx_t_1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__STRUCTURE_CHANGED, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line32")'> 32: from  xplor_access cimport norm,Vec3, Dihedral, Atom,  dot,  cross,  Simulation, CDSVector, DerivList, clearVector, EnsembleSimulation, createSharedVec</pre>
<pre id='line32' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line33")'> 33: from libc.math cimport cos,sin,  fabs, tanh, pow, cosh</pre>
<pre id='line33' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line34")'> 34: from libc.stdlib cimport malloc, free</pre>
<pre id='line34' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line35")'> 35: from libc.string cimport strcmp</pre>
<pre id='line35' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line36")'> 36: from time import time</pre>
<pre id='line36' class='code' style='background-color: #FFFF41'>
  /* "Cython_shift_calculator.pyx":36
 * from libc.stdlib cimport malloc, free
 * from libc.string cimport strcmp
 * from time import time             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * from utils import Atom_utils
 * from cpython cimport array
 */
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__time));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_n_s__time));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__time));
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__time), ((PyObject *)__pyx_t_2), -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__time);
  if (__pyx_t_2 == NULL) {
    if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseImportError</span>(__pyx_n_s__time);
    if (unlikely(!__pyx_t_2))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__time, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line37")'> 37: from utils import Atom_utils</pre>
<pre id='line37' class='code' style='background-color: #FFFF41'>
  /* "Cython_shift_calculator.pyx":37
 * from libc.string cimport strcmp
 * from time import time
 * from utils import Atom_utils             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * from cpython cimport array
 * import ctypes
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__Atom_utils));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_n_s__Atom_utils));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__Atom_utils));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__utils), ((PyObject *)__pyx_t_1), -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__Atom_utils);
  if (__pyx_t_1 == NULL) {
    if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseImportError</span>(__pyx_n_s__Atom_utils);
    if (unlikely(!__pyx_t_1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__Atom_utils, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line38")'> 38: from cpython cimport array</pre>
<pre id='line38' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line39")'> 39: import ctypes</pre>
<pre id='line39' class='code' style='background-color: #FFFF8d'>
  /* "Cython_shift_calculator.pyx":39
 * from utils import Atom_utils
 * from cpython cimport array
 * import ctypes             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * from component_list import  Component_list, Native_component_list
 * from ensembleSimulation import EnsembleSimulation as pyEnsembleSimulation
 */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__ctypes), 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__ctypes, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF2b' onclick='toggleDiv("line40")'> 40: from component_list import  Component_list, Native_component_list</pre>
<pre id='line40' class='code' style='background-color: #FFFF2b'>
  /* "Cython_shift_calculator.pyx":40
 * from cpython cimport array
 * import ctypes
 * from component_list import  Component_list, Native_component_list             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * from ensembleSimulation import EnsembleSimulation as pyEnsembleSimulation
 * from libcpp.map cimport map as cmap
 */
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__Component_list));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_n_s__Component_list));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__Component_list));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s_82));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, ((PyObject *)__pyx_n_s_82));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s_82));
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__component_list), ((PyObject *)__pyx_t_2), -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__Component_list);
  if (__pyx_t_2 == NULL) {
    if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseImportError</span>(__pyx_n_s__Component_list);
    if (unlikely(!__pyx_t_2))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__Component_list, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s_82);
  if (__pyx_t_2 == NULL) {
    if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseImportError</span>(__pyx_n_s_82);
    if (unlikely(!__pyx_t_2))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s_82, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line41")'> 41: from ensembleSimulation import EnsembleSimulation as pyEnsembleSimulation</pre>
<pre id='line41' class='code' style='background-color: #FFFF41'>
  /* "Cython_shift_calculator.pyx":41
 * import ctypes
 * from component_list import  Component_list, Native_component_list
 * from ensembleSimulation import EnsembleSimulation as pyEnsembleSimulation             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * from libcpp.map cimport map as cmap
 * from libc.stdint cimport uintptr_t
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__EnsembleSimulation));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_n_s__EnsembleSimulation));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__EnsembleSimulation));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__ensembleSimulation), ((PyObject *)__pyx_t_1), -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__EnsembleSimulation);
  if (__pyx_t_1 == NULL) {
    if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseImportError</span>(__pyx_n_s__EnsembleSimulation);
    if (unlikely(!__pyx_t_1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s_4, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line42")'> 42: from libcpp.map cimport map as cmap</pre>
<pre id='line42' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line43")'> 43: from libc.stdint cimport uintptr_t</pre>
<pre id='line43' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line44")'> 44: import sys</pre>
<pre id='line44' class='code' style='background-color: #FFFF8d'>
  /* "Cython_shift_calculator.pyx":44
 * from libcpp.map cimport map as cmap
 * from libc.stdint cimport uintptr_t
 * import sys             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef int ATOM = 0
 */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__sys), 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__sys, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line45")'> 45: </pre>
<pre id='line45' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line46")'> 46: cdef int ATOM = 0</pre>
<pre id='line46' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":46
 * import sys
 * 
 * cdef int ATOM = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * cdef int NATOM = 1
 * cdef int SIMU = 2
 */
  __pyx_v_17shift_calculators_ATOM = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line47")'> 47: cdef int NATOM = 1</pre>
<pre id='line47' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":47
 * 
 * cdef int ATOM = 0
 * cdef int NATOM = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * cdef int SIMU = 2
 * cdef int NBRM = 3
 */
  __pyx_v_17shift_calculators_NATOM = 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line48")'> 48: cdef int SIMU = 2</pre>
<pre id='line48' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":48
 * cdef int ATOM = 0
 * cdef int NATOM = 1
 * cdef int SIMU = 2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * cdef int NBRM = 3
 * cdef int NNBRM = 4
 */
  __pyx_v_17shift_calculators_SIMU = 2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line49")'> 49: cdef int NBRM = 3</pre>
<pre id='line49' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":49
 * cdef int NATOM = 1
 * cdef int SIMU = 2
 * cdef int NBRM = 3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * cdef int NNBRM = 4
 * cdef int COEF =  5
 */
  __pyx_v_17shift_calculators_NBRM = 3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line50")'> 50: cdef int NNBRM = 4</pre>
<pre id='line50' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":50
 * cdef int SIMU = 2
 * cdef int NBRM = 3
 * cdef int NNBRM = 4             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * cdef int COEF =  5
 * cdef int NCOEF =  6
 */
  __pyx_v_17shift_calculators_NNBRM = 4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line51")'> 51: cdef int COEF =  5</pre>
<pre id='line51' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":51
 * cdef int NBRM = 3
 * cdef int NNBRM = 4
 * cdef int COEF =  5             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * cdef int NCOEF =  6
 * cdef int NBLT = 7
 */
  __pyx_v_17shift_calculators_COEF = 5;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line52")'> 52: cdef int NCOEF =  6</pre>
<pre id='line52' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":52
 * cdef int NNBRM = 4
 * cdef int COEF =  5
 * cdef int NCOEF =  6             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * cdef int NBLT = 7
 * cdef int NNBLT = 8
 */
  __pyx_v_17shift_calculators_NCOEF = 6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line53")'> 53: cdef int NBLT = 7</pre>
<pre id='line53' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":53
 * cdef int COEF =  5
 * cdef int NCOEF =  6
 * cdef int NBLT = 7             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * cdef int NNBLT = 8
 * cdef int OFFS = 9
 */
  __pyx_v_17shift_calculators_NBLT = 7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line54")'> 54: cdef int NNBLT = 8</pre>
<pre id='line54' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":54
 * cdef int NCOEF =  6
 * cdef int NBLT = 7
 * cdef int NNBLT = 8             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * cdef int OFFS = 9
 * 
 */
  __pyx_v_17shift_calculators_NNBLT = 8;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line55")'> 55: cdef int OFFS = 9</pre>
<pre id='line55' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":55
 * cdef int NBLT = 7
 * cdef int NNBLT = 8
 * cdef int OFFS = 9             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #TODO: should be ensembleSimulationAsNative
 */
  __pyx_v_17shift_calculators_OFFS = 9;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line56")'> 56: </pre>
<pre id='line56' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line57")'> 57: #TODO: should be ensembleSimulationAsNative</pre>
<pre id='line57' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line58")'> 58: cdef inline EnsembleSimulation* simulationAsNative(object simulation) except NULL:</pre>
<pre id='line58' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":58
 * 
 * #TODO: should be ensembleSimulationAsNative
 * cdef inline EnsembleSimulation* simulationAsNative(object simulation) except NULL:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     #TODO tell charles his __eq__ method has problems
 *     if id(None) == id(simulation):
 */

static CYTHON_INLINE EnsembleSimulation *__pyx_f_17shift_calculators_simulationAsNative(PyObject *__pyx_v_simulation) {
  EnsembleSimulation *__pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("simulationAsNative", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line59")'> 59:     #TODO tell charles his __eq__ method has problems</pre>
<pre id='line59' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF37' onclick='toggleDiv("line60")'> 60:     if id(None) == id(simulation):</pre>
<pre id='line60' class='code' style='background-color: #FFFF37'>
  /* "Cython_shift_calculator.pyx":60
 * cdef inline EnsembleSimulation* simulationAsNative(object simulation) except NULL:
 *     #TODO tell charles his __eq__ method has problems
 *     if id(None) == id(simulation):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         raise Exception("_simulation cannot be None!")
 *     if not isinstance(simulation, pyEnsembleSimulation):
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_id, ((PyObject *)__pyx_k_tuple_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simulation);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_simulation);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_simulation);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_id, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_3, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_4) {

  /* "Cython_shift_calculator.pyx":60
 * cdef inline EnsembleSimulation* simulationAsNative(object simulation) except NULL:
 *     #TODO tell charles his __eq__ method has problems
 *     if id(None) == id(simulation):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         raise Exception("_simulation cannot be None!")
 *     if not isinstance(simulation, pyEnsembleSimulation):
 */
  __pyx_k_tuple_1 = <span class='py_c_api'>PyTuple_Pack</span>(1, Py_None);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_1));
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line61")'> 61:         raise Exception("_simulation cannot be None!")</pre>
<pre id='line61' class='code' style='background-color: #FFFF6e'>
    /* "Cython_shift_calculator.pyx":61
 *     #TODO tell charles his __eq__ method has problems
 *     if id(None) == id(simulation):
 *         raise Exception("_simulation cannot be None!")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     if not isinstance(simulation, pyEnsembleSimulation):
 *         raise Exception("a %s can't be converted to a EnsembleSimulation*" % simulation.__class__.__name__)
 */
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_Exception, ((PyObject *)__pyx_k_tuple_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "Cython_shift_calculator.pyx":61
 *     #TODO tell charles his __eq__ method has problems
 *     if id(None) == id(simulation):
 *         raise Exception("_simulation cannot be None!")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     if not isinstance(simulation, pyEnsembleSimulation):
 *         raise Exception("a %s can't be converted to a EnsembleSimulation*" % simulation.__class__.__name__)
 */
  __pyx_k_tuple_3 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_2));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_3));
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line62")'> 62:     if not isinstance(simulation, pyEnsembleSimulation):</pre>
<pre id='line62' class='code' style='background-color: #FFFF8d'>
  /* "Cython_shift_calculator.pyx":62
 *     if id(None) == id(simulation):
 *         raise Exception("_simulation cannot be None!")
 *     if not isinstance(simulation, pyEnsembleSimulation):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         raise Exception("a %s can't be converted to a EnsembleSimulation*" % simulation.__class__.__name__)
 *     return <code><</code>EnsembleSimulation*><code><</code>size_t>int(simulation.this)
 */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_simulation, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = (!__pyx_t_4);
  if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFF3c' onclick='toggleDiv("line63")'> 63:         raise Exception("a %s can't be converted to a EnsembleSimulation*" % simulation.__class__.__name__)</pre>
<pre id='line63' class='code' style='background-color: #FFFF3c'>
    /* "Cython_shift_calculator.pyx":63
 *         raise Exception("_simulation cannot be None!")
 *     if not isinstance(simulation, pyEnsembleSimulation):
 *         raise Exception("a %s can't be converted to a EnsembleSimulation*" % simulation.__class__.__name__)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return <code><</code>EnsembleSimulation*><code><</code>size_t>int(simulation.this)
 * 
 */
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_simulation, __pyx_n_s____class__);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s____name__);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_5), __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, ((PyObject *)__pyx_t_2));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_2));
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_Exception, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L4;
  }
  __pyx_L4:;
</pre><pre class='line' style='background-color: #FFFF39' onclick='toggleDiv("line64")'> 64:     return &lt;EnsembleSimulation*&gt;&lt;size_t&gt;int(simulation.this)</pre>
<pre id='line64' class='code' style='background-color: #FFFF39'>
  /* "Cython_shift_calculator.pyx":64
 *     if not isinstance(simulation, pyEnsembleSimulation):
 *         raise Exception("a %s can't be converted to a EnsembleSimulation*" % simulation.__class__.__name__)
 *     return <code><</code>EnsembleSimulation*><code><</code>size_t>int(simulation.this)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cpdef array.array allocate_array(int len, type='d'):
 */
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_simulation, __pyx_n_s__this);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_t_6 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_6 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = ((EnsembleSimulation *)((size_t)__pyx_t_6));
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.simulationAsNative", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line65")'> 65: </pre>
<pre id='line65' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line66")'> 66: cpdef array.array allocate_array(int len, type='d'):</pre>
<pre id='line66' class='code' style='background-color: #FFFF9f'>
/* "Cython_shift_calculator.pyx":66
 *     return <code><</code>EnsembleSimulation*><code><</code>size_t>int(simulation.this)
 * 
 * cpdef array.array allocate_array(int len, type='d'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     result = array.array(type,[0])
 *     array.resize(result, len)
 */

static PyObject *__pyx_pw_17shift_calculators_1allocate_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static arrayobject *__pyx_f_17shift_calculators_allocate_array(int __pyx_v_len, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_17shift_calculators_allocate_array *__pyx_optional_args) {
  PyObject *__pyx_v_type = ((PyObject *)__pyx_n_s__d);
  PyObject *__pyx_v_result = NULL;
  arrayobject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("allocate_array", 0);
  if (__pyx_optional_args) {
    if (__pyx_optional_args->__pyx_n > 0) {
      __pyx_v_type = __pyx_optional_args->type;
    }
  }

/* "Cython_shift_calculator.pyx":66
 *     return <code><</code>EnsembleSimulation*><code><</code>size_t>int(simulation.this)
 * 
 * cpdef array.array allocate_array(int len, type='d'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     result = array.array(type,[0])
 *     array.resize(result, len)
 */

static PyObject *__pyx_pf_17shift_calculators_allocate_array(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_len, PyObject *__pyx_v_type) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("allocate_array", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2.__pyx_n = 1;
  __pyx_t_2.type = __pyx_v_type;
  __pyx_t_1 = ((PyObject *)__pyx_f_17shift_calculators_allocate_array(__pyx_v_len, 0, &__pyx_t_2));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.allocate_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* "Cython_shift_calculator.pyx":66
 *     return <code><</code>EnsembleSimulation*><code><</code>size_t>int(simulation.this)
 * 
 * cpdef array.array allocate_array(int len, type='d'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     result = array.array(type,[0])
 *     array.resize(result, len)
 */
struct __pyx_opt_args_17shift_calculators_allocate_array {
  int __pyx_n;
  PyObject *type;
};
</pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line67")'> 67:     result = array.array(type,[0])</pre>
<pre id='line67' class='code' style='background-color: #FFFF52'>
  /* "Cython_shift_calculator.pyx":67
 * 
 * cpdef array.array allocate_array(int len, type='d'):
 *     result = array.array(type,[0])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     array.resize(result, len)
 *     array.zero(result)
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_0);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_0);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_type);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_type);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_type);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, ((PyObject *)__pyx_t_1));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_1));
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)__pyx_ptype_7cpython_5array_array)), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_v_result = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line68")'> 68:     array.resize(result, len)</pre>
<pre id='line68' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":68
 * cpdef array.array allocate_array(int len, type='d'):
 *     result = array.array(type,[0])
 *     array.resize(result, len)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     array.zero(result)
 *     return result
 */
  if (!(likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_result, __pyx_ptype_7cpython_5array_array))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  resize(((arrayobject *)__pyx_v_result), __pyx_v_len);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line69")'> 69:     array.zero(result)</pre>
<pre id='line69' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":69
 *     result = array.array(type,[0])
 *     array.resize(result, len)
 *     array.zero(result)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return result
 * 
 */
  if (!(likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_result, __pyx_ptype_7cpython_5array_array))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_f_7cpython_5array_zero(((arrayobject *)__pyx_v_result));
</pre><pre class='line' style='background-color: #FFFF29' onclick='toggleDiv("line70")'> 70:     return result</pre>
<pre id='line70' class='code' style='background-color: #FFFF29'>
  /* "Cython_shift_calculator.pyx":70
 *     array.resize(result, len)
 *     array.zero(result)
 *     return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cpdef zero_array(array.array in_array):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  if (!(likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_result, __pyx_ptype_7cpython_5array_array))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 70; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_result);
  __pyx_r = ((arrayobject *)__pyx_v_result);
  goto __pyx_L0;

  __pyx_r = ((arrayobject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.allocate_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>((PyObject *)__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_1allocate_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_1allocate_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_len;
  PyObject *__pyx_v_type = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("allocate_array (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__len,&__pyx_n_s__type,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject *)__pyx_n_s__d);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__len)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__type);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "allocate_array") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_len = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_len == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_type = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("allocate_array", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.allocate_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_allocate_array(__pyx_self, __pyx_v_len, __pyx_v_type);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line71")'> 71: </pre>
<pre id='line71' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line72")'> 72: cpdef zero_array(array.array in_array):</pre>
<pre id='line72' class='code' style='background-color: #FFFF9f'>
/* "Cython_shift_calculator.pyx":72
 *     return result
 * 
 * cpdef zero_array(array.array in_array):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *      array.zero(in_array)
 * 
 */

static PyObject *__pyx_pw_17shift_calculators_3zero_array(PyObject *__pyx_self, PyObject *__pyx_v_in_array); /*proto*/
static PyObject *__pyx_f_17shift_calculators_zero_array(arrayobject *__pyx_v_in_array, CYTHON_UNUSED int __pyx_skip_dispatch) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("zero_array", 0);

/* "Cython_shift_calculator.pyx":72
 *     return result
 * 
 * cpdef zero_array(array.array in_array):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *      array.zero(in_array)
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_2zero_array(CYTHON_UNUSED PyObject *__pyx_self, arrayobject *__pyx_v_in_array) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("zero_array", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_17shift_calculators_zero_array(__pyx_v_in_array, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.zero_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line73")'> 73:      array.zero(in_array)</pre>
<pre id='line73' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":73
 * 
 * cpdef zero_array(array.array in_array):
 *      array.zero(in_array)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cpdef resize_array(array.array in_array, int len):
 */
  __pyx_f_7cpython_5array_zero(__pyx_v_in_array);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_3zero_array(PyObject *__pyx_self, PyObject *__pyx_v_in_array); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_3zero_array(PyObject *__pyx_self, PyObject *__pyx_v_in_array) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("zero_array (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_in_array), __pyx_ptype_7cpython_5array_array, 1, "in_array", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_2zero_array(__pyx_self, ((arrayobject *)__pyx_v_in_array));
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line74")'> 74: </pre>
<pre id='line74' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF29' onclick='toggleDiv("line75")'> 75: cpdef resize_array(array.array in_array, int len):</pre>
<pre id='line75' class='code' style='background-color: #FFFF29'>
/* "Cython_shift_calculator.pyx":75
 *      array.zero(in_array)
 * 
 * cpdef resize_array(array.array in_array, int len):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     array.resize(in_array, len)
 * 
 */

static PyObject *__pyx_pw_17shift_calculators_5resize_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_17shift_calculators_resize_array(arrayobject *__pyx_v_in_array, int __pyx_v_len, CYTHON_UNUSED int __pyx_skip_dispatch) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("resize_array", 0);

/* "Cython_shift_calculator.pyx":75
 *      array.zero(in_array)
 * 
 * cpdef resize_array(array.array in_array, int len):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     array.resize(in_array, len)
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_4resize_array(CYTHON_UNUSED PyObject *__pyx_self, arrayobject *__pyx_v_in_array, int __pyx_v_len) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("resize_array", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_17shift_calculators_resize_array(__pyx_v_in_array, __pyx_v_len, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.resize_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_7test_dump_component_index_pair(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_17shift_calculators_7test_dump_component_index_pair = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("test_dump_component_index_pair"), (PyCFunction)__pyx_pw_17shift_calculators_7test_dump_component_index_pair, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_17shift_calculators_7test_dump_component_index_pair(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_data = 0;
  int __pyx_v_index;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("test_dump_component_index_pair (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__data,&__pyx_n_s__index,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__data)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__index)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("test_dump_component_index_pair", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "test_dump_component_index_pair") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_data = ((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)values[0]);
    __pyx_v_index = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_index == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("test_dump_component_index_pair", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.test_dump_component_index_pair", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_data), __pyx_ptype_17shift_calculators_Non_bonded_interaction_list, 1, "data", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_6test_dump_component_index_pair(__pyx_self, __pyx_v_data, __pyx_v_index);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFF2d' onclick='toggleDiv("line76")'> 76:     array.resize(in_array, len)</pre>
<pre id='line76' class='code' style='background-color: #FFFF2d'>
  /* "Cython_shift_calculator.pyx":76
 * 
 * cpdef resize_array(array.array in_array, int len):
 *     array.resize(in_array, len)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef struct Random_coil_component:
 */
  resize(__pyx_v_in_array, __pyx_v_len);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_5resize_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_5resize_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  arrayobject *__pyx_v_in_array = 0;
  int __pyx_v_len;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("resize_array (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__in_array,&__pyx_n_s__len,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__in_array)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__len)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("resize_array", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "resize_array") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_in_array = ((arrayobject *)values[0]);
    __pyx_v_len = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_len == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("resize_array", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.resize_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_in_array), __pyx_ptype_7cpython_5array_array, 1, "in_array", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_4resize_array(__pyx_self, __pyx_v_in_array, __pyx_v_len);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line77")'> 77: </pre>
<pre id='line77' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line78")'> 78: cdef struct Random_coil_component:</pre>
<pre id='line78' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":78
 *     array.resize(in_array, len)
 * 
 * cdef struct Random_coil_component:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     int target_atom
 *     float shift
 */
struct __pyx_t_17shift_calculators_Random_coil_component {
  int target_atom;
  float shift;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line79")'> 79:     int target_atom</pre>
<pre id='line79' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line80")'> 80:     float shift</pre>
<pre id='line80' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line81")'> 81: </pre>
<pre id='line81' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line82")'> 82: cdef struct Nonbonded_coefficient_component:</pre>
<pre id='line82' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":82
 *     float shift
 * 
 * cdef struct Nonbonded_coefficient_component:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     int chem_type_id
 *     int sphere_id
 */
struct __pyx_t_17shift_calculators_Nonbonded_coefficient_component {
  int chem_type_id;
  int sphere_id;
  float exponent;
  float coefficients[(3 * 7)];
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line83")'> 83:     int chem_type_id</pre>
<pre id='line83' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line84")'> 84:     int sphere_id</pre>
<pre id='line84' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line85")'> 85:     float exponent</pre>
<pre id='line85' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line86")'> 86:     float[3*7] coefficients</pre>
<pre id='line86' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line87")'> 87: </pre>
<pre id='line87' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line88")'> 88: cdef struct Distance_component:</pre>
<pre id='line88' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":88
 *     float[3*7] coefficients
 * 
 * cdef struct Distance_component:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *       int target_atom
 *       int remote_atom_1
 */
struct __pyx_t_17shift_calculators_Distance_component {
  int target_atom;
  int remote_atom_1;
  int remote_atom_2;
  float coefficient;
  float exponent;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line89")'> 89:       int target_atom</pre>
<pre id='line89' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line90")'> 90:       int remote_atom_1</pre>
<pre id='line90' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line91")'> 91:       int remote_atom_2</pre>
<pre id='line91' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line92")'> 92:       float coefficient</pre>
<pre id='line92' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line93")'> 93:       float exponent</pre>
<pre id='line93' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line94")'> 94: </pre>
<pre id='line94' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line95")'> 95: cdef struct Dihedral_component:</pre>
<pre id='line95' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":95
 *       float exponent
 * 
 * cdef struct Dihedral_component:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *       int target_atom
 *       int[4] dihedral_atoms
 */
struct __pyx_t_17shift_calculators_Dihedral_component {
  int target_atom;
  int dihedral_atoms[4];
  float coefficient;
  float parameters[6];
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line96")'> 96:       int target_atom</pre>
<pre id='line96' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line97")'> 97:       int[4] dihedral_atoms</pre>
<pre id='line97' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line98")'> 98:       float coefficient</pre>
<pre id='line98' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line99")'> 99:       float[6] parameters</pre>
<pre id='line99' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line100")'> 100:       #TODO: there seems to be an extra float here...</pre>
<pre id='line100' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line101")'> 101: </pre>
<pre id='line101' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line102")'> 102: #TODO: same as sing target component unite and rename</pre>
<pre id='line102' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line103")'> 103: cdef struct Non_bonded_target_component:</pre>
<pre id='line103' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":103
 * 
 * #TODO: same as sing target component unite and rename
 * cdef struct Non_bonded_target_component:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *       int target_atom_id
 *       int atom_type_id
 */
struct __pyx_t_17shift_calculators_Non_bonded_target_component {
  int target_atom_id;
  int atom_type_id;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line104")'> 104:       int target_atom_id</pre>
<pre id='line104' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line105")'> 105:       int atom_type_id</pre>
<pre id='line105' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line106")'> 106: </pre>
<pre id='line106' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line107")'> 107: cdef struct Non_bonded_remote_atom_component:</pre>
<pre id='line107' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":107
 *       int atom_type_id
 * 
 * cdef struct Non_bonded_remote_atom_component:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *       int remote_atom_id
 *       int chem_type[2] # one for each sphere
 */
struct __pyx_t_17shift_calculators_Non_bonded_remote_atom_component {
  int remote_atom_id;
  int chem_type[2];
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line108")'> 108:       int remote_atom_id</pre>
<pre id='line108' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line109")'> 109:       int chem_type[2] # one for each sphere</pre>
<pre id='line109' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line110")'> 110: </pre>
<pre id='line110' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line111")'> 111: </pre>
<pre id='line111' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line112")'> 112: </pre>
<pre id='line112' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line113")'> 113: </pre>
<pre id='line113' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line114")'> 114: </pre>
<pre id='line114' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line115")'> 115: def test_dump_component_index_pair(Non_bonded_interaction_list data, int index):</pre>
<pre id='line115' class='code' style='background-color: #FFFF62'>
/* "Cython_shift_calculator.pyx":115
 * 
 * 
 * def test_dump_component_index_pair(Non_bonded_interaction_list data, int index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Component_index_pair* result =  data.get(index)
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_6test_dump_component_index_pair(CYTHON_UNUSED PyObject *__pyx_self, struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_data, int __pyx_v_index) {
  struct __pyx_t_17shift_calculators_Component_index_pair *__pyx_v_result;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("test_dump_component_index_pair", 0);

  /* "Cython_shift_calculator.pyx":115
 * 
 * 
 * def test_dump_component_index_pair(Non_bonded_interaction_list data, int index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Component_index_pair* result =  data.get(index)
 * 
 */
  __pyx_k_tuple_83 = <span class='py_c_api'>PyTuple_Pack</span>(3, ((PyObject *)__pyx_n_s__data), ((PyObject *)__pyx_n_s__index), ((PyObject *)__pyx_n_s__result));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_83)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_83);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_83));

  /* "Cython_shift_calculator.pyx":115
 * 
 * 
 * def test_dump_component_index_pair(Non_bonded_interaction_list data, int index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Component_index_pair* result =  data.get(index)
 * 
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_17shift_calculators_7test_dump_component_index_pair, NULL, __pyx_n_s__shift_calculators);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s_85, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_84 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(2, 0, 3, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_83, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_86, __pyx_n_s_85, 115, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_84)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line116")'> 116:     cdef Component_index_pair* result =  data.get(index)</pre>
<pre id='line116' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":116
 * 
 * def test_dump_component_index_pair(Non_bonded_interaction_list data, int index):
 *     cdef Component_index_pair* result =  data.get(index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     return result[0].target_atom_id, result[0].target_index, result[0].remote_index, result[0].component_index
 */
  __pyx_v_result = __pyx_f_17shift_calculators_27Non_bonded_interaction_list_get(__pyx_v_data, __pyx_v_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line117")'> 117: </pre>
<pre id='line117' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF31' onclick='toggleDiv("line118")'> 118:     return result[0].target_atom_id, result[0].target_index, result[0].remote_index, result[0].component_index</pre>
<pre id='line118' class='code' style='background-color: #FFFF31'>
  /* "Cython_shift_calculator.pyx":118
 *     cdef Component_index_pair* result =  data.get(index)
 * 
 *     return result[0].target_atom_id, result[0].target_index, result[0].remote_index, result[0].component_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * def test_dump_component_offsets(data):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_result[0]).target_atom_id);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_result[0]).target_index);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_result[0]).remote_index);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_result[0]).component_index);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_t_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 3, __pyx_t_4);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_r = ((PyObject *)__pyx_t_5);
  __pyx_t_5 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.test_dump_component_index_pair", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_9test_dump_component_offsets(PyObject *__pyx_self, PyObject *__pyx_v_data); /*proto*/
static PyMethodDef __pyx_mdef_17shift_calculators_9test_dump_component_offsets = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("test_dump_component_offsets"), (PyCFunction)__pyx_pw_17shift_calculators_9test_dump_component_offsets, METH_O, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_17shift_calculators_9test_dump_component_offsets(PyObject *__pyx_self, PyObject *__pyx_v_data) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("test_dump_component_offsets (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_8test_dump_component_offsets(__pyx_self, ((PyObject *)__pyx_v_data));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line119")'> 119: </pre>
<pre id='line119' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line120")'> 120: def test_dump_component_offsets(data):</pre>
<pre id='line120' class='code' style='background-color: #FFFF62'>
/* "Cython_shift_calculator.pyx":120
 *     return result[0].target_atom_id, result[0].target_index, result[0].remote_index, result[0].component_index
 * 
 * def test_dump_component_offsets(data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef size_t  test  = ctypes.addressof(data)
 *     cdef Component_Offsets* test2 = <code><</code>Component_Offsets*> test
 */

static PyObject *__pyx_pf_17shift_calculators_8test_dump_component_offsets(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data) {
  size_t __pyx_v_test;
  struct __pyx_t_17shift_calculators_Component_Offsets *__pyx_v_test2;
  __Pyx_memviewslice __pyx_v_dummy_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_result = NULL;
  PyObject *__pyx_v_result_data = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("test_dump_component_offsets", 0);

  /* "Cython_shift_calculator.pyx":120
 *     return result[0].target_atom_id, result[0].target_index, result[0].remote_index, result[0].component_index
 * 
 * def test_dump_component_offsets(data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef size_t  test  = ctypes.addressof(data)
 *     cdef Component_Offsets* test2 = <code><</code>Component_Offsets*> test
 */
  __pyx_k_tuple_87 = <span class='py_c_api'>PyTuple_Pack</span>(7, ((PyObject *)__pyx_n_s__data), ((PyObject *)__pyx_n_s__test), ((PyObject *)__pyx_n_s__test2), ((PyObject *)__pyx_n_s__dummy_view), ((PyObject *)__pyx_n_s__result), ((PyObject *)__pyx_n_s__result_data), ((PyObject *)__pyx_n_s__i));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_87)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_87);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_87));

  /* "Cython_shift_calculator.pyx":120
 *     return result[0].target_atom_id, result[0].target_index, result[0].remote_index, result[0].component_index
 * 
 * def test_dump_component_offsets(data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef size_t  test  = ctypes.addressof(data)
 *     cdef Component_Offsets* test2 = <code><</code>Component_Offsets*> test
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_17shift_calculators_9test_dump_component_offsets, NULL, __pyx_n_s__shift_calculators);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s_89, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_88 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(1, 0, 7, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_87, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_86, __pyx_n_s_89, 120, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_88)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line121")'> 121:     cdef size_t  test  = ctypes.addressof(data)</pre>
<pre id='line121' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":121
 * 
 * def test_dump_component_offsets(data):
 *     cdef size_t  test  = ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Component_Offsets* test2 = <code><</code>Component_Offsets*> test
 *     cdef Component_Offsets[:] dummy_view
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_test = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line122")'> 122:     cdef Component_Offsets* test2 = &lt;Component_Offsets*&gt; test</pre>
<pre id='line122' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":122
 * def test_dump_component_offsets(data):
 *     cdef size_t  test  = ctypes.addressof(data)
 *     cdef Component_Offsets* test2 = <code><</code>Component_Offsets*> test             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Component_Offsets[:] dummy_view
 *     if len(data) == 0:
 */
  __pyx_v_test2 = ((struct __pyx_t_17shift_calculators_Component_Offsets *)__pyx_v_test);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line123")'> 123:     cdef Component_Offsets[:] dummy_view</pre>
<pre id='line123' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line124")'> 124:     if len(data) == 0:</pre>
<pre id='line124' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":124
 *     cdef Component_Offsets* test2 = <code><</code>Component_Offsets*> test
 *     cdef Component_Offsets[:] dummy_view
 *     if len(data) == 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result = ()
 *     else:
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = (__pyx_t_5 == 0);
  if (__pyx_t_6) {
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line125")'> 125:         result = ()</pre>
<pre id='line125' class='code' style='background-color: #FFFFe7'>
    /* "Cython_shift_calculator.pyx":125
 *     cdef Component_Offsets[:] dummy_view
 *     if len(data) == 0:
 *         result = ()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     else:
 *         dummy_view = <code><</code>Component_Offsets[:len(data)/ sizeof(Component_Offsets)]> &test2[0]
 */
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_empty_tuple));
    __pyx_v_result = __pyx_empty_tuple;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line126")'> 126:     else:</pre>
<pre id='line126' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line127")'> 127:         dummy_view = &lt;Component_Offsets[:len(data)/ sizeof(Component_Offsets)]&gt; &amp;test2[0]</pre>
<pre id='line127' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":127
 *         result = ()
 *     else:
 *         dummy_view = <code><</code>Component_Offsets[:len(data)/ sizeof(Component_Offsets)]> &test2[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         result_data = []
 */
    __pyx_t_7 = (&(__pyx_v_test2[0]));
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    if (!__pyx_t_7) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_1 = __pyx_format_from_typeinfo(&__Pyx_TypeInfo_nn_struct___pyx_t_17shift_calculators_Component_Offsets);
    __pyx_t_3 = Py_BuildValue("("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)(__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Component_Offsets)))));
    if (unlikely(!__pyx_t_1 || !__pyx_t_3 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_8 = __pyx_array_new(__pyx_t_3, sizeof(struct __pyx_t_17shift_calculators_Component_Offsets), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_1), (char *) "c", (char *) __pyx_t_7);
    if (unlikely(!__pyx_t_8))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn_struct___pyx_t_17shift_calculators_Component_Offsets(((PyObject *)__pyx_t_8));
    if (unlikely(!__pyx_t_9.memview))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
    __pyx_v_dummy_view = __pyx_t_9;
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line128")'> 128: </pre>
<pre id='line128' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line129")'> 129:         result_data = []</pre>
<pre id='line129' class='code' style='background-color: #FFFFaa'>
    /* "Cython_shift_calculator.pyx":129
 *         dummy_view = <code><</code>Component_Offsets[:len(data)/ sizeof(Component_Offsets)]> &test2[0]
 * 
 *         result_data = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for i in range(len(data)/ sizeof(Component_Offsets)):
 *             result_data.append((dummy_view[i].id,  dummy_view[i].offset,  dummy_view[i].length))
 */
    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_v_result_data = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF1e' onclick='toggleDiv("line130")'> 130:         for i in range(len(data)/ sizeof(Component_Offsets)):</pre>
<pre id='line130' class='code' style='background-color: #FFFF1e'>
    /* "Cython_shift_calculator.pyx":130
 * 
 *         result_data = []
 *         for i in range(len(data)/ sizeof(Component_Offsets)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             result_data.append((dummy_view[i].id,  dummy_view[i].offset,  dummy_view[i].length))
 *         result = tuple(result_data)
 */
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = __Pyx_<span class='py_c_api'>PyInt_FromSize_t</span>((__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Component_Offsets))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      __pyx_t_3 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5 = 0;
      __pyx_t_10 = NULL;
    } else {
      __pyx_t_5 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_10 = Py_TYPE(__pyx_t_3)->tp_iternext;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (!__pyx_t_10 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) {
        if (__pyx_t_5 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else if (!__pyx_t_10 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
        if (__pyx_t_5 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else {
        __pyx_t_1 = __pyx_t_10(__pyx_t_3);
        if (unlikely(!__pyx_t_1)) {
          if (<span class='py_c_api'>PyErr_Occurred</span>()) {
            if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
      __pyx_v_i = __pyx_t_1;
      __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF24' onclick='toggleDiv("line131")'> 131:             result_data.append((dummy_view[i].id,  dummy_view[i].offset,  dummy_view[i].length))</pre>
<pre id='line131' class='code' style='background-color: #FFFF24'>
      /* "Cython_shift_calculator.pyx":131
 *         result_data = []
 *         for i in range(len(data)/ sizeof(Component_Offsets)):
 *             result_data.append((dummy_view[i].id,  dummy_view[i].offset,  dummy_view[i].length))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result = tuple(result_data)
 *     return result
 */
      __pyx_t_11 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_12 = __pyx_t_11;
      __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>((*((struct __pyx_t_17shift_calculators_Component_Offsets *) ( /* dim=0 */ (__pyx_v_dummy_view.data + __pyx_t_12 * __pyx_v_dummy_view.strides[0]) ))).id);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_11 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_13 = __pyx_t_11;
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>((*((struct __pyx_t_17shift_calculators_Component_Offsets *) ( /* dim=0 */ (__pyx_v_dummy_view.data + __pyx_t_13 * __pyx_v_dummy_view.strides[0]) ))).offset);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_11 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_14 = __pyx_t_11;
      __pyx_t_15 = <span class='py_c_api'>PyInt_FromLong</span>((*((struct __pyx_t_17shift_calculators_Component_Offsets *) ( /* dim=0 */ (__pyx_v_dummy_view.data + __pyx_t_14 * __pyx_v_dummy_view.strides[0]) ))).length);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
      __pyx_t_16 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_16);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 0, __pyx_t_1);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 1, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 2, __pyx_t_15);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_15);
      __pyx_t_1 = 0;
      __pyx_t_2 = 0;
      __pyx_t_15 = 0;
      __pyx_t_17 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_result_data, ((PyObject *)__pyx_t_16));<span class='error_goto'> if (unlikely(__pyx_t_17 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_16)); __pyx_t_16 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line132")'> 132:         result = tuple(result_data)</pre>
<pre id='line132' class='code' style='background-color: #FFFFaa'>
    /* "Cython_shift_calculator.pyx":132
 *         for i in range(len(data)/ sizeof(Component_Offsets)):
 *             result_data.append((dummy_view[i].id,  dummy_view[i].offset,  dummy_view[i].length))
 *         result = tuple(result_data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return result
 * 
 */
    __pyx_t_3 = ((PyObject *)<span class='py_c_api'>PyList_AsTuple</span>(__pyx_v_result_data));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
    __pyx_v_result = ((PyObject*)__pyx_t_3);
    __pyx_t_3 = 0;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line133")'> 133:     return result</pre>
<pre id='line133' class='code' style='background-color: #FFFF5b'>
  /* "Cython_shift_calculator.pyx":133
 *             result_data.append((dummy_view[i].id,  dummy_view[i].offset,  dummy_view[i].length))
 *         result = tuple(result_data)
 *     return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_result));
  __pyx_r = ((PyObject *)__pyx_v_result);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_t_8));
  __PYX_XDEC_MEMVIEW(&__pyx_t_9, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.test_dump_component_offsets", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&__pyx_v_dummy_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result_data);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_11test_dump_dist_comp(PyObject *__pyx_self, PyObject *__pyx_v_data); /*proto*/
static PyMethodDef __pyx_mdef_17shift_calculators_11test_dump_dist_comp = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("test_dump_dist_comp"), (PyCFunction)__pyx_pw_17shift_calculators_11test_dump_dist_comp, METH_O, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_17shift_calculators_11test_dump_dist_comp(PyObject *__pyx_self, PyObject *__pyx_v_data) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("test_dump_dist_comp (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_10test_dump_dist_comp(__pyx_self, ((PyObject *)__pyx_v_data));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line134")'> 134: </pre>
<pre id='line134' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line135")'> 135: </pre>
<pre id='line135' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line136")'> 136: def test_dump_dist_comp(data):</pre>
<pre id='line136' class='code' style='background-color: #FFFF62'>
/* "Cython_shift_calculator.pyx":136
 * 
 * 
 * def test_dump_dist_comp(data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef size_t  test  = ctypes.addressof(data)
 *     cdef Distance_component* test2 = <code><</code>Distance_component*> test
 */

static PyObject *__pyx_pf_17shift_calculators_10test_dump_dist_comp(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data) {
  size_t __pyx_v_test;
  struct __pyx_t_17shift_calculators_Distance_component *__pyx_v_test2;
  __Pyx_memviewslice __pyx_v_dummy_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_result = NULL;
  PyObject *__pyx_v_result_data = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("test_dump_dist_comp", 0);

  /* "Cython_shift_calculator.pyx":136
 * 
 * 
 * def test_dump_dist_comp(data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef size_t  test  = ctypes.addressof(data)
 *     cdef Distance_component* test2 = <code><</code>Distance_component*> test
 */
  __pyx_k_tuple_90 = <span class='py_c_api'>PyTuple_Pack</span>(7, ((PyObject *)__pyx_n_s__data), ((PyObject *)__pyx_n_s__test), ((PyObject *)__pyx_n_s__test2), ((PyObject *)__pyx_n_s__dummy_view), ((PyObject *)__pyx_n_s__result), ((PyObject *)__pyx_n_s__result_data), ((PyObject *)__pyx_n_s__i));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_90)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_90);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_90));

  /* "Cython_shift_calculator.pyx":136
 * 
 * 
 * def test_dump_dist_comp(data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef size_t  test  = ctypes.addressof(data)
 *     cdef Distance_component* test2 = <code><</code>Distance_component*> test
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_17shift_calculators_11test_dump_dist_comp, NULL, __pyx_n_s__shift_calculators);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__test_dump_dist_comp, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_91 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(1, 0, 7, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_90, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_86, __pyx_n_s__test_dump_dist_comp, 136, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_91)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line137")'> 137:     cdef size_t  test  = ctypes.addressof(data)</pre>
<pre id='line137' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":137
 * 
 * def test_dump_dist_comp(data):
 *     cdef size_t  test  = ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Distance_component* test2 = <code><</code>Distance_component*> test
 *     cdef Distance_component[:] dummy_view
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_test = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line138")'> 138:     cdef Distance_component* test2 = &lt;Distance_component*&gt; test</pre>
<pre id='line138' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":138
 * def test_dump_dist_comp(data):
 *     cdef size_t  test  = ctypes.addressof(data)
 *     cdef Distance_component* test2 = <code><</code>Distance_component*> test             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Distance_component[:] dummy_view
 *     if len(data) == 0:
 */
  __pyx_v_test2 = ((struct __pyx_t_17shift_calculators_Distance_component *)__pyx_v_test);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line139")'> 139:     cdef Distance_component[:] dummy_view</pre>
<pre id='line139' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line140")'> 140:     if len(data) == 0:</pre>
<pre id='line140' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":140
 *     cdef Distance_component* test2 = <code><</code>Distance_component*> test
 *     cdef Distance_component[:] dummy_view
 *     if len(data) == 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result = ()
 *     else:
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = (__pyx_t_5 == 0);
  if (__pyx_t_6) {
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line141")'> 141:         result = ()</pre>
<pre id='line141' class='code' style='background-color: #FFFFe7'>
    /* "Cython_shift_calculator.pyx":141
 *     cdef Distance_component[:] dummy_view
 *     if len(data) == 0:
 *         result = ()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     else:
 *         dummy_view = <code><</code>Distance_component[:len(data)/ sizeof(Distance_component)]> &test2[0]
 */
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_empty_tuple));
    __pyx_v_result = __pyx_empty_tuple;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line142")'> 142:     else:</pre>
<pre id='line142' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line143")'> 143:         dummy_view = &lt;Distance_component[:len(data)/ sizeof(Distance_component)]&gt; &amp;test2[0]</pre>
<pre id='line143' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":143
 *         result = ()
 *     else:
 *         dummy_view = <code><</code>Distance_component[:len(data)/ sizeof(Distance_component)]> &test2[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         result_data = []
 */
    __pyx_t_7 = (&(__pyx_v_test2[0]));
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    if (!__pyx_t_7) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_1 = __pyx_format_from_typeinfo(&__Pyx_TypeInfo_nn_struct___pyx_t_17shift_calculators_Distance_component);
    __pyx_t_3 = Py_BuildValue("("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)(__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Distance_component)))));
    if (unlikely(!__pyx_t_1 || !__pyx_t_3 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_8 = __pyx_array_new(__pyx_t_3, sizeof(struct __pyx_t_17shift_calculators_Distance_component), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_1), (char *) "c", (char *) __pyx_t_7);
    if (unlikely(!__pyx_t_8))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn_struct___pyx_t_17shift_calculators_Distance_component(((PyObject *)__pyx_t_8));
    if (unlikely(!__pyx_t_9.memview))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
    __pyx_v_dummy_view = __pyx_t_9;
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line144")'> 144: </pre>
<pre id='line144' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line145")'> 145:         result_data = []</pre>
<pre id='line145' class='code' style='background-color: #FFFFaa'>
    /* "Cython_shift_calculator.pyx":145
 *         dummy_view = <code><</code>Distance_component[:len(data)/ sizeof(Distance_component)]> &test2[0]
 * 
 *         result_data = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for i in range(len(data)/ sizeof(Distance_component)):
 *             result_data.append((dummy_view[i].target_atom,  dummy_view[i].remote_atom_1,  dummy_view[i].remote_atom_2,   dummy_view[i].coefficient, dummy_view[i].exponent))
 */
    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_v_result_data = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF1e' onclick='toggleDiv("line146")'> 146:         for i in range(len(data)/ sizeof(Distance_component)):</pre>
<pre id='line146' class='code' style='background-color: #FFFF1e'>
    /* "Cython_shift_calculator.pyx":146
 * 
 *         result_data = []
 *         for i in range(len(data)/ sizeof(Distance_component)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             result_data.append((dummy_view[i].target_atom,  dummy_view[i].remote_atom_1,  dummy_view[i].remote_atom_2,   dummy_view[i].coefficient, dummy_view[i].exponent))
 *         result = tuple(result_data)
 */
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = __Pyx_<span class='py_c_api'>PyInt_FromSize_t</span>((__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Distance_component))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      __pyx_t_3 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5 = 0;
      __pyx_t_10 = NULL;
    } else {
      __pyx_t_5 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_10 = Py_TYPE(__pyx_t_3)->tp_iternext;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (!__pyx_t_10 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) {
        if (__pyx_t_5 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else if (!__pyx_t_10 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
        if (__pyx_t_5 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else {
        __pyx_t_1 = __pyx_t_10(__pyx_t_3);
        if (unlikely(!__pyx_t_1)) {
          if (<span class='py_c_api'>PyErr_Occurred</span>()) {
            if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
      __pyx_v_i = __pyx_t_1;
      __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF19' onclick='toggleDiv("line147")'> 147:             result_data.append((dummy_view[i].target_atom,  dummy_view[i].remote_atom_1,  dummy_view[i].remote_atom_2,   dummy_view[i].coefficient, dummy_view[i].exponent))</pre>
<pre id='line147' class='code' style='background-color: #FFFF19'>
      /* "Cython_shift_calculator.pyx":147
 *         result_data = []
 *         for i in range(len(data)/ sizeof(Distance_component)):
 *             result_data.append((dummy_view[i].target_atom,  dummy_view[i].remote_atom_1,  dummy_view[i].remote_atom_2,   dummy_view[i].coefficient, dummy_view[i].exponent))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result = tuple(result_data)
 *     return result
 */
      __pyx_t_11 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_12 = __pyx_t_11;
      __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>((*((struct __pyx_t_17shift_calculators_Distance_component *) ( /* dim=0 */ (__pyx_v_dummy_view.data + __pyx_t_12 * __pyx_v_dummy_view.strides[0]) ))).target_atom);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_11 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_13 = __pyx_t_11;
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>((*((struct __pyx_t_17shift_calculators_Distance_component *) ( /* dim=0 */ (__pyx_v_dummy_view.data + __pyx_t_13 * __pyx_v_dummy_view.strides[0]) ))).remote_atom_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_11 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_14 = __pyx_t_11;
      __pyx_t_15 = <span class='py_c_api'>PyInt_FromLong</span>((*((struct __pyx_t_17shift_calculators_Distance_component *) ( /* dim=0 */ (__pyx_v_dummy_view.data + __pyx_t_14 * __pyx_v_dummy_view.strides[0]) ))).remote_atom_2);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
      __pyx_t_11 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_16 = __pyx_t_11;
      __pyx_t_17 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((struct __pyx_t_17shift_calculators_Distance_component *) ( /* dim=0 */ (__pyx_v_dummy_view.data + __pyx_t_16 * __pyx_v_dummy_view.strides[0]) ))).coefficient);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
      __pyx_t_11 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_18 = __pyx_t_11;
      __pyx_t_19 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((struct __pyx_t_17shift_calculators_Distance_component *) ( /* dim=0 */ (__pyx_v_dummy_view.data + __pyx_t_18 * __pyx_v_dummy_view.strides[0]) ))).exponent);<span class='error_goto'> if (unlikely(!__pyx_t_19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_19);
      __pyx_t_20 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_20)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_20);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 0, __pyx_t_1);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 1, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 2, __pyx_t_15);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_15);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 3, __pyx_t_17);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_17);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 4, __pyx_t_19);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_19);
      __pyx_t_1 = 0;
      __pyx_t_2 = 0;
      __pyx_t_15 = 0;
      __pyx_t_17 = 0;
      __pyx_t_19 = 0;
      __pyx_t_21 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_result_data, ((PyObject *)__pyx_t_20));<span class='error_goto'> if (unlikely(__pyx_t_21 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_20)); __pyx_t_20 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line148")'> 148:         result = tuple(result_data)</pre>
<pre id='line148' class='code' style='background-color: #FFFFaa'>
    /* "Cython_shift_calculator.pyx":148
 *         for i in range(len(data)/ sizeof(Distance_component)):
 *             result_data.append((dummy_view[i].target_atom,  dummy_view[i].remote_atom_1,  dummy_view[i].remote_atom_2,   dummy_view[i].coefficient, dummy_view[i].exponent))
 *         result = tuple(result_data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return result
 * 
 */
    __pyx_t_3 = ((PyObject *)<span class='py_c_api'>PyList_AsTuple</span>(__pyx_v_result_data));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
    __pyx_v_result = ((PyObject*)__pyx_t_3);
    __pyx_t_3 = 0;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line149")'> 149:     return result</pre>
<pre id='line149' class='code' style='background-color: #FFFF55'>
  /* "Cython_shift_calculator.pyx":149
 *             result_data.append((dummy_view[i].target_atom,  dummy_view[i].remote_atom_1,  dummy_view[i].remote_atom_2,   dummy_view[i].coefficient, dummy_view[i].exponent))
 *         result = tuple(result_data)
 *     return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * def test_dump_dihedral_comp(data):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_result));
  __pyx_r = ((PyObject *)__pyx_v_result);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_t_8));
  __PYX_XDEC_MEMVIEW(&__pyx_t_9, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_19);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.test_dump_dist_comp", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&__pyx_v_dummy_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result_data);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_13test_dump_dihedral_comp(PyObject *__pyx_self, PyObject *__pyx_v_data); /*proto*/
static PyMethodDef __pyx_mdef_17shift_calculators_13test_dump_dihedral_comp = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("test_dump_dihedral_comp"), (PyCFunction)__pyx_pw_17shift_calculators_13test_dump_dihedral_comp, METH_O, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_17shift_calculators_13test_dump_dihedral_comp(PyObject *__pyx_self, PyObject *__pyx_v_data) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("test_dump_dihedral_comp (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_12test_dump_dihedral_comp(__pyx_self, ((PyObject *)__pyx_v_data));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line150")'> 150: </pre>
<pre id='line150' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line151")'> 151: def test_dump_dihedral_comp(data):</pre>
<pre id='line151' class='code' style='background-color: #FFFF62'>
/* "Cython_shift_calculator.pyx":151
 *     return result
 * 
 * def test_dump_dihedral_comp(data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef size_t  test  = ctypes.addressof(data)
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_12test_dump_dihedral_comp(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data) {
  size_t __pyx_v_test;
  struct __pyx_t_17shift_calculators_Dihedral_component *__pyx_v_compiled_components;
  PyObject *__pyx_v_num_components = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("test_dump_dihedral_comp", 0);

  /* "Cython_shift_calculator.pyx":151
 *     return result
 * 
 * def test_dump_dihedral_comp(data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef size_t  test  = ctypes.addressof(data)
 * 
 */
  __pyx_k_tuple_92 = <span class='py_c_api'>PyTuple_Pack</span>(5, ((PyObject *)__pyx_n_s__data), ((PyObject *)__pyx_n_s__test), ((PyObject *)__pyx_n_s__compiled_components), ((PyObject *)__pyx_n_s__num_components), ((PyObject *)__pyx_n_s__i));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_92)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_92);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_92));

  /* "Cython_shift_calculator.pyx":151
 *     return result
 * 
 * def test_dump_dihedral_comp(data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef size_t  test  = ctypes.addressof(data)
 * 
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_17shift_calculators_13test_dump_dihedral_comp, NULL, __pyx_n_s__shift_calculators);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s_94, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_93 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(1, 0, 5, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_92, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_86, __pyx_n_s_94, 151, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_93)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line152")'> 152:     cdef size_t  test  = ctypes.addressof(data)</pre>
<pre id='line152' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":152
 * 
 * def test_dump_dihedral_comp(data):
 *     cdef size_t  test  = ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     compiled_components =  <code><</code>Dihedral_component*> <code><</code>size_t> ctypes.addressof(data)
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_test = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line153")'> 153: </pre>
<pre id='line153' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line154")'> 154:     compiled_components =  &lt;Dihedral_component*&gt; &lt;size_t&gt; ctypes.addressof(data)</pre>
<pre id='line154' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":154
 *     cdef size_t  test  = ctypes.addressof(data)
 * 
 *     compiled_components =  <code><</code>Dihedral_component*> <code><</code>size_t> ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     num_components =  len(data)/ sizeof(Dihedral_component)
 *     print 'dump num comp',num_components, test
 */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 154; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_3, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 154; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 154; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 154; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 154; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_compiled_components = ((struct __pyx_t_17shift_calculators_Dihedral_component *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line155")'> 155:     num_components =  len(data)/ sizeof(Dihedral_component)</pre>
<pre id='line155' class='code' style='background-color: #FFFF7f'>
  /* "Cython_shift_calculator.pyx":155
 * 
 *     compiled_components =  <code><</code>Dihedral_component*> <code><</code>size_t> ctypes.addressof(data)
 *     num_components =  len(data)/ sizeof(Dihedral_component)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     print 'dump num comp',num_components, test
 * 
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyInt_FromSize_t</span>((__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Dihedral_component))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_v_num_components = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line156")'> 156:     print 'dump num comp',num_components, test</pre>
<pre id='line156' class='code' style='background-color: #FFFF5b'>
  /* "Cython_shift_calculator.pyx":156
 *     compiled_components =  <code><</code>Dihedral_component*> <code><</code>size_t> ctypes.addressof(data)
 *     num_components =  len(data)/ sizeof(Dihedral_component)
 *     print 'dump num comp',num_components, test             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     for i in range(num_components):
 */
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyInt_FromSize_t</span>(__pyx_v_test);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 156; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 156; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_6));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, ((PyObject *)__pyx_kp_s_6));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_6));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_components);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_num_components);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_num_components);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;
  if (<span class='pyx_c_api'>__Pyx_Print</span>(0, ((PyObject *)__pyx_t_3), 1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 156; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line157")'> 157: </pre>
<pre id='line157' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF22' onclick='toggleDiv("line158")'> 158:     for i in range(num_components):</pre>
<pre id='line158' class='code' style='background-color: #FFFF22'>
  /* "Cython_shift_calculator.pyx":158
 *     print 'dump num comp',num_components, test
 * 
 *     for i in range(num_components):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         print 'target_atom',i, compiled_components[0].target_atom
 */
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_components);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_num_components);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_num_components);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
    __pyx_t_3 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_6 = Py_TYPE(__pyx_t_3)->tp_iternext;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (!__pyx_t_6 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) {
      if (__pyx_t_5 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_6 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
      if (__pyx_t_5 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_2 = __pyx_t_6(__pyx_t_3);
      if (unlikely(!__pyx_t_2)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
    __pyx_v_i = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line159")'> 159: </pre>
<pre id='line159' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line160")'> 160:         print 'target_atom',i, compiled_components[0].target_atom</pre>
<pre id='line160' class='code' style='background-color: #FFFF5b'>
    /* "Cython_shift_calculator.pyx":160
 *     for i in range(num_components):
 * 
 *         print 'target_atom',i, compiled_components[0].target_atom             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         print 'dihedral_atoms',i, compiled_components[i].dihedral_atoms[0],compiled_components[i].dihedral_atoms[1],\
 */
    __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_compiled_components[0]).target_atom);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__target_atom));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_n_s__target_atom));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__target_atom));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_i);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_t_2);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
    __pyx_t_2 = 0;
    if (<span class='pyx_c_api'>__Pyx_Print</span>(0, ((PyObject *)__pyx_t_1), 1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line161")'> 161: </pre>
<pre id='line161' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line162")'> 162:         print 'dihedral_atoms',i, compiled_components[i].dihedral_atoms[0],compiled_components[i].dihedral_atoms[1],\</pre>
<pre id='line162' class='code' style='background-color: #FFFF3f'>
    /* "Cython_shift_calculator.pyx":162
 *         print 'target_atom',i, compiled_components[0].target_atom
 * 
 *         print 'dihedral_atoms',i, compiled_components[i].dihedral_atoms[0],compiled_components[i].dihedral_atoms[1],\             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                compiled_components[i].dihedral_atoms[2], compiled_components[i].dihedral_atoms[4]
 *         print 'coeff',i, compiled_components[i].coefficient
 */
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(((__pyx_v_compiled_components[__pyx_t_7]).dihedral_atoms[0]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(((__pyx_v_compiled_components[__pyx_t_7]).dihedral_atoms[1]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
</pre><pre class='line' style='background-color: #FFFF2d' onclick='toggleDiv("line163")'> 163:                                compiled_components[i].dihedral_atoms[2], compiled_components[i].dihedral_atoms[4]</pre>
<pre id='line163' class='code' style='background-color: #FFFF2d'>
    /* "Cython_shift_calculator.pyx":163
 * 
 *         print 'dihedral_atoms',i, compiled_components[i].dihedral_atoms[0],compiled_components[i].dihedral_atoms[1],\
 *                                compiled_components[i].dihedral_atoms[2], compiled_components[i].dihedral_atoms[4]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         print 'coeff',i, compiled_components[i].coefficient
 *         print 'param',i, compiled_components[i].parameters[0], compiled_components[i].parameters[1],\
 */
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_8 = <span class='py_c_api'>PyInt_FromLong</span>(((__pyx_v_compiled_components[__pyx_t_7]).dihedral_atoms[2]));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_9 = <span class='py_c_api'>PyInt_FromLong</span>(((__pyx_v_compiled_components[__pyx_t_7]).dihedral_atoms[4]));<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
    __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__dihedral_atoms));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, ((PyObject *)__pyx_n_s__dihedral_atoms));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__dihedral_atoms));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_v_i);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 2, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 3, __pyx_t_2);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 4, __pyx_t_8);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 5, __pyx_t_9);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_9);
    __pyx_t_1 = 0;
    __pyx_t_2 = 0;
    __pyx_t_8 = 0;
    __pyx_t_9 = 0;
    if (<span class='pyx_c_api'>__Pyx_Print</span>(0, ((PyObject *)__pyx_t_10), 1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_10)); __pyx_t_10 = 0;
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line164")'> 164:         print 'coeff',i, compiled_components[i].coefficient</pre>
<pre id='line164' class='code' style='background-color: #FFFF43'>
    /* "Cython_shift_calculator.pyx":164
 *         print 'dihedral_atoms',i, compiled_components[i].dihedral_atoms[0],compiled_components[i].dihedral_atoms[1],\
 *                                compiled_components[i].dihedral_atoms[2], compiled_components[i].dihedral_atoms[4]
 *         print 'coeff',i, compiled_components[i].coefficient             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         print 'param',i, compiled_components[i].parameters[0], compiled_components[i].parameters[1],\
 *                       compiled_components[i].parameters[2], compiled_components[i].parameters[3],\
 */
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_10 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_compiled_components[__pyx_t_7]).coefficient);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__coeff));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, ((PyObject *)__pyx_n_s__coeff));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__coeff));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_v_i);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2, __pyx_t_10);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_10);
    __pyx_t_10 = 0;
    if (<span class='pyx_c_api'>__Pyx_Print</span>(0, ((PyObject *)__pyx_t_9), 1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_9)); __pyx_t_9 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line165")'> 165:         print 'param',i, compiled_components[i].parameters[0], compiled_components[i].parameters[1],\</pre>
<pre id='line165' class='code' style='background-color: #FFFF3f'>
    /* "Cython_shift_calculator.pyx":165
 *                                compiled_components[i].dihedral_atoms[2], compiled_components[i].dihedral_atoms[4]
 *         print 'coeff',i, compiled_components[i].coefficient
 *         print 'param',i, compiled_components[i].parameters[0], compiled_components[i].parameters[1],\             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                       compiled_components[i].parameters[2], compiled_components[i].parameters[3],\
 *                       compiled_components[i].parameters[4], compiled_components[i].parameters[5],\
 */
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_compiled_components[__pyx_t_7]).parameters[0]));<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_10 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_compiled_components[__pyx_t_7]).parameters[1]));<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line166")'> 166:                       compiled_components[i].parameters[2], compiled_components[i].parameters[3],\</pre>
<pre id='line166' class='code' style='background-color: #FFFF3f'>
    /* "Cython_shift_calculator.pyx":166
 *         print 'coeff',i, compiled_components[i].coefficient
 *         print 'param',i, compiled_components[i].parameters[0], compiled_components[i].parameters[1],\
 *                       compiled_components[i].parameters[2], compiled_components[i].parameters[3],\             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                       compiled_components[i].parameters[4], compiled_components[i].parameters[5],\
 *                       compiled_components[i].parameters[6]
 */
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_compiled_components[__pyx_t_7]).parameters[2]));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_compiled_components[__pyx_t_7]).parameters[3]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line167")'> 167:                       compiled_components[i].parameters[4], compiled_components[i].parameters[5],\</pre>
<pre id='line167' class='code' style='background-color: #FFFF3f'>
    /* "Cython_shift_calculator.pyx":167
 *         print 'param',i, compiled_components[i].parameters[0], compiled_components[i].parameters[1],\
 *                       compiled_components[i].parameters[2], compiled_components[i].parameters[3],\
 *                       compiled_components[i].parameters[4], compiled_components[i].parameters[5],\             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                       compiled_components[i].parameters[6]
 * 
 */
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_compiled_components[__pyx_t_7]).parameters[4]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_compiled_components[__pyx_t_7]).parameters[5]));<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
</pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line168")'> 168:                       compiled_components[i].parameters[6]</pre>
<pre id='line168' class='code' style='background-color: #FFFF2a'>
    /* "Cython_shift_calculator.pyx":168
 *                       compiled_components[i].parameters[2], compiled_components[i].parameters[3],\
 *                       compiled_components[i].parameters[4], compiled_components[i].parameters[5],\
 *                       compiled_components[i].parameters[6]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 168; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_12 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_compiled_components[__pyx_t_7]).parameters[6]));<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 168; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
    __pyx_t_13 = <span class='py_c_api'>PyTuple_New</span>(9);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__param));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0, ((PyObject *)__pyx_n_s__param));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__param));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 1, __pyx_v_i);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 2, __pyx_t_9);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 3, __pyx_t_10);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_10);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 4, __pyx_t_8);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 5, __pyx_t_2);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 6, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 7, __pyx_t_11);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_11);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 8, __pyx_t_12);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_12);
    __pyx_t_9 = 0;
    __pyx_t_10 = 0;
    __pyx_t_8 = 0;
    __pyx_t_2 = 0;
    __pyx_t_1 = 0;
    __pyx_t_11 = 0;
    __pyx_t_12 = 0;
    if (<span class='pyx_c_api'>__Pyx_Print</span>(0, ((PyObject *)__pyx_t_13), 1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_13)); __pyx_t_13 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.test_dump_dihedral_comp", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_components);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_20CDSSharedVectorFloat_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_20CDSSharedVectorFloat_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_size;
  PyObject *__pyx_v_ensembleSimulation = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__size,&__pyx_n_s__ensembleSimulation,0};
    PyObject* values[2] = {0,0};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line169")'> 169: </pre>
<pre id='line169' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line170")'> 170: </pre>
<pre id='line170' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line171")'> 171: cdef class CDSSharedVectorFloat:</pre>
<pre id='line171' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":171
 * 
 * 
 * cdef class CDSSharedVectorFloat:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */

struct __pyx_vtabstruct_17shift_calculators_CDSSharedVectorFloat {
  void (*resize)(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *, int);
  CDSVector<code><</code>double> *(*get_data)(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *);
  int (*size)(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *);
};
static struct __pyx_vtabstruct_17shift_calculators_CDSSharedVectorFloat *__pyx_vtabptr_17shift_calculators_CDSSharedVectorFloat;


</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line172")'> 172: </pre>
<pre id='line172' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line173")'> 173: </pre>
<pre id='line173' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF33' onclick='toggleDiv("line174")'> 174:     def __cinit__(self, int size=0, object ensembleSimulation=None):</pre>
<pre id='line174' class='code' style='background-color: #FFFF33'>
    /* "Cython_shift_calculator.pyx":174
 * 
 * 
 *     def __cinit__(self, int size=0, object ensembleSimulation=None):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef EnsembleSimulation* cEnsembleSimulation = simulationAsNative(ensembleSimulation)
 *         #TODO: get rid of this casting
 */
    values[1] = ((PyObject *)Py_None);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__size);
          if (value) { values[0] = value; kw_args--; }
        }
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__ensembleSimulation);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    if (values[0]) {
      __pyx_v_size = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_size == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_size = ((int)0);
    }
    __pyx_v_ensembleSimulation = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 0, 0, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.CDSSharedVectorFloat.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_20CDSSharedVectorFloat___cinit__(((struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *)__pyx_v_self), __pyx_v_size, __pyx_v_ensembleSimulation);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

static int __pyx_pf_17shift_calculators_20CDSSharedVectorFloat___cinit__(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_self, int __pyx_v_size, PyObject *__pyx_v_ensembleSimulation) {
  EnsembleSimulation *__pyx_v_cEnsembleSimulation;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line175")'> 175:         cdef EnsembleSimulation* cEnsembleSimulation = simulationAsNative(ensembleSimulation)</pre>
<pre id='line175' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":175
 * 
 *     def __cinit__(self, int size=0, object ensembleSimulation=None):
 *         cdef EnsembleSimulation* cEnsembleSimulation = simulationAsNative(ensembleSimulation)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         #TODO: get rid of this casting
 *         self.data = <code><</code>CDSVector[double]*>createSharedVec(size, 0.0,  cEnsembleSimulation)
 */
  __pyx_t_1 = __pyx_f_17shift_calculators_simulationAsNative(__pyx_v_ensembleSimulation);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_cEnsembleSimulation = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line176")'> 176:         #TODO: get rid of this casting</pre>
<pre id='line176' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line177")'> 177:         self.data = &lt;CDSVector[double]*&gt;createSharedVec(size, 0.0,  cEnsembleSimulation)</pre>
<pre id='line177' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":177
 *         cdef EnsembleSimulation* cEnsembleSimulation = simulationAsNative(ensembleSimulation)
 *         #TODO: get rid of this casting
 *         self.data = <code><</code>CDSVector[double]*>createSharedVec(size, 0.0,  cEnsembleSimulation)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.resize(size)
 * 
 */
  __pyx_v_self->data = ((CDSVector<code><</code>double> *)SharedCDSVectorFactory::createSharedVec(__pyx_v_size, 0.0, __pyx_v_cEnsembleSimulation));
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line178")'> 178:         self.resize(size)</pre>
<pre id='line178' class='code' style='background-color: #FFFFc4'>
  /* "Cython_shift_calculator.pyx":178
 *         #TODO: get rid of this casting
 *         self.data = <code><</code>CDSVector[double]*>createSharedVec(size, 0.0,  cEnsembleSimulation)
 *         self.resize(size)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef int size(self) nogil:
 */
  ((struct __pyx_vtabstruct_17shift_calculators_CDSSharedVectorFloat *)__pyx_v_self->__pyx_vtab)->resize(__pyx_v_self, __pyx_v_size);

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.CDSSharedVectorFloat.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line179")'> 179: </pre>
<pre id='line179' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line180")'> 180:     cdef int size(self) nogil:</pre>
<pre id='line180' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":180
 *         self.resize(size)
 * 
 *     cdef int size(self) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *          return self.data[0].size()
 * 
 */

static int __pyx_f_17shift_calculators_20CDSSharedVectorFloat_size(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_self) {
  int __pyx_r;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line181")'> 181:          return self.data[0].size()</pre>
<pre id='line181' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":181
 * 
 *     cdef int size(self) nogil:
 *          return self.data[0].size()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void resize(self,int size) nogil:
 */
  __pyx_r = (__pyx_v_self->data[0]).size();
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line182")'> 182: </pre>
<pre id='line182' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line183")'> 183:     cdef void resize(self,int size) nogil:</pre>
<pre id='line183' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":183
 *          return self.data[0].size()
 * 
 *     cdef void resize(self,int size) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.data[0].resize(size)
 * 
 */

static void __pyx_f_17shift_calculators_20CDSSharedVectorFloat_resize(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_self, int __pyx_v_size) {
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line184")'> 184:         self.data[0].resize(size)</pre>
<pre id='line184' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":184
 * 
 *     cdef void resize(self,int size) nogil:
 *         self.data[0].resize(size)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def clear(self):
 */
  (__pyx_v_self->data[0]).resize(__pyx_v_size);

}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_20CDSSharedVectorFloat_3clear(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_20CDSSharedVectorFloat_3clear(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("clear (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_20CDSSharedVectorFloat_2clear(((struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line185")'> 185: </pre>
<pre id='line185' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line186")'> 186:     def clear(self):</pre>
<pre id='line186' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":186
 *         self.data[0].resize(size)
 * 
 *     def clear(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         clearVector(self.data)
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_20CDSSharedVectorFloat_2clear(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("clear", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line187")'> 187:         clearVector(self.data)</pre>
<pre id='line187' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":187
 * 
 *     def clear(self):
 *         clearVector(self.data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     #TODO: a bit ugly can we use operator
 */
  SharedCDSVectorFactory::clearVector(__pyx_v_self->data);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line188")'> 188: </pre>
<pre id='line188' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line189")'> 189:     #TODO: a bit ugly can we use operator</pre>
<pre id='line189' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line190")'> 190:     cdef CDSVector[double]* get_data(self) nogil:</pre>
<pre id='line190' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":190
 * 
 *     #TODO: a bit ugly can we use operator
 *     cdef CDSVector[double]* get_data(self) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return  self.data
 * 
 */

static CDSVector<code><</code>double> *__pyx_f_17shift_calculators_20CDSSharedVectorFloat_get_data(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_self) {
  CDSVector<code><</code>double> *__pyx_r;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line191")'> 191:         return  self.data</pre>
<pre id='line191' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":191
 *     #TODO: a bit ugly can we use operator
 *     cdef CDSVector[double]* get_data(self) nogil:
 *         return  self.data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __len__(self):
 */
  __pyx_r = __pyx_v_self->data;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}

/* Python wrapper */
static Py_ssize_t __pyx_pw_17shift_calculators_20CDSSharedVectorFloat_5__len__(PyObject *__pyx_v_self); /*proto*/
static Py_ssize_t __pyx_pw_17shift_calculators_20CDSSharedVectorFloat_5__len__(PyObject *__pyx_v_self) {
  Py_ssize_t __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__len__ (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_20CDSSharedVectorFloat_4__len__(((struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line192")'> 192: </pre>
<pre id='line192' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line193")'> 193:     def __len__(self):</pre>
<pre id='line193' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":193
 *         return  self.data
 * 
 *     def __len__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self.data[0].size()
 * 
 */

static Py_ssize_t __pyx_pf_17shift_calculators_20CDSSharedVectorFloat_4__len__(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_self) {
  Py_ssize_t __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__len__", 0);
</pre><pre class='line' style='background-color: #FFFF2f' onclick='toggleDiv("line194")'> 194:         return self.data[0].size()</pre>
<pre id='line194' class='code' style='background-color: #FFFF2f'>
  /* "Cython_shift_calculator.pyx":194
 * 
 *     def __len__(self):
 *         return self.data[0].size()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef  class Non_bonded_interaction_list:
 */
  __pyx_r = (__pyx_v_self->data[0]).size();
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_27Non_bonded_interaction_list_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_27Non_bonded_interaction_list_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_length;
  double __pyx_v_fill_factor;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__length,&__pyx_n_s__fill_factor,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__length);
          if (value) { values[0] = value; kw_args--; }
        }
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__fill_factor);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    if (values[0]) {
      __pyx_v_length = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_length == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_length = ((int)0);
    }
    if (values[1]) {
      __pyx_v_fill_factor = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_fill_factor == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line195")'> 195: </pre>
<pre id='line195' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line196")'> 196: cdef  class Non_bonded_interaction_list:</pre>
<pre id='line196' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":196
 *         return self.data[0].size()
 * 
 * cdef  class Non_bonded_interaction_list:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __cinit__(self, int length=0, double fill_factor=1.0):
 */

struct __pyx_vtabstruct_17shift_calculators_Non_bonded_interaction_list {
  void (*append)(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *, int, int, int, int);
  void (*resize)(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *);
  struct __pyx_t_17shift_calculators_Component_index_pair *(*get)(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *, int);
  int (*get_length)(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *);
};
static struct __pyx_vtabstruct_17shift_calculators_Non_bonded_interaction_list *__pyx_vtabptr_17shift_calculators_Non_bonded_interaction_list;
static CYTHON_INLINE void __pyx_f_17shift_calculators_27Non_bonded_interaction_list_append(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *, int, int, int, int);
static CYTHON_INLINE void __pyx_f_17shift_calculators_27Non_bonded_interaction_list_resize(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *);
static CYTHON_INLINE struct __pyx_t_17shift_calculators_Component_index_pair *__pyx_f_17shift_calculators_27Non_bonded_interaction_list_get(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *, int);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line197")'> 197: </pre>
<pre id='line197' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line198")'> 198:     def __cinit__(self, int length=0, double fill_factor=1.0):</pre>
<pre id='line198' class='code' style='background-color: #FFFF96'>
      /* "Cython_shift_calculator.pyx":198
 * cdef  class Non_bonded_interaction_list:
 * 
 *     def __cinit__(self, int length=0, double fill_factor=1.0):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.data = new CDSVector[int]()
 *         self.data[0].resize(<code><</code>int>ceil(length*fill_factor*2))
 */
      __pyx_v_fill_factor = ((double)1.0);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 0, 0, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Non_bonded_interaction_list.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_27Non_bonded_interaction_list___cinit__(((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)__pyx_v_self), __pyx_v_length, __pyx_v_fill_factor);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

static int __pyx_pf_17shift_calculators_27Non_bonded_interaction_list___cinit__(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_self, int __pyx_v_length, double __pyx_v_fill_factor) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line199")'> 199:         self.data = new CDSVector[int]()</pre>
<pre id='line199' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":199
 * 
 *     def __cinit__(self, int length=0, double fill_factor=1.0):
 *         self.data = new CDSVector[int]()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.data[0].resize(<code><</code>int>ceil(length*fill_factor*2))
 *         self.length =  0
 */
  __pyx_v_self->data = new CDSVector<code><</code>int>();
</pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line200")'> 200:         self.data[0].resize(&lt;int&gt;ceil(length*fill_factor*2))</pre>
<pre id='line200' class='code' style='background-color: #FFFF3e'>
  /* "Cython_shift_calculator.pyx":200
 *     def __cinit__(self, int length=0, double fill_factor=1.0):
 *         self.data = new CDSVector[int]()
 *         self.data[0].resize(<code><</code>int>ceil(length*fill_factor*2))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.length =  0
 *         self.size_increment =  20
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ceil);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_length * __pyx_v_fill_factor) * 2.0));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_4 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  (__pyx_v_self->data[0]).resize(((int)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line201")'> 201:         self.length =  0</pre>
<pre id='line201' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":201
 *         self.data = new CDSVector[int]()
 *         self.data[0].resize(<code><</code>int>ceil(length*fill_factor*2))
 *         self.length =  0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.size_increment =  20
 *         self.RECORD_LENGTH = 4
 */
  __pyx_v_self->length = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line202")'> 202:         self.size_increment =  20</pre>
<pre id='line202' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":202
 *         self.data[0].resize(<code><</code>int>ceil(length*fill_factor*2))
 *         self.length =  0
 *         self.size_increment =  20             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.RECORD_LENGTH = 4
 * 
 */
  __pyx_v_self->size_increment = 20;
</pre><pre class='line' style='background-color: #FFFF1a' onclick='toggleDiv("line203")'> 203:         self.RECORD_LENGTH = 4</pre>
<pre id='line203' class='code' style='background-color: #FFFF1a'>
  /* "Cython_shift_calculator.pyx":203
 *         self.length =  0
 *         self.size_increment =  20
 *         self.RECORD_LENGTH = 4             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def test_append(self,int target_atom_id, int target_id, int remote_id, component_index):
 */
  __pyx_v_self->RECORD_LENGTH = 4;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Non_bonded_interaction_list.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_27Non_bonded_interaction_list_3test_append(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_27Non_bonded_interaction_list_3test_append(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_target_atom_id;
  int __pyx_v_target_id;
  int __pyx_v_remote_id;
  PyObject *__pyx_v_component_index = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("test_append (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__target_atom_id,&__pyx_n_s__target_id,&__pyx_n_s__remote_id,&__pyx_n_s__component_index,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__target_atom_id)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__target_id)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("test_append", 1, 4, 4, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__remote_id)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("test_append", 1, 4, 4, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__component_index)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("test_append", 1, 4, 4, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "test_append") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_target_atom_id = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_target_atom_id == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_target_id = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_target_id == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_remote_id = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_remote_id == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_component_index = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("test_append", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Non_bonded_interaction_list.test_append", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_27Non_bonded_interaction_list_2test_append(((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)__pyx_v_self), __pyx_v_target_atom_id, __pyx_v_target_id, __pyx_v_remote_id, __pyx_v_component_index);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line204")'> 204: </pre>
<pre id='line204' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line205")'> 205:     def test_append(self,int target_atom_id, int target_id, int remote_id, component_index):</pre>
<pre id='line205' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":205
 *         self.RECORD_LENGTH = 4
 * 
 *     def test_append(self,int target_atom_id, int target_id, int remote_id, component_index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.append(target_atom_id,  target_id,  remote_id, component_index)
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_27Non_bonded_interaction_list_2test_append(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_self, int __pyx_v_target_atom_id, int __pyx_v_target_id, int __pyx_v_remote_id, PyObject *__pyx_v_component_index) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("test_append", 0);
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line206")'> 206:         self.append(target_atom_id,  target_id,  remote_id, component_index)</pre>
<pre id='line206' class='code' style='background-color: #FFFF66'>
  /* "Cython_shift_calculator.pyx":206
 * 
 *     def test_append(self,int target_atom_id, int target_id, int remote_id, component_index):
 *         self.append(target_atom_id,  target_id,  remote_id, component_index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def clear(self):
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_component_index);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_f_17shift_calculators_27Non_bonded_interaction_list_append(__pyx_v_self, __pyx_v_target_atom_id, __pyx_v_target_id, __pyx_v_remote_id, __pyx_t_1);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Non_bonded_interaction_list.test_append", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_27Non_bonded_interaction_list_5clear(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_27Non_bonded_interaction_list_5clear(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("clear (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_27Non_bonded_interaction_list_4clear(((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line207")'> 207: </pre>
<pre id='line207' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line208")'> 208:     def clear(self):</pre>
<pre id='line208' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":208
 *         self.append(target_atom_id,  target_id,  remote_id, component_index)
 * 
 *     def clear(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.length = 0
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_27Non_bonded_interaction_list_4clear(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("clear", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line209")'> 209:         self.length = 0</pre>
<pre id='line209' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":209
 * 
 *     def clear(self):
 *         self.length = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline void append(self, int target_atom_id, int target_id, int remote_id, int component_index):
 */
  __pyx_v_self->length = 0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line210")'> 210: </pre>
<pre id='line210' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line211")'> 211:     cdef inline void append(self, int target_atom_id, int target_id, int remote_id, int component_index):</pre>
<pre id='line211' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":211
 *         self.length = 0
 * 
 *     cdef inline void append(self, int target_atom_id, int target_id, int remote_id, int component_index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if  self.data[0].size()*self.RECORD_LENGTH <code><</code>= self.length*self.RECORD_LENGTH:
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_27Non_bonded_interaction_list_append(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_self, int __pyx_v_target_atom_id, int __pyx_v_target_id, int __pyx_v_remote_id, int __pyx_v_component_index) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("append", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line212")'> 212: </pre>
<pre id='line212' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line213")'> 213:         if  self.data[0].size()*self.RECORD_LENGTH &lt;= self.length*self.RECORD_LENGTH:</pre>
<pre id='line213' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":213
 *     cdef inline void append(self, int target_atom_id, int target_id, int remote_id, int component_index):
 * 
 *         if  self.data[0].size()*self.RECORD_LENGTH <code><</code>= self.length*self.RECORD_LENGTH:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self.resize()
 *         self.data[0][self.length] = target_atom_id
 */
  __pyx_t_1 = (((__pyx_v_self->data[0]).size() * __pyx_v_self->RECORD_LENGTH) <code><</code>= (__pyx_v_self->length * __pyx_v_self->RECORD_LENGTH));
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line214")'> 214:             self.resize()</pre>
<pre id='line214' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":214
 * 
 *         if  self.data[0].size()*self.RECORD_LENGTH <code><</code>= self.length*self.RECORD_LENGTH:
 *             self.resize()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.data[0][self.length] = target_atom_id
 *         self.data[0][self.length+1] = target_id
 */
    __pyx_f_17shift_calculators_27Non_bonded_interaction_list_resize(__pyx_v_self);
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line215")'> 215:         self.data[0][self.length] = target_atom_id</pre>
<pre id='line215' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":215
 *         if  self.data[0].size()*self.RECORD_LENGTH <code><</code>= self.length*self.RECORD_LENGTH:
 *             self.resize()
 *         self.data[0][self.length] = target_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.data[0][self.length+1] = target_id
 *         self.data[0][self.length+2] = remote_id
 */
  ((__pyx_v_self->data[0])[__pyx_v_self->length]) = __pyx_v_target_atom_id;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line216")'> 216:         self.data[0][self.length+1] = target_id</pre>
<pre id='line216' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":216
 *             self.resize()
 *         self.data[0][self.length] = target_atom_id
 *         self.data[0][self.length+1] = target_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.data[0][self.length+2] = remote_id
 *         self.data[0][self.length+3] = component_index
 */
  ((__pyx_v_self->data[0])[(__pyx_v_self->length + 1)]) = __pyx_v_target_id;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line217")'> 217:         self.data[0][self.length+2] = remote_id</pre>
<pre id='line217' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":217
 *         self.data[0][self.length] = target_atom_id
 *         self.data[0][self.length+1] = target_id
 *         self.data[0][self.length+2] = remote_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.data[0][self.length+3] = component_index
 * 
 */
  ((__pyx_v_self->data[0])[(__pyx_v_self->length + 2)]) = __pyx_v_remote_id;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line218")'> 218:         self.data[0][self.length+3] = component_index</pre>
<pre id='line218' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":218
 *         self.data[0][self.length+1] = target_id
 *         self.data[0][self.length+2] = remote_id
 *         self.data[0][self.length+3] = component_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self.length += self.RECORD_LENGTH
 */
  ((__pyx_v_self->data[0])[(__pyx_v_self->length + 3)]) = __pyx_v_component_index;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line219")'> 219: </pre>
<pre id='line219' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line220")'> 220:         self.length += self.RECORD_LENGTH</pre>
<pre id='line220' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":220
 *         self.data[0][self.length+3] = component_index
 * 
 *         self.length += self.RECORD_LENGTH             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_self->length = (__pyx_v_self->length + __pyx_v_self->RECORD_LENGTH);

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line221")'> 221: </pre>
<pre id='line221' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line222")'> 222: </pre>
<pre id='line222' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line223")'> 223:     cdef inline void resize(self):</pre>
<pre id='line223' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":223
 * 
 * 
 *     cdef inline void resize(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.data[0].resize(self.data[0].size()+self.size_increment*self.RECORD_LENGTH)
 * 
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_27Non_bonded_interaction_list_resize(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("resize", 0);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line224")'> 224:         self.data[0].resize(self.data[0].size()+self.size_increment*self.RECORD_LENGTH)</pre>
<pre id='line224' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":224
 * 
 *     cdef inline void resize(self):
 *         self.data[0].resize(self.data[0].size()+self.size_increment*self.RECORD_LENGTH)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline Component_index_pair* get(self,int offset) nogil:
 */
  (__pyx_v_self->data[0]).resize(((__pyx_v_self->data[0]).size() + (__pyx_v_self->size_increment * __pyx_v_self->RECORD_LENGTH)));

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line225")'> 225: </pre>
<pre id='line225' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line226")'> 226:     cdef inline Component_index_pair* get(self,int offset) nogil:</pre>
<pre id='line226' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":226
 *         self.data[0].resize(self.data[0].size()+self.size_increment*self.RECORD_LENGTH)
 * 
 *     cdef inline Component_index_pair* get(self,int offset) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return <code><</code>Component_index_pair *> &self.data[0][offset*self.RECORD_LENGTH]
 * 
 */

static CYTHON_INLINE struct __pyx_t_17shift_calculators_Component_index_pair *__pyx_f_17shift_calculators_27Non_bonded_interaction_list_get(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_self, int __pyx_v_offset) {
  struct __pyx_t_17shift_calculators_Component_index_pair *__pyx_r;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line227")'> 227:         return &lt;Component_index_pair *&gt; &amp;self.data[0][offset*self.RECORD_LENGTH]</pre>
<pre id='line227' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":227
 * 
 *     cdef inline Component_index_pair* get(self,int offset) nogil:
 *         return <code><</code>Component_index_pair *> &self.data[0][offset*self.RECORD_LENGTH]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def get_allocation(self):
 */
  __pyx_r = ((struct __pyx_t_17shift_calculators_Component_index_pair *)(&((__pyx_v_self->data[0])[(__pyx_v_offset * __pyx_v_self->RECORD_LENGTH)])));
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_27Non_bonded_interaction_list_7get_allocation(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_27Non_bonded_interaction_list_7get_allocation(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_allocation (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_27Non_bonded_interaction_list_6get_allocation(((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line228")'> 228: </pre>
<pre id='line228' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line229")'> 229:     def get_allocation(self):</pre>
<pre id='line229' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":229
 *         return <code><</code>Component_index_pair *> &self.data[0][offset*self.RECORD_LENGTH]
 * 
 *     def get_allocation(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self.data[0].size()
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_27Non_bonded_interaction_list_6get_allocation(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_allocation", 0);
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line230")'> 230:         return self.data[0].size()</pre>
<pre id='line230' class='code' style='background-color: #FFFF73'>
  /* "Cython_shift_calculator.pyx":230
 * 
 *     def get_allocation(self):
 *         return self.data[0].size()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def get_size_increment(self):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_self->data[0]).size());<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Non_bonded_interaction_list.get_allocation", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_27Non_bonded_interaction_list_9get_size_increment(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_27Non_bonded_interaction_list_9get_size_increment(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_size_increment (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_27Non_bonded_interaction_list_8get_size_increment(((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line231")'> 231: </pre>
<pre id='line231' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line232")'> 232:     def get_size_increment(self):</pre>
<pre id='line232' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":232
 *         return self.data[0].size()
 * 
 *     def get_size_increment(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self.size_increment
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_27Non_bonded_interaction_list_8get_size_increment(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_size_increment", 0);
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line233")'> 233:         return self.size_increment</pre>
<pre id='line233' class='code' style='background-color: #FFFF73'>
  /* "Cython_shift_calculator.pyx":233
 * 
 *     def get_size_increment(self):
 *         return self.size_increment             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __len__(self):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->size_increment);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Non_bonded_interaction_list.get_size_increment", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static Py_ssize_t __pyx_pw_17shift_calculators_27Non_bonded_interaction_list_11__len__(PyObject *__pyx_v_self); /*proto*/
static Py_ssize_t __pyx_pw_17shift_calculators_27Non_bonded_interaction_list_11__len__(PyObject *__pyx_v_self) {
  Py_ssize_t __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__len__ (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_27Non_bonded_interaction_list_10__len__(((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line234")'> 234: </pre>
<pre id='line234' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line235")'> 235:     def __len__(self):</pre>
<pre id='line235' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":235
 *         return self.size_increment
 * 
 *     def __len__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self.get_length()
 * 
 */

static Py_ssize_t __pyx_pf_17shift_calculators_27Non_bonded_interaction_list_10__len__(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_self) {
  Py_ssize_t __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__len__", 0);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line236")'> 236:         return self.get_length()</pre>
<pre id='line236' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":236
 * 
 *     def __len__(self):
 *         return self.get_length()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef int get_length(self) nogil:
 */
  __pyx_r = ((struct __pyx_vtabstruct_17shift_calculators_Non_bonded_interaction_list *)__pyx_v_self->__pyx_vtab)->get_length(__pyx_v_self);
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line237")'> 237: </pre>
<pre id='line237' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line238")'> 238:     cdef int get_length(self) nogil:</pre>
<pre id='line238' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":238
 *         return self.get_length()
 * 
 *     cdef int get_length(self) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self.length/self.RECORD_LENGTH
 * 
 */

static int __pyx_f_17shift_calculators_27Non_bonded_interaction_list_get_length(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_self) {
  int __pyx_r;
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line239")'> 239:         return self.length/self.RECORD_LENGTH</pre>
<pre id='line239' class='code' style='background-color: #FFFF6a'>
  /* "Cython_shift_calculator.pyx":239
 * 
 *     cdef int get_length(self) nogil:
 *         return self.length/self.RECORD_LENGTH             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __getitem__(self, int key):
 */
  __pyx_r = (__pyx_v_self->length / __pyx_v_self->RECORD_LENGTH);
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_27Non_bonded_interaction_list_13__getitem__(PyObject *__pyx_v_self, PyObject *__pyx_arg_key); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_27Non_bonded_interaction_list_13__getitem__(PyObject *__pyx_v_self, PyObject *__pyx_arg_key) {
  int __pyx_v_key;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__getitem__ (wrapper)", 0);
  assert(__pyx_arg_key); {
    __pyx_v_key = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_arg_key);<span class='error_goto'> if (unlikely((__pyx_v_key == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 241; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Non_bonded_interaction_list.__getitem__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_27Non_bonded_interaction_list_12__getitem__(((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)__pyx_v_self), ((int)__pyx_v_key));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line240")'> 240: </pre>
<pre id='line240' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line241")'> 241:     def __getitem__(self, int key):</pre>
<pre id='line241' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":241
 *         return self.length/self.RECORD_LENGTH
 * 
 *     def __getitem__(self, int key):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if key >= self.length/self.RECORD_LENGTH:
 *             raise IndexError("index (%i) out of range (%i)" % (key, self.length/self.RECORD_LENGTH))
 */

static PyObject *__pyx_pf_17shift_calculators_27Non_bonded_interaction_list_12__getitem__(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_self, int __pyx_v_key) {
  PyObject *__pyx_v_result = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__getitem__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line242")'> 242:         if key &gt;= self.length/self.RECORD_LENGTH:</pre>
<pre id='line242' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":242
 * 
 *     def __getitem__(self, int key):
 *         if key >= self.length/self.RECORD_LENGTH:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             raise IndexError("index (%i) out of range (%i)" % (key, self.length/self.RECORD_LENGTH))
 *         result  = []
 */
  __pyx_t_1 = (__pyx_v_key >= (__pyx_v_self->length / __pyx_v_self->RECORD_LENGTH));
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFF35' onclick='toggleDiv("line243")'> 243:             raise IndexError("index (%i) out of range (%i)" % (key, self.length/self.RECORD_LENGTH))</pre>
<pre id='line243' class='code' style='background-color: #FFFF35'>
    /* "Cython_shift_calculator.pyx":243
 *     def __getitem__(self, int key):
 *         if key >= self.length/self.RECORD_LENGTH:
 *             raise IndexError("index (%i) out of range (%i)" % (key, self.length/self.RECORD_LENGTH))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result  = []
 *         for i in range(self.RECORD_LENGTH):
 */
    __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_self->length / __pyx_v_self->RECORD_LENGTH));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    __pyx_t_2 = 0;
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_7), ((PyObject *)__pyx_t_4));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, ((PyObject *)__pyx_t_3));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_3));
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_IndexError, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line244")'> 244:         result  = []</pre>
<pre id='line244' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":244
 *         if key >= self.length/self.RECORD_LENGTH:
 *             raise IndexError("index (%i) out of range (%i)" % (key, self.length/self.RECORD_LENGTH))
 *         result  = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for i in range(self.RECORD_LENGTH):
 *             result.append(self.data[0][key*self.RECORD_LENGTH+i])
 */
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 244; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_v_result = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line245")'> 245:         for i in range(self.RECORD_LENGTH):</pre>
<pre id='line245' class='code' style='background-color: #FFFF20'>
  /* "Cython_shift_calculator.pyx":245
 *             raise IndexError("index (%i) out of range (%i)" % (key, self.length/self.RECORD_LENGTH))
 *         result  = []
 *         for i in range(self.RECORD_LENGTH):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             result.append(self.data[0][key*self.RECORD_LENGTH+i])
 *         return tuple(result)
 */
  __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->RECORD_LENGTH);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
    __pyx_t_4 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (!__pyx_t_6 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4)) {
      if (__pyx_t_5 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_6 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {
      if (__pyx_t_5 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_3 = __pyx_t_6(__pyx_t_4);
      if (unlikely(!__pyx_t_3)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
    __pyx_v_i = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF39' onclick='toggleDiv("line246")'> 246:             result.append(self.data[0][key*self.RECORD_LENGTH+i])</pre>
<pre id='line246' class='code' style='background-color: #FFFF39'>
    /* "Cython_shift_calculator.pyx":246
 *         result  = []
 *         for i in range(self.RECORD_LENGTH):
 *             result.append(self.data[0][key*self.RECORD_LENGTH+i])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return tuple(result)
 * 
 */
    __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_key * __pyx_v_self->RECORD_LENGTH));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_7 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(((__pyx_v_self->data[0])[__pyx_t_7]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_8 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_result, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF35' onclick='toggleDiv("line247")'> 247:         return tuple(result)</pre>
<pre id='line247' class='code' style='background-color: #FFFF35'>
  /* "Cython_shift_calculator.pyx":247
 *         for i in range(self.RECORD_LENGTH):
 *             result.append(self.data[0][key*self.RECORD_LENGTH+i])
 *         return tuple(result)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def build_selection_list(self, accept = lambda x: True):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_4 = ((PyObject *)<span class='py_c_api'>PyList_AsTuple</span>(__pyx_v_result));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_4));
  __pyx_r = ((PyObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Non_bonded_interaction_list.__getitem__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_27Non_bonded_interaction_list_15build_selection_list(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_27Non_bonded_interaction_list_15build_selection_list(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_accept = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("build_selection_list (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__accept,0};
    PyObject* values[1] = {0};
    values[0] = __pyx_k_8;
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__accept);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "build_selection_list") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_accept = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("build_selection_list", 0, 0, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Non_bonded_interaction_list.build_selection_list", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_27Non_bonded_interaction_list_14build_selection_list(((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)__pyx_v_self), __pyx_v_accept);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line248")'> 248: </pre>
<pre id='line248' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line249")'> 249:     def build_selection_list(self, accept = lambda x: True):</pre>
<pre id='line249' class='code' style='background-color: #FFFF6e'>
/* "Cython_shift_calculator.pyx":249
 *         return tuple(result)
 * 
 *     def build_selection_list(self, accept = lambda x: True):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result = []
 *         for i,elem in enumerate(self):
 */

static PyObject *__pyx_lambda_funcdef_17shift_calculators_lambda1(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("lambda1", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.lambda1", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* "Cython_shift_calculator.pyx":249
 *         return tuple(result)
 * 
 *     def build_selection_list(self, accept = lambda x: True):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result = []
 *         for i,elem in enumerate(self):
 */

static PyObject *__pyx_pf_17shift_calculators_27Non_bonded_interaction_list_14build_selection_list(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_self, PyObject *__pyx_v_accept) {
  PyObject *__pyx_v_result = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_elem = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("build_selection_list", 0);

  /* "Cython_shift_calculator.pyx":249
 *         return tuple(result)
 * 
 *     def build_selection_list(self, accept = lambda x: True):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result = []
 *         for i,elem in enumerate(self):
 */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_17shift_calculators_14lambda1, 0, __pyx_n_s_95, NULL, __pyx_n_s__shift_calculators, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_k_8 = __pyx_t_2;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line250")'> 250:         result = []</pre>
<pre id='line250' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":250
 * 
 *     def build_selection_list(self, accept = lambda x: True):
 *         result = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for i,elem in enumerate(self):
 *             if accept(elem):
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 250; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_result = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF24' onclick='toggleDiv("line251")'> 251:         for i,elem in enumerate(self):</pre>
<pre id='line251' class='code' style='background-color: #FFFF24'>
  /* "Cython_shift_calculator.pyx":251
 *     def build_selection_list(self, accept = lambda x: True):
 *         result = []
 *         for i,elem in enumerate(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if accept(elem):
 *                 result.append(i)
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_t_1 = __pyx_int_0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(((PyObject *)__pyx_v_self)) || <span class='py_c_api'>PyTuple_CheckExact</span>(((PyObject *)__pyx_v_self))) {
    __pyx_t_2 = ((PyObject *)__pyx_v_self); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(((PyObject *)__pyx_v_self));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext;
  }
  for (;;) {
    if (!__pyx_t_4 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) {
      if (__pyx_t_3 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_4 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
      if (__pyx_t_3 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_5 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_5)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_elem);
    __pyx_v_elem = __pyx_t_5;
    __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
    __pyx_v_i = __pyx_t_1;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1);
    __pyx_t_1 = __pyx_t_5;
    __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line252")'> 252:             if accept(elem):</pre>
<pre id='line252' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":252
 *         result = []
 *         for i,elem in enumerate(self):
 *             if accept(elem):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 result.append(i)
 *         return array.array('i',result)
 */
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_elem);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_elem);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_elem);
    __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_v_accept, ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(__pyx_t_7 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (__pyx_t_7) {
</pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line253")'> 253:                 result.append(i)</pre>
<pre id='line253' class='code' style='background-color: #FFFF96'>
      /* "Cython_shift_calculator.pyx":253
 *         for i,elem in enumerate(self):
 *             if accept(elem):
 *                 result.append(i)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return array.array('i',result)
 * 
 */
      __pyx_t_8 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_result, __pyx_v_i);<span class='error_goto'> if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      goto __pyx_L5;
    }
    __pyx_L5:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line254")'> 254:         return array.array('i',result)</pre>
<pre id='line254' class='code' style='background-color: #FFFF43'>
  /* "Cython_shift_calculator.pyx":254
 *             if accept(elem):
 *                 result.append(i)
 *         return array.array('i',result)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__i));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_n_s__i));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__i));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_result));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_result));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_result));
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)__pyx_ptype_7cpython_5array_array)), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Non_bonded_interaction_list.build_selection_list", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_elem);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_27Non_bonded_interaction_list_17get_all_components(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_27Non_bonded_interaction_list_17get_all_components(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_all_components (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_27Non_bonded_interaction_list_16get_all_components(((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line255")'> 255: </pre>
<pre id='line255' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line256")'> 256: </pre>
<pre id='line256' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line257")'> 257:     def get_all_components(self):</pre>
<pre id='line257' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":257
 * 
 * 
 *     def get_all_components(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result = []
 *         for i in range(self.length/self.RECORD_LENGTH):
 */

static PyObject *__pyx_pf_17shift_calculators_27Non_bonded_interaction_list_16get_all_components(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_self) {
  PyObject *__pyx_v_result = NULL;
  int __pyx_v_i;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_all_components", 0);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line258")'> 258:         result = []</pre>
<pre id='line258' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":258
 * 
 *     def get_all_components(self):
 *         result = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for i in range(self.length/self.RECORD_LENGTH):
 *             result.append(self[i])
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_result = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line259")'> 259:         for i in range(self.length/self.RECORD_LENGTH):</pre>
<pre id='line259' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":259
 *     def get_all_components(self):
 *         result = []
 *         for i in range(self.length/self.RECORD_LENGTH):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             result.append(self[i])
 *         return result
 */
  __pyx_t_2 = (__pyx_v_self->length / __pyx_v_self->RECORD_LENGTH);
  for (__pyx_t_3 = 0; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line260")'> 260:             result.append(self[i])</pre>
<pre id='line260' class='code' style='background-color: #FFFF8d'>
    /* "Cython_shift_calculator.pyx":260
 *         result = []
 *         for i in range(self.length/self.RECORD_LENGTH):
 *             result.append(self[i])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return result
 * 
 */
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_self), __pyx_v_i, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_4 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_result, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line261")'> 261:         return result</pre>
<pre id='line261' class='code' style='background-color: #FFFF55'>
  /* "Cython_shift_calculator.pyx":261
 *         for i in range(self.length/self.RECORD_LENGTH):
 *             result.append(self[i])
 *         return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef class Vec3_list:
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_result));
  __pyx_r = ((PyObject *)__pyx_v_result);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Non_bonded_interaction_list.get_all_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_9Vec3_list_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_9Vec3_list_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) > 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) > 0) && unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__cinit__", 0))) return -1;
  __pyx_r = __pyx_pf_17shift_calculators_9Vec3_list___cinit__(((struct __pyx_obj_17shift_calculators_Vec3_list *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line262")'> 262: </pre>
<pre id='line262' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line263")'> 263: cdef class Vec3_list:</pre>
<pre id='line263' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":263
 *         return result
 * 
 * cdef class Vec3_list:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef CDSVector[Vec3] *data
 * 
 */
struct __pyx_obj_17shift_calculators_Vec3_list {
  PyObject_HEAD
  struct __pyx_vtabstruct_17shift_calculators_Vec3_list *__pyx_vtab;
  CDSVector<code><</code>Vec3> *data;
};


/* "Cython_shift_calculator.pyx":263
 *         return result
 * 
 * cdef class Vec3_list:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef CDSVector[Vec3] *data
 * 
 */

struct __pyx_vtabstruct_17shift_calculators_Vec3_list {
  PyObject *(*set_length)(struct __pyx_obj_17shift_calculators_Vec3_list *, int);
  Vec3 *(*get)(struct __pyx_obj_17shift_calculators_Vec3_list *, int);
  PyObject *(*set)(struct __pyx_obj_17shift_calculators_Vec3_list *, int, Vec3 &);
};
static struct __pyx_vtabstruct_17shift_calculators_Vec3_list *__pyx_vtabptr_17shift_calculators_Vec3_list;
static CYTHON_INLINE Vec3 *__pyx_f_17shift_calculators_9Vec3_list_get(struct __pyx_obj_17shift_calculators_Vec3_list *, int);
static CYTHON_INLINE PyObject *__pyx_f_17shift_calculators_9Vec3_list_set(struct __pyx_obj_17shift_calculators_Vec3_list *, int, Vec3 &);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line264")'> 264:     cdef CDSVector[Vec3] *data</pre>
<pre id='line264' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line265")'> 265: </pre>
<pre id='line265' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line266")'> 266:     def __cinit__(self):</pre>
<pre id='line266' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":266
 *     cdef CDSVector[Vec3] *data
 * 
 *     def __cinit__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *          self.data = new CDSVector[Vec3]()
 * 
 */

static int __pyx_pf_17shift_calculators_9Vec3_list___cinit__(struct __pyx_obj_17shift_calculators_Vec3_list *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__", 0);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line267")'> 267:          self.data = new CDSVector[Vec3]()</pre>
<pre id='line267' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":267
 * 
 *     def __cinit__(self):
 *          self.data = new CDSVector[Vec3]()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_self->data = new CDSVector<code><</code>Vec3>();

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line268")'> 268: </pre>
<pre id='line268' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line269")'> 269: </pre>
<pre id='line269' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line270")'> 270:     cdef set_length(self,int length):</pre>
<pre id='line270' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":270
 * 
 * 
 *     cdef set_length(self,int length):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.data.resize(length)
 * 
 */

static PyObject *__pyx_f_17shift_calculators_9Vec3_list_set_length(struct __pyx_obj_17shift_calculators_Vec3_list *__pyx_v_self, int __pyx_v_length) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_length", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line271")'> 271:         self.data.resize(length)</pre>
<pre id='line271' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":271
 * 
 *     cdef set_length(self,int length):
 *         self.data.resize(length)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     @cython.profile(False)
 */
  __pyx_v_self->data->resize(__pyx_v_length);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line272")'> 272: </pre>
<pre id='line272' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line273")'> 273:     @cython.profile(False)</pre>
<pre id='line273' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line274")'> 274:     cdef inline Vec3*  get(self, int offset) nogil:</pre>
<pre id='line274' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":274
 * 
 *     @cython.profile(False)
 *     cdef inline Vec3*  get(self, int offset) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return &self.data[0][offset]
 * 
 */

static CYTHON_INLINE Vec3 *__pyx_f_17shift_calculators_9Vec3_list_get(struct __pyx_obj_17shift_calculators_Vec3_list *__pyx_v_self, int __pyx_v_offset) {
  Vec3 *__pyx_r;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line275")'> 275:         return &amp;self.data[0][offset]</pre>
<pre id='line275' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":275
 *     @cython.profile(False)
 *     cdef inline Vec3*  get(self, int offset) nogil:
 *         return &self.data[0][offset]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     @cython.profile(False)
 */
  __pyx_r = (&((__pyx_v_self->data[0])[__pyx_v_offset]));
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line276")'> 276: </pre>
<pre id='line276' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line277")'> 277:     @cython.profile(False)</pre>
<pre id='line277' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line278")'> 278:     cdef inline set(self, int x, Vec3&amp; y):</pre>
<pre id='line278' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":278
 * 
 *     @cython.profile(False)
 *     cdef inline set(self, int x, Vec3& y):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.data[0][x] =  y
 * 
 */

static CYTHON_INLINE PyObject *__pyx_f_17shift_calculators_9Vec3_list_set(struct __pyx_obj_17shift_calculators_Vec3_list *__pyx_v_self, int __pyx_v_x, Vec3 &__pyx_v_y) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set", 0);
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line279")'> 279:         self.data[0][x] =  y</pre>
<pre id='line279' class='code' style='background-color: #FFFFc4'>
  /* "Cython_shift_calculator.pyx":279
 *     @cython.profile(False)
 *     cdef inline set(self, int x, Vec3& y):
 *         self.data[0][x] =  y             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __dealloc__(self):
 */
  ((__pyx_v_self->data[0])[__pyx_v_x]) = __pyx_v_y;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static void __pyx_pw_17shift_calculators_9Vec3_list_3__dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pw_17shift_calculators_9Vec3_list_3__dealloc__(PyObject *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__dealloc__ (wrapper)", 0);
  __pyx_pf_17shift_calculators_9Vec3_list_2__dealloc__(((struct __pyx_obj_17shift_calculators_Vec3_list *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line280")'> 280: </pre>
<pre id='line280' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line281")'> 281:     def __dealloc__(self):</pre>
<pre id='line281' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":281
 *         self.data[0][x] =  y
 * 
 *     def __dealloc__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if self.data != NULL:
 */

static void __pyx_pf_17shift_calculators_9Vec3_list_2__dealloc__(struct __pyx_obj_17shift_calculators_Vec3_list *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__dealloc__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line282")'> 282: </pre>
<pre id='line282' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line283")'> 283:         if self.data != NULL:</pre>
<pre id='line283' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":283
 *     def __dealloc__(self):
 * 
 *         if self.data != NULL:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             del self.data
 * 
 */
  __pyx_t_1 = (__pyx_v_self->data != NULL);
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line284")'> 284:             del self.data</pre>
<pre id='line284' class='code' style='background-color: #FFFFd4'>
    /* "Cython_shift_calculator.pyx":284
 * 
 *         if self.data != NULL:
 *             del self.data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    delete __pyx_v_self->data;
    goto __pyx_L3;
  }
  __pyx_L3:;

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
static PyObject *__pyx_gb_17shift_calculators_9Vec3_list_6generator(__pyx_GeneratorObject *__pyx_generator, PyObject *__pyx_sent_value); /* proto */

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_9Vec3_list_5__iter__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_9Vec3_list_5__iter__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__iter__ (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_9Vec3_list_4__iter__(((struct __pyx_obj_17shift_calculators_Vec3_list *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line285")'> 285: </pre>
<pre id='line285' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line286")'> 286: </pre>
<pre id='line286' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line287")'> 287:     def __iter__(self):</pre>
<pre id='line287' class='code' style='background-color: #FFFF79'>
/* "Cython_shift_calculator.pyx":287
 * 
 * 
 *     def __iter__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3 vec3
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_9Vec3_list_4__iter__(struct __pyx_obj_17shift_calculators_Vec3_list *__pyx_v_self) {
  struct __pyx_obj_17shift_calculators___pyx_scope_struct____iter__ *__pyx_cur_scope;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__iter__", 0);
  __pyx_cur_scope = (struct __pyx_obj_17shift_calculators___pyx_scope_struct____iter__ *)__pyx_ptype_17shift_calculators___pyx_scope_struct____iter__->tp_new(__pyx_ptype_17shift_calculators___pyx_scope_struct____iter__, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
    return NULL;
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_cur_scope);
  __pyx_cur_scope->__pyx_v_self = __pyx_v_self;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_cur_scope->__pyx_v_self);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>((PyObject *)__pyx_cur_scope->__pyx_v_self);
  {
    __pyx_GeneratorObject *gen = <span class='pyx_c_api'>__Pyx_Generator_New</span>((__pyx_generator_body_t) __pyx_gb_17shift_calculators_9Vec3_list_6generator, (PyObject *) __pyx_cur_scope);<span class='error_goto'> if (unlikely(!gen)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope);
    <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
    return (PyObject *) gen;
  }

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Vec3_list.__iter__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

static PyObject *__pyx_gb_17shift_calculators_9Vec3_list_6generator(__pyx_GeneratorObject *__pyx_generator, PyObject *__pyx_sent_value) /* generator body */
{
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("None", 0);
  __pyx_L3_first_run:;
  if (unlikely(!__pyx_sent_value))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>

/* "Cython_shift_calculator.pyx":287
 * 
 * 
 *     def __iter__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3 vec3
 * 
 */
struct __pyx_obj_17shift_calculators___pyx_scope_struct____iter__ {
  PyObject_HEAD
  int __pyx_v_i;
  struct __pyx_obj_17shift_calculators_Vec3_list *__pyx_v_self;
  Vec3 __pyx_v_vec3;
  int __pyx_t_0;
  int __pyx_t_1;
};

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line288")'> 288:         cdef Vec3 vec3</pre>
<pre id='line288' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line289")'> 289: </pre>
<pre id='line289' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line290")'> 290: </pre>
<pre id='line290' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line291")'> 291: </pre>
<pre id='line291' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line292")'> 292:         for i in range(self.data.size()):</pre>
<pre id='line292' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":292
 * 
 * 
 *         for i in range(self.data.size()):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             vec3 = self.get(i)[0]
 *             yield (i,python_vec3(vec3[0],vec3[1],vec3[2]))
 */
  __pyx_t_1 = __pyx_cur_scope->__pyx_v_self->data->size();
  for (__pyx_t_2 = 0; __pyx_t_2 <code><</code> __pyx_t_1; __pyx_t_2+=1) {
    __pyx_cur_scope->__pyx_v_i = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line293")'> 293:             vec3 = self.get(i)[0]</pre>
<pre id='line293' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":293
 * 
 *         for i in range(self.data.size()):
 *             vec3 = self.get(i)[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             yield (i,python_vec3(vec3[0],vec3[1],vec3[2]))
 * 
 */
    __pyx_cur_scope->__pyx_v_vec3 = (__pyx_f_17shift_calculators_9Vec3_list_get(__pyx_cur_scope->__pyx_v_self, __pyx_cur_scope->__pyx_v_i)[0]);
</pre><pre class='line' style='background-color: #FFFF1a' onclick='toggleDiv("line294")'> 294:             yield (i,python_vec3(vec3[0],vec3[1],vec3[2]))</pre>
<pre id='line294' class='code' style='background-color: #FFFF1a'>
    /* "Cython_shift_calculator.pyx":294
 *         for i in range(self.data.size()):
 *             vec3 = self.get(i)[0]
 *             yield (i,python_vec3(vec3[0],vec3[1],vec3[2]))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_cur_scope->__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__python_vec3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_cur_scope->__pyx_v_vec3[0]));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_cur_scope->__pyx_v_vec3[1]));<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_cur_scope->__pyx_v_vec3[2]));<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_5);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_6);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2, __pyx_t_7);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_7);
    __pyx_t_5 = 0;
    __pyx_t_6 = 0;
    __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_4, ((PyObject *)__pyx_t_8), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_7);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_7);
    __pyx_t_3 = 0;
    __pyx_t_7 = 0;
    __pyx_r = ((PyObject *)__pyx_t_8);
    __pyx_t_8 = 0;
    __pyx_cur_scope->__pyx_t_0 = __pyx_t_1;
    __pyx_cur_scope->__pyx_t_1 = __pyx_t_2;
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
    <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
    /* return from generator, yielding value */
    __pyx_generator->resume_label = 1;
    return __pyx_r;
    __pyx_L6_resume_from_yield:;
    __pyx_t_1 = __pyx_cur_scope->__pyx_t_0;
    __pyx_t_2 = __pyx_cur_scope->__pyx_t_1;
    if (unlikely(!__pyx_sent_value))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='py_c_api'>PyErr_SetNone</span>(PyExc_StopIteration);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("__iter__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_generator->resume_label = -1;
  <span class='pyx_c_api'>__Pyx_Generator_clear</span>((PyObject*)__pyx_generator);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_9Out_array_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_9Out_array_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_simulation = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__simulation,0};
    PyObject* values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__simulation)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 1) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
    }
    __pyx_v_simulation = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 1, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_9Out_array___init__(((struct __pyx_obj_17shift_calculators_Out_array *)__pyx_v_self), __pyx_v_simulation);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line295")'> 295: </pre>
<pre id='line295' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line296")'> 296: </pre>
<pre id='line296' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line297")'> 297: cdef class Out_array:</pre>
<pre id='line297' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":297
 * 
 * 
 * cdef class Out_array:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __init__ (self, simulation):
 */

struct __pyx_vtabstruct_17shift_calculators_Out_array {
  PyObject *(*get_length)(struct __pyx_obj_17shift_calculators_Out_array *, int __pyx_skip_dispatch);
  PyObject *(*add_all)(struct __pyx_obj_17shift_calculators_Out_array *, struct __pyx_obj_17shift_calculators_Out_array *, int __pyx_skip_dispatch);
  int (*_check_clear_length)(struct __pyx_obj_17shift_calculators_Out_array *, long);
  int (*_check_offset)(struct __pyx_obj_17shift_calculators_Out_array *, long);
  int (*realloc)(struct __pyx_obj_17shift_calculators_Out_array *, long);
  int (*_check_state)(struct __pyx_obj_17shift_calculators_Out_array *);
  void (*_clear)(struct __pyx_obj_17shift_calculators_Out_array *, int);
  void (*add)(struct __pyx_obj_17shift_calculators_Out_array *, long, Vec3 &);
  void (*add_forces_to_result)(struct __pyx_obj_17shift_calculators_Out_array *, DerivList *);
};
static struct __pyx_vtabstruct_17shift_calculators_Out_array *__pyx_vtabptr_17shift_calculators_Out_array;
static CYTHON_INLINE int __pyx_f_17shift_calculators_9Out_array__check_clear_length(struct __pyx_obj_17shift_calculators_Out_array *, long);
static CYTHON_INLINE int __pyx_f_17shift_calculators_9Out_array__check_offset(struct __pyx_obj_17shift_calculators_Out_array *, long);
static CYTHON_INLINE int __pyx_f_17shift_calculators_9Out_array__check_state(struct __pyx_obj_17shift_calculators_Out_array *);
static CYTHON_INLINE void __pyx_f_17shift_calculators_9Out_array_add(struct __pyx_obj_17shift_calculators_Out_array *, long, Vec3 &);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line298")'> 298: </pre>
<pre id='line298' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line299")'> 299:     def __init__ (self, simulation):</pre>
<pre id='line299' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":299
 * cdef class Out_array:
 * 
 *     def __init__ (self, simulation):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._length = 60000
 *         self._simulation = simulationAsNative(simulation)
 */

static int __pyx_pf_17shift_calculators_9Out_array___init__(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self, PyObject *__pyx_v_simulation) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line300")'> 300:         self._length = 60000</pre>
<pre id='line300' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":300
 * 
 *     def __init__ (self, simulation):
 *         self._length = 60000             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._simulation = simulationAsNative(simulation)
 * 
 */
  __pyx_v_self->_length = 60000;
</pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line301")'> 301:         self._simulation = simulationAsNative(simulation)</pre>
<pre id='line301' class='code' style='background-color: #FFFF46'>
  /* "Cython_shift_calculator.pyx":301
 *     def __init__ (self, simulation):
 *         self._length = 60000
 *         self._simulation = simulationAsNative(simulation)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_1 = __pyx_f_17shift_calculators_simulationAsNative(__pyx_v_simulation);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_simulation = __pyx_t_1;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_9Out_array_3__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_9Out_array_3__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED PyObject *__pyx_v_simulation = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__simulation,0};
    PyObject* values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__simulation)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 1) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
    }
    __pyx_v_simulation = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 1, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_9Out_array_2__cinit__(((struct __pyx_obj_17shift_calculators_Out_array *)__pyx_v_self), __pyx_v_simulation);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line302")'> 302: </pre>
<pre id='line302' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line303")'> 303: </pre>
<pre id='line303' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line304")'> 304:     def __cinit__(self, simulation):</pre>
<pre id='line304' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":304
 * 
 * 
 *     def __cinit__(self, simulation):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._length =  60000
 * 
 */

static int __pyx_pf_17shift_calculators_9Out_array_2__cinit__(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_simulation) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__", 0);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line305")'> 305:         self._length =  60000</pre>
<pre id='line305' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":305
 * 
 *     def __cinit__(self, simulation):
 *         self._length =  60000             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #         if length > 60000:
 */
  __pyx_v_self->_length = 60000;

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line306")'> 306: </pre>
<pre id='line306' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line307")'> 307: #         if length &gt; 60000:</pre>
<pre id='line307' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line308")'> 308: #             raise MemoryError("couldn't allocate array beyond length %i" % 60000)</pre>
<pre id='line308' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line309")'> 309: #        self._data = &lt;double *&gt;malloc(length * sizeof(double))</pre>
<pre id='line309' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line310")'> 310: #        if not self._data:</pre>
<pre id='line310' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line311")'> 311: #            raise MemoryError("couldn't allocate array of length %i" % length)</pre>
<pre id='line311' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line312")'> 312: #</pre>
<pre id='line312' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line313")'> 313: #        self._mask = &lt;long *&gt;malloc(length * sizeof(long))</pre>
<pre id='line313' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line314")'> 314: #        if not self._mask:</pre>
<pre id='line314' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line315")'> 315: #            raise MemoryError("couldn't allocate array of length %i" % length)</pre>
<pre id='line315' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line316")'> 316: #</pre>
<pre id='line316' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line317")'> 317: #        if  self._data  and self._mask:</pre>
<pre id='line317' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line318")'> 318: #            self._clear(length)</pre>
<pre id='line318' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line319")'> 319: #        print 'allocated'</pre>
<pre id='line319' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line320")'> 320: </pre>
<pre id='line320' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line321")'> 321:     cpdef get_length(self):</pre>
<pre id='line321' class='code' style='background-color: #FFFF57'>
/* "Cython_shift_calculator.pyx":321
 * #        print 'allocated'
 * 
 *     cpdef get_length(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._length
 * 
 */

static PyObject *__pyx_pw_17shift_calculators_9Out_array_5get_length(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_f_17shift_calculators_9Out_array_get_length(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self, int __pyx_skip_dispatch) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_length", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s__get_length);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_17shift_calculators_9Out_array_5get_length)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "Cython_shift_calculator.pyx":321
 * #        print 'allocated'
 * 
 *     cpdef get_length(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._length
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_9Out_array_4get_length(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_length", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_17shift_calculators_Out_array *)__pyx_v_self->__pyx_vtab)->get_length(__pyx_v_self, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.get_length", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line322")'> 322:         return self._length</pre>
<pre id='line322' class='code' style='background-color: #FFFF6e'>
  /* "Cython_shift_calculator.pyx":322
 * 
 *     cpdef get_length(self):
 *         return self._length             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef add_all(self, Out_array target_array):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_length);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.get_length", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_9Out_array_5get_length(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_9Out_array_5get_length(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_length (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_9Out_array_4get_length(((struct __pyx_obj_17shift_calculators_Out_array *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line323")'> 323: </pre>
<pre id='line323' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line324")'> 324:     cpdef add_all(self, Out_array target_array):</pre>
<pre id='line324' class='code' style='background-color: #FFFF43'>
/* "Cython_shift_calculator.pyx":324
 *         return self._length
 * 
 *     cpdef add_all(self, Out_array target_array):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3 value
 *         for i in range(target_array._length):
 */

static PyObject *__pyx_pw_17shift_calculators_9Out_array_7add_all(PyObject *__pyx_v_self, PyObject *__pyx_v_target_array); /*proto*/
static PyObject *__pyx_f_17shift_calculators_9Out_array_add_all(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_target_array, int __pyx_skip_dispatch) {
  Vec3 __pyx_v_value;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("add_all", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s__add_all);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 324; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_17shift_calculators_9Out_array_7add_all)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 324; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_target_array));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_v_target_array));
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_target_array));
      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 324; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "Cython_shift_calculator.pyx":324
 *         return self._length
 * 
 *     cpdef add_all(self, Out_array target_array):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3 value
 *         for i in range(target_array._length):
 */

static PyObject *__pyx_pf_17shift_calculators_9Out_array_6add_all(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_target_array) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("add_all", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_17shift_calculators_Out_array *)__pyx_v_self->__pyx_vtab)->add_all(__pyx_v_self, __pyx_v_target_array, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 324; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.add_all", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static void __pyx_pw_17shift_calculators_9Out_array_9__dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pw_17shift_calculators_9Out_array_9__dealloc__(PyObject *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__dealloc__ (wrapper)", 0);
  __pyx_pf_17shift_calculators_9Out_array_8__dealloc__(((struct __pyx_obj_17shift_calculators_Out_array *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line325")'> 325:         cdef Vec3 value</pre>
<pre id='line325' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line326")'> 326:         for i in range(target_array._length):</pre>
<pre id='line326' class='code' style='background-color: #FFFF20'>
  /* "Cython_shift_calculator.pyx":326
 *     cpdef add_all(self, Out_array target_array):
 *         cdef Vec3 value
 *         for i in range(target_array._length):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if i <code><</code> self._length and target_array._mask[i]:
 *                 value = Vec3(target_array._data[i*3+0],target_array._data[i*3+1],target_array._data[i*3+2])
 */
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_target_array->_length);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_3 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (!__pyx_t_5 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) {
      if (__pyx_t_4 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_5 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
      if (__pyx_t_4 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_1 = __pyx_t_5(__pyx_t_3);
      if (unlikely(!__pyx_t_1)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
    __pyx_v_i = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF44' onclick='toggleDiv("line327")'> 327:             if i &lt; self._length and target_array._mask[i]:</pre>
<pre id='line327' class='code' style='background-color: #FFFF44'>
    /* "Cython_shift_calculator.pyx":327
 *         cdef Vec3 value
 *         for i in range(target_array._length):
 *             if i <code><</code> self._length and target_array._mask[i]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 value = Vec3(target_array._data[i*3+0],target_array._data[i*3+1],target_array._data[i*3+2])
 *                 self.add(i, value)
 */
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_length);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_i, __pyx_t_1, Py_LT); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_6 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (__pyx_t_6) {
      __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_8 = (__pyx_v_target_array->_mask[__pyx_t_7]);
    } else {
      __pyx_t_8 = __pyx_t_6;
    }
    if (__pyx_t_8) {
</pre><pre class='line' style='background-color: #FFFF21' onclick='toggleDiv("line328")'> 328:                 value = Vec3(target_array._data[i*3+0],target_array._data[i*3+1],target_array._data[i*3+2])</pre>
<pre id='line328' class='code' style='background-color: #FFFF21'>
      /* "Cython_shift_calculator.pyx":328
 *         for i in range(target_array._length):
 *             if i <code><</code> self._length and target_array._mask[i]:
 *                 value = Vec3(target_array._data[i*3+0],target_array._data[i*3+1],target_array._data[i*3+2])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self.add(i, value)
 * 
 */
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_i, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_i, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_9 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_i, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_10 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_v_value = Vec3((__pyx_v_target_array->_data[__pyx_t_7]), (__pyx_v_target_array->_data[__pyx_t_9]), (__pyx_v_target_array->_data[__pyx_t_10]));
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line329")'> 329:                 self.add(i, value)</pre>
<pre id='line329' class='code' style='background-color: #FFFF4f'>
      /* "Cython_shift_calculator.pyx":329
 *             if i <code><</code> self._length and target_array._mask[i]:
 *                 value = Vec3(target_array._data[i*3+0],target_array._data[i*3+1],target_array._data[i*3+2])
 *                 self.add(i, value)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __dealloc__(self):
 */
      __pyx_t_11 = __Pyx_<span class='py_c_api'>PyInt_AsLong</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_11 == (long)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_f_17shift_calculators_9Out_array_add(__pyx_v_self, __pyx_t_11, __pyx_v_value);
      goto __pyx_L5;
    }
    __pyx_L5:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.add_all", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_9Out_array_7add_all(PyObject *__pyx_v_self, PyObject *__pyx_v_target_array); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_9Out_array_7add_all(PyObject *__pyx_v_self, PyObject *__pyx_v_target_array) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("add_all (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_target_array), __pyx_ptype_17shift_calculators_Out_array, 1, "target_array", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 324; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_9Out_array_6add_all(((struct __pyx_obj_17shift_calculators_Out_array *)__pyx_v_self), ((struct __pyx_obj_17shift_calculators_Out_array *)__pyx_v_target_array));
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line330")'> 330: </pre>
<pre id='line330' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line331")'> 331:     def __dealloc__(self):</pre>
<pre id='line331' class='code' style='background-color: #FFFFe7'>
/* "Cython_shift_calculator.pyx":331
 *                 self.add(i, value)
 * 
 *     def __dealloc__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         pass
 * #        free(self._data)
 */

static void __pyx_pf_17shift_calculators_9Out_array_8__dealloc__(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__dealloc__", 0);

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line332")'> 332:         pass</pre>
<pre id='line332' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line333")'> 333: #        free(self._data)</pre>
<pre id='line333' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line334")'> 334: #        self._data = NULL</pre>
<pre id='line334' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line335")'> 335: #        free(self._mask)</pre>
<pre id='line335' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line336")'> 336: #        self._mask = NULL</pre>
<pre id='line336' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line337")'> 337: </pre>
<pre id='line337' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line338")'> 338:     cdef inline bint _check_clear_length(self, long length) nogil except -1:</pre>
<pre id='line338' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":338
 * #        self._mask = NULL
 * 
 *     cdef inline bint _check_clear_length(self, long length) nogil except -1:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if not length <code><</code>= self._length:
 *             with gil:
 */

static CYTHON_INLINE int __pyx_f_17shift_calculators_9Out_array__check_clear_length(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self, long __pyx_v_length) {
  int __pyx_r;
  #ifdef WITH_THREAD
  PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
  #endif
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_check_clear_length", 0);
  #ifdef WITH_THREAD
  PyGILState_Release(__pyx_gilstate_save);
  #endif
  /*try:*/ {
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line339")'> 339:         if not length &lt;= self._length:</pre>
<pre id='line339' class='code' style='background-color: #FFFFaa'>
    /* "Cython_shift_calculator.pyx":339
 * 
 *     cdef inline bint _check_clear_length(self, long length) nogil except -1:
 *         if not length <code><</code>= self._length:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             with gil:
 *                 raise IndexError("tried to clear to %i length is %i" % (length,self._length))
 */
    __pyx_t_1 = (!(__pyx_v_length <code><</code>= __pyx_v_self->_length));
    if (__pyx_t_1) {

  /* "Cython_shift_calculator.pyx":339
 * 
 *     cdef inline bint _check_clear_length(self, long length) nogil except -1:
 *         if not length <code><</code>= self._length:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             with gil:
 *                 raise IndexError("tried to clear to %i length is %i" % (length,self._length))
 */
  /*finally:*/ {
    int __pyx_why;
    __pyx_why = 0; goto __pyx_L5;
    __pyx_L4: __pyx_why = 4; goto __pyx_L5;
    __pyx_L5:;
    #ifdef WITH_THREAD
    __pyx_gilstate_save = PyGILState_Ensure();
    #endif
    switch (__pyx_why) {
      case 4: goto __pyx_L1_error;
    }
  }

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Out_array._check_clear_length", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  #ifdef WITH_THREAD
  PyGILState_Release(__pyx_gilstate_save);
  #endif
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line340")'> 340:             with gil:</pre>
<pre id='line340' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":340
 *     cdef inline bint _check_clear_length(self, long length) nogil except -1:
 *         if not length <code><</code>= self._length:
 *             with gil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 raise IndexError("tried to clear to %i length is %i" % (length,self._length))
 *         if self._data is NULL:
 */
      {
          #ifdef WITH_THREAD
          PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
          #endif
          /*try:*/ {

          /* "Cython_shift_calculator.pyx":340
 *     cdef inline bint _check_clear_length(self, long length) nogil except -1:
 *         if not length <code><</code>= self._length:
 *             with gil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 raise IndexError("tried to clear to %i length is %i" % (length,self._length))
 *         if self._data is NULL:
 */
          /*finally:*/ {
            int __pyx_why;
            __pyx_why = 0; goto __pyx_L9;
            __pyx_L8: __pyx_why = 4; goto __pyx_L9;
            __pyx_L9:;
            #ifdef WITH_THREAD
            PyGILState_Release(__pyx_gilstate_save);
            #endif
            switch (__pyx_why) {
              case 4: goto __pyx_L4;
            }
          }
      }
      goto __pyx_L6;
    }
    __pyx_L6:;
</pre><pre class='line' style='background-color: #FFFF35' onclick='toggleDiv("line341")'> 341:                 raise IndexError("tried to clear to %i length is %i" % (length,self._length))</pre>
<pre id='line341' class='code' style='background-color: #FFFF35'>
            /* "Cython_shift_calculator.pyx":341
 *         if not length <code><</code>= self._length:
 *             with gil:
 *                 raise IndexError("tried to clear to %i length is %i" % (length,self._length))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if self._data is NULL:
 *             with gil:
 */
            __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_length);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L8;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
            __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_length);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L8;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
            __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L8;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
            __pyx_t_2 = 0;
            __pyx_t_3 = 0;
            __pyx_t_3 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_9), ((PyObject *)__pyx_t_4));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L8;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
            __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L8;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, ((PyObject *)__pyx_t_3));
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_3));
            __pyx_t_3 = 0;
            __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_IndexError, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L8;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
            <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L8;}</span>
          }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line342")'> 342:         if self._data is NULL:</pre>
<pre id='line342' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":342
 *             with gil:
 *                 raise IndexError("tried to clear to %i length is %i" % (length,self._length))
 *         if self._data is NULL:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             with gil:
 *                 raise AttributeError("trying to access deallocated memory!")
 */
    __pyx_t_1 = (__pyx_v_self->_data == NULL);
    if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line343")'> 343:             with gil:</pre>
<pre id='line343' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":343
 *                 raise IndexError("tried to clear to %i length is %i" % (length,self._length))
 *         if self._data is NULL:
 *             with gil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 raise AttributeError("trying to access deallocated memory!")
 * 
 */
      {
          #ifdef WITH_THREAD
          PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
          #endif
          /*try:*/ {

          /* "Cython_shift_calculator.pyx":343
 *                 raise IndexError("tried to clear to %i length is %i" % (length,self._length))
 *         if self._data is NULL:
 *             with gil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 raise AttributeError("trying to access deallocated memory!")
 * 
 */
          /*finally:*/ {
            int __pyx_why;
            __pyx_why = 0; goto __pyx_L14;
            __pyx_L13: __pyx_why = 4; goto __pyx_L14;
            __pyx_L14:;
            #ifdef WITH_THREAD
            PyGILState_Release(__pyx_gilstate_save);
            #endif
            switch (__pyx_why) {
              case 4: goto __pyx_L4;
            }
          }
      }
      goto __pyx_L11;
    }
    __pyx_L11:;
  }
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line344")'> 344:                 raise AttributeError("trying to access deallocated memory!")</pre>
<pre id='line344' class='code' style='background-color: #FFFF6e'>
            /* "Cython_shift_calculator.pyx":344
 *         if self._data is NULL:
 *             with gil:
 *                 raise AttributeError("trying to access deallocated memory!")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline bint _check_offset(self, long offset) except -1:
 */
            __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_AttributeError, ((PyObject *)__pyx_k_tuple_11), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L13;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
            <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L13;}</span>
          }

  /* "Cython_shift_calculator.pyx":344
 *         if self._data is NULL:
 *             with gil:
 *                 raise AttributeError("trying to access deallocated memory!")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline bint _check_offset(self, long offset) except -1:
 */
  __pyx_k_tuple_11 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_10));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_11);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_11));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line345")'> 345: </pre>
<pre id='line345' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line346")'> 346:     cdef inline bint _check_offset(self, long offset) except -1:</pre>
<pre id='line346' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":346
 *                 raise AttributeError("trying to access deallocated memory!")
 * 
 *     cdef inline bint _check_offset(self, long offset) except -1:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if not offset <code><</code> self._length:
 *             raise IndexError("tried to access object at %i length is %i" % (offset,self._length))
 */

static CYTHON_INLINE int __pyx_f_17shift_calculators_9Out_array__check_offset(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self, long __pyx_v_offset) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_check_offset", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line347")'> 347:         if not offset &lt; self._length:</pre>
<pre id='line347' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":347
 * 
 *     cdef inline bint _check_offset(self, long offset) except -1:
 *         if not offset <code><</code> self._length:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             raise IndexError("tried to access object at %i length is %i" % (offset,self._length))
 *         if self._data is NULL:
 */
  __pyx_t_1 = (!(__pyx_v_offset <code><</code> __pyx_v_self->_length));
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFF35' onclick='toggleDiv("line348")'> 348:             raise IndexError("tried to access object at %i length is %i" % (offset,self._length))</pre>
<pre id='line348' class='code' style='background-color: #FFFF35'>
    /* "Cython_shift_calculator.pyx":348
 *     cdef inline bint _check_offset(self, long offset) except -1:
 *         if not offset <code><</code> self._length:
 *             raise IndexError("tried to access object at %i length is %i" % (offset,self._length))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if self._data is NULL:
 *             raise AttributeError("trying to access deallocated memory!")
 */
    __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_offset);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_length);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    __pyx_t_2 = 0;
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_12), ((PyObject *)__pyx_t_4));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, ((PyObject *)__pyx_t_3));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_3));
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_IndexError, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line349")'> 349:         if self._data is NULL:</pre>
<pre id='line349' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":349
 *         if not offset <code><</code> self._length:
 *             raise IndexError("tried to access object at %i length is %i" % (offset,self._length))
 *         if self._data is NULL:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             raise AttributeError("trying to access deallocated memory!")
 * 
 */
  __pyx_t_1 = (__pyx_v_self->_data == NULL);
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line350")'> 350:             raise AttributeError("trying to access deallocated memory!")</pre>
<pre id='line350' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":350
 *             raise IndexError("tried to access object at %i length is %i" % (offset,self._length))
 *         if self._data is NULL:
 *             raise AttributeError("trying to access deallocated memory!")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef bint realloc(Out_array self,long length) nogil except -1:
 */
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_AttributeError, ((PyObject *)__pyx_k_tuple_13), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L4;
  }
  __pyx_L4:;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Out_array._check_offset", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

  /* "Cython_shift_calculator.pyx":350
 *             raise IndexError("tried to access object at %i length is %i" % (offset,self._length))
 *         if self._data is NULL:
 *             raise AttributeError("trying to access deallocated memory!")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef bint realloc(Out_array self,long length) nogil except -1:
 */
  __pyx_k_tuple_13 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_10));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_13);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_13));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line351")'> 351: </pre>
<pre id='line351' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line352")'> 352:     cdef bint realloc(Out_array self,long length) nogil except -1:</pre>
<pre id='line352' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":352
 *             raise AttributeError("trying to access deallocated memory!")
 * 
 *     cdef bint realloc(Out_array self,long length) nogil except -1:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if length <code><</code>60000:
 * #            free(self._data)
 */

static int __pyx_f_17shift_calculators_9Out_array_realloc(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self, long __pyx_v_length) {
  int __pyx_r;
  #ifdef WITH_THREAD
  PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
  #endif
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("realloc", 0);
  #ifdef WITH_THREAD
  PyGILState_Release(__pyx_gilstate_save);
  #endif
  /*try:*/ {
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line353")'> 353:         if length &lt;60000:</pre>
<pre id='line353' class='code' style='background-color: #FFFFb6'>
    /* "Cython_shift_calculator.pyx":353
 * 
 *     cdef bint realloc(Out_array self,long length) nogil except -1:
 *         if length <code><</code>60000:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #            free(self._data)
 * #            self._data = NULL
 */
    __pyx_t_1 = (__pyx_v_length <code><</code> 60000);
    if (__pyx_t_1) {

  /* "Cython_shift_calculator.pyx":353
 * 
 *     cdef bint realloc(Out_array self,long length) nogil except -1:
 *         if length <code><</code>60000:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #            free(self._data)
 * #            self._data = NULL
 */
  /*finally:*/ {
    int __pyx_why;
    __pyx_why = 0; goto __pyx_L5;
    __pyx_L4: __pyx_why = 4; goto __pyx_L5;
    __pyx_L5:;
    #ifdef WITH_THREAD
    __pyx_gilstate_save = PyGILState_Ensure();
    #endif
    switch (__pyx_why) {
      case 4: goto __pyx_L1_error;
    }
  }

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Out_array.realloc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  #ifdef WITH_THREAD
  PyGILState_Release(__pyx_gilstate_save);
  #endif
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line354")'> 354: #            free(self._data)</pre>
<pre id='line354' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line355")'> 355: #            self._data = NULL</pre>
<pre id='line355' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line356")'> 356: #            self._data = &lt;double *&gt;malloc(3 *(length+1) * sizeof(double))</pre>
<pre id='line356' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line357")'> 357: #            if not self._data:</pre>
<pre id='line357' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line358")'> 358: #                raise MemoryError("couldn't allocate array of length %i" % length)</pre>
<pre id='line358' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line359")'> 359: #            if  self._data:</pre>
<pre id='line359' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line360")'> 360: #                self._length =length</pre>
<pre id='line360' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line361")'> 361:             self._clear(length)</pre>
<pre id='line361' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":361
 * #            if  self._data:
 * #                self._length =length
 *             self._clear(length)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             with gil:
 */
      ((struct __pyx_vtabstruct_17shift_calculators_Out_array *)__pyx_v_self->__pyx_vtab)->_clear(__pyx_v_self, __pyx_v_length);
      goto __pyx_L6;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line362")'> 362:         else:</pre>
<pre id='line362' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line363")'> 363:             with gil:</pre>
<pre id='line363' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":363
 *             self._clear(length)
 *         else:
 *             with gil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 raise MemoryError("couldn't go beyond length of %i" % 60000)
 * #
 */
      {
          #ifdef WITH_THREAD
          PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
          #endif
          /*try:*/ {

          /* "Cython_shift_calculator.pyx":363
 *             self._clear(length)
 *         else:
 *             with gil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 raise MemoryError("couldn't go beyond length of %i" % 60000)
 * #
 */
          /*finally:*/ {
            int __pyx_why;
            __pyx_why = 0; goto __pyx_L9;
            __pyx_L8: __pyx_why = 4; goto __pyx_L9;
            __pyx_L9:;
            #ifdef WITH_THREAD
            PyGILState_Release(__pyx_gilstate_save);
            #endif
            switch (__pyx_why) {
              case 4: goto __pyx_L4;
            }
          }
      }
    }
    __pyx_L6:;
  }
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line364")'> 364:                 raise MemoryError("couldn't go beyond length of %i" % 60000)</pre>
<pre id='line364' class='code' style='background-color: #FFFF55'>
            /* "Cython_shift_calculator.pyx":364
 *         else:
 *             with gil:
 *                 raise MemoryError("couldn't go beyond length of %i" % 60000)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #
 * #            free(self._mask)
 */
            __pyx_t_2 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_14), __pyx_int_60000);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L8;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
            __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L8;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, ((PyObject *)__pyx_t_2));
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_2));
            __pyx_t_2 = 0;
            __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_MemoryError, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L8;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
            <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
           <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L8;}</span>
          }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line365")'> 365: #</pre>
<pre id='line365' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line366")'> 366: #            free(self._mask)</pre>
<pre id='line366' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line367")'> 367: #            self._mask = NULL</pre>
<pre id='line367' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line368")'> 368: #            self._mask = &lt;int *&gt;malloc((length+1) * sizeof(int))</pre>
<pre id='line368' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line369")'> 369: #            if not self._mask:</pre>
<pre id='line369' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line370")'> 370: #                raise MemoryError("couldn't allocate array of length %i" % length)</pre>
<pre id='line370' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line371")'> 371: #            if  self._mask:</pre>
<pre id='line371' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line372")'> 372: #                self._clear_mask(length)</pre>
<pre id='line372' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line373")'> 373: </pre>
<pre id='line373' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line374")'> 374:     cdef inline bint _check_state(self) except -1:</pre>
<pre id='line374' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":374
 * #                self._clear_mask(length)
 * 
 *     cdef inline bint _check_state(self) except -1:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if self._data is NULL:
 *             raise MemoryError("couldn't reallocate array of length %i" % self._length)
 */

static CYTHON_INLINE int __pyx_f_17shift_calculators_9Out_array__check_state(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_check_state", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line375")'> 375:         if self._data is NULL:</pre>
<pre id='line375' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":375
 * 
 *     cdef inline bint _check_state(self) except -1:
 *         if self._data is NULL:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             raise MemoryError("couldn't reallocate array of length %i" % self._length)
 * 
 */
  __pyx_t_1 = (__pyx_v_self->_data == NULL);
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line376")'> 376:             raise MemoryError("couldn't reallocate array of length %i" % self._length)</pre>
<pre id='line376' class='code' style='background-color: #FFFF3e'>
    /* "Cython_shift_calculator.pyx":376
 *     cdef inline bint _check_state(self) except -1:
 *         if self._data is NULL:
 *             raise MemoryError("couldn't reallocate array of length %i" % self._length)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void  _clear(Out_array self, int length) nogil:
 */
    __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_length);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_15), __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_t_3));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_3));
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_MemoryError, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L3;
  }
  __pyx_L3:;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Out_array._check_state", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line377")'> 377: </pre>
<pre id='line377' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line378")'> 378:     cdef void  _clear(Out_array self, int length) nogil:</pre>
<pre id='line378' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":378
 *             raise MemoryError("couldn't reallocate array of length %i" % self._length)
 * 
 *     cdef void  _clear(Out_array self, int length) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._check_clear_length(length)
 *         for i in range(length*3):
 */

static void __pyx_f_17shift_calculators_9Out_array__clear(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self, int __pyx_v_length) {
  long __pyx_v_i;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line379")'> 379:         self._check_clear_length(length)</pre>
<pre id='line379' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":379
 * 
 *     cdef void  _clear(Out_array self, int length) nogil:
 *         self._check_clear_length(length)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for i in range(length*3):
 *             self._data[i] = 0.0
 */
  __pyx_f_17shift_calculators_9Out_array__check_clear_length(__pyx_v_self, __pyx_v_length);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line380")'> 380:         for i in range(length*3):</pre>
<pre id='line380' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":380
 *     cdef void  _clear(Out_array self, int length) nogil:
 *         self._check_clear_length(length)
 *         for i in range(length*3):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._data[i] = 0.0
 *         for i in range(length):
 */
  __pyx_t_1 = (__pyx_v_length * 3);
  for (__pyx_t_2 = 0; __pyx_t_2 <code><</code> __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_i = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line381")'> 381:             self._data[i] = 0.0</pre>
<pre id='line381' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":381
 *         self._check_clear_length(length)
 *         for i in range(length*3):
 *             self._data[i] = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for i in range(length):
 *             self._mask[i]=0
 */
    (__pyx_v_self->_data[__pyx_v_i]) = 0.0;
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line382")'> 382:         for i in range(length):</pre>
<pre id='line382' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":382
 *         for i in range(length*3):
 *             self._data[i] = 0.0
 *         for i in range(length):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._mask[i]=0
 * 
 */
  __pyx_t_3 = __pyx_v_length;
  for (__pyx_t_1 = 0; __pyx_t_1 <code><</code> __pyx_t_3; __pyx_t_1+=1) {
    __pyx_v_i = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFF3c' onclick='toggleDiv("line383")'> 383:             self._mask[i]=0</pre>
<pre id='line383' class='code' style='background-color: #FFFF3c'>
    /* "Cython_shift_calculator.pyx":383
 *             self._data[i] = 0.0
 *         for i in range(length):
 *             self._mask[i]=0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def padd(self,offset,value):
 */
    (__pyx_v_self->_mask[__pyx_v_i]) = 0;
  }

}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_9Out_array_11padd(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_9Out_array_11padd(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_offset = 0;
  PyObject *__pyx_v_value = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("padd (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__offset,&__pyx_n_s__value,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__offset)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__value)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("padd", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "padd") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_offset = values[0];
    __pyx_v_value = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("padd", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.padd", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_9Out_array_10padd(((struct __pyx_obj_17shift_calculators_Out_array *)__pyx_v_self), __pyx_v_offset, __pyx_v_value);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line384")'> 384: </pre>
<pre id='line384' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line385")'> 385:     def padd(self,offset,value):</pre>
<pre id='line385' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":385
 *             self._mask[i]=0
 * 
 *     def padd(self,offset,value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3 cvalue  = Vec3(value[0],value[1],value[2])
 *         self.add(offset, cvalue)
 */

static PyObject *__pyx_pf_17shift_calculators_9Out_array_10padd(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self, PyObject *__pyx_v_offset, PyObject *__pyx_v_value) {
  Vec3 __pyx_v_cvalue;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("padd", 0);
</pre><pre class='line' style='background-color: #FFFF34' onclick='toggleDiv("line386")'> 386:         cdef Vec3 cvalue  = Vec3(value[0],value[1],value[2])</pre>
<pre id='line386' class='code' style='background-color: #FFFF34'>
  /* "Cython_shift_calculator.pyx":386
 * 
 *     def padd(self,offset,value):
 *         cdef Vec3 cvalue  = Vec3(value[0],value[1],value[2])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.add(offset, cvalue)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_value, 0, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_value, 1, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_3 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_value, 2, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_4 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_4 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_cvalue = Vec3(__pyx_t_2, __pyx_t_3, __pyx_t_4);
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line387")'> 387:         self.add(offset, cvalue)</pre>
<pre id='line387' class='code' style='background-color: #FFFF66'>
  /* "Cython_shift_calculator.pyx":387
 *     def padd(self,offset,value):
 *         cdef Vec3 cvalue  = Vec3(value[0],value[1],value[2])
 *         self.add(offset, cvalue)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     @cython.profile(False)
 */
  __pyx_t_5 = __Pyx_<span class='py_c_api'>PyInt_AsLong</span>(__pyx_v_offset);<span class='error_goto'> if (unlikely((__pyx_t_5 == (long)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_f_17shift_calculators_9Out_array_add(__pyx_v_self, __pyx_t_5, __pyx_v_cvalue);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.padd", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line388")'> 388: </pre>
<pre id='line388' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line389")'> 389:     @cython.profile(False)</pre>
<pre id='line389' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line390")'> 390:     cdef inline void  add(self,long offset, Vec3&amp; value):</pre>
<pre id='line390' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":390
 * 
 *     @cython.profile(False)
 *     cdef inline void  add(self,long offset, Vec3& value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #        self._check_offset(offset)
 *         cdef long id3 = offset *3
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_9Out_array_add(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self, long __pyx_v_offset, Vec3 &__pyx_v_value) {
  long __pyx_v_id3;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("add", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line391")'> 391: #        self._check_offset(offset)</pre>
<pre id='line391' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line392")'> 392:         cdef long id3 = offset *3</pre>
<pre id='line392' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":392
 *     cdef inline void  add(self,long offset, Vec3& value):
 * #        self._check_offset(offset)
 *         cdef long id3 = offset *3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._data[id3]   += value[0]
 */
  __pyx_v_id3 = (__pyx_v_offset * 3);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line393")'> 393: </pre>
<pre id='line393' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line394")'> 394:         self._data[id3]   += value[0]</pre>
<pre id='line394' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":394
 *         cdef long id3 = offset *3
 * 
 *         self._data[id3]   += value[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._data[id3+1] += value[1]
 *         self._data[id3+2] += value[2]
 */
  __pyx_t_1 = __pyx_v_id3;
  (__pyx_v_self->_data[__pyx_t_1]) = ((__pyx_v_self->_data[__pyx_t_1]) + (__pyx_v_value[0]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line395")'> 395:         self._data[id3+1] += value[1]</pre>
<pre id='line395' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":395
 * 
 *         self._data[id3]   += value[0]
 *         self._data[id3+1] += value[1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._data[id3+2] += value[2]
 * 
 */
  __pyx_t_1 = (__pyx_v_id3 + 1);
  (__pyx_v_self->_data[__pyx_t_1]) = ((__pyx_v_self->_data[__pyx_t_1]) + (__pyx_v_value[1]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line396")'> 396:         self._data[id3+2] += value[2]</pre>
<pre id='line396' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":396
 *         self._data[id3]   += value[0]
 *         self._data[id3+1] += value[1]
 *         self._data[id3+2] += value[2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._mask[offset] = 1
 */
  __pyx_t_1 = (__pyx_v_id3 + 2);
  (__pyx_v_self->_data[__pyx_t_1]) = ((__pyx_v_self->_data[__pyx_t_1]) + (__pyx_v_value[2]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line397")'> 397: </pre>
<pre id='line397' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line398")'> 398:         self._mask[offset] = 1</pre>
<pre id='line398' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":398
 *         self._data[id3+2] += value[2]
 * 
 *         self._mask[offset] = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def clear_by_id(self,target_ids):
 */
  (__pyx_v_self->_mask[__pyx_v_offset]) = 1;

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_9Out_array_13clear_by_id(PyObject *__pyx_v_self, PyObject *__pyx_v_target_ids); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_9Out_array_13clear_by_id(PyObject *__pyx_v_self, PyObject *__pyx_v_target_ids) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("clear_by_id (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_9Out_array_12clear_by_id(((struct __pyx_obj_17shift_calculators_Out_array *)__pyx_v_self), ((PyObject *)__pyx_v_target_ids));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line399")'> 399: </pre>
<pre id='line399' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line400")'> 400:     def clear_by_id(self,target_ids):</pre>
<pre id='line400' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":400
 *         self._mask[offset] = 1
 * 
 *     def clear_by_id(self,target_ids):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef long id3 = 0
 *         for target_id in target_ids:
 */

static PyObject *__pyx_pf_17shift_calculators_9Out_array_12clear_by_id(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self, PyObject *__pyx_v_target_ids) {
  long __pyx_v_id3;
  PyObject *__pyx_v_target_id = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("clear_by_id", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line401")'> 401:         cdef long id3 = 0</pre>
<pre id='line401' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":401
 * 
 *     def clear_by_id(self,target_ids):
 *         cdef long id3 = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for target_id in target_ids:
 *             self._check_offset(target_id)
 */
  __pyx_v_id3 = 0;
</pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line402")'> 402:         for target_id in target_ids:</pre>
<pre id='line402' class='code' style='background-color: #FFFF2a'>
  /* "Cython_shift_calculator.pyx":402
 *     def clear_by_id(self,target_ids):
 *         cdef long id3 = 0
 *         for target_id in target_ids:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._check_offset(target_id)
 *             id3 = target_id *3
 */
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_target_ids) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_target_ids)) {
    __pyx_t_1 = __pyx_v_target_ids; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_target_ids);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext;
  }
  for (;;) {
    if (!__pyx_t_3 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_3 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_target_id);
    __pyx_v_target_id = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line403")'> 403:             self._check_offset(target_id)</pre>
<pre id='line403' class='code' style='background-color: #FFFF7f'>
    /* "Cython_shift_calculator.pyx":403
 *         cdef long id3 = 0
 *         for target_id in target_ids:
 *             self._check_offset(target_id)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             id3 = target_id *3
 * 
 */
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyInt_AsLong</span>(__pyx_v_target_id);<span class='error_goto'> if (unlikely((__pyx_t_5 == (long)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 403; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_f_17shift_calculators_9Out_array__check_offset(__pyx_v_self, __pyx_t_5);
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line404")'> 404:             id3 = target_id *3</pre>
<pre id='line404' class='code' style='background-color: #FFFF62'>
    /* "Cython_shift_calculator.pyx":404
 *         for target_id in target_ids:
 *             self._check_offset(target_id)
 *             id3 = target_id *3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             self._data[id3]   = 0.0
 */
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_target_id, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 404; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyInt_AsLong</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_5 == (long)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 404; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_id3 = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line405")'> 405: </pre>
<pre id='line405' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line406")'> 406:             self._data[id3]   = 0.0</pre>
<pre id='line406' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":406
 *             id3 = target_id *3
 * 
 *             self._data[id3]   = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._data[id3+1] = 0.0
 *             self._data[id3+2] = 0.0
 */
    (__pyx_v_self->_data[__pyx_v_id3]) = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line407")'> 407:             self._data[id3+1] = 0.0</pre>
<pre id='line407' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":407
 * 
 *             self._data[id3]   = 0.0
 *             self._data[id3+1] = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._data[id3+2] = 0.0
 * 
 */
    (__pyx_v_self->_data[(__pyx_v_id3 + 1)]) = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line408")'> 408:             self._data[id3+2] = 0.0</pre>
<pre id='line408' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":408
 *             self._data[id3]   = 0.0
 *             self._data[id3+1] = 0.0
 *             self._data[id3+2] = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             self._mask[target_id] = 0
 */
    (__pyx_v_self->_data[(__pyx_v_id3 + 2)]) = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line409")'> 409: </pre>
<pre id='line409' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line410")'> 410:             self._mask[target_id] = 0</pre>
<pre id='line410' class='code' style='background-color: #FFFF5b'>
    /* "Cython_shift_calculator.pyx":410
 *             self._data[id3+2] = 0.0
 * 
 *             self._mask[target_id] = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void add_forces_to_result(self, DerivList *derivList) nogil:
 */
    __pyx_t_6 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_target_id);<span class='error_goto'> if (unlikely((__pyx_t_6 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    (__pyx_v_self->_mask[__pyx_t_6]) = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.clear_by_id", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_target_id);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line411")'> 411: </pre>
<pre id='line411' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line412")'> 412:     cdef void add_forces_to_result(self, DerivList *derivList) nogil:</pre>
<pre id='line412' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":412
 *             self._mask[target_id] = 0
 * 
 *     cdef void add_forces_to_result(self, DerivList *derivList) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef long id3
 *         cdef CDSVector[Vec3]* derivs
 */

static void __pyx_f_17shift_calculators_9Out_array_add_forces_to_result(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self, DerivList *__pyx_v_derivList) {
  long __pyx_v_id3;
  CDSVector<code><</code>Vec3> *__pyx_v_derivs;
  float __pyx_v_weight;
  int __pyx_v_i;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line413")'> 413:         cdef long id3</pre>
<pre id='line413' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line414")'> 414:         cdef CDSVector[Vec3]* derivs</pre>
<pre id='line414' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line415")'> 415:         cdef Vec3* test</pre>
<pre id='line415' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line416")'> 416:         cdef float weight =1.0</pre>
<pre id='line416' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":416
 *         cdef CDSVector[Vec3]* derivs
 *         cdef Vec3* test
 *         cdef float weight =1.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int i
 * 
 */
  __pyx_v_weight = 1.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line417")'> 417:         cdef int i</pre>
<pre id='line417' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line418")'> 418: </pre>
<pre id='line418' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line419")'> 419: </pre>
<pre id='line419' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line420")'> 420:         #TODO: references don't work here lots of problems -&gt; cython mailing list</pre>
<pre id='line420' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line421")'> 421:         derivs  = &amp;derivList[0][self._simulation]</pre>
<pre id='line421' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":421
 * 
 *         #TODO: references don't work here lots of problems -> cython mailing list
 *         derivs  = &derivList[0][self._simulation]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for i in range(self._length):
 *             if self._mask[i] != 0:
 */
  __pyx_v_derivs = (&((__pyx_v_derivList[0])[__pyx_v_self->_simulation]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line422")'> 422:         for i in range(self._length):</pre>
<pre id='line422' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":422
 *         #TODO: references don't work here lots of problems -> cython mailing list
 *         derivs  = &derivList[0][self._simulation]
 *         for i in range(self._length):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if self._mask[i] != 0:
 *                 id3 = i * 3
 */
  __pyx_t_1 = __pyx_v_self->_length;
  for (__pyx_t_2 = 0; __pyx_t_2 <code><</code> __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_i = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line423")'> 423:             if self._mask[i] != 0:</pre>
<pre id='line423' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":423
 *         derivs  = &derivList[0][self._simulation]
 *         for i in range(self._length):
 *             if self._mask[i] != 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 id3 = i * 3
 * 
 */
    __pyx_t_3 = ((__pyx_v_self->_mask[__pyx_v_i]) != 0);
    if (__pyx_t_3) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line424")'> 424:                 id3 = i * 3</pre>
<pre id='line424' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":424
 *         for i in range(self._length):
 *             if self._mask[i] != 0:
 *                 id3 = i * 3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 derivs[0][i][0]  +=  self._data[id3] * weight
 */
      __pyx_v_id3 = (__pyx_v_i * 3);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line425")'> 425: </pre>
<pre id='line425' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line426")'> 426:                 derivs[0][i][0]  +=  self._data[id3] * weight</pre>
<pre id='line426' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":426
 *                 id3 = i * 3
 * 
 *                 derivs[0][i][0]  +=  self._data[id3] * weight             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 derivs[0][i][1]  +=  self._data[id3+1] *weight
 *                 derivs[0][i][2]  +=  self._data[id3+2] * weight
 */
      __pyx_t_4 = 0;
      __pyx_t_5 = __pyx_v_i;
      __pyx_t_6 = 0;
      (((__pyx_v_derivs[__pyx_t_4])[__pyx_t_5])[__pyx_t_6]) = ((((__pyx_v_derivs[__pyx_t_4])[__pyx_t_5])[__pyx_t_6]) + ((__pyx_v_self->_data[__pyx_v_id3]) * __pyx_v_weight));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line427")'> 427:                 derivs[0][i][1]  +=  self._data[id3+1] *weight</pre>
<pre id='line427' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":427
 * 
 *                 derivs[0][i][0]  +=  self._data[id3] * weight
 *                 derivs[0][i][1]  +=  self._data[id3+1] *weight             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 derivs[0][i][2]  +=  self._data[id3+2] * weight
 * 
 */
      __pyx_t_4 = 0;
      __pyx_t_5 = __pyx_v_i;
      __pyx_t_6 = 1;
      (((__pyx_v_derivs[__pyx_t_4])[__pyx_t_5])[__pyx_t_6]) = ((((__pyx_v_derivs[__pyx_t_4])[__pyx_t_5])[__pyx_t_6]) + ((__pyx_v_self->_data[(__pyx_v_id3 + 1)]) * __pyx_v_weight));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line428")'> 428:                 derivs[0][i][2]  +=  self._data[id3+2] * weight</pre>
<pre id='line428' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":428
 *                 derivs[0][i][0]  +=  self._data[id3] * weight
 *                 derivs[0][i][1]  +=  self._data[id3+1] *weight
 *                 derivs[0][i][2]  +=  self._data[id3+2] * weight             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
      __pyx_t_4 = 0;
      __pyx_t_5 = __pyx_v_i;
      __pyx_t_6 = 2;
      (((__pyx_v_derivs[__pyx_t_4])[__pyx_t_5])[__pyx_t_6]) = ((((__pyx_v_derivs[__pyx_t_4])[__pyx_t_5])[__pyx_t_6]) + ((__pyx_v_self->_data[(__pyx_v_id3 + 2)]) * __pyx_v_weight));
      goto __pyx_L5;
    }
    __pyx_L5:;
  }

}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_9Out_array_15add_forces_to_result_by_id(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_9Out_array_15add_forces_to_result_by_id(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_target_atom_ids = 0;
  PyObject *__pyx_v_result = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("add_forces_to_result_by_id (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__target_atom_ids,&__pyx_n_s__result,0};
    PyObject* values[2] = {0,0};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line429")'> 429: </pre>
<pre id='line429' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line430")'> 430: </pre>
<pre id='line430' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF38' onclick='toggleDiv("line431")'> 431:     def add_forces_to_result_by_id(self, list target_atom_ids, list result=None):</pre>
<pre id='line431' class='code' style='background-color: #FFFF38'>
    /* "Cython_shift_calculator.pyx":431
 * 
 * 
 *     def add_forces_to_result_by_id(self, list target_atom_ids, list result=None):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if result ==  None:
 *             result = [None] * self._length
 */
    values[1] = ((PyObject*)Py_None);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__target_atom_ids)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__result);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "add_forces_to_result_by_id") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_target_atom_ids = ((PyObject*)values[0]);
    __pyx_v_result = ((PyObject*)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("add_forces_to_result_by_id", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.add_forces_to_result_by_id", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_target_atom_ids), (&PyList_Type), 1, "target_atom_ids", 1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_result), (&PyList_Type), 1, "result", 1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_9Out_array_14add_forces_to_result_by_id(((struct __pyx_obj_17shift_calculators_Out_array *)__pyx_v_self), __pyx_v_target_atom_ids, __pyx_v_result);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_17shift_calculators_9Out_array_14add_forces_to_result_by_id(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self, PyObject *__pyx_v_target_atom_ids, PyObject *__pyx_v_result) {
  double __pyx_v_x;
  double __pyx_v_y;
  double __pyx_v_z;
  long __pyx_v_id3;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("add_forces_to_result_by_id", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_result);
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line432")'> 432:         if result ==  None:</pre>
<pre id='line432' class='code' style='background-color: #FFFF79'>
  /* "Cython_shift_calculator.pyx":432
 * 
 *     def add_forces_to_result_by_id(self, list target_atom_ids, list result=None):
 *         if result ==  None:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             result = [None] * self._length
 * 
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(((PyObject *)__pyx_v_result), Py_None, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line433")'> 433:             result = [None] * self._length</pre>
<pre id='line433' class='code' style='background-color: #FFFF8d'>
    /* "Cython_shift_calculator.pyx":433
 *     def add_forces_to_result_by_id(self, list target_atom_ids, list result=None):
 *         if result ==  None:
 *             result = [None] * self._length             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef double x = 0.0
 */
    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1 * ((__pyx_v_self->_length<code><</code>0) ? 0:__pyx_v_self->_length));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 433; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    { Py_ssize_t __pyx_temp;
      for (__pyx_temp=0; __pyx_temp <code><</code> __pyx_v_self->_length; __pyx_temp++) {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
        <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, __pyx_temp, Py_None);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_result));
    __pyx_v_result = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line434")'> 434: </pre>
<pre id='line434' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line435")'> 435:         cdef double x = 0.0</pre>
<pre id='line435' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":435
 *             result = [None] * self._length
 * 
 *         cdef double x = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef double y = 0.0
 *         cdef double z = 0.0
 */
  __pyx_v_x = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line436")'> 436:         cdef double y = 0.0</pre>
<pre id='line436' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":436
 * 
 *         cdef double x = 0.0
 *         cdef double y = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef double z = 0.0
 *         cdef long id3
 */
  __pyx_v_y = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line437")'> 437:         cdef double z = 0.0</pre>
<pre id='line437' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":437
 *         cdef double x = 0.0
 *         cdef double y = 0.0
 *         cdef double z = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef long id3
 *         for i in target_atom_ids:
 */
  __pyx_v_z = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line438")'> 438:         cdef long id3</pre>
<pre id='line438' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line439")'> 439:         for i in target_atom_ids:</pre>
<pre id='line439' class='code' style='background-color: #FFFF79'>
  /* "Cython_shift_calculator.pyx":439
 *         cdef double z = 0.0
 *         cdef long id3
 *         for i in target_atom_ids:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if self._mask[i] != 0:
 *                 if result[i] ==  None:
 */
  if (unlikely(((PyObject *)__pyx_v_target_atom_ids) == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_1 = ((PyObject *)__pyx_v_target_atom_ids); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3 = 0;
  for (;;) {
    if (__pyx_t_3 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    #else
    __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    #endif
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
    __pyx_v_i = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line440")'> 440:             if self._mask[i] != 0:</pre>
<pre id='line440' class='code' style='background-color: #FFFF7f'>
    /* "Cython_shift_calculator.pyx":440
 *         cdef long id3
 *         for i in target_atom_ids:
 *             if self._mask[i] != 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if result[i] ==  None:
 *                     result[i] = [0.0]*3
 */
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 440; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_2 = ((__pyx_v_self->_mask[__pyx_t_5]) != 0);
    if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line441")'> 441:                 if result[i] ==  None:</pre>
<pre id='line441' class='code' style='background-color: #FFFF4f'>
      /* "Cython_shift_calculator.pyx":441
 *         for i in target_atom_ids:
 *             if self._mask[i] != 0:
 *                 if result[i] ==  None:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     result[i] = [0.0]*3
 *                 id3 = i * 3
 */
      if (unlikely(((PyObject *)__pyx_v_result) == Py_None)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
       <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 441; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_result), __pyx_v_i);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 441; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_6 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_4, Py_None, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 441; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(__pyx_t_2 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 441; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line442")'> 442:                     result[i] = [0.0]*3</pre>
<pre id='line442' class='code' style='background-color: #FFFF4b'>
        /* "Cython_shift_calculator.pyx":442
 *             if self._mask[i] != 0:
 *                 if result[i] ==  None:
 *                     result[i] = [0.0]*3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 id3 = i * 3
 *                 x  = self._data[id3]
 */
        __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(0.0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 442; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
        __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(1 * 3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 442; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
        { Py_ssize_t __pyx_temp;
          for (__pyx_temp=0; __pyx_temp <code><</code> 3; __pyx_temp++) {
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
            <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, __pyx_temp, __pyx_t_6);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_6);
          }
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(((PyObject *)__pyx_v_result) == Py_None)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 442; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        if (<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_result), __pyx_v_i, ((PyObject *)__pyx_t_4)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 442; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
        goto __pyx_L7;
      }
      __pyx_L7:;
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line443")'> 443:                 id3 = i * 3</pre>
<pre id='line443' class='code' style='background-color: #FFFF62'>
      /* "Cython_shift_calculator.pyx":443
 *                 if result[i] ==  None:
 *                     result[i] = [0.0]*3
 *                 id3 = i * 3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 x  = self._data[id3]
 *                 y  = self._data[id3+1]
 */
      __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_i, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 443; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_7 = __Pyx_<span class='py_c_api'>PyInt_AsLong</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_7 == (long)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 443; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_v_id3 = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line444")'> 444:                 x  = self._data[id3]</pre>
<pre id='line444' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":444
 *                     result[i] = [0.0]*3
 *                 id3 = i * 3
 *                 x  = self._data[id3]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 y  = self._data[id3+1]
 *                 z  = self._data[id3+2]
 */
      __pyx_v_x = (__pyx_v_self->_data[__pyx_v_id3]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line445")'> 445:                 y  = self._data[id3+1]</pre>
<pre id='line445' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":445
 *                 id3 = i * 3
 *                 x  = self._data[id3]
 *                 y  = self._data[id3+1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 z  = self._data[id3+2]
 *                 result[i][0] += x
 */
      __pyx_v_y = (__pyx_v_self->_data[(__pyx_v_id3 + 1)]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line446")'> 446:                 z  = self._data[id3+2]</pre>
<pre id='line446' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":446
 *                 x  = self._data[id3]
 *                 y  = self._data[id3+1]
 *                 z  = self._data[id3+2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 result[i][0] += x
 *                 result[i][1] += y
 */
      __pyx_v_z = (__pyx_v_self->_data[(__pyx_v_id3 + 2)]);
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line447")'> 447:                 result[i][0] += x</pre>
<pre id='line447' class='code' style='background-color: #FFFF43'>
      /* "Cython_shift_calculator.pyx":447
 *                 y  = self._data[id3+1]
 *                 z  = self._data[id3+2]
 *                 result[i][0] += x             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 result[i][1] += y
 *                 result[i][2] += z
 */
      if (unlikely(((PyObject *)__pyx_v_result) == Py_None)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
       <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 447; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_result), __pyx_v_i);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 447; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_5 = 0;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, __pyx_t_5, sizeof(Py_ssize_t), PyInt_FromSsize_t);<span class='error_goto'> if (!__pyx_t_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 447; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_x);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 447; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      __pyx_t_9 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_6, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 447; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      if (<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_t_4, __pyx_t_5, __pyx_t_9, sizeof(Py_ssize_t), PyInt_FromSsize_t) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 447; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line448")'> 448:                 result[i][1] += y</pre>
<pre id='line448' class='code' style='background-color: #FFFF43'>
      /* "Cython_shift_calculator.pyx":448
 *                 z  = self._data[id3+2]
 *                 result[i][0] += x
 *                 result[i][1] += y             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 result[i][2] += z
 * 
 */
      if (unlikely(((PyObject *)__pyx_v_result) == Py_None)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
       <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 448; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_result), __pyx_v_i);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 448; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_5 = 1;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, __pyx_t_5, sizeof(Py_ssize_t), PyInt_FromSsize_t);<span class='error_goto'> if (!__pyx_t_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 448; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_y);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 448; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      __pyx_t_6 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_9, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 448; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      if (<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_t_4, __pyx_t_5, __pyx_t_6, sizeof(Py_ssize_t), PyInt_FromSsize_t) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 448; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line449")'> 449:                 result[i][2] += z</pre>
<pre id='line449' class='code' style='background-color: #FFFF41'>
      /* "Cython_shift_calculator.pyx":449
 *                 result[i][0] += x
 *                 result[i][1] += y
 *                 result[i][2] += z             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
      if (unlikely(((PyObject *)__pyx_v_result) == Py_None)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
       <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 449; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_result), __pyx_v_i);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 449; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_5 = 2;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, __pyx_t_5, sizeof(Py_ssize_t), PyInt_FromSsize_t);<span class='error_goto'> if (!__pyx_t_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 449; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_z);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 449; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      __pyx_t_9 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_6, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 449; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      if (<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_t_4, __pyx_t_5, __pyx_t_9, sizeof(Py_ssize_t), PyInt_FromSsize_t) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 449; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      goto __pyx_L6;
    }
    __pyx_L6:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line450")'> 450: </pre>
<pre id='line450' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line451")'> 451: </pre>
<pre id='line451' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line452")'> 452:         return result</pre>
<pre id='line452' class='code' style='background-color: #FFFF6a'>
  /* "Cython_shift_calculator.pyx":452
 * 
 * 
 *         return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __str__(self):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_result));
  __pyx_r = ((PyObject *)__pyx_v_result);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.add_forces_to_result_by_id", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_9Out_array_17__str__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_9Out_array_17__str__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__str__ (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_9Out_array_16__str__(((struct __pyx_obj_17shift_calculators_Out_array *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line453")'> 453: </pre>
<pre id='line453' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line454")'> 454:     def __str__(self):</pre>
<pre id='line454' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":454
 *         return result
 * 
 *     def __str__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef long id3 =0
 */

static PyObject *__pyx_pf_17shift_calculators_9Out_array_16__str__(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self) {
  long __pyx_v_id3;
  PyObject *__pyx_v_result = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__str__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line455")'> 455: </pre>
<pre id='line455' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line456")'> 456:         cdef long id3 =0</pre>
<pre id='line456' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":456
 *     def __str__(self):
 * 
 *         cdef long id3 =0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result =  []
 *         result.append('length = %i' % self._length)
 */
  __pyx_v_id3 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line457")'> 457:         result =  []</pre>
<pre id='line457' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":457
 * 
 *         cdef long id3 =0
 *         result =  []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.append('length = %i' % self._length)
 *         for i in range(self._length):
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 457; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_result = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line458")'> 458:         result.append('length = %i' % self._length)</pre>
<pre id='line458' class='code' style='background-color: #FFFF5e'>
  /* "Cython_shift_calculator.pyx":458
 *         cdef long id3 =0
 *         result =  []
 *         result.append('length = %i' % self._length)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for i in range(self._length):
 *             if self._mask[i] ==0:
 */
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_length);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 458; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_16), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 458; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_result, ((PyObject *)__pyx_t_2));<span class='error_goto'> if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 458; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line459")'> 459:         for i in range(self._length):</pre>
<pre id='line459' class='code' style='background-color: #FFFF20'>
  /* "Cython_shift_calculator.pyx":459
 *         result =  []
 *         result.append('length = %i' % self._length)
 *         for i in range(self._length):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if self._mask[i] ==0:
 *                 result.append("%5i ." % i)
 */
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_length);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 459; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 459; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 459; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
    __pyx_t_1 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 459; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_5 = Py_TYPE(__pyx_t_1)->tp_iternext;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (!__pyx_t_5 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) {
      if (__pyx_t_4 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 459; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 459; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_5 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      if (__pyx_t_4 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 459; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 459; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_2 = __pyx_t_5(__pyx_t_1);
      if (unlikely(!__pyx_t_2)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 459; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
    __pyx_v_i = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line460")'> 460:             if self._mask[i] ==0:</pre>
<pre id='line460' class='code' style='background-color: #FFFF7f'>
    /* "Cython_shift_calculator.pyx":460
 *         result.append('length = %i' % self._length)
 *         for i in range(self._length):
 *             if self._mask[i] ==0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 result.append("%5i ." % i)
 *             else:
 */
    __pyx_t_6 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_6 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 460; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_7 = ((__pyx_v_self->_mask[__pyx_t_6]) == 0);
    if (__pyx_t_7) {
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line461")'> 461:                 result.append("%5i ." % i)</pre>
<pre id='line461' class='code' style='background-color: #FFFF79'>
      /* "Cython_shift_calculator.pyx":461
 *         for i in range(self._length):
 *             if self._mask[i] ==0:
 *                 result.append("%5i ." % i)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 id3 = i * 3
 */
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_17), __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 461; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
      __pyx_t_3 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_result, ((PyObject *)__pyx_t_2));<span class='error_goto'> if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 461; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
      goto __pyx_L5;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line462")'> 462:             else:</pre>
<pre id='line462' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line463")'> 463:                 id3 = i * 3</pre>
<pre id='line463' class='code' style='background-color: #FFFF62'>
      /* "Cython_shift_calculator.pyx":463
 *                 result.append("%5i ." % i)
 *             else:
 *                 id3 = i * 3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 result.append('%5i %4.7f,%4.7f,%4.7f' % (i,self._data[id3],self._data[id3+1],self._data[id3+2]))
 *         return '\n'.join(result)
 */
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_i, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 463; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_8 = __Pyx_<span class='py_c_api'>PyInt_AsLong</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_8 == (long)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 463; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_v_id3 = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFF35' onclick='toggleDiv("line464")'> 464:                 result.append('%5i %4.7f,%4.7f,%4.7f' % (i,self._data[id3],self._data[id3+1],self._data[id3+2]))</pre>
<pre id='line464' class='code' style='background-color: #FFFF35'>
      /* "Cython_shift_calculator.pyx":464
 *             else:
 *                 id3 = i * 3
 *                 result.append('%5i %4.7f,%4.7f,%4.7f' % (i,self._data[id3],self._data[id3+1],self._data[id3+2]))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return '\n'.join(result)
 * 
 */
      __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self->_data[__pyx_v_id3]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self->_data[(__pyx_v_id3 + 1)]));<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_10 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self->_data[(__pyx_v_id3 + 2)]));<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
      __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_v_i);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_i);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 2, __pyx_t_9);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_9);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 3, __pyx_t_10);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_10);
      __pyx_t_2 = 0;
      __pyx_t_9 = 0;
      __pyx_t_10 = 0;
      __pyx_t_10 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_18), ((PyObject *)__pyx_t_11));<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_10));
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_11)); __pyx_t_11 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_result, ((PyObject *)__pyx_t_10));<span class='error_goto'> if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_10)); __pyx_t_10 = 0;
    }
    __pyx_L5:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line465")'> 465:         return '\n'.join(result)</pre>
<pre id='line465' class='code' style='background-color: #FFFF3e'>
  /* "Cython_shift_calculator.pyx":465
 *                 id3 = i * 3
 *                 result.append('%5i %4.7f,%4.7f,%4.7f' % (i,self._data[id3],self._data[id3+1],self._data[id3+2]))
 *         return '\n'.join(result)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_kp_s_19), __pyx_n_s__join);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_result));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, ((PyObject *)__pyx_v_result));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_result));
  __pyx_t_11 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_10), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_10)); __pyx_t_10 = 0;
  __pyx_r = __pyx_t_11;
  __pyx_t_11 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.__str__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line466")'> 466: </pre>
<pre id='line466' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line467")'> 467: </pre>
<pre id='line467' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line468")'> 468: #cdef float* out_array = null</pre>
<pre id='line468' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line469")'> 469: #cdef long out_array_length = -1</pre>
<pre id='line469' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line470")'> 470: #cdef bint allocate_out_array_for_forces(long length) except -1:</pre>
<pre id='line470' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line471")'> 471: #    global out_array</pre>
<pre id='line471' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line472")'> 472: #    global out_array_length</pre>
<pre id='line472' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line473")'> 473: #    cdef long required_length = length*3</pre>
<pre id='line473' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line474")'> 474: #    cdef bint allocate =  False</pre>
<pre id='line474' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line475")'> 475: #    if out_array ==  null:</pre>
<pre id='line475' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line476")'> 476: #        out_array = &lt;float*&gt; malloc*(required_length *sizeof(float))</pre>
<pre id='line476' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line477")'> 477: #        if out_array  == null:</pre>
<pre id='line477' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line478")'> 478: #            Raise</pre>
<pre id='line478' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line479")'> 479: #        allocate=True</pre>
<pre id='line479' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line480")'> 480: #        out_array_length =</pre>
<pre id='line480' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line481")'> 481: #        elif  len(out_array) &lt; required_length</pre>
<pre id='line481' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line482")'> 482: #    return allocate</pre>
<pre id='line482' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line483")'> 483: #</pre>
<pre id='line483' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line484")'> 484: #def _clear_out_array_for_forces(self, length):</pre>
<pre id='line484' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line485")'> 485: #</pre>
<pre id='line485' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line486")'> 486: #</pre>
<pre id='line486' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line487")'> 487: #    is_new  = self.allocate_out_array_for_forces(length)</pre>
<pre id='line487' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line488")'> 488: #</pre>
<pre id='line488' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line489")'> 489: #    if not is_new:</pre>
<pre id='line489' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line490")'> 490: #        length = length*3</pre>
<pre id='line490' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line491")'> 491: #        for i in range(length):</pre>
<pre id='line491' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line492")'> 492: #            self._out_array[i] =0.0</pre>
<pre id='line492' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line493")'> 493: #    return self._out_array</pre>
<pre id='line493' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line494")'> 494: #</pre>
<pre id='line494' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line495")'> 495: #def _copy_back_forces(self, data_dict, data_array, target_atom_ids):</pre>
<pre id='line495' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line496")'> 496: #    for id in target_atom_ids:</pre>
<pre id='line496' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line497")'> 497: #        result =  dict.setdefault(id,[0.0,0.0,0.0])</pre>
<pre id='line497' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line498")'> 498: #        id3 = id*3</pre>
<pre id='line498' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line499")'> 499: #        result[0] = data_array[id3]</pre>
<pre id='line499' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line500")'> 500: #        result[1] = data_array[id3+1]</pre>
<pre id='line500' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line501")'> 501: #        result[2] = data_array[id3+2]</pre>
<pre id='line501' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line502")'> 502: </pre>
<pre id='line502' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line503")'> 503: </pre>
<pre id='line503' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line504")'> 504: </pre>
<pre id='line504' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line505")'> 505: cdef object vec3_as_tuple(Vec3&amp; vec_3):</pre>
<pre id='line505' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":505
 * 
 * 
 * cdef object vec3_as_tuple(Vec3& vec_3):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return vec_3.x(), vec_3.y(), vec_3.z()
 * 
 */

static PyObject *__pyx_f_17shift_calculators_vec3_as_tuple(Vec3 &__pyx_v_vec_3) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("vec3_as_tuple", 0);
</pre><pre class='line' style='background-color: #FFFF3c' onclick='toggleDiv("line506")'> 506:     return vec_3.x(), vec_3.y(), vec_3.z()</pre>
<pre id='line506' class='code' style='background-color: #FFFF3c'>
  /* "Cython_shift_calculator.pyx":506
 * 
 * cdef object vec3_as_tuple(Vec3& vec_3):
 *     return vec_3.x(), vec_3.y(), vec_3.z()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef class Vec3_container:
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_vec_3.x());<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_vec_3.y());<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_vec_3.z());<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_t_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_r = ((PyObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.vec3_as_tuple", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line507")'> 507: </pre>
<pre id='line507' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line508")'> 508: cdef class Vec3_container:</pre>
<pre id='line508' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":508
 *     return vec_3.x(), vec_3.y(), vec_3.z()
 * 
 * cdef class Vec3_container:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef float[3] floats
 */
struct __pyx_obj_17shift_calculators_Vec3_container {
  PyObject_HEAD
  struct __pyx_vtabstruct_17shift_calculators_Vec3_container *__pyx_vtab;
  float floats[3];
};


/* "Cython_shift_calculator.pyx":508
 *     return vec_3.x(), vec_3.y(), vec_3.z()
 * 
 * cdef class Vec3_container:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef float[3] floats
 */

struct __pyx_vtabstruct_17shift_calculators_Vec3_container {
  PyObject *(*set_vec3)(struct __pyx_obj_17shift_calculators_Vec3_container *, Vec3 &);
  Vec3 (*get_vec3)(struct __pyx_obj_17shift_calculators_Vec3_container *);
};
static struct __pyx_vtabstruct_17shift_calculators_Vec3_container *__pyx_vtabptr_17shift_calculators_Vec3_container;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line509")'> 509: </pre>
<pre id='line509' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line510")'> 510:     cdef float[3] floats</pre>
<pre id='line510' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line511")'> 511: </pre>
<pre id='line511' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line512")'> 512:     cdef set_vec3(self,Vec3&amp; vec3):</pre>
<pre id='line512' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":512
 *     cdef float[3] floats
 * 
 *     cdef set_vec3(self,Vec3& vec3):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.floats[0] =  vec3.x()
 *         self.floats[1] =  vec3.y()
 */

static PyObject *__pyx_f_17shift_calculators_14Vec3_container_set_vec3(struct __pyx_obj_17shift_calculators_Vec3_container *__pyx_v_self, Vec3 &__pyx_v_vec3) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_vec3", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line513")'> 513:         self.floats[0] =  vec3.x()</pre>
<pre id='line513' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":513
 * 
 *     cdef set_vec3(self,Vec3& vec3):
 *         self.floats[0] =  vec3.x()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.floats[1] =  vec3.y()
 *         self.floats[2] =  vec3.z()
 */
  (__pyx_v_self->floats[0]) = __pyx_v_vec3.x();
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line514")'> 514:         self.floats[1] =  vec3.y()</pre>
<pre id='line514' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":514
 *     cdef set_vec3(self,Vec3& vec3):
 *         self.floats[0] =  vec3.x()
 *         self.floats[1] =  vec3.y()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.floats[2] =  vec3.z()
 * 
 */
  (__pyx_v_self->floats[1]) = __pyx_v_vec3.y();
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line515")'> 515:         self.floats[2] =  vec3.z()</pre>
<pre id='line515' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":515
 *         self.floats[0] =  vec3.x()
 *         self.floats[1] =  vec3.y()
 *         self.floats[2] =  vec3.z()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     @cython.profile(False)
 */
  (__pyx_v_self->floats[2]) = __pyx_v_vec3.z();

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line516")'> 516: </pre>
<pre id='line516' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line517")'> 517:     @cython.profile(False)</pre>
<pre id='line517' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line518")'> 518:     cdef Vec3  get_vec3(self):</pre>
<pre id='line518' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":518
 * 
 *     @cython.profile(False)
 *     cdef Vec3  get_vec3(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return Vec3(self.floats[0],self.floats[1],self.floats[2])
 * 
 */

static Vec3 __pyx_f_17shift_calculators_14Vec3_container_get_vec3(struct __pyx_obj_17shift_calculators_Vec3_container *__pyx_v_self) {
  Vec3 __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_vec3", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line519")'> 519:         return Vec3(self.floats[0],self.floats[1],self.floats[2])</pre>
<pre id='line519' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":519
 *     @cython.profile(False)
 *     cdef Vec3  get_vec3(self):
 *         return Vec3(self.floats[0],self.floats[1],self.floats[2])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __getitem__(self, i):
 */
  __pyx_r = Vec3((__pyx_v_self->floats[0]), (__pyx_v_self->floats[1]), (__pyx_v_self->floats[2]));
  goto __pyx_L0;

  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_14Vec3_container_1__getitem__(PyObject *__pyx_v_self, PyObject *__pyx_v_i); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_14Vec3_container_1__getitem__(PyObject *__pyx_v_self, PyObject *__pyx_v_i) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__getitem__ (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_14Vec3_container___getitem__(((struct __pyx_obj_17shift_calculators_Vec3_container *)__pyx_v_self), ((PyObject *)__pyx_v_i));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line520")'> 520: </pre>
<pre id='line520' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line521")'> 521:     def __getitem__(self, i):</pre>
<pre id='line521' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":521
 *         return Vec3(self.floats[0],self.floats[1],self.floats[2])
 * 
 *     def __getitem__(self, i):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if i > 2:
 *             msg = "tried to access object at %i length is %i"
 */

static PyObject *__pyx_pf_17shift_calculators_14Vec3_container___getitem__(struct __pyx_obj_17shift_calculators_Vec3_container *__pyx_v_self, PyObject *__pyx_v_i) {
  PyObject *__pyx_v_msg = NULL;
  PyObject *__pyx_v_values = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__getitem__", 0);
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line522")'> 522:         if i &gt; 2:</pre>
<pre id='line522' class='code' style='background-color: #FFFF79'>
  /* "Cython_shift_calculator.pyx":522
 * 
 *     def __getitem__(self, i):
 *         if i > 2:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             msg = "tried to access object at %i length is %i"
 *             values = (i,3)
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_i, __pyx_int_2, Py_GT); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line523")'> 523:             msg = "tried to access object at %i length is %i"</pre>
<pre id='line523' class='code' style='background-color: #FFFFe7'>
    /* "Cython_shift_calculator.pyx":523
 *     def __getitem__(self, i):
 *         if i > 2:
 *             msg = "tried to access object at %i length is %i"             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             values = (i,3)
 *             raise IndexError(msg % values)
 */
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_12));
    __pyx_v_msg = ((PyObject *)__pyx_kp_s_12);
</pre><pre class='line' style='background-color: #FFFF86' onclick='toggleDiv("line524")'> 524:             values = (i,3)</pre>
<pre id='line524' class='code' style='background-color: #FFFF86'>
    /* "Cython_shift_calculator.pyx":524
 *         if i > 2:
 *             msg = "tried to access object at %i length is %i"
 *             values = (i,3)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             raise IndexError(msg % values)
 * 
 */
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_i);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_i);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_3);
    __pyx_v_values = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line525")'> 525:             raise IndexError(msg % values)</pre>
<pre id='line525' class='code' style='background-color: #FFFF55'>
    /* "Cython_shift_calculator.pyx":525
 *             msg = "tried to access object at %i length is %i"
 *             values = (i,3)
 *             raise IndexError(msg % values)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         return self.floats[i]
 */
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Remainder</span>(__pyx_v_msg, ((PyObject *)__pyx_v_values));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_IndexError, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line526")'> 526: </pre>
<pre id='line526' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF37' onclick='toggleDiv("line527")'> 527:         return self.floats[i]</pre>
<pre id='line527' class='code' style='background-color: #FFFF37'>
  /* "Cython_shift_calculator.pyx":527
 *             raise IndexError(msg % values)
 * 
 *         return self.floats[i]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_4 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self->floats[__pyx_t_4]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Vec3_container.__getitem__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_msg);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_values);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_27Python_ring_force_sub_terms_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_27Python_ring_force_sub_terms_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) > 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) > 0) && unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__init__", 0))) return -1;
  __pyx_r = __pyx_pf_17shift_calculators_27Python_ring_force_sub_terms___init__(((struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line528")'> 528: </pre>
<pre id='line528' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line529")'> 529: </pre>
<pre id='line529' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line530")'> 530: cdef struct target_distant_atom:</pre>
<pre id='line530' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":530
 * 
 * 
 * cdef struct target_distant_atom:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     int target_atom_id
 *     int distant_atom_id
 */
struct __pyx_t_17shift_calculators_target_distant_atom {
  int target_atom_id;
  int distant_atom_id;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line531")'> 531:     int target_atom_id</pre>
<pre id='line531' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line532")'> 532:     int distant_atom_id</pre>
<pre id='line532' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line533")'> 533: </pre>
<pre id='line533' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line534")'> 534: cdef struct target_type:</pre>
<pre id='line534' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":534
 *     int distant_atom_id
 * 
 * cdef struct target_type:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     int  target_atom_id
 *     int  atom_type_id
 */
struct __pyx_t_17shift_calculators_target_type {
  int target_atom_id;
  int atom_type_id;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line535")'> 535:     int  target_atom_id</pre>
<pre id='line535' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line536")'> 536:     int  atom_type_id</pre>
<pre id='line536' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line537")'> 537: </pre>
<pre id='line537' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line538")'> 538: cdef struct coefficient_exponent:</pre>
<pre id='line538' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":538
 *     int  atom_type_id
 * 
 * cdef struct coefficient_exponent:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     float coefficient
 *     float exponent
 */
struct __pyx_t_17shift_calculators_coefficient_exponent {
  float coefficient;
  float exponent;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line539")'> 539:     float coefficient</pre>
<pre id='line539' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line540")'> 540:     float exponent</pre>
<pre id='line540' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line541")'> 541: </pre>
<pre id='line541' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line542")'> 542: cdef struct dihedral_ids:</pre>
<pre id='line542' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":542
 *     float exponent
 * 
 * cdef struct dihedral_ids:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     int atom_id_1
 *     int atom_id_2
 */
struct __pyx_t_17shift_calculators_dihedral_ids {
  int atom_id_1;
  int atom_id_2;
  int atom_id_3;
  int atom_id_4;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line543")'> 543:     int atom_id_1</pre>
<pre id='line543' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line544")'> 544:     int atom_id_2</pre>
<pre id='line544' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line545")'> 545:     int atom_id_3</pre>
<pre id='line545' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line546")'> 546:     int atom_id_4</pre>
<pre id='line546' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line547")'> 547: </pre>
<pre id='line547' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line548")'> 548: cdef struct Coef_component:</pre>
<pre id='line548' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":548
 *     int atom_id_4
 * 
 * cdef struct Coef_component:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     int atom_type_id
 *     int ring_id
 */
struct __pyx_t_17shift_calculators_Coef_component {
  int atom_type_id;
  int ring_id;
  float coefficient;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line549")'> 549:     int atom_type_id</pre>
<pre id='line549' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line550")'> 550:     int ring_id</pre>
<pre id='line550' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line551")'> 551:     float coefficient</pre>
<pre id='line551' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line552")'> 552: </pre>
<pre id='line552' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line553")'> 553: cdef struct Ring_force_sub_terms:</pre>
<pre id='line553' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":553
 *     float coefficient
 * 
 * cdef struct Ring_force_sub_terms:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     Vec3 d
 *     float dLnL
 */
struct __pyx_t_17shift_calculators_Ring_force_sub_terms {
  Vec3 d;
  float dLnL;
  float dL3nL3;
  float dn;
  float dL;
  float nL;
  Vec3 gradUQ;
  float dL3;
  float u;
  Vec3 gradVQ;
  float dL6;
  Vec3 ring_normal;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line554")'> 554:     Vec3 d</pre>
<pre id='line554' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line555")'> 555:     float dLnL</pre>
<pre id='line555' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line556")'> 556:     float dL3nL3</pre>
<pre id='line556' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line557")'> 557:     float dn</pre>
<pre id='line557' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line558")'> 558:     float dL</pre>
<pre id='line558' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line559")'> 559:     float nL</pre>
<pre id='line559' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line560")'> 560:     Vec3 gradUQ</pre>
<pre id='line560' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line561")'> 561:     float dL3</pre>
<pre id='line561' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line562")'> 562:     float u</pre>
<pre id='line562' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line563")'> 563:     Vec3 gradVQ</pre>
<pre id='line563' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line564")'> 564:     float dL6</pre>
<pre id='line564' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line565")'> 565:     Vec3 ring_normal</pre>
<pre id='line565' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line566")'> 566: </pre>
<pre id='line566' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line567")'> 567: cdef class Python_ring_force_sub_terms:</pre>
<pre id='line567' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":567
 *     Vec3 ring_normal
 * 
 * cdef class Python_ring_force_sub_terms:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Ring_force_sub_terms _terms
 * 
 */
struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms {
  PyObject_HEAD
  struct __pyx_vtabstruct_17shift_calculators_Python_ring_force_sub_terms *__pyx_vtab;
  struct __pyx_t_17shift_calculators_Ring_force_sub_terms _terms;
};


/* "Cython_shift_calculator.pyx":567
 *     Vec3 ring_normal
 * 
 * cdef class Python_ring_force_sub_terms:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Ring_force_sub_terms _terms
 * 
 */

struct __pyx_vtabstruct_17shift_calculators_Python_ring_force_sub_terms {
  PyObject *(*setup)(struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms *, struct __pyx_t_17shift_calculators_Ring_force_sub_terms &);
  struct __pyx_t_17shift_calculators_Ring_force_sub_terms (*get_terms)(struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms *);
};
static struct __pyx_vtabstruct_17shift_calculators_Python_ring_force_sub_terms *__pyx_vtabptr_17shift_calculators_Python_ring_force_sub_terms;

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line568")'> 568:     cdef Ring_force_sub_terms _terms</pre>
<pre id='line568' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line569")'> 569: </pre>
<pre id='line569' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line570")'> 570: #    def __cinit__(self):</pre>
<pre id='line570' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line571")'> 571: #        self._terms = NULL</pre>
<pre id='line571' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line572")'> 572: </pre>
<pre id='line572' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line573")'> 573:     def __init__(self):</pre>
<pre id='line573' class='code' style='background-color: #FFFFe7'>
/* "Cython_shift_calculator.pyx":573
 * #        self._terms = NULL
 * 
 *     def __init__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         pass
 * 
 */

static int __pyx_pf_17shift_calculators_27Python_ring_force_sub_terms___init__(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line574")'> 574:         pass</pre>
<pre id='line574' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line575")'> 575: </pre>
<pre id='line575' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line576")'> 576:     cdef setup(self, Ring_force_sub_terms&amp; terms):</pre>
<pre id='line576' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":576
 *         pass
 * 
 *     cdef setup(self, Ring_force_sub_terms& terms):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._terms=terms
 * 
 */

static PyObject *__pyx_f_17shift_calculators_27Python_ring_force_sub_terms_setup(struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms *__pyx_v_self, struct __pyx_t_17shift_calculators_Ring_force_sub_terms &__pyx_v_terms) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("setup", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line577")'> 577:         self._terms=terms</pre>
<pre id='line577' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":577
 * 
 *     cdef setup(self, Ring_force_sub_terms& terms):
 *         self._terms=terms             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef Ring_force_sub_terms get_terms(self):
 */
  __pyx_v_self->_terms = __pyx_v_terms;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line578")'> 578: </pre>
<pre id='line578' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line579")'> 579:     cdef Ring_force_sub_terms get_terms(self):</pre>
<pre id='line579' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":579
 *         self._terms=terms
 * 
 *     cdef Ring_force_sub_terms get_terms(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._terms
 * 
 */

static struct __pyx_t_17shift_calculators_Ring_force_sub_terms __pyx_f_17shift_calculators_27Python_ring_force_sub_terms_get_terms(struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms *__pyx_v_self) {
  struct __pyx_t_17shift_calculators_Ring_force_sub_terms __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_terms", 0);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line580")'> 580:         return self._terms</pre>
<pre id='line580' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":580
 * 
 *     cdef Ring_force_sub_terms get_terms(self):
 *         return self._terms             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_r = __pyx_v_self->_terms;
  goto __pyx_L0;

  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line581")'> 581: </pre>
<pre id='line581' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line582")'> 582: </pre>
<pre id='line582' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line583")'> 583: cdef struct Component_Offsets:</pre>
<pre id='line583' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":583
 * 
 * 
 * cdef struct Component_Offsets:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     int id
 *     int offset
 */
struct __pyx_t_17shift_calculators_Component_Offsets {
  int id;
  int offset;
  int length;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line584")'> 584:     int id</pre>
<pre id='line584' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line585")'> 585:     int offset</pre>
<pre id='line585' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line586")'> 586:     int length</pre>
<pre id='line586' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line587")'> 587: </pre>
<pre id='line587' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line588")'> 588: </pre>
<pre id='line588' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line589")'> 589: cdef class Coef_components:</pre>
<pre id='line589' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":589
 * 
 * 
 * cdef class Coef_components:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef object _raw_data
 *     cdef Coef_component* _components
 */
struct __pyx_obj_17shift_calculators_Coef_components {
  PyObject_HEAD
  struct __pyx_vtabstruct_17shift_calculators_Coef_components *__pyx_vtab;
  PyObject *_raw_data;
  struct __pyx_t_17shift_calculators_Coef_component *_components;
  int _num_components;
  PyObject *_raw_component_offsets_data;
  struct __pyx_t_17shift_calculators_Component_Offsets *_component_offsets;
  int num_ids;
};


/* "Cython_shift_calculator.pyx":589
 * 
 * 
 * cdef class Coef_components:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef object _raw_data
 *     cdef Coef_component* _components
 */

struct __pyx_vtabstruct_17shift_calculators_Coef_components {
  PyObject *(*_bytes_to_components)(struct __pyx_obj_17shift_calculators_Coef_components *, PyObject *);
  void (*_bytes_to_component_offsets)(struct __pyx_obj_17shift_calculators_Coef_components *, PyObject *);
  struct __pyx_t_17shift_calculators_Component_Offsets *(*get_id_offsets)(struct __pyx_obj_17shift_calculators_Coef_components *, int);
  struct __pyx_t_17shift_calculators_Coef_component *(*get_component)(struct __pyx_obj_17shift_calculators_Coef_components *, int);
};
static struct __pyx_vtabstruct_17shift_calculators_Coef_components *__pyx_vtabptr_17shift_calculators_Coef_components;
static CYTHON_INLINE struct __pyx_t_17shift_calculators_Component_Offsets *__pyx_f_17shift_calculators_15Coef_components_get_id_offsets(struct __pyx_obj_17shift_calculators_Coef_components *, int);
static CYTHON_INLINE struct __pyx_t_17shift_calculators_Coef_component *__pyx_f_17shift_calculators_15Coef_components_get_component(struct __pyx_obj_17shift_calculators_Coef_components *, int);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line590")'> 590:     cdef object _raw_data</pre>
<pre id='line590' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line591")'> 591:     cdef Coef_component* _components</pre>
<pre id='line591' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line592")'> 592:     cdef int _num_components</pre>
<pre id='line592' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line593")'> 593: </pre>
<pre id='line593' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line594")'> 594:     cdef object _raw_component_offsets_data</pre>
<pre id='line594' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line595")'> 595:     cdef Component_Offsets* _component_offsets</pre>
<pre id='line595' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line596")'> 596:     cdef int num_ids</pre>
<pre id='line596' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line597")'> 597: </pre>
<pre id='line597' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line598")'> 598:     cdef _bytes_to_components(self, data):</pre>
<pre id='line598' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":598
 *     cdef int num_ids
 * 
 *     cdef _bytes_to_components(self, data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._raw_data =  data
 */

static PyObject *__pyx_f_17shift_calculators_15Coef_components__bytes_to_components(struct __pyx_obj_17shift_calculators_Coef_components *__pyx_v_self, PyObject *__pyx_v_data) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_components", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line599")'> 599: </pre>
<pre id='line599' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line600")'> 600:         self._raw_data =  data</pre>
<pre id='line600' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":600
 *     cdef _bytes_to_components(self, data):
 * 
 *         self._raw_data =  data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._components =  <code><</code>Coef_component*> <code><</code>size_t> ctypes.addressof(data)
 *         self._num_components =  len(data)/ sizeof(Coef_component)
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_raw_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_raw_data);
  __pyx_v_self->_raw_data = __pyx_v_data;
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line601")'> 601:         self._components =  &lt;Coef_component*&gt; &lt;size_t&gt; ctypes.addressof(data)</pre>
<pre id='line601' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":601
 * 
 *         self._raw_data =  data
 *         self._components =  <code><</code>Coef_component*> <code><</code>size_t> ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components =  len(data)/ sizeof(Coef_component)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_self->_components = ((struct __pyx_t_17shift_calculators_Coef_component *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line602")'> 602:         self._num_components =  len(data)/ sizeof(Coef_component)</pre>
<pre id='line602' class='code' style='background-color: #FFFF73'>
  /* "Cython_shift_calculator.pyx":602
 *         self._raw_data =  data
 *         self._components =  <code><</code>Coef_component*> <code><</code>size_t> ctypes.addressof(data)
 *         self._num_components =  len(data)/ sizeof(Coef_component)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void _bytes_to_component_offsets(self, data):
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_num_components = (__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Coef_component)));

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Coef_components._bytes_to_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line603")'> 603: </pre>
<pre id='line603' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line604")'> 604:     cdef void _bytes_to_component_offsets(self, data):</pre>
<pre id='line604' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":604
 *         self._num_components =  len(data)/ sizeof(Coef_component)
 * 
 *     cdef void _bytes_to_component_offsets(self, data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._raw_component_offsets_data =  data
 */

static void __pyx_f_17shift_calculators_15Coef_components__bytes_to_component_offsets(struct __pyx_obj_17shift_calculators_Coef_components *__pyx_v_self, PyObject *__pyx_v_data) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_component_offsets", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line605")'> 605: </pre>
<pre id='line605' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line606")'> 606:         self._raw_component_offsets_data =  data</pre>
<pre id='line606' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":606
 *     cdef void _bytes_to_component_offsets(self, data):
 * 
 *         self._raw_component_offsets_data =  data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._component_offsets =  <code><</code>Component_Offsets*> <code><</code>size_t> ctypes.addressof(data)
 *         self.num_ids =  len(data)/ sizeof(Component_Offsets)
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_raw_component_offsets_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_raw_component_offsets_data);
  __pyx_v_self->_raw_component_offsets_data = __pyx_v_data;
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line607")'> 607:         self._component_offsets =  &lt;Component_Offsets*&gt; &lt;size_t&gt; ctypes.addressof(data)</pre>
<pre id='line607' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":607
 * 
 *         self._raw_component_offsets_data =  data
 *         self._component_offsets =  <code><</code>Component_Offsets*> <code><</code>size_t> ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.num_ids =  len(data)/ sizeof(Component_Offsets)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_self->_component_offsets = ((struct __pyx_t_17shift_calculators_Component_Offsets *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line608")'> 608:         self.num_ids =  len(data)/ sizeof(Component_Offsets)</pre>
<pre id='line608' class='code' style='background-color: #FFFF30'>
  /* "Cython_shift_calculator.pyx":608
 *         self._raw_component_offsets_data =  data
 *         self._component_offsets =  <code><</code>Component_Offsets*> <code><</code>size_t> ctypes.addressof(data)
 *         self.num_ids =  len(data)/ sizeof(Component_Offsets)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __cinit__(self, object coef_components, component_offsets):
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->num_ids = (__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Component_Offsets)));

  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Coef_components._bytes_to_component_offsets", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_15Coef_components_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_15Coef_components_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_coef_components = 0;
  PyObject *__pyx_v_component_offsets = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__coef_components,&__pyx_n_s__component_offsets,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__coef_components)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__component_offsets)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_coef_components = values[0];
    __pyx_v_component_offsets = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Coef_components.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_15Coef_components___cinit__(((struct __pyx_obj_17shift_calculators_Coef_components *)__pyx_v_self), __pyx_v_coef_components, __pyx_v_component_offsets);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line609")'> 609: </pre>
<pre id='line609' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line610")'> 610:     def __cinit__(self, object coef_components, component_offsets):</pre>
<pre id='line610' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":610
 *         self.num_ids =  len(data)/ sizeof(Component_Offsets)
 * 
 *     def __cinit__(self, object coef_components, component_offsets):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */

static int __pyx_pf_17shift_calculators_15Coef_components___cinit__(struct __pyx_obj_17shift_calculators_Coef_components *__pyx_v_self, PyObject *__pyx_v_coef_components, PyObject *__pyx_v_component_offsets) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line611")'> 611: </pre>
<pre id='line611' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line612")'> 612: </pre>
<pre id='line612' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line613")'> 613:         self._bytes_to_components(coef_components)</pre>
<pre id='line613' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":613
 * 
 * 
 *         self._bytes_to_components(coef_components)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._bytes_to_component_offsets(component_offsets)
 * 
 */
  __pyx_t_1 = ((struct __pyx_vtabstruct_17shift_calculators_Coef_components *)__pyx_v_self->__pyx_vtab)->_bytes_to_components(__pyx_v_self, __pyx_v_coef_components);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 613; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF37' onclick='toggleDiv("line614")'> 614:         self._bytes_to_component_offsets(component_offsets)</pre>
<pre id='line614' class='code' style='background-color: #FFFF37'>
  /* "Cython_shift_calculator.pyx":614
 * 
 *         self._bytes_to_components(coef_components)
 *         self._bytes_to_component_offsets(component_offsets)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #         self. num_ids = len(components.get_component_atom_ids())
 */
  ((struct __pyx_vtabstruct_17shift_calculators_Coef_components *)__pyx_v_self->__pyx_vtab)->_bytes_to_component_offsets(__pyx_v_self, __pyx_v_component_offsets);

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Coef_components.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_15Coef_components_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_15Coef_components_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED PyObject *__pyx_v_coef_components = 0;
  CYTHON_UNUSED PyObject *__pyx_v_components = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__coef_components,&__pyx_n_s__components,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__coef_components)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__components)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 630; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 630; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_coef_components = values[0];
    __pyx_v_components = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 630; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Coef_components.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_15Coef_components_2__init__(((struct __pyx_obj_17shift_calculators_Coef_components *)__pyx_v_self), __pyx_v_coef_components, __pyx_v_components);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line615")'> 615: </pre>
<pre id='line615' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line616")'> 616: #         self. num_ids = len(components.get_component_atom_ids())</pre>
<pre id='line616' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line617")'> 617: #         self._component_offsets =  &lt;Component_Offsets*&gt;malloc(self.num_ids * sizeof(Component_Offsets))</pre>
<pre id='line617' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line618")'> 618: #         if not self._component_offsets:</pre>
<pre id='line618' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line619")'> 619: #             raise MemoryError()</pre>
<pre id='line619' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line620")'> 620: #</pre>
<pre id='line620' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line621")'> 621: #</pre>
<pre id='line621' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line622")'> 622: #         ids =  components.get_component_atom_ids()</pre>
<pre id='line622' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line623")'> 623: #         for i,id in enumerate(ids):</pre>
<pre id='line623' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line624")'> 624: #             start,end = components.get_component_range(id)</pre>
<pre id='line624' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line625")'> 625: #             self._component_offsets[i].id = id</pre>
<pre id='line625' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line626")'> 626: #             self._component_offsets[i].offset = start</pre>
<pre id='line626' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line627")'> 627: #             self._component_offsets[i].length = end-start</pre>
<pre id='line627' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line628")'> 628: </pre>
<pre id='line628' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line629")'> 629: </pre>
<pre id='line629' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line630")'> 630:     def __init__ (self, object coef_components, object components):</pre>
<pre id='line630' class='code' style='background-color: #FFFFe7'>
/* "Cython_shift_calculator.pyx":630
 * 
 * 
 *     def __init__ (self, object coef_components, object components):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         pass
 * 
 */

static int __pyx_pf_17shift_calculators_15Coef_components_2__init__(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Coef_components *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_coef_components, CYTHON_UNUSED PyObject *__pyx_v_components) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line631")'> 631:         pass</pre>
<pre id='line631' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line632")'> 632: </pre>
<pre id='line632' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line633")'> 633: </pre>
<pre id='line633' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line634")'> 634:     cdef inline Component_Offsets* get_id_offsets(self,int id) nogil:</pre>
<pre id='line634' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":634
 * 
 * 
 *     cdef inline Component_Offsets* get_id_offsets(self,int id) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return &self._component_offsets[id]
 * 
 */

static CYTHON_INLINE struct __pyx_t_17shift_calculators_Component_Offsets *__pyx_f_17shift_calculators_15Coef_components_get_id_offsets(struct __pyx_obj_17shift_calculators_Coef_components *__pyx_v_self, int __pyx_v_id) {
  struct __pyx_t_17shift_calculators_Component_Offsets *__pyx_r;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line635")'> 635:         return &amp;self._component_offsets[id]</pre>
<pre id='line635' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":635
 * 
 *     cdef inline Component_Offsets* get_id_offsets(self,int id) nogil:
 *         return &self._component_offsets[id]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __dealloc__(self):
 */
  __pyx_r = (&(__pyx_v_self->_component_offsets[__pyx_v_id]));
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}

/* Python wrapper */
static void __pyx_pw_17shift_calculators_15Coef_components_5__dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pw_17shift_calculators_15Coef_components_5__dealloc__(PyObject *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__dealloc__ (wrapper)", 0);
  __pyx_pf_17shift_calculators_15Coef_components_4__dealloc__(((struct __pyx_obj_17shift_calculators_Coef_components *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line636")'> 636: </pre>
<pre id='line636' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line637")'> 637:     def __dealloc__(self):</pre>
<pre id='line637' class='code' style='background-color: #FFFFe7'>
/* "Cython_shift_calculator.pyx":637
 *         return &self._component_offsets[id]
 * 
 *     def __dealloc__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         pass
 * 
 */

static void __pyx_pf_17shift_calculators_15Coef_components_4__dealloc__(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Coef_components *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__dealloc__", 0);

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line638")'> 638:         pass</pre>
<pre id='line638' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line639")'> 639: </pre>
<pre id='line639' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line640")'> 640: </pre>
<pre id='line640' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line641")'> 641: </pre>
<pre id='line641' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line642")'> 642: </pre>
<pre id='line642' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line643")'> 643: #         if self._component_offsets != NULL:</pre>
<pre id='line643' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line644")'> 644: #             free(self._component_offsets)</pre>
<pre id='line644' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line645")'> 645: #             self._component_offsets =  NULL</pre>
<pre id='line645' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line646")'> 646: #             self.num_ids = 0</pre>
<pre id='line646' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line647")'> 647: </pre>
<pre id='line647' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line648")'> 648: </pre>
<pre id='line648' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line649")'> 649: #    cdef int _check_offset(self, int offset) except -1:</pre>
<pre id='line649' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line650")'> 650: #</pre>
<pre id='line650' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line651")'> 651: #        if not offset &lt; self.num_components:</pre>
<pre id='line651' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line652")'> 652: #            raise IndexError("tried to access object at %i length is %i" % (offset,self._num_components))</pre>
<pre id='line652' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line653")'> 653: #        if self._components is NULL:</pre>
<pre id='line653' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line654")'> 654: #            raise AttributeError("trying to access deallocated memory!")</pre>
<pre id='line654' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line655")'> 655: #        return 0</pre>
<pre id='line655' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line656")'> 656: </pre>
<pre id='line656' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line657")'> 657: </pre>
<pre id='line657' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line658")'> 658: </pre>
<pre id='line658' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line659")'> 659:     @cython.profile(False)</pre>
<pre id='line659' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line660")'> 660:     cdef inline Coef_component* get_component(self,int offset) nogil:</pre>
<pre id='line660' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":660
 * 
 *     @cython.profile(False)
 *     cdef inline Coef_component* get_component(self,int offset) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #        self._check_offset(offset)
 *         return &self._components[offset]
 */

static CYTHON_INLINE struct __pyx_t_17shift_calculators_Coef_component *__pyx_f_17shift_calculators_15Coef_components_get_component(struct __pyx_obj_17shift_calculators_Coef_components *__pyx_v_self, int __pyx_v_offset) {
  struct __pyx_t_17shift_calculators_Coef_component *__pyx_r;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line661")'> 661: #        self._check_offset(offset)</pre>
<pre id='line661' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line662")'> 662:         return &amp;self._components[offset]</pre>
<pre id='line662' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":662
 *     cdef inline Coef_component* get_component(self,int offset) nogil:
 * #        self._check_offset(offset)
 *         return &self._components[offset]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef struct ring_atom_ids:
 */
  __pyx_r = (&(__pyx_v_self->_components[__pyx_v_offset]));
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line663")'> 663: </pre>
<pre id='line663' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line664")'> 664: cdef struct ring_atom_ids:</pre>
<pre id='line664' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":664
 *         return &self._components[offset]
 * 
 * cdef struct ring_atom_ids:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     int num_atoms
 *     int[6] atom_ids
 */
struct __pyx_t_17shift_calculators_ring_atom_ids {
  int num_atoms;
  int atom_ids[6];
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line665")'> 665:     int num_atoms</pre>
<pre id='line665' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line666")'> 666:     int[6] atom_ids</pre>
<pre id='line666' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line667")'> 667: </pre>
<pre id='line667' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line668")'> 668: </pre>
<pre id='line668' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line669")'> 669: </pre>
<pre id='line669' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line670")'> 670: </pre>
<pre id='line670' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line671")'> 671: </pre>
<pre id='line671' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line672")'> 672: </pre>
<pre id='line672' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line673")'> 673: cdef struct dihedral_parameters:</pre>
<pre id='line673' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":673
 * 
 * 
 * cdef struct dihedral_parameters:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     float param_0
 *     float param_1
 */
struct __pyx_t_17shift_calculators_dihedral_parameters {
  float param_0;
  float param_1;
  float param_2;
  float param_3;
  float param_4;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line674")'> 674:     float param_0</pre>
<pre id='line674' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line675")'> 675:     float param_1</pre>
<pre id='line675' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line676")'> 676:     float param_2</pre>
<pre id='line676' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line677")'> 677:     float param_3</pre>
<pre id='line677' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line678")'> 678:     float param_4</pre>
<pre id='line678' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line679")'> 679: </pre>
<pre id='line679' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line680")'> 680: </pre>
<pre id='line680' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line681")'> 681: #cdef float sum(Vec3 vec3):</pre>
<pre id='line681' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line682")'> 682: #    return vec3.x()+vec3.y()+vec3.z()</pre>
<pre id='line682' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line683")'> 683: </pre>
<pre id='line683' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line684")'> 684: </pre>
<pre id='line684' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line685")'> 685: @cython.profile(False)</pre>
<pre id='line685' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line686")'> 686: cdef inline void operator_times (Vec3&amp; vec3, float scale):</pre>
<pre id='line686' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":686
 * 
 * @cython.profile(False)
 * cdef inline void operator_times (Vec3& vec3, float scale):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *      vec3[0] =  vec3[0] * scale
 *      vec3[1] =  vec3[1] * scale
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_operator_times(Vec3 &__pyx_v_vec3, float __pyx_v_scale) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("operator_times", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line687")'> 687:      vec3[0] =  vec3[0] * scale</pre>
<pre id='line687' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":687
 * @cython.profile(False)
 * cdef inline void operator_times (Vec3& vec3, float scale):
 *      vec3[0] =  vec3[0] * scale             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *      vec3[1] =  vec3[1] * scale
 *      vec3[2] =  vec3[2] * scale
 */
  (__pyx_v_vec3[0]) = ((__pyx_v_vec3[0]) * __pyx_v_scale);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line688")'> 688:      vec3[1] =  vec3[1] * scale</pre>
<pre id='line688' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":688
 * cdef inline void operator_times (Vec3& vec3, float scale):
 *      vec3[0] =  vec3[0] * scale
 *      vec3[1] =  vec3[1] * scale             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *      vec3[2] =  vec3[2] * scale
 * 
 */
  (__pyx_v_vec3[1]) = ((__pyx_v_vec3[1]) * __pyx_v_scale);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line689")'> 689:      vec3[2] =  vec3[2] * scale</pre>
<pre id='line689' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":689
 *      vec3[0] =  vec3[0] * scale
 *      vec3[1] =  vec3[1] * scale
 *      vec3[2] =  vec3[2] * scale             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * @cython.profile(False)
 */
  (__pyx_v_vec3[2]) = ((__pyx_v_vec3[2]) * __pyx_v_scale);

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line690")'> 690: </pre>
<pre id='line690' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line691")'> 691: @cython.profile(False)</pre>
<pre id='line691' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line692")'> 692: cdef inline float calc_distance_simulation(Simulation* sim, int atom_index_1, int atom_index_2) nogil:</pre>
<pre id='line692' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":692
 * 
 * @cython.profile(False)
 * cdef inline float calc_distance_simulation(Simulation* sim, int atom_index_1, int atom_index_2) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef Vec3 vec1 = sim[0].atomPos(atom_index_1)
 */

static CYTHON_INLINE float __pyx_f_17shift_calculators_calc_distance_simulation(Simulation *__pyx_v_sim, int __pyx_v_atom_index_1, int __pyx_v_atom_index_2) {
  Vec3 __pyx_v_vec1;
  Vec3 __pyx_v_vec2;
  Vec3 __pyx_v_result;
  float __pyx_r;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line693")'> 693: </pre>
<pre id='line693' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line694")'> 694:     cdef Vec3 vec1 = sim[0].atomPos(atom_index_1)</pre>
<pre id='line694' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":694
 * cdef inline float calc_distance_simulation(Simulation* sim, int atom_index_1, int atom_index_2) nogil:
 * 
 *     cdef Vec3 vec1 = sim[0].atomPos(atom_index_1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Vec3 vec2 = sim[0].atomPos(atom_index_2)
 *     cdef Vec3 result =  vec2 - vec1
 */
  __pyx_v_vec1 = (__pyx_v_sim[0]).atomPos(__pyx_v_atom_index_1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line695")'> 695:     cdef Vec3 vec2 = sim[0].atomPos(atom_index_2)</pre>
<pre id='line695' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":695
 * 
 *     cdef Vec3 vec1 = sim[0].atomPos(atom_index_1)
 *     cdef Vec3 vec2 = sim[0].atomPos(atom_index_2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Vec3 result =  vec2 - vec1
 *     return norm(result)
 */
  __pyx_v_vec2 = (__pyx_v_sim[0]).atomPos(__pyx_v_atom_index_2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line696")'> 696:     cdef Vec3 result =  vec2 - vec1</pre>
<pre id='line696' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":696
 *     cdef Vec3 vec1 = sim[0].atomPos(atom_index_1)
 *     cdef Vec3 vec2 = sim[0].atomPos(atom_index_2)
 *     cdef Vec3 result =  vec2 - vec1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return norm(result)
 * 
 */
  __pyx_v_result = (__pyx_v_vec2 - __pyx_v_vec1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line697")'> 697:     return norm(result)</pre>
<pre id='line697' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":697
 *     cdef Vec3 vec2 = sim[0].atomPos(atom_index_2)
 *     cdef Vec3 result =  vec2 - vec1
 *     return norm(result)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_r = norm(__pyx_v_result);
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line698")'> 698: </pre>
<pre id='line698' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line699")'> 699: </pre>
<pre id='line699' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line700")'> 700: </pre>
<pre id='line700' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line701")'> 701: #</pre>
<pre id='line701' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line702")'> 702: #</pre>
<pre id='line702' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line703")'> 703: #cdef inline bint distance_less_than(int atom_index_1, atom_index_2, float target):</pre>
<pre id='line703' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line704")'> 704: #    cdef float total = 0.0</pre>
<pre id='line704' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line705")'> 705: #    cdef float diff</pre>
<pre id='line705' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line706")'> 706: #    cdef float target2  = target*target</pre>
<pre id='line706' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line707")'> 707: #</pre>
<pre id='line707' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line708")'> 708: #    cdef Vec3 vec1 = currentSimulation().atomPosArr().data(atom_index_1)</pre>
<pre id='line708' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line709")'> 709: #    cdef Vec3 vec2 = currentSimulation().atomPosArr().data(atom_index_2)</pre>
<pre id='line709' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line710")'> 710: #    cdef bint result  =  True</pre>
<pre id='line710' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line711")'> 711: #    for i in range(3):</pre>
<pre id='line711' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line712")'> 712: #        diff = vec1[i] - vec2[i]</pre>
<pre id='line712' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line713")'> 713: #        total += diff * diff</pre>
<pre id='line713' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line714")'> 714: #</pre>
<pre id='line714' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line715")'> 715: #        if total &gt; target2:</pre>
<pre id='line715' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line716")'> 716: #            result = False</pre>
<pre id='line716' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line717")'> 717: #            break</pre>
<pre id='line717' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line718")'> 718: #    return result</pre>
<pre id='line718' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line719")'> 719: </pre>
<pre id='line719' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line720")'> 720: </pre>
<pre id='line720' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line721")'> 721: </pre>
<pre id='line721' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line722")'> 722: </pre>
<pre id='line722' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line723")'> 723: </pre>
<pre id='line723' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line724")'> 724: #TODO how does currentSimulation().atomByID work inside</pre>
<pre id='line724' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line725")'> 725: @cython.profile(False)</pre>
<pre id='line725' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line726")'> 726: cdef inline float calc_dihedral_angle_simulation(Simulation* simulation, dihedral_ids dihedral_atom_ids) nogil:</pre>
<pre id='line726' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":726
 * #TODO how does currentSimulation().atomByID work inside
 * @cython.profile(False)
 * cdef inline float calc_dihedral_angle_simulation(Simulation* simulation, dihedral_ids dihedral_atom_ids) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */

static CYTHON_INLINE float __pyx_f_17shift_calculators_calc_dihedral_angle_simulation(Simulation *__pyx_v_simulation, struct __pyx_t_17shift_calculators_dihedral_ids __pyx_v_dihedral_atom_ids) {
  Atom __pyx_v_atom_1;
  Atom __pyx_v_atom_2;
  Atom __pyx_v_atom_3;
  Atom __pyx_v_atom_4;
  double __pyx_v_result;
  float __pyx_r;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line727")'> 727: </pre>
<pre id='line727' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line728")'> 728: </pre>
<pre id='line728' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line729")'> 729: </pre>
<pre id='line729' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line730")'> 730:     cdef Atom atom_1  = simulation[0].atomByID(dihedral_atom_ids.atom_id_1)</pre>
<pre id='line730' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":730
 * 
 * 
 *     cdef Atom atom_1  = simulation[0].atomByID(dihedral_atom_ids.atom_id_1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Atom atom_2  = simulation[0].atomByID(dihedral_atom_ids.atom_id_2)
 *     cdef Atom atom_3  = simulation[0].atomByID(dihedral_atom_ids.atom_id_3)
 */
  __pyx_v_atom_1 = (__pyx_v_simulation[0]).atomByID(__pyx_v_dihedral_atom_ids.atom_id_1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line731")'> 731:     cdef Atom atom_2  = simulation[0].atomByID(dihedral_atom_ids.atom_id_2)</pre>
<pre id='line731' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":731
 * 
 *     cdef Atom atom_1  = simulation[0].atomByID(dihedral_atom_ids.atom_id_1)
 *     cdef Atom atom_2  = simulation[0].atomByID(dihedral_atom_ids.atom_id_2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Atom atom_3  = simulation[0].atomByID(dihedral_atom_ids.atom_id_3)
 *     cdef Atom atom_4  = simulation[0].atomByID(dihedral_atom_ids.atom_id_4)
 */
  __pyx_v_atom_2 = (__pyx_v_simulation[0]).atomByID(__pyx_v_dihedral_atom_ids.atom_id_2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line732")'> 732:     cdef Atom atom_3  = simulation[0].atomByID(dihedral_atom_ids.atom_id_3)</pre>
<pre id='line732' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":732
 *     cdef Atom atom_1  = simulation[0].atomByID(dihedral_atom_ids.atom_id_1)
 *     cdef Atom atom_2  = simulation[0].atomByID(dihedral_atom_ids.atom_id_2)
 *     cdef Atom atom_3  = simulation[0].atomByID(dihedral_atom_ids.atom_id_3)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Atom atom_4  = simulation[0].atomByID(dihedral_atom_ids.atom_id_4)
 * 
 */
  __pyx_v_atom_3 = (__pyx_v_simulation[0]).atomByID(__pyx_v_dihedral_atom_ids.atom_id_3);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line733")'> 733:     cdef Atom atom_4  = simulation[0].atomByID(dihedral_atom_ids.atom_id_4)</pre>
<pre id='line733' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":733
 *     cdef Atom atom_2  = simulation[0].atomByID(dihedral_atom_ids.atom_id_2)
 *     cdef Atom atom_3  = simulation[0].atomByID(dihedral_atom_ids.atom_id_3)
 *     cdef Atom atom_4  = simulation[0].atomByID(dihedral_atom_ids.atom_id_4)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef double result = Dihedral(atom_1,atom_2,atom_3,atom_4).value()
 */
  __pyx_v_atom_4 = (__pyx_v_simulation[0]).atomByID(__pyx_v_dihedral_atom_ids.atom_id_4);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line734")'> 734: </pre>
<pre id='line734' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line735")'> 735:     cdef double result = Dihedral(atom_1,atom_2,atom_3,atom_4).value()</pre>
<pre id='line735' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":735
 *     cdef Atom atom_4  = simulation[0].atomByID(dihedral_atom_ids.atom_id_4)
 * 
 *     cdef double result = Dihedral(atom_1,atom_2,atom_3,atom_4).value()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return result
 * 
 */
  __pyx_v_result = Dihedral(__pyx_v_atom_1, __pyx_v_atom_2, __pyx_v_atom_3, __pyx_v_atom_4).value();
</pre><pre class='line' style='background-color: #FFFF39' onclick='toggleDiv("line736")'> 736:     return result</pre>
<pre id='line736' class='code' style='background-color: #FFFF39'>
  /* "Cython_shift_calculator.pyx":736
 * 
 *     cdef double result = Dihedral(atom_1,atom_2,atom_3,atom_4).value()
 *     return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_21Base_shift_calculator_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_21Base_shift_calculator_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_simulation = 0;
  PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__simulation,&__pyx_n_s__name,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__simulation)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 746; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 746; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_simulation = values[0];
    __pyx_v_name = ((PyObject*)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 746; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Base_shift_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&PyString_Type), 1, "name", 1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 746; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_21Base_shift_calculator___init__(((struct __pyx_obj_17shift_calculators_Base_shift_calculator *)__pyx_v_self), __pyx_v_simulation, __pyx_v_name);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line737")'> 737: </pre>
<pre id='line737' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line738")'> 738: </pre>
<pre id='line738' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line739")'> 739: </pre>
<pre id='line739' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line740")'> 740: cdef float DEFAULT_CUTOFF = 5.0</pre>
<pre id='line740' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":740
 * 
 * 
 * cdef float DEFAULT_CUTOFF = 5.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * cdef float DEFAULT_SMOOTHING_FACTOR = 1.0
 * cdef float DEFAULT_NB_CUTOFF = 5.0
 */
  __pyx_v_17shift_calculators_DEFAULT_CUTOFF = 5.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line741")'> 741: cdef float DEFAULT_SMOOTHING_FACTOR = 1.0</pre>
<pre id='line741' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":741
 * 
 * cdef float DEFAULT_CUTOFF = 5.0
 * cdef float DEFAULT_SMOOTHING_FACTOR = 1.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * cdef float DEFAULT_NB_CUTOFF = 5.0
 * 
 */
  __pyx_v_17shift_calculators_DEFAULT_SMOOTHING_FACTOR = 1.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line742")'> 742: cdef float DEFAULT_NB_CUTOFF = 5.0</pre>
<pre id='line742' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":742
 * cdef float DEFAULT_CUTOFF = 5.0
 * cdef float DEFAULT_SMOOTHING_FACTOR = 1.0
 * cdef float DEFAULT_NB_CUTOFF = 5.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef class Base_shift_calculator:
 */
  __pyx_v_17shift_calculators_DEFAULT_NB_CUTOFF = 5.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line743")'> 743: </pre>
<pre id='line743' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line744")'> 744: cdef class Base_shift_calculator:</pre>
<pre id='line744' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":744
 * cdef float DEFAULT_NB_CUTOFF = 5.0
 * 
 * cdef class Base_shift_calculator:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __init__(self, simulation, str name):
 */

struct __pyx_vtabstruct_17shift_calculators_Base_shift_calculator {
  void (*_bytes_to_components)(struct __pyx_obj_17shift_calculators_Base_shift_calculator *, uintptr_t, uintptr_t);
  void (*_set_components)(struct __pyx_obj_17shift_calculators_Base_shift_calculator *, std::map<code><</code>int,uintptr_t> *);
  int (*ensemble_size)(struct __pyx_obj_17shift_calculators_Base_shift_calculator *);
  int (*ensemble_member_index)(struct __pyx_obj_17shift_calculators_Base_shift_calculator *);
  int (*ensemble_array_offset)(struct __pyx_obj_17shift_calculators_Base_shift_calculator *, int);
  void (*calc)(struct __pyx_obj_17shift_calculators_Base_shift_calculator *, std::map<code><</code>int,uintptr_t> *, struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *, __Pyx_memviewslice, __Pyx_memviewslice);
};
static struct __pyx_vtabstruct_17shift_calculators_Base_shift_calculator *__pyx_vtabptr_17shift_calculators_Base_shift_calculator;
static CYTHON_INLINE int __pyx_f_17shift_calculators_21Base_shift_calculator_ensemble_size(struct __pyx_obj_17shift_calculators_Base_shift_calculator *);
static CYTHON_INLINE int __pyx_f_17shift_calculators_21Base_shift_calculator_ensemble_member_index(struct __pyx_obj_17shift_calculators_Base_shift_calculator *);
static CYTHON_INLINE int __pyx_f_17shift_calculators_21Base_shift_calculator_ensemble_array_offset(struct __pyx_obj_17shift_calculators_Base_shift_calculator *, int);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line745")'> 745: </pre>
<pre id='line745' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line746")'> 746:     def __init__(self, simulation, str name):</pre>
<pre id='line746' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":746
 * cdef class Base_shift_calculator:
 * 
 *     def __init__(self, simulation, str name):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._verbose = False
 *             self._name = name
 */

static int __pyx_pf_17shift_calculators_21Base_shift_calculator___init__(struct __pyx_obj_17shift_calculators_Base_shift_calculator *__pyx_v_self, PyObject *__pyx_v_simulation, PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line747")'> 747:             self._verbose = False</pre>
<pre id='line747' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":747
 * 
 *     def __init__(self, simulation, str name):
 *             self._verbose = False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._name = name
 *             self._simulation =  simulationAsNative(simulation)
 */
  __pyx_v_self->_verbose = 0;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line748")'> 748:             self._name = name</pre>
<pre id='line748' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":748
 *     def __init__(self, simulation, str name):
 *             self._verbose = False
 *             self._name = name             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._simulation =  simulationAsNative(simulation)
 * 
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_name));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_name));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_name);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_name));
  __pyx_v_self->_name = __pyx_v_name;
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line749")'> 749:             self._simulation =  simulationAsNative(simulation)</pre>
<pre id='line749' class='code' style='background-color: #FFFF5e'>
  /* "Cython_shift_calculator.pyx":749
 *             self._verbose = False
 *             self._name = name
 *             self._simulation =  simulationAsNative(simulation)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_1 = __pyx_f_17shift_calculators_simulationAsNative(__pyx_v_simulation);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 749; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_simulation = __pyx_t_1;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Base_shift_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_21Base_shift_calculator_3set_verbose(PyObject *__pyx_v_self, PyObject *__pyx_arg_state); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_21Base_shift_calculator_3set_verbose(PyObject *__pyx_v_self, PyObject *__pyx_arg_state) {
  int __pyx_v_state;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_verbose (wrapper)", 0);
  assert(__pyx_arg_state); {
    __pyx_v_state = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_arg_state);<span class='error_goto'> if (unlikely((__pyx_v_state == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 753; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Base_shift_calculator.set_verbose", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_21Base_shift_calculator_2set_verbose(((struct __pyx_obj_17shift_calculators_Base_shift_calculator *)__pyx_v_self), ((int)__pyx_v_state));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line750")'> 750: </pre>
<pre id='line750' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line751")'> 751: </pre>
<pre id='line751' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line752")'> 752: </pre>
<pre id='line752' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line753")'> 753:     def set_verbose(self,bint state):</pre>
<pre id='line753' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":753
 * 
 * 
 *     def set_verbose(self,bint state):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._verbose =  state
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_21Base_shift_calculator_2set_verbose(struct __pyx_obj_17shift_calculators_Base_shift_calculator *__pyx_v_self, int __pyx_v_state) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_verbose", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line754")'> 754:         self._verbose =  state</pre>
<pre id='line754' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":754
 * 
 *     def set_verbose(self,bint state):
 *         self._verbose =  state             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:
 */
  __pyx_v_self->_verbose = __pyx_v_state;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line755")'> 755: </pre>
<pre id='line755' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line756")'> 756:     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:</pre>
<pre id='line756' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":756
 *         self._verbose =  state
 * 
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         with gil:
 *             print >> sys.stderr, "please implement _bytes_to_components, this is a pure virtual function"
 */

static void __pyx_f_17shift_calculators_21Base_shift_calculator__bytes_to_components(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Base_shift_calculator *__pyx_v_self, CYTHON_UNUSED uintptr_t __pyx_v_data, CYTHON_UNUSED uintptr_t __pyx_v_length) {
  #ifdef WITH_THREAD
  PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
  #endif
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_components", 0);
  #ifdef WITH_THREAD
  PyGILState_Release(__pyx_gilstate_save);
  #endif
  /*try:*/ {
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line757")'> 757:         with gil:</pre>
<pre id='line757' class='code' style='background-color: #FFFFb6'>
    /* "Cython_shift_calculator.pyx":757
 * 
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:
 *         with gil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print >> sys.stderr, "please implement _bytes_to_components, this is a pure virtual function"
 *             sys.exit(-1)
 */
    {
        #ifdef WITH_THREAD
        PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
        #endif
        /*try:*/ {

        /* "Cython_shift_calculator.pyx":757
 * 
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:
 *         with gil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print >> sys.stderr, "please implement _bytes_to_components, this is a pure virtual function"
 *             sys.exit(-1)
 */
        /*finally:*/ {
          int __pyx_why;
          __pyx_why = 0; goto __pyx_L8;
          __pyx_L7: __pyx_why = 4; goto __pyx_L8;
          __pyx_L8:;
          #ifdef WITH_THREAD
          PyGILState_Release(__pyx_gilstate_save);
          #endif
          switch (__pyx_why) {
            case 4: goto __pyx_L4;
          }
        }
    }
  }
  /*finally:*/ {
    int __pyx_why;
    __pyx_why = 0; goto __pyx_L5;
    __pyx_L4: __pyx_why = 4; goto __pyx_L5;
    __pyx_L5:;
    #ifdef WITH_THREAD
    __pyx_gilstate_save = PyGILState_Ensure();
    #endif
    switch (__pyx_why) {
      case 4: goto __pyx_L1_error;
    }
  }

  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Base_shift_calculator._bytes_to_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  #ifdef WITH_THREAD
  PyGILState_Release(__pyx_gilstate_save);
  #endif
}
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line758")'> 758:             print &gt;&gt; sys.stderr, "please implement _bytes_to_components, this is a pure virtual function"</pre>
<pre id='line758' class='code' style='background-color: #FFFF79'>
          /* "Cython_shift_calculator.pyx":758
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:
 *         with gil:
 *             print >> sys.stderr, "please implement _bytes_to_components, this is a pure virtual function"             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             sys.exit(-1)
 * 
 */
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__sys);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 758; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__stderr);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 758; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(__pyx_t_2, ((PyObject *)__pyx_kp_s_20)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 758; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line759")'> 759:             sys.exit(-1)</pre>
<pre id='line759' class='code' style='background-color: #FFFF55'>
          /* "Cython_shift_calculator.pyx":759
 *         with gil:
 *             print >> sys.stderr, "please implement _bytes_to_components, this is a pure virtual function"
 *             sys.exit(-1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void _set_components(self, cmap[int, uintptr_t] *components) nogil:
 */
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__sys);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 759; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
          __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__exit);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 759; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_21), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 759; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        }

  /* "Cython_shift_calculator.pyx":759
 *         with gil:
 *             print >> sys.stderr, "please implement _bytes_to_components, this is a pure virtual function"
 *             sys.exit(-1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void _set_components(self, cmap[int, uintptr_t] *components) nogil:
 */
  __pyx_k_tuple_21 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_neg_1);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 759; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_21);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_21));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line760")'> 760: </pre>
<pre id='line760' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line761")'> 761:     cdef void _set_components(self, cmap[int, uintptr_t] *components) nogil:</pre>
<pre id='line761' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":761
 *             sys.exit(-1)
 * 
 *     cdef void _set_components(self, cmap[int, uintptr_t] *components) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._bytes_to_components(components[0][ATOM], components[0][NATOM])
 */

static void __pyx_f_17shift_calculators_21Base_shift_calculator__set_components(struct __pyx_obj_17shift_calculators_Base_shift_calculator *__pyx_v_self, std::map<code><</code>int,uintptr_t> *__pyx_v_components) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line762")'> 762: </pre>
<pre id='line762' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line763")'> 763:         self._bytes_to_components(components[0][ATOM], components[0][NATOM])</pre>
<pre id='line763' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":763
 *     cdef void _set_components(self, cmap[int, uintptr_t] *components) nogil:
 * 
 *         self._bytes_to_components(components[0][ATOM], components[0][NATOM])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._simulation = <code><</code>EnsembleSimulation*><code><</code>size_t>components[0][SIMU]
 * 
 */
  ((struct __pyx_vtabstruct_17shift_calculators_Base_shift_calculator *)__pyx_v_self->__pyx_vtab)->_bytes_to_components(__pyx_v_self, ((__pyx_v_components[0])[__pyx_v_17shift_calculators_ATOM]), ((__pyx_v_components[0])[__pyx_v_17shift_calculators_NATOM]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line764")'> 764:         self._simulation = &lt;EnsembleSimulation*&gt;&lt;size_t&gt;components[0][SIMU]</pre>
<pre id='line764' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":764
 * 
 *         self._bytes_to_components(components[0][ATOM], components[0][NATOM])
 *         self._simulation = <code><</code>EnsembleSimulation*><code><</code>size_t>components[0][SIMU]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_self->_simulation = ((EnsembleSimulation *)((size_t)((__pyx_v_components[0])[__pyx_v_17shift_calculators_SIMU])));

}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line765")'> 765: </pre>
<pre id='line765' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line766")'> 766: </pre>
<pre id='line766' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line767")'> 767:     cdef inline int ensemble_size(self) nogil:</pre>
<pre id='line767' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":767
 * 
 * 
 *     cdef inline int ensemble_size(self) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._simulation[0].size()
 * 
 */

static CYTHON_INLINE int __pyx_f_17shift_calculators_21Base_shift_calculator_ensemble_size(struct __pyx_obj_17shift_calculators_Base_shift_calculator *__pyx_v_self) {
  int __pyx_r;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line768")'> 768:         return self._simulation[0].size()</pre>
<pre id='line768' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":768
 * 
 *     cdef inline int ensemble_size(self) nogil:
 *         return self._simulation[0].size()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline int ensemble_member_index(self) nogil:
 */
  __pyx_r = (__pyx_v_self->_simulation[0]).size();
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line769")'> 769: </pre>
<pre id='line769' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line770")'> 770:     cdef inline int ensemble_member_index(self) nogil:</pre>
<pre id='line770' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":770
 *         return self._simulation[0].size()
 * 
 *     cdef inline int ensemble_member_index(self) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._simulation[0].member()[0].memberIndex()
 * 
 */

static CYTHON_INLINE int __pyx_f_17shift_calculators_21Base_shift_calculator_ensemble_member_index(struct __pyx_obj_17shift_calculators_Base_shift_calculator *__pyx_v_self) {
  int __pyx_r;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line771")'> 771:         return self._simulation[0].member()[0].memberIndex()</pre>
<pre id='line771' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":771
 * 
 *     cdef inline int ensemble_member_index(self) nogil:
 *         return self._simulation[0].member()[0].memberIndex()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline int ensemble_array_offset(self,int index) nogil:
 */
  __pyx_r = ((__pyx_v_self->_simulation[0]).member()[0]).memberIndex();
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line772")'> 772: </pre>
<pre id='line772' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line773")'> 773:     cdef inline int ensemble_array_offset(self,int index) nogil:</pre>
<pre id='line773' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":773
 *         return self._simulation[0].member()[0].memberIndex()
 * 
 *     cdef inline int ensemble_array_offset(self,int index) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return (self.ensemble_size() * index) + self.ensemble_member_index()
 * 
 */

static CYTHON_INLINE int __pyx_f_17shift_calculators_21Base_shift_calculator_ensemble_array_offset(struct __pyx_obj_17shift_calculators_Base_shift_calculator *__pyx_v_self, int __pyx_v_index) {
  int __pyx_r;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line774")'> 774:         return (self.ensemble_size() * index) + self.ensemble_member_index()</pre>
<pre id='line774' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":774
 * 
 *     cdef inline int ensemble_array_offset(self,int index) nogil:
 *         return (self.ensemble_size() * index) + self.ensemble_member_index()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void calc(Base_shift_calculator self, cmap[int,uintptr_t] *components, CDSSharedVectorFloat shift_cache, int[:] component_to_target,  int[:] active_components) nogil:
 */
  __pyx_r = ((__pyx_f_17shift_calculators_21Base_shift_calculator_ensemble_size(__pyx_v_self) * __pyx_v_index) + __pyx_f_17shift_calculators_21Base_shift_calculator_ensemble_member_index(__pyx_v_self));
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line775")'> 775: </pre>
<pre id='line775' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line776")'> 776:     cdef void calc(Base_shift_calculator self, cmap[int,uintptr_t] *components, CDSSharedVectorFloat shift_cache, int[:] component_to_target,  int[:] active_components) nogil:</pre>
<pre id='line776' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":776
 *         return (self.ensemble_size() * index) + self.ensemble_member_index()
 * 
 *     cdef void calc(Base_shift_calculator self, cmap[int,uintptr_t] *components, CDSSharedVectorFloat shift_cache, int[:] component_to_target,  int[:] active_components) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         with gil:
 *             print >> sys.stderr, "please implement calc, this is a pure virtual function"
 */

static void __pyx_f_17shift_calculators_21Base_shift_calculator_calc(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Base_shift_calculator *__pyx_v_self, CYTHON_UNUSED std::map<code><</code>int,uintptr_t> *__pyx_v_components, CYTHON_UNUSED struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_shift_cache, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_component_to_target, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_active_components) {
  #ifdef WITH_THREAD
  PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
  #endif
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc", 0);
  #ifdef WITH_THREAD
  PyGILState_Release(__pyx_gilstate_save);
  #endif
  /*try:*/ {
</pre><pre class='line' style='background-color: #FFFF37' onclick='toggleDiv("line777")'> 777:         with gil:</pre>
<pre id='line777' class='code' style='background-color: #FFFF37'>
    /* "Cython_shift_calculator.pyx":777
 * 
 *     cdef void calc(Base_shift_calculator self, cmap[int,uintptr_t] *components, CDSSharedVectorFloat shift_cache, int[:] component_to_target,  int[:] active_components) nogil:
 *         with gil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print >> sys.stderr, "please implement calc, this is a pure virtual function"
 *             sys.exit(-1)
 */
    {
        #ifdef WITH_THREAD
        PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
        #endif
        /*try:*/ {

        /* "Cython_shift_calculator.pyx":777
 * 
 *     cdef void calc(Base_shift_calculator self, cmap[int,uintptr_t] *components, CDSSharedVectorFloat shift_cache, int[:] component_to_target,  int[:] active_components) nogil:
 *         with gil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print >> sys.stderr, "please implement calc, this is a pure virtual function"
 *             sys.exit(-1)
 */
        /*finally:*/ {
          int __pyx_why;
          __pyx_why = 0; goto __pyx_L8;
          __pyx_L7: __pyx_why = 4; goto __pyx_L8;
          __pyx_L8:;
          #ifdef WITH_THREAD
          PyGILState_Release(__pyx_gilstate_save);
          #endif
          switch (__pyx_why) {
            case 4: goto __pyx_L4;
          }
        }
    }
  }
  /*finally:*/ {
    int __pyx_why;
    __pyx_why = 0; goto __pyx_L5;
    __pyx_L4: __pyx_why = 4; goto __pyx_L5;
    __pyx_L5:;
    #ifdef WITH_THREAD
    __pyx_gilstate_save = PyGILState_Ensure();
    #endif
    switch (__pyx_why) {
      case 4: goto __pyx_L1_error;
    }
  }

  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Base_shift_calculator.calc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  #ifdef WITH_THREAD
  PyGILState_Release(__pyx_gilstate_save);
  #endif
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_33Fast_random_coil_shift_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_33Fast_random_coil_shift_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED PyObject *__pyx_v_simulation = 0;
  CYTHON_UNUSED PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__simulation,&__pyx_n_s__name,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject*)__pyx_kp_s_24);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__simulation)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_simulation = values[0];
    __pyx_v_name = ((PyObject*)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_random_coil_shift_calculator.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&PyString_Type), 1, "name", 1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_33Fast_random_coil_shift_calculator___cinit__(((struct __pyx_obj_17shift_calculators_Fast_random_coil_shift_calculator *)__pyx_v_self), __pyx_v_simulation, __pyx_v_name);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line778")'> 778:             print &gt;&gt; sys.stderr, "please implement calc, this is a pure virtual function"</pre>
<pre id='line778' class='code' style='background-color: #FFFF79'>
          /* "Cython_shift_calculator.pyx":778
 *     cdef void calc(Base_shift_calculator self, cmap[int,uintptr_t] *components, CDSSharedVectorFloat shift_cache, int[:] component_to_target,  int[:] active_components) nogil:
 *         with gil:
 *             print >> sys.stderr, "please implement calc, this is a pure virtual function"             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             sys.exit(-1)
 * 
 */
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__sys);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 778; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__stderr);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 778; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(__pyx_t_2, ((PyObject *)__pyx_kp_s_22)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 778; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line779")'> 779:             sys.exit(-1)</pre>
<pre id='line779' class='code' style='background-color: #FFFF55'>
          /* "Cython_shift_calculator.pyx":779
 *         with gil:
 *             print >> sys.stderr, "please implement calc, this is a pure virtual function"
 *             sys.exit(-1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef class Fast_random_coil_shift_calculator(Base_shift_calculator):
 */
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__sys);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 779; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
          __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__exit);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 779; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_23), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 779; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        }

  /* "Cython_shift_calculator.pyx":779
 *         with gil:
 *             print >> sys.stderr, "please implement calc, this is a pure virtual function"
 *             sys.exit(-1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef class Fast_random_coil_shift_calculator(Base_shift_calculator):
 */
  __pyx_k_tuple_23 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_neg_1);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 779; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_23);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_23));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line780")'> 780: </pre>
<pre id='line780' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line781")'> 781: cdef class Fast_random_coil_shift_calculator(Base_shift_calculator):</pre>
<pre id='line781' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":781
 *             sys.exit(-1)
 * 
 * cdef class Fast_random_coil_shift_calculator(Base_shift_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef Random_coil_component* _compiled_components
 */
struct __pyx_obj_17shift_calculators_Fast_random_coil_shift_calculator {
  struct __pyx_obj_17shift_calculators_Base_shift_calculator __pyx_base;
  struct __pyx_t_17shift_calculators_Random_coil_component *_compiled_components;
  int _num_components;
  PyObject *_raw_data;
};


/* "Cython_shift_calculator.pyx":781
 *             sys.exit(-1)
 * 
 * cdef class Fast_random_coil_shift_calculator(Base_shift_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef Random_coil_component* _compiled_components
 */

struct __pyx_vtabstruct_17shift_calculators_Fast_random_coil_shift_calculator {
  struct __pyx_vtabstruct_17shift_calculators_Base_shift_calculator __pyx_base;
};
static struct __pyx_vtabstruct_17shift_calculators_Fast_random_coil_shift_calculator *__pyx_vtabptr_17shift_calculators_Fast_random_coil_shift_calculator;

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line782")'> 782: </pre>
<pre id='line782' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line783")'> 783:     cdef Random_coil_component* _compiled_components</pre>
<pre id='line783' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line784")'> 784:     cdef int _num_components</pre>
<pre id='line784' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line785")'> 785:     cdef object _raw_data</pre>
<pre id='line785' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line786")'> 786: </pre>
<pre id='line786' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line787")'> 787:     def __cinit__(self, simulation,  str name = "not set"):</pre>
<pre id='line787' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":787
 *     cdef object _raw_data
 * 
 *     def __cinit__(self, simulation,  str name = "not set"):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._raw_data = None
 *         self._compiled_components  = NULL
 */

static int __pyx_pf_17shift_calculators_33Fast_random_coil_shift_calculator___cinit__(struct __pyx_obj_17shift_calculators_Fast_random_coil_shift_calculator *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_simulation, CYTHON_UNUSED PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line788")'> 788:         self._raw_data = None</pre>
<pre id='line788' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":788
 * 
 *     def __cinit__(self, simulation,  str name = "not set"):
 *         self._raw_data = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components  = NULL
 *         self._num_components =  0
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_raw_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_raw_data);
  __pyx_v_self->_raw_data = Py_None;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line789")'> 789:         self._compiled_components  = NULL</pre>
<pre id='line789' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":789
 *     def __cinit__(self, simulation,  str name = "not set"):
 *         self._raw_data = None
 *         self._compiled_components  = NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components =  0
 * 
 */
  __pyx_v_self->_compiled_components = NULL;
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line790")'> 790:         self._num_components =  0</pre>
<pre id='line790' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":790
 *         self._raw_data = None
 *         self._compiled_components  = NULL
 *         self._num_components =  0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __init__(self, simulation, str name = "not set"):
 */
  __pyx_v_self->_num_components = 0;

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_33Fast_random_coil_shift_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_33Fast_random_coil_shift_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_simulation = 0;
  PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__simulation,&__pyx_n_s__name,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject*)__pyx_kp_s_24);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__simulation)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 792; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_simulation = values[0];
    __pyx_v_name = ((PyObject*)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 792; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_random_coil_shift_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&PyString_Type), 1, "name", 1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 792; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_33Fast_random_coil_shift_calculator_2__init__(((struct __pyx_obj_17shift_calculators_Fast_random_coil_shift_calculator *)__pyx_v_self), __pyx_v_simulation, __pyx_v_name);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line791")'> 791: </pre>
<pre id='line791' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line792")'> 792:     def __init__(self, simulation, str name = "not set"):</pre>
<pre id='line792' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":792
 *         self._num_components =  0
 * 
 *     def __init__(self, simulation, str name = "not set"):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         Base_shift_calculator.__init__(self, simulation, name)
 * 
 */

static int __pyx_pf_17shift_calculators_33Fast_random_coil_shift_calculator_2__init__(struct __pyx_obj_17shift_calculators_Fast_random_coil_shift_calculator *__pyx_v_self, PyObject *__pyx_v_simulation, PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line793")'> 793:         Base_shift_calculator.__init__(self, simulation, name)</pre>
<pre id='line793' class='code' style='background-color: #FFFF3f'>
  /* "Cython_shift_calculator.pyx":793
 * 
 *     def __init__(self, simulation, str name = "not set"):
 *         Base_shift_calculator.__init__(self, simulation, name)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Base_shift_calculator)), __pyx_n_s____init__);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simulation);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_simulation);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_simulation);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_name));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, ((PyObject *)__pyx_v_name));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_name));
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_random_coil_shift_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line794")'> 794: </pre>
<pre id='line794' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line795")'> 795: #</pre>
<pre id='line795' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line796")'> 796: #    TODO: this needs to be removed</pre>
<pre id='line796' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line797")'> 797:     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:</pre>
<pre id='line797' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":797
 * #
 * #    TODO: this needs to be removed
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._compiled_components =  <code><</code>Random_coil_component*> <code><</code>size_t> data
 */

static void __pyx_f_17shift_calculators_33Fast_random_coil_shift_calculator__bytes_to_components(struct __pyx_obj_17shift_calculators_Fast_random_coil_shift_calculator *__pyx_v_self, uintptr_t __pyx_v_data, uintptr_t __pyx_v_length) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line798")'> 798: </pre>
<pre id='line798' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line799")'> 799:         self._compiled_components =  &lt;Random_coil_component*&gt; &lt;size_t&gt; data</pre>
<pre id='line799' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":799
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:
 * 
 *         self._compiled_components =  <code><</code>Random_coil_component*> <code><</code>size_t> data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components =  length
 * 
 */
  __pyx_v_self->_compiled_components = ((struct __pyx_t_17shift_calculators_Random_coil_component *)((size_t)__pyx_v_data));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line800")'> 800:         self._num_components =  length</pre>
<pre id='line800' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":800
 * 
 *         self._compiled_components =  <code><</code>Random_coil_component*> <code><</code>size_t> data
 *         self._num_components =  length             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_self->_num_components = __pyx_v_length;

}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line801")'> 801: </pre>
<pre id='line801' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line802")'> 802: </pre>
<pre id='line802' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line803")'> 803: </pre>
<pre id='line803' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line804")'> 804: </pre>
<pre id='line804' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line805")'> 805:     cdef void calc(self, cmap[int,uintptr_t] *components, CDSSharedVectorFloat shift_cache, int[:] component_to_target,  int[:] active_components) nogil:</pre>
<pre id='line805' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":805
 * 
 * 
 *     cdef void calc(self, cmap[int,uintptr_t] *components, CDSSharedVectorFloat shift_cache, int[:] component_to_target,  int[:] active_components) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef CDSVector[double]  *results = shift_cache.get_data()
 */

static void __pyx_f_17shift_calculators_33Fast_random_coil_shift_calculator_calc(struct __pyx_obj_17shift_calculators_Fast_random_coil_shift_calculator *__pyx_v_self, std::map<code><</code>int,uintptr_t> *__pyx_v_components, struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_shift_cache, __Pyx_memviewslice __pyx_v_component_to_target, __Pyx_memviewslice __pyx_v_active_components) {
  CDSVector<code><</code>double> *__pyx_v_results;
  int __pyx_v_factor_index;
  int __pyx_v_component_index;
  int __pyx_v_offset;
  int __pyx_v_size;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line806")'> 806: </pre>
<pre id='line806' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line807")'> 807:         cdef CDSVector[double]  *results = shift_cache.get_data()</pre>
<pre id='line807' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":807
 *     cdef void calc(self, cmap[int,uintptr_t] *components, CDSSharedVectorFloat shift_cache, int[:] component_to_target,  int[:] active_components) nogil:
 * 
 *         cdef CDSVector[double]  *results = shift_cache.get_data()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._set_components(components)
 */
  __pyx_v_results = ((struct __pyx_vtabstruct_17shift_calculators_CDSSharedVectorFloat *)__pyx_v_shift_cache->__pyx_vtab)->get_data(__pyx_v_shift_cache);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line808")'> 808: </pre>
<pre id='line808' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line809")'> 809:         self._set_components(components)</pre>
<pre id='line809' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":809
 *         cdef CDSVector[double]  *results = shift_cache.get_data()
 * 
 *         self._set_components(components)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef int factor_index = 0
 */
  ((struct __pyx_vtabstruct_17shift_calculators_Fast_random_coil_shift_calculator *)__pyx_v_self->__pyx_base.__pyx_vtab)->__pyx_base._set_components(((struct __pyx_obj_17shift_calculators_Base_shift_calculator *)__pyx_v_self), __pyx_v_components);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line810")'> 810: </pre>
<pre id='line810' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line811")'> 811:         cdef int factor_index = 0</pre>
<pre id='line811' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":811
 *         self._set_components(components)
 * 
 *         cdef int factor_index = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int component_index
 *         cdef int offset
 */
  __pyx_v_factor_index = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line812")'> 812:         cdef int component_index</pre>
<pre id='line812' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line813")'> 813:         cdef int offset</pre>
<pre id='line813' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line814")'> 814: </pre>
<pre id='line814' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line815")'> 815:         #TODO: note to cython list for componnt_index in active_components produces awful code!</pre>
<pre id='line815' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line816")'> 816:         cdef int size = active_components.shape[0]</pre>
<pre id='line816' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":816
 * 
 *         #TODO: note to cython list for componnt_index in active_components produces awful code!
 *         cdef int size = active_components.shape[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for factor_index in range(size):
 *             component_index = active_components[factor_index]
 */
  __pyx_v_size = (__pyx_v_active_components.shape[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line817")'> 817:         for factor_index in range(size):</pre>
<pre id='line817' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":817
 *         #TODO: note to cython list for componnt_index in active_components produces awful code!
 *         cdef int size = active_components.shape[0]
 *         for factor_index in range(size):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             component_index = active_components[factor_index]
 * 
 */
  __pyx_t_1 = __pyx_v_size;
  for (__pyx_t_2 = 0; __pyx_t_2 <code><</code> __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_factor_index = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line818")'> 818:             component_index = active_components[factor_index]</pre>
<pre id='line818' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":818
 *         cdef int size = active_components.shape[0]
 *         for factor_index in range(size):
 *             component_index = active_components[factor_index]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             offset = self.ensemble_array_offset(component_to_target[factor_index])
 */
    __pyx_t_3 = __pyx_v_factor_index;
    __pyx_v_component_index = (*((int *) ( /* dim=0 */ (__pyx_v_active_components.data + __pyx_t_3 * __pyx_v_active_components.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line819")'> 819: </pre>
<pre id='line819' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line820")'> 820:             offset = self.ensemble_array_offset(component_to_target[factor_index])</pre>
<pre id='line820' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":820
 *             component_index = active_components[factor_index]
 * 
 *             offset = self.ensemble_array_offset(component_to_target[factor_index])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             results[0][offset]  += self._compiled_components[component_index].shift
 * 
 */
    __pyx_t_4 = __pyx_v_factor_index;
    __pyx_v_offset = __pyx_f_17shift_calculators_21Base_shift_calculator_ensemble_array_offset(((struct __pyx_obj_17shift_calculators_Base_shift_calculator *)__pyx_v_self), (*((int *) ( /* dim=0 */ (__pyx_v_component_to_target.data + __pyx_t_4 * __pyx_v_component_to_target.strides[0]) ))));
</pre><pre class='line' style='background-color: #FFFF32' onclick='toggleDiv("line821")'> 821:             results[0][offset]  += self._compiled_components[component_index].shift</pre>
<pre id='line821' class='code' style='background-color: #FFFF32'>
    /* "Cython_shift_calculator.pyx":821
 * 
 *             offset = self.ensemble_array_offset(component_to_target[factor_index])
 *             results[0][offset]  += self._compiled_components[component_index].shift             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_t_5 = 0;
    __pyx_t_6 = __pyx_v_offset;
    ((__pyx_v_results[__pyx_t_5])[__pyx_t_6]) = (((__pyx_v_results[__pyx_t_5])[__pyx_t_6]) + (__pyx_v_self->_compiled_components[__pyx_v_component_index]).shift);
  }

}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_30Fast_distance_shift_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_30Fast_distance_shift_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED PyObject *__pyx_v_simulation = 0;
  CYTHON_UNUSED PyObject *__pyx_v_smoothed = 0;
  CYTHON_UNUSED PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__simulation,&__pyx_n_s__smoothed,&__pyx_n_s__name,0};
    PyObject* values[3] = {0,0,0};
    values[2] = ((PyObject*)__pyx_kp_s_24);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__simulation)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__smoothed)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 0, 2, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 840; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 840; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_simulation = values[0];
    __pyx_v_smoothed = values[1];
    __pyx_v_name = ((PyObject*)values[2]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 0, 2, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 840; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_distance_shift_calculator.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&PyString_Type), 1, "name", 1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 840; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_30Fast_distance_shift_calculator___cinit__(((struct __pyx_obj_17shift_calculators_Fast_distance_shift_calculator *)__pyx_v_self), __pyx_v_simulation, __pyx_v_smoothed, __pyx_v_name);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line822")'> 822: </pre>
<pre id='line822' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line823")'> 823: </pre>
<pre id='line823' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line824")'> 824: cdef class Fast_distance_shift_calculator(Base_shift_calculator):</pre>
<pre id='line824' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":824
 * 
 * 
 * cdef class Fast_distance_shift_calculator(Base_shift_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
struct __pyx_obj_17shift_calculators_Fast_distance_shift_calculator {
  struct __pyx_obj_17shift_calculators_Base_shift_calculator __pyx_base;
  int _target_atom_index;
  int _distance_atom_index_1;
  int _distance_atom_index_2;
  int _exponent_index;
  int _coefficient_index;
  int _smoothed;
  float _smoothing_factor;
  float _cutoff;
  struct __pyx_t_17shift_calculators_Distance_component *_compiled_components;
  int _num_components;
  PyObject *_raw_data;
};


/* "Cython_shift_calculator.pyx":824
 * 
 * 
 * cdef class Fast_distance_shift_calculator(Base_shift_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */

struct __pyx_vtabstruct_17shift_calculators_Fast_distance_shift_calculator {
  struct __pyx_vtabstruct_17shift_calculators_Base_shift_calculator __pyx_base;
  struct __pyx_t_17shift_calculators_target_distant_atom (*_get_target_and_distant_atom_ids)(struct __pyx_obj_17shift_calculators_Fast_distance_shift_calculator *, int);
  struct __pyx_t_17shift_calculators_coefficient_exponent (*_get_coefficient_and_exponent)(struct __pyx_obj_17shift_calculators_Fast_distance_shift_calculator *, int);
};
static struct __pyx_vtabstruct_17shift_calculators_Fast_distance_shift_calculator *__pyx_vtabptr_17shift_calculators_Fast_distance_shift_calculator;
static CYTHON_INLINE struct __pyx_t_17shift_calculators_target_distant_atom __pyx_f_17shift_calculators_30Fast_distance_shift_calculator__get_target_and_distant_atom_ids(struct __pyx_obj_17shift_calculators_Fast_distance_shift_calculator *, int);
static CYTHON_INLINE struct __pyx_t_17shift_calculators_coefficient_exponent __pyx_f_17shift_calculators_30Fast_distance_shift_calculator__get_coefficient_and_exponent(struct __pyx_obj_17shift_calculators_Fast_distance_shift_calculator *, int);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line825")'> 825: </pre>
<pre id='line825' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line826")'> 826: </pre>
<pre id='line826' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line827")'> 827:     cdef int _target_atom_index</pre>
<pre id='line827' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line828")'> 828:     cdef int _distance_atom_index_1</pre>
<pre id='line828' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line829")'> 829:     cdef int _distance_atom_index_2</pre>
<pre id='line829' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line830")'> 830:     cdef int _exponent_index</pre>
<pre id='line830' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line831")'> 831:     cdef int _coefficient_index</pre>
<pre id='line831' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line832")'> 832:     cdef bint _smoothed</pre>
<pre id='line832' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line833")'> 833:     cdef float _smoothing_factor</pre>
<pre id='line833' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line834")'> 834:     cdef float _cutoff</pre>
<pre id='line834' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line835")'> 835: </pre>
<pre id='line835' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line836")'> 836:     cdef Distance_component* _compiled_components</pre>
<pre id='line836' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line837")'> 837:     cdef int _num_components</pre>
<pre id='line837' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line838")'> 838:     cdef object _raw_data</pre>
<pre id='line838' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line839")'> 839: </pre>
<pre id='line839' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line840")'> 840:     def __cinit__(self, simulation, smoothed, str name = "not set"):</pre>
<pre id='line840' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":840
 *     cdef object _raw_data
 * 
 *     def __cinit__(self, simulation, smoothed, str name = "not set"):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._raw_data = None
 *         self._compiled_components  = NULL
 */

static int __pyx_pf_17shift_calculators_30Fast_distance_shift_calculator___cinit__(struct __pyx_obj_17shift_calculators_Fast_distance_shift_calculator *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_simulation, CYTHON_UNUSED PyObject *__pyx_v_smoothed, CYTHON_UNUSED PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line841")'> 841:         self._raw_data = None</pre>
<pre id='line841' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":841
 * 
 *     def __cinit__(self, simulation, smoothed, str name = "not set"):
 *         self._raw_data = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components  = NULL
 *         self._num_components =  0
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_raw_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_raw_data);
  __pyx_v_self->_raw_data = Py_None;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line842")'> 842:         self._compiled_components  = NULL</pre>
<pre id='line842' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":842
 *     def __cinit__(self, simulation, smoothed, str name = "not set"):
 *         self._raw_data = None
 *         self._compiled_components  = NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components =  0
 * 
 */
  __pyx_v_self->_compiled_components = NULL;
</pre><pre class='line' style='background-color: #FFFF31' onclick='toggleDiv("line843")'> 843:         self._num_components =  0</pre>
<pre id='line843' class='code' style='background-color: #FFFF31'>
  /* "Cython_shift_calculator.pyx":843
 *         self._raw_data = None
 *         self._compiled_components  = NULL
 *         self._num_components =  0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __init__(self, simulation, smoothed, str name = "not set"):
 */
  __pyx_v_self->_num_components = 0;

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_30Fast_distance_shift_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_30Fast_distance_shift_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_simulation = 0;
  PyObject *__pyx_v_smoothed = 0;
  PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__simulation,&__pyx_n_s__smoothed,&__pyx_n_s__name,0};
    PyObject* values[3] = {0,0,0};
    values[2] = ((PyObject*)__pyx_kp_s_24);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__simulation)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__smoothed)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 2, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 845; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 845; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_simulation = values[0];
    __pyx_v_smoothed = values[1];
    __pyx_v_name = ((PyObject*)values[2]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 2, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 845; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_distance_shift_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&PyString_Type), 1, "name", 1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 845; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_30Fast_distance_shift_calculator_2__init__(((struct __pyx_obj_17shift_calculators_Fast_distance_shift_calculator *)__pyx_v_self), __pyx_v_simulation, __pyx_v_smoothed, __pyx_v_name);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line844")'> 844: </pre>
<pre id='line844' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line845")'> 845:     def __init__(self, simulation, smoothed, str name = "not set"):</pre>
<pre id='line845' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":845
 *         self._num_components =  0
 * 
 *     def __init__(self, simulation, smoothed, str name = "not set"):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         Base_shift_calculator.__init__(self, simulation, name)
 * 
 */

static int __pyx_pf_17shift_calculators_30Fast_distance_shift_calculator_2__init__(struct __pyx_obj_17shift_calculators_Fast_distance_shift_calculator *__pyx_v_self, PyObject *__pyx_v_simulation, PyObject *__pyx_v_smoothed, PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line846")'> 846:         Base_shift_calculator.__init__(self, simulation, name)</pre>
<pre id='line846' class='code' style='background-color: #FFFF4b'>
  /* "Cython_shift_calculator.pyx":846
 * 
 *     def __init__(self, simulation, smoothed, str name = "not set"):
 *         Base_shift_calculator.__init__(self, simulation, name)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._smoothed =  smoothed
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Base_shift_calculator)), __pyx_n_s____init__);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 846; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 846; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simulation);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_simulation);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_simulation);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_name));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, ((PyObject *)__pyx_v_name));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_name));
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 846; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line847")'> 847: </pre>
<pre id='line847' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line848")'> 848:         self._smoothed =  smoothed</pre>
<pre id='line848' class='code' style='background-color: #FFFF7f'>
  /* "Cython_shift_calculator.pyx":848
 *         Base_shift_calculator.__init__(self, simulation, name)
 * 
 *         self._smoothed =  smoothed             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._smoothing_factor =  DEFAULT_SMOOTHING_FACTOR
 * #
 */
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_v_smoothed);<span class='error_goto'> if (unlikely((__pyx_t_4 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 848; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_smoothed = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line849")'> 849:         self._smoothing_factor =  DEFAULT_SMOOTHING_FACTOR</pre>
<pre id='line849' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":849
 * 
 *         self._smoothed =  smoothed
 *         self._smoothing_factor =  DEFAULT_SMOOTHING_FACTOR             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #
 *         self._cutoff =  DEFAULT_CUTOFF
 */
  __pyx_v_self->_smoothing_factor = __pyx_v_17shift_calculators_DEFAULT_SMOOTHING_FACTOR;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line850")'> 850: #</pre>
<pre id='line850' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line851")'> 851:         self._cutoff =  DEFAULT_CUTOFF</pre>
<pre id='line851' class='code' style='background-color: #FFFF9f'>
  /* "Cython_shift_calculator.pyx":851
 *         self._smoothing_factor =  DEFAULT_SMOOTHING_FACTOR
 * #
 *         self._cutoff =  DEFAULT_CUTOFF             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #
 * #    def set_cutoff(self, cutoff):
 */
  __pyx_v_self->_cutoff = __pyx_v_17shift_calculators_DEFAULT_CUTOFF;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_distance_shift_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line852")'> 852: #</pre>
<pre id='line852' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line853")'> 853: #    def set_cutoff(self, cutoff):</pre>
<pre id='line853' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line854")'> 854: #        self._cutoff =  cutoff</pre>
<pre id='line854' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line855")'> 855: #</pre>
<pre id='line855' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line856")'> 856: #    def set_smoothing_factor(self,smoothing_factor):</pre>
<pre id='line856' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line857")'> 857: #        self._smoothing_factor = smoothing_factor</pre>
<pre id='line857' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line858")'> 858: #</pre>
<pre id='line858' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line859")'> 859: #    TODO: this needs to be removed</pre>
<pre id='line859' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line860")'> 860:     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:</pre>
<pre id='line860' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":860
 * #
 * #    TODO: this needs to be removed
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._compiled_components =  <code><</code>Distance_component*> <code><</code>size_t> data
 */

static void __pyx_f_17shift_calculators_30Fast_distance_shift_calculator__bytes_to_components(struct __pyx_obj_17shift_calculators_Fast_distance_shift_calculator *__pyx_v_self, uintptr_t __pyx_v_data, uintptr_t __pyx_v_length) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line861")'> 861: </pre>
<pre id='line861' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line862")'> 862:         self._compiled_components =  &lt;Distance_component*&gt; &lt;size_t&gt; data</pre>
<pre id='line862' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":862
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:
 * 
 *         self._compiled_components =  <code><</code>Distance_component*> <code><</code>size_t> data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components =  length
 * 
 */
  __pyx_v_self->_compiled_components = ((struct __pyx_t_17shift_calculators_Distance_component *)((size_t)__pyx_v_data));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line863")'> 863:         self._num_components =  length</pre>
<pre id='line863' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":863
 * 
 *         self._compiled_components =  <code><</code>Distance_component*> <code><</code>size_t> data
 *         self._num_components =  length             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_self->_num_components = __pyx_v_length;

}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line864")'> 864: </pre>
<pre id='line864' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line865")'> 865: </pre>
<pre id='line865' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line866")'> 866: </pre>
<pre id='line866' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line867")'> 867: </pre>
<pre id='line867' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line868")'> 868: </pre>
<pre id='line868' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line869")'> 869:     @cython.profile(False)</pre>
<pre id='line869' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line870")'> 870:     cdef inline target_distant_atom _get_target_and_distant_atom_ids(self, int index) nogil:</pre>
<pre id='line870' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":870
 * 
 *     @cython.profile(False)
 *     cdef inline target_distant_atom _get_target_and_distant_atom_ids(self, int index) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef target_distant_atom result
 * 
 */

static CYTHON_INLINE struct __pyx_t_17shift_calculators_target_distant_atom __pyx_f_17shift_calculators_30Fast_distance_shift_calculator__get_target_and_distant_atom_ids(struct __pyx_obj_17shift_calculators_Fast_distance_shift_calculator *__pyx_v_self, int __pyx_v_index) {
  struct __pyx_t_17shift_calculators_target_distant_atom __pyx_v_result;
  struct __pyx_t_17shift_calculators_target_distant_atom __pyx_r;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line871")'> 871:         cdef target_distant_atom result</pre>
<pre id='line871' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line872")'> 872: </pre>
<pre id='line872' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line873")'> 873:         result.target_atom_id = self._compiled_components[index].remote_atom_1</pre>
<pre id='line873' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":873
 *         cdef target_distant_atom result
 * 
 *         result.target_atom_id = self._compiled_components[index].remote_atom_1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.distant_atom_id  = self._compiled_components[index].remote_atom_2
 *         return result
 */
  __pyx_t_1 = (__pyx_v_self->_compiled_components[__pyx_v_index]).remote_atom_1;
  __pyx_v_result.target_atom_id = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line874")'> 874:         result.distant_atom_id  = self._compiled_components[index].remote_atom_2</pre>
<pre id='line874' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":874
 * 
 *         result.target_atom_id = self._compiled_components[index].remote_atom_1
 *         result.distant_atom_id  = self._compiled_components[index].remote_atom_2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return result
 * 
 */
  __pyx_t_1 = (__pyx_v_self->_compiled_components[__pyx_v_index]).remote_atom_2;
  __pyx_v_result.distant_atom_id = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line875")'> 875:         return result</pre>
<pre id='line875' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":875
 *         result.target_atom_id = self._compiled_components[index].remote_atom_1
 *         result.distant_atom_id  = self._compiled_components[index].remote_atom_2
 *         return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     @cython.profile(False)
 */
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;

  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line876")'> 876: </pre>
<pre id='line876' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line877")'> 877:     @cython.profile(False)</pre>
<pre id='line877' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line878")'> 878:     cdef inline coefficient_exponent _get_coefficient_and_exponent(self, int index) nogil:</pre>
<pre id='line878' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":878
 * 
 *     @cython.profile(False)
 *     cdef inline coefficient_exponent _get_coefficient_and_exponent(self, int index) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef coefficient_exponent result
 * 
 */

static CYTHON_INLINE struct __pyx_t_17shift_calculators_coefficient_exponent __pyx_f_17shift_calculators_30Fast_distance_shift_calculator__get_coefficient_and_exponent(struct __pyx_obj_17shift_calculators_Fast_distance_shift_calculator *__pyx_v_self, int __pyx_v_index) {
  struct __pyx_t_17shift_calculators_coefficient_exponent __pyx_v_result;
  struct __pyx_t_17shift_calculators_coefficient_exponent __pyx_r;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line879")'> 879:         cdef coefficient_exponent result</pre>
<pre id='line879' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line880")'> 880: </pre>
<pre id='line880' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line881")'> 881: </pre>
<pre id='line881' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line882")'> 882:         result.coefficient = self._compiled_components[index].coefficient</pre>
<pre id='line882' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":882
 * 
 * 
 *         result.coefficient = self._compiled_components[index].coefficient             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.exponent = self._compiled_components[index].exponent
 * 
 */
  __pyx_t_1 = (__pyx_v_self->_compiled_components[__pyx_v_index]).coefficient;
  __pyx_v_result.coefficient = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line883")'> 883:         result.exponent = self._compiled_components[index].exponent</pre>
<pre id='line883' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":883
 * 
 *         result.coefficient = self._compiled_components[index].coefficient
 *         result.exponent = self._compiled_components[index].exponent             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         return result
 */
  __pyx_t_1 = (__pyx_v_self->_compiled_components[__pyx_v_index]).exponent;
  __pyx_v_result.exponent = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line884")'> 884: </pre>
<pre id='line884' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line885")'> 885:         return result</pre>
<pre id='line885' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":885
 *         result.exponent = self._compiled_components[index].exponent
 * 
 *         return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;

  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line886")'> 886: </pre>
<pre id='line886' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line887")'> 887: </pre>
<pre id='line887' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line888")'> 888:     cdef void calc(self, cmap[int,uintptr_t] *components, CDSSharedVectorFloat shift_cache, int[:] component_to_target,  int[:] active_components) nogil:</pre>
<pre id='line888' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":888
 * 
 * 
 *     cdef void calc(self, cmap[int,uintptr_t] *components, CDSSharedVectorFloat shift_cache, int[:] component_to_target,  int[:] active_components) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._set_components(components)
 * 
 */

static void __pyx_f_17shift_calculators_30Fast_distance_shift_calculator_calc(struct __pyx_obj_17shift_calculators_Fast_distance_shift_calculator *__pyx_v_self, std::map<code><</code>int,uintptr_t> *__pyx_v_components, struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_shift_cache, __Pyx_memviewslice __pyx_v_component_to_target, __Pyx_memviewslice __pyx_v_active_components) {
  CDSVector<code><</code>double> *__pyx_v_results;
  float __pyx_v_smoothing_factor;
  float __pyx_v_ratio;
  struct __pyx_t_17shift_calculators_coefficient_exponent __pyx_v_coef_exp;
  int __pyx_v_target_atom_id;
  int __pyx_v_distant_atom_id;
  float __pyx_v_distance;
  int __pyx_v_factor_index;
  int __pyx_v_component_index;
  int __pyx_v_offset;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line889")'> 889:         self._set_components(components)</pre>
<pre id='line889' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":889
 * 
 *     cdef void calc(self, cmap[int,uintptr_t] *components, CDSSharedVectorFloat shift_cache, int[:] component_to_target,  int[:] active_components) nogil:
 *         self._set_components(components)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef CDSVector[double]  *results = shift_cache.get_data()
 */
  ((struct __pyx_vtabstruct_17shift_calculators_Fast_distance_shift_calculator *)__pyx_v_self->__pyx_base.__pyx_vtab)->__pyx_base._set_components(((struct __pyx_obj_17shift_calculators_Base_shift_calculator *)__pyx_v_self), __pyx_v_components);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line890")'> 890: </pre>
<pre id='line890' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line891")'> 891:         cdef CDSVector[double]  *results = shift_cache.get_data()</pre>
<pre id='line891' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":891
 *         self._set_components(components)
 * 
 *         cdef CDSVector[double]  *results = shift_cache.get_data()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_results = ((struct __pyx_vtabstruct_17shift_calculators_CDSSharedVectorFloat *)__pyx_v_shift_cache->__pyx_vtab)->get_data(__pyx_v_shift_cache);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line892")'> 892: </pre>
<pre id='line892' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line893")'> 893: </pre>
<pre id='line893' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line894")'> 894: </pre>
<pre id='line894' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line895")'> 895: </pre>
<pre id='line895' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line896")'> 896:         cdef float smoothing_factor = self._smoothing_factor</pre>
<pre id='line896' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":896
 * 
 * 
 *         cdef float smoothing_factor = self._smoothing_factor             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef float ratio
 *         cdef float result
 */
  __pyx_t_1 = __pyx_v_self->_smoothing_factor;
  __pyx_v_smoothing_factor = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line897")'> 897:         cdef float ratio</pre>
<pre id='line897' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line898")'> 898:         cdef float result</pre>
<pre id='line898' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line899")'> 899:         cdef coefficient_exponent coef_exp</pre>
<pre id='line899' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line900")'> 900:         cdef float coefficent</pre>
<pre id='line900' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line901")'> 901:         cdef float exponent</pre>
<pre id='line901' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line902")'> 902:         cdef int target_atom_id</pre>
<pre id='line902' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line903")'> 903:         cdef int distant_atom_id</pre>
<pre id='line903' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line904")'> 904:         cdef float distance</pre>
<pre id='line904' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line905")'> 905: </pre>
<pre id='line905' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line906")'> 906: </pre>
<pre id='line906' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line907")'> 907: </pre>
<pre id='line907' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line908")'> 908: </pre>
<pre id='line908' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line909")'> 909: </pre>
<pre id='line909' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line910")'> 910:         cdef int factor_index = 0</pre>
<pre id='line910' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":910
 * 
 * 
 *         cdef int factor_index = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int component_index
 *         cdef int offset
 */
  __pyx_v_factor_index = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line911")'> 911:         cdef int component_index</pre>
<pre id='line911' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line912")'> 912:         cdef int offset</pre>
<pre id='line912' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line913")'> 913: </pre>
<pre id='line913' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line914")'> 914:         #TODO: note to cython list for componnt_index in active_components produces awful code!</pre>
<pre id='line914' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line915")'> 915:         for factor_index in range(active_components.shape[0]):</pre>
<pre id='line915' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":915
 * 
 *         #TODO: note to cython list for componnt_index in active_components produces awful code!
 *         for factor_index in range(active_components.shape[0]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             component_index = active_components[factor_index]
 * 
 */
  __pyx_t_2 = (__pyx_v_active_components.shape[0]);
  for (__pyx_t_3 = 0; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_factor_index = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line916")'> 916:             component_index = active_components[factor_index]</pre>
<pre id='line916' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":916
 *         #TODO: note to cython list for componnt_index in active_components produces awful code!
 *         for factor_index in range(active_components.shape[0]):
 *             component_index = active_components[factor_index]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #             component = components[index]
 */
    __pyx_t_4 = __pyx_v_factor_index;
    __pyx_v_component_index = (*((int *) ( /* dim=0 */ (__pyx_v_active_components.data + __pyx_t_4 * __pyx_v_active_components.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line917")'> 917: </pre>
<pre id='line917' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line918")'> 918: #             component = components[index]</pre>
<pre id='line918' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line919")'> 919: </pre>
<pre id='line919' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line920")'> 920: </pre>
<pre id='line920' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line921")'> 921:             target_atom_id = self._compiled_components[component_index].remote_atom_1</pre>
<pre id='line921' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":921
 * 
 * 
 *             target_atom_id = self._compiled_components[component_index].remote_atom_1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             distant_atom_id  = self._compiled_components[component_index].remote_atom_2
 * 
 */
    __pyx_t_5 = (__pyx_v_self->_compiled_components[__pyx_v_component_index]).remote_atom_1;
    __pyx_v_target_atom_id = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line922")'> 922:             distant_atom_id  = self._compiled_components[component_index].remote_atom_2</pre>
<pre id='line922' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":922
 * 
 *             target_atom_id = self._compiled_components[component_index].remote_atom_1
 *             distant_atom_id  = self._compiled_components[component_index].remote_atom_2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_t_5 = (__pyx_v_self->_compiled_components[__pyx_v_component_index]).remote_atom_2;
    __pyx_v_distant_atom_id = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line923")'> 923: </pre>
<pre id='line923' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line924")'> 924: </pre>
<pre id='line924' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line925")'> 925:             coef_exp = self._get_coefficient_and_exponent(component_index)</pre>
<pre id='line925' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":925
 * 
 * 
 *             coef_exp = self._get_coefficient_and_exponent(component_index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             distance =calc_distance_simulation(self._simulation, target_atom_id, distant_atom_id)
 *     #        Atom_utils._calculate_distance(target_atom_index, sidechain_atom_index)
 */
    __pyx_v_coef_exp = __pyx_f_17shift_calculators_30Fast_distance_shift_calculator__get_coefficient_and_exponent(__pyx_v_self, __pyx_v_component_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line926")'> 926:             distance =calc_distance_simulation(self._simulation, target_atom_id, distant_atom_id)</pre>
<pre id='line926' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":926
 * 
 *             coef_exp = self._get_coefficient_and_exponent(component_index)
 *             distance =calc_distance_simulation(self._simulation, target_atom_id, distant_atom_id)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     #        Atom_utils._calculate_distance(target_atom_index, sidechain_atom_index)
 * 
 */
    __pyx_v_distance = __pyx_f_17shift_calculators_calc_distance_simulation(__pyx_v_self->__pyx_base._simulation, __pyx_v_target_atom_id, __pyx_v_distant_atom_id);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line927")'> 927:     #        Atom_utils._calculate_distance(target_atom_index, sidechain_atom_index)</pre>
<pre id='line927' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line928")'> 928: </pre>
<pre id='line928' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line929")'> 929:             if self._smoothed:</pre>
<pre id='line929' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":929
 *     #        Atom_utils._calculate_distance(target_atom_index, sidechain_atom_index)
 * 
 *             if self._smoothed:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 ratio = distance / self._cutoff
 *                 smoothing_factor = 1.0 - ratio ** 8
 */
    if (__pyx_v_self->_smoothed) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line930")'> 930:                 ratio = distance / self._cutoff</pre>
<pre id='line930' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":930
 * 
 *             if self._smoothed:
 *                 ratio = distance / self._cutoff             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 smoothing_factor = 1.0 - ratio ** 8
 * 
 */
      __pyx_v_ratio = (__pyx_v_distance / __pyx_v_self->_cutoff);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line931")'> 931:                 smoothing_factor = 1.0 - ratio ** 8</pre>
<pre id='line931' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":931
 *             if self._smoothed:
 *                 ratio = distance / self._cutoff
 *                 smoothing_factor = 1.0 - ratio ** 8             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             offset = self.ensemble_array_offset(component_to_target[factor_index])
 */
      __pyx_v_smoothing_factor = (1.0 - powf(__pyx_v_ratio, 8.0));
      goto __pyx_L5;
    }
    __pyx_L5:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line932")'> 932: </pre>
<pre id='line932' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line933")'> 933:             offset = self.ensemble_array_offset(component_to_target[factor_index])</pre>
<pre id='line933' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":933
 *                 smoothing_factor = 1.0 - ratio ** 8
 * 
 *             offset = self.ensemble_array_offset(component_to_target[factor_index])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             results[0][offset]  += smoothing_factor * pow(distance,  coef_exp.exponent) * coef_exp.coefficient
 * 
 */
    __pyx_t_5 = __pyx_v_factor_index;
    __pyx_v_offset = __pyx_f_17shift_calculators_21Base_shift_calculator_ensemble_array_offset(((struct __pyx_obj_17shift_calculators_Base_shift_calculator *)__pyx_v_self), (*((int *) ( /* dim=0 */ (__pyx_v_component_to_target.data + __pyx_t_5 * __pyx_v_component_to_target.strides[0]) ))));
</pre><pre class='line' style='background-color: #FFFF3c' onclick='toggleDiv("line934")'> 934:             results[0][offset]  += smoothing_factor * pow(distance,  coef_exp.exponent) * coef_exp.coefficient</pre>
<pre id='line934' class='code' style='background-color: #FFFF3c'>
    /* "Cython_shift_calculator.pyx":934
 * 
 *             offset = self.ensemble_array_offset(component_to_target[factor_index])
 *             results[0][offset]  += smoothing_factor * pow(distance,  coef_exp.exponent) * coef_exp.coefficient             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_t_6 = 0;
    __pyx_t_7 = __pyx_v_offset;
    ((__pyx_v_results[__pyx_t_6])[__pyx_t_7]) = (((__pyx_v_results[__pyx_t_6])[__pyx_t_7]) + ((__pyx_v_smoothing_factor * pow(__pyx_v_distance, __pyx_v_coef_exp.exponent)) * __pyx_v_coef_exp.coefficient));
  }

}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_30Fast_dihedral_shift_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_30Fast_dihedral_shift_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED PyObject *__pyx_v_simulation = 0;
  CYTHON_UNUSED PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__simulation,&__pyx_n_s__name,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject*)__pyx_kp_s_24);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__simulation)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 946; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_simulation = values[0];
    __pyx_v_name = ((PyObject*)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 946; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_dihedral_shift_calculator.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&PyString_Type), 1, "name", 1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 946; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_30Fast_dihedral_shift_calculator___cinit__(((struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *)__pyx_v_self), __pyx_v_simulation, __pyx_v_name);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line935")'> 935: </pre>
<pre id='line935' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line936")'> 936: </pre>
<pre id='line936' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line937")'> 937: </pre>
<pre id='line937' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line938")'> 938: </pre>
<pre id='line938' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line939")'> 939: </pre>
<pre id='line939' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line940")'> 940: cdef class Fast_dihedral_shift_calculator(Base_shift_calculator):</pre>
<pre id='line940' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":940
 * 
 * 
 * cdef class Fast_dihedral_shift_calculator(Base_shift_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef Dihedral_component *_compiled_components
 */
struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator {
  struct __pyx_obj_17shift_calculators_Base_shift_calculator __pyx_base;
  struct __pyx_t_17shift_calculators_Dihedral_component *_compiled_components;
  int _num_components;
  PyObject *_raw_data;
};


/* "Cython_shift_calculator.pyx":940
 * 
 * 
 * cdef class Fast_dihedral_shift_calculator(Base_shift_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef Dihedral_component *_compiled_components
 */

struct __pyx_vtabstruct_17shift_calculators_Fast_dihedral_shift_calculator {
  struct __pyx_vtabstruct_17shift_calculators_Base_shift_calculator __pyx_base;
  struct __pyx_t_17shift_calculators_dihedral_ids (*_get_dihedral_atom_ids)(struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *, int);
  struct __pyx_t_17shift_calculators_dihedral_parameters (*_get_parameters)(struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *, int);
  float (*_get_coefficient)(struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *, int);
};
static struct __pyx_vtabstruct_17shift_calculators_Fast_dihedral_shift_calculator *__pyx_vtabptr_17shift_calculators_Fast_dihedral_shift_calculator;
static CYTHON_INLINE struct __pyx_t_17shift_calculators_dihedral_ids __pyx_f_17shift_calculators_30Fast_dihedral_shift_calculator__get_dihedral_atom_ids(struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *, int);
static CYTHON_INLINE struct __pyx_t_17shift_calculators_dihedral_parameters __pyx_f_17shift_calculators_30Fast_dihedral_shift_calculator__get_parameters(struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *, int);
static CYTHON_INLINE float __pyx_f_17shift_calculators_30Fast_dihedral_shift_calculator__get_coefficient(struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *, int);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line941")'> 941: </pre>
<pre id='line941' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line942")'> 942:     cdef Dihedral_component *_compiled_components</pre>
<pre id='line942' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line943")'> 943:     cdef int _num_components</pre>
<pre id='line943' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line944")'> 944:     cdef object _raw_data</pre>
<pre id='line944' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line945")'> 945: </pre>
<pre id='line945' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line946")'> 946:     def __cinit__(self, simulation, str name = "not set"):</pre>
<pre id='line946' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":946
 *     cdef object _raw_data
 * 
 *     def __cinit__(self, simulation, str name = "not set"):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._raw_data =  None
 *         self._compiled_components = NULL
 */

static int __pyx_pf_17shift_calculators_30Fast_dihedral_shift_calculator___cinit__(struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_simulation, CYTHON_UNUSED PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line947")'> 947:         self._raw_data =  None</pre>
<pre id='line947' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":947
 * 
 *     def __cinit__(self, simulation, str name = "not set"):
 *         self._raw_data =  None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components = NULL
 *         self._num_components = 0
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_raw_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_raw_data);
  __pyx_v_self->_raw_data = Py_None;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line948")'> 948:         self._compiled_components = NULL</pre>
<pre id='line948' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":948
 *     def __cinit__(self, simulation, str name = "not set"):
 *         self._raw_data =  None
 *         self._compiled_components = NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components = 0
 * 
 */
  __pyx_v_self->_compiled_components = NULL;
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line949")'> 949:         self._num_components = 0</pre>
<pre id='line949' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":949
 *         self._raw_data =  None
 *         self._compiled_components = NULL
 *         self._num_components = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_self->_num_components = 0;

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_30Fast_dihedral_shift_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_30Fast_dihedral_shift_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_simulation = 0;
  PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__simulation,&__pyx_n_s__name,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject*)__pyx_kp_s_24);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__simulation)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 952; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_simulation = values[0];
    __pyx_v_name = ((PyObject*)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 952; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_dihedral_shift_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&PyString_Type), 1, "name", 1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 952; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_30Fast_dihedral_shift_calculator_2__init__(((struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *)__pyx_v_self), __pyx_v_simulation, __pyx_v_name);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line950")'> 950: </pre>
<pre id='line950' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line951")'> 951: </pre>
<pre id='line951' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line952")'> 952:     def __init__(self, simulation, str name = "not set"):</pre>
<pre id='line952' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":952
 * 
 * 
 *     def __init__(self, simulation, str name = "not set"):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         Base_shift_calculator.__init__(self, simulation, name)
 * 
 */

static int __pyx_pf_17shift_calculators_30Fast_dihedral_shift_calculator_2__init__(struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *__pyx_v_self, PyObject *__pyx_v_simulation, PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line953")'> 953:         Base_shift_calculator.__init__(self, simulation, name)</pre>
<pre id='line953' class='code' style='background-color: #FFFF3f'>
  /* "Cython_shift_calculator.pyx":953
 * 
 *     def __init__(self, simulation, str name = "not set"):
 *         Base_shift_calculator.__init__(self, simulation, name)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Base_shift_calculator)), __pyx_n_s____init__);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 953; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 953; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simulation);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_simulation);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_simulation);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_name));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, ((PyObject *)__pyx_v_name));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_name));
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 953; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_dihedral_shift_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line954")'> 954: </pre>
<pre id='line954' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line955")'> 955: </pre>
<pre id='line955' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line956")'> 956:     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:</pre>
<pre id='line956' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":956
 * 
 * 
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components =  <code><</code>Dihedral_component*> <code><</code>size_t> data
 *         self._num_components =  length
 */

static void __pyx_f_17shift_calculators_30Fast_dihedral_shift_calculator__bytes_to_components(struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *__pyx_v_self, uintptr_t __pyx_v_data, uintptr_t __pyx_v_length) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line957")'> 957:         self._compiled_components =  &lt;Dihedral_component*&gt; &lt;size_t&gt; data</pre>
<pre id='line957' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":957
 * 
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:
 *         self._compiled_components =  <code><</code>Dihedral_component*> <code><</code>size_t> data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components =  length
 * 
 */
  __pyx_v_self->_compiled_components = ((struct __pyx_t_17shift_calculators_Dihedral_component *)((size_t)__pyx_v_data));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line958")'> 958:         self._num_components =  length</pre>
<pre id='line958' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":958
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:
 *         self._compiled_components =  <code><</code>Dihedral_component*> <code><</code>size_t> data
 *         self._num_components =  length             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_self->_num_components = __pyx_v_length;

}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line959")'> 959: </pre>
<pre id='line959' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line960")'> 960: </pre>
<pre id='line960' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line961")'> 961: #     cdef inline _get_component(self,int index) nogil:</pre>
<pre id='line961' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line962")'> 962: #         return self._components[index]</pre>
<pre id='line962' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line963")'> 963: </pre>
<pre id='line963' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line964")'> 964:     @cython.profile(False)</pre>
<pre id='line964' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line965")'> 965:     cdef inline dihedral_ids _get_dihedral_atom_ids(self, int index) nogil:</pre>
<pre id='line965' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":965
 * 
 *     @cython.profile(False)
 *     cdef inline dihedral_ids _get_dihedral_atom_ids(self, int index) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef dihedral_ids result
 * 
 */

static CYTHON_INLINE struct __pyx_t_17shift_calculators_dihedral_ids __pyx_f_17shift_calculators_30Fast_dihedral_shift_calculator__get_dihedral_atom_ids(struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *__pyx_v_self, int __pyx_v_index) {
  struct __pyx_t_17shift_calculators_dihedral_ids __pyx_v_result;
  struct __pyx_t_17shift_calculators_dihedral_ids __pyx_r;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line966")'> 966:         cdef dihedral_ids result</pre>
<pre id='line966' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line967")'> 967: </pre>
<pre id='line967' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line968")'> 968:         result.atom_id_1 = self._compiled_components[index].dihedral_atoms[0]</pre>
<pre id='line968' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":968
 *         cdef dihedral_ids result
 * 
 *         result.atom_id_1 = self._compiled_components[index].dihedral_atoms[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.atom_id_2 = self._compiled_components[index].dihedral_atoms[1]
 *         result.atom_id_3 = self._compiled_components[index].dihedral_atoms[2]
 */
  __pyx_v_result.atom_id_1 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).dihedral_atoms[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line969")'> 969:         result.atom_id_2 = self._compiled_components[index].dihedral_atoms[1]</pre>
<pre id='line969' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":969
 * 
 *         result.atom_id_1 = self._compiled_components[index].dihedral_atoms[0]
 *         result.atom_id_2 = self._compiled_components[index].dihedral_atoms[1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.atom_id_3 = self._compiled_components[index].dihedral_atoms[2]
 *         result.atom_id_4 = self._compiled_components[index].dihedral_atoms[3]
 */
  __pyx_v_result.atom_id_2 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).dihedral_atoms[1]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line970")'> 970:         result.atom_id_3 = self._compiled_components[index].dihedral_atoms[2]</pre>
<pre id='line970' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":970
 *         result.atom_id_1 = self._compiled_components[index].dihedral_atoms[0]
 *         result.atom_id_2 = self._compiled_components[index].dihedral_atoms[1]
 *         result.atom_id_3 = self._compiled_components[index].dihedral_atoms[2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.atom_id_4 = self._compiled_components[index].dihedral_atoms[3]
 * 
 */
  __pyx_v_result.atom_id_3 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).dihedral_atoms[2]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line971")'> 971:         result.atom_id_4 = self._compiled_components[index].dihedral_atoms[3]</pre>
<pre id='line971' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":971
 *         result.atom_id_2 = self._compiled_components[index].dihedral_atoms[1]
 *         result.atom_id_3 = self._compiled_components[index].dihedral_atoms[2]
 *         result.atom_id_4 = self._compiled_components[index].dihedral_atoms[3]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         return result
 */
  __pyx_v_result.atom_id_4 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).dihedral_atoms[3]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line972")'> 972: </pre>
<pre id='line972' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line973")'> 973:         return result</pre>
<pre id='line973' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":973
 *         result.atom_id_4 = self._compiled_components[index].dihedral_atoms[3]
 * 
 *         return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline dihedral_parameters _get_parameters(self, int index) nogil:
 */
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;

  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line974")'> 974: </pre>
<pre id='line974' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line975")'> 975:     cdef inline dihedral_parameters _get_parameters(self, int index) nogil:</pre>
<pre id='line975' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":975
 *         return result
 * 
 *     cdef inline dihedral_parameters _get_parameters(self, int index) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef dihedral_parameters result
 */

static CYTHON_INLINE struct __pyx_t_17shift_calculators_dihedral_parameters __pyx_f_17shift_calculators_30Fast_dihedral_shift_calculator__get_parameters(struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *__pyx_v_self, int __pyx_v_index) {
  struct __pyx_t_17shift_calculators_dihedral_parameters __pyx_v_result;
  struct __pyx_t_17shift_calculators_dihedral_parameters __pyx_r;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line976")'> 976: </pre>
<pre id='line976' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line977")'> 977:         cdef dihedral_parameters result</pre>
<pre id='line977' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line978")'> 978: </pre>
<pre id='line978' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line979")'> 979:         result.param_0 = self._compiled_components[index].parameters[0]</pre>
<pre id='line979' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":979
 *         cdef dihedral_parameters result
 * 
 *         result.param_0 = self._compiled_components[index].parameters[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.param_1 = self._compiled_components[index].parameters[3]
 *         result.param_2 = self._compiled_components[index].parameters[1]
 */
  __pyx_v_result.param_0 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).parameters[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line980")'> 980:         result.param_1 = self._compiled_components[index].parameters[3]</pre>
<pre id='line980' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":980
 * 
 *         result.param_0 = self._compiled_components[index].parameters[0]
 *         result.param_1 = self._compiled_components[index].parameters[3]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.param_2 = self._compiled_components[index].parameters[1]
 *         result.param_3 = self._compiled_components[index].parameters[4]
 */
  __pyx_v_result.param_1 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).parameters[3]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line981")'> 981:         result.param_2 = self._compiled_components[index].parameters[1]</pre>
<pre id='line981' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":981
 *         result.param_0 = self._compiled_components[index].parameters[0]
 *         result.param_1 = self._compiled_components[index].parameters[3]
 *         result.param_2 = self._compiled_components[index].parameters[1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.param_3 = self._compiled_components[index].parameters[4]
 *         result.param_4 = self._compiled_components[index].parameters[2]
 */
  __pyx_v_result.param_2 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).parameters[1]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line982")'> 982:         result.param_3 = self._compiled_components[index].parameters[4]</pre>
<pre id='line982' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":982
 *         result.param_1 = self._compiled_components[index].parameters[3]
 *         result.param_2 = self._compiled_components[index].parameters[1]
 *         result.param_3 = self._compiled_components[index].parameters[4]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.param_4 = self._compiled_components[index].parameters[2]
 * 
 */
  __pyx_v_result.param_3 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).parameters[4]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line983")'> 983:         result.param_4 = self._compiled_components[index].parameters[2]</pre>
<pre id='line983' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":983
 *         result.param_2 = self._compiled_components[index].parameters[1]
 *         result.param_3 = self._compiled_components[index].parameters[4]
 *         result.param_4 = self._compiled_components[index].parameters[2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_result.param_4 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).parameters[2]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line984")'> 984: </pre>
<pre id='line984' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line985")'> 985: </pre>
<pre id='line985' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line986")'> 986: </pre>
<pre id='line986' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line987")'> 987: </pre>
<pre id='line987' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line988")'> 988:         return result</pre>
<pre id='line988' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":988
 * 
 * 
 *         return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     @cython.profile(False)
 */
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;

  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line989")'> 989: </pre>
<pre id='line989' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line990")'> 990:     @cython.profile(False)</pre>
<pre id='line990' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line991")'> 991:     cdef inline float _get_coefficient(self, int index) nogil:</pre>
<pre id='line991' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":991
 * 
 *     @cython.profile(False)
 *     cdef inline float _get_coefficient(self, int index) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._compiled_components[index].coefficient
 * 
 */

static CYTHON_INLINE float __pyx_f_17shift_calculators_30Fast_dihedral_shift_calculator__get_coefficient(struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *__pyx_v_self, int __pyx_v_index) {
  float __pyx_r;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line992")'> 992:         return self._compiled_components[index].coefficient</pre>
<pre id='line992' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":992
 *     @cython.profile(False)
 *     cdef inline float _get_coefficient(self, int index) nogil:
 *         return self._compiled_components[index].coefficient             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_r = (__pyx_v_self->_compiled_components[__pyx_v_index]).coefficient;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line993")'> 993: </pre>
<pre id='line993' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line994")'> 994: </pre>
<pre id='line994' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line995")'> 995: </pre>
<pre id='line995' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line996")'> 996:     cdef void calc(self, cmap[int,uintptr_t] *components, CDSSharedVectorFloat shift_cache, int[:] component_to_target,  int[:] active_components) nogil:</pre>
<pre id='line996' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":996
 * 
 * 
 *     cdef void calc(self, cmap[int,uintptr_t] *components, CDSSharedVectorFloat shift_cache, int[:] component_to_target,  int[:] active_components) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef CDSVector[double]  *results = shift_cache.get_data()
 * 
 */

static void __pyx_f_17shift_calculators_30Fast_dihedral_shift_calculator_calc(struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *__pyx_v_self, std::map<code><</code>int,uintptr_t> *__pyx_v_components, struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_shift_cache, __Pyx_memviewslice __pyx_v_component_to_target, __Pyx_memviewslice __pyx_v_active_components) {
  CDSVector<code><</code>double> *__pyx_v_results;
  float __pyx_v_angle;
  float __pyx_v_angle_term;
  float __pyx_v_shift;
  float __pyx_v_coefficient;
  struct __pyx_t_17shift_calculators_dihedral_parameters __pyx_v_parameters;
  struct __pyx_t_17shift_calculators_dihedral_ids __pyx_v_dihedral_atom_ids;
  int __pyx_v_factor_index;
  int __pyx_v_component_index;
  int __pyx_v_offset;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line997")'> 997:         cdef CDSVector[double]  *results = shift_cache.get_data()</pre>
<pre id='line997' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":997
 * 
 *     cdef void calc(self, cmap[int,uintptr_t] *components, CDSSharedVectorFloat shift_cache, int[:] component_to_target,  int[:] active_components) nogil:
 *         cdef CDSVector[double]  *results = shift_cache.get_data()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_results = ((struct __pyx_vtabstruct_17shift_calculators_CDSSharedVectorFloat *)__pyx_v_shift_cache->__pyx_vtab)->get_data(__pyx_v_shift_cache);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line998")'> 998: </pre>
<pre id='line998' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line999")'> 999: </pre>
<pre id='line999' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1000")'> 1000:         cdef float angle</pre>
<pre id='line1000' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1001")'> 1001:         cdef float angle_term</pre>
<pre id='line1001' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1002")'> 1002:         cdef float shift</pre>
<pre id='line1002' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1003")'> 1003:         cdef float coefficient</pre>
<pre id='line1003' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1004")'> 1004:         cdef dihedral_parameters parameters</pre>
<pre id='line1004' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1005")'> 1005:         cdef dihedral_ids dihedral_atom_ids</pre>
<pre id='line1005' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1006")'> 1006: </pre>
<pre id='line1006' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1007")'> 1007:         cdef int factor_index</pre>
<pre id='line1007' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1008")'> 1008:         cdef int component_index</pre>
<pre id='line1008' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1009")'> 1009:         cdef int offset</pre>
<pre id='line1009' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1010")'> 1010: </pre>
<pre id='line1010' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1011")'> 1011:         self._set_components(components)</pre>
<pre id='line1011' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1011
 *         cdef int offset
 * 
 *         self._set_components(components)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         for factor_index in range(active_components.shape[0]):
 */
  ((struct __pyx_vtabstruct_17shift_calculators_Fast_dihedral_shift_calculator *)__pyx_v_self->__pyx_base.__pyx_vtab)->__pyx_base._set_components(((struct __pyx_obj_17shift_calculators_Base_shift_calculator *)__pyx_v_self), __pyx_v_components);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1012")'> 1012: </pre>
<pre id='line1012' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1013")'> 1013:         for factor_index in range(active_components.shape[0]):</pre>
<pre id='line1013' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1013
 *         self._set_components(components)
 * 
 *         for factor_index in range(active_components.shape[0]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             component_index = active_components[factor_index]
 * 
 */
  __pyx_t_1 = (__pyx_v_active_components.shape[0]);
  for (__pyx_t_2 = 0; __pyx_t_2 <code><</code> __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_factor_index = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1014")'> 1014:             component_index = active_components[factor_index]</pre>
<pre id='line1014' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1014
 * 
 *         for factor_index in range(active_components.shape[0]):
 *             component_index = active_components[factor_index]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             dihedral_atom_ids = self._get_dihedral_atom_ids(component_index)
 */
    __pyx_t_3 = __pyx_v_factor_index;
    __pyx_v_component_index = (*((int *) ( /* dim=0 */ (__pyx_v_active_components.data + __pyx_t_3 * __pyx_v_active_components.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1015")'> 1015: </pre>
<pre id='line1015' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1016")'> 1016:             dihedral_atom_ids = self._get_dihedral_atom_ids(component_index)</pre>
<pre id='line1016' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1016
 *             component_index = active_components[factor_index]
 * 
 *             dihedral_atom_ids = self._get_dihedral_atom_ids(component_index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             coefficient = self._get_coefficient(component_index)
 */
    __pyx_v_dihedral_atom_ids = __pyx_f_17shift_calculators_30Fast_dihedral_shift_calculator__get_dihedral_atom_ids(__pyx_v_self, __pyx_v_component_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1017")'> 1017: </pre>
<pre id='line1017' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1018")'> 1018:             coefficient = self._get_coefficient(component_index)</pre>
<pre id='line1018' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1018
 *             dihedral_atom_ids = self._get_dihedral_atom_ids(component_index)
 * 
 *             coefficient = self._get_coefficient(component_index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             parameters = self._get_parameters(component_index)
 */
    __pyx_v_coefficient = __pyx_f_17shift_calculators_30Fast_dihedral_shift_calculator__get_coefficient(__pyx_v_self, __pyx_v_component_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1019")'> 1019: </pre>
<pre id='line1019' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1020")'> 1020:             parameters = self._get_parameters(component_index)</pre>
<pre id='line1020' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1020
 *             coefficient = self._get_coefficient(component_index)
 * 
 *             parameters = self._get_parameters(component_index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             angle = calc_dihedral_angle_simulation(self._simulation, dihedral_atom_ids)
 */
    __pyx_v_parameters = __pyx_f_17shift_calculators_30Fast_dihedral_shift_calculator__get_parameters(__pyx_v_self, __pyx_v_component_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1021")'> 1021: </pre>
<pre id='line1021' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1022")'> 1022:             angle = calc_dihedral_angle_simulation(self._simulation, dihedral_atom_ids)</pre>
<pre id='line1022' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1022
 *             parameters = self._get_parameters(component_index)
 * 
 *             angle = calc_dihedral_angle_simulation(self._simulation, dihedral_atom_ids)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             angle_term = parameters.param_0 * cos(3.0 * angle + parameters.param_1) + \
 */
    __pyx_v_angle = __pyx_f_17shift_calculators_calc_dihedral_angle_simulation(__pyx_v_self->__pyx_base._simulation, __pyx_v_dihedral_atom_ids);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1023")'> 1023: </pre>
<pre id='line1023' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1024")'> 1024:             angle_term = parameters.param_0 * cos(3.0 * angle + parameters.param_1) + \</pre>
<pre id='line1024' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1025")'> 1025:                          parameters.param_2 * cos(angle +  parameters.param_3) +      \</pre>
<pre id='line1025' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1026")'> 1026:                          parameters.param_4</pre>
<pre id='line1026' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1026
 *             angle_term = parameters.param_0 * cos(3.0 * angle + parameters.param_1) + \
 *                          parameters.param_2 * cos(angle +  parameters.param_3) +      \
 *                          parameters.param_4             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             shift = coefficient * angle_term
 * 
 */
    __pyx_v_angle_term = (((__pyx_v_parameters.param_0 * cos(((3.0 * __pyx_v_angle) + __pyx_v_parameters.param_1))) + (__pyx_v_parameters.param_2 * cos((__pyx_v_angle + __pyx_v_parameters.param_3)))) + __pyx_v_parameters.param_4);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1027")'> 1027:             shift = coefficient * angle_term</pre>
<pre id='line1027' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1027
 *                          parameters.param_2 * cos(angle +  parameters.param_3) +      \
 *                          parameters.param_4
 *             shift = coefficient * angle_term             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             offset = self.ensemble_array_offset(component_to_target[factor_index])
 */
    __pyx_v_shift = (__pyx_v_coefficient * __pyx_v_angle_term);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1028")'> 1028: </pre>
<pre id='line1028' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1029")'> 1029:             offset = self.ensemble_array_offset(component_to_target[factor_index])</pre>
<pre id='line1029' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1029
 *             shift = coefficient * angle_term
 * 
 *             offset = self.ensemble_array_offset(component_to_target[factor_index])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             results[0][offset] += shift
 * 
 */
    __pyx_t_4 = __pyx_v_factor_index;
    __pyx_v_offset = __pyx_f_17shift_calculators_21Base_shift_calculator_ensemble_array_offset(((struct __pyx_obj_17shift_calculators_Base_shift_calculator *)__pyx_v_self), (*((int *) ( /* dim=0 */ (__pyx_v_component_to_target.data + __pyx_t_4 * __pyx_v_component_to_target.strides[0]) ))));
</pre><pre class='line' style='background-color: #FFFF3c' onclick='toggleDiv("line1030")'> 1030:             results[0][offset] += shift</pre>
<pre id='line1030' class='code' style='background-color: #FFFF3c'>
    /* "Cython_shift_calculator.pyx":1030
 * 
 *             offset = self.ensemble_array_offset(component_to_target[factor_index])
 *             results[0][offset] += shift             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_t_5 = 0;
    __pyx_t_6 = __pyx_v_offset;
    ((__pyx_v_results[__pyx_t_5])[__pyx_t_6]) = (((__pyx_v_results[__pyx_t_5])[__pyx_t_6]) + __pyx_v_shift);
  }

}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED PyObject *__pyx_v_simulation = 0;
  CYTHON_UNUSED PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__simulation,&__pyx_n_s__name,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject*)__pyx_kp_s_24);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__simulation)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1048; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_simulation = values[0];
    __pyx_v_name = ((PyObject*)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1048; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_shift_calculator.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&PyString_Type), 1, "name", 1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1048; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_shift_calculator___cinit__(((struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *)__pyx_v_self), __pyx_v_simulation, __pyx_v_name);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1031")'> 1031: </pre>
<pre id='line1031' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1032")'> 1032: </pre>
<pre id='line1032' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1033")'> 1033: cdef class Fast_ring_shift_calculator(Base_shift_calculator):</pre>
<pre id='line1033' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1033
 * 
 * 
 * cdef class Fast_ring_shift_calculator(Base_shift_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Vec3_list _centre_cache
 *     cdef Vec3_list _normal_cache
 */
struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator {
  struct __pyx_obj_17shift_calculators_Base_shift_calculator __pyx_base;
  struct __pyx_obj_17shift_calculators_Vec3_list *_centre_cache;
  struct __pyx_obj_17shift_calculators_Vec3_list *_normal_cache;
  struct __pyx_t_17shift_calculators_Ring_target_component *_compiled_components;
  int _num_components;
  PyObject *raw_data;
  struct __pyx_t_17shift_calculators_Ring_component *_compiled_ring_components;
  int _num_ring_components;
  PyObject *_raw_ring_component_data;
  struct __pyx_obj_17shift_calculators_Coef_components *_compiled_coef_components;
};


/* "Cython_shift_calculator.pyx":1033
 * 
 * 
 * cdef class Fast_ring_shift_calculator(Base_shift_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Vec3_list _centre_cache
 *     cdef Vec3_list _normal_cache
 */

struct __pyx_vtabstruct_17shift_calculators_Fast_ring_shift_calculator {
  struct __pyx_vtabstruct_17shift_calculators_Base_shift_calculator __pyx_base;
  void (*_bytes_to_ring_components)(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *, PyObject *);
  Vec3 *(*_get_ring_normal)(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *, int);
  Vec3 *(*_get_ring_centre)(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *, int);
  float (*_calc_sub_component_shift)(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *, int, int, float);
};
static struct __pyx_vtabstruct_17shift_calculators_Fast_ring_shift_calculator *__pyx_vtabptr_17shift_calculators_Fast_ring_shift_calculator;
static CYTHON_INLINE Vec3 *__pyx_f_17shift_calculators_26Fast_ring_shift_calculator__get_ring_normal(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *, int);
static CYTHON_INLINE Vec3 *__pyx_f_17shift_calculators_26Fast_ring_shift_calculator__get_ring_centre(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *, int);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1034")'> 1034:     cdef Vec3_list _centre_cache</pre>
<pre id='line1034' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1035")'> 1035:     cdef Vec3_list _normal_cache</pre>
<pre id='line1035' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1036")'> 1036: </pre>
<pre id='line1036' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1037")'> 1037:     cdef Ring_target_component* _compiled_components</pre>
<pre id='line1037' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1038")'> 1038:     cdef int _num_components</pre>
<pre id='line1038' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1039")'> 1039:     cdef object raw_data</pre>
<pre id='line1039' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1040")'> 1040: </pre>
<pre id='line1040' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1041")'> 1041:     cdef Ring_component* _compiled_ring_components</pre>
<pre id='line1041' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1042")'> 1042:     cdef int _num_ring_components</pre>
<pre id='line1042' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1043")'> 1043:     cdef object _raw_ring_component_data</pre>
<pre id='line1043' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1044")'> 1044: </pre>
<pre id='line1044' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1045")'> 1045: </pre>
<pre id='line1045' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1046")'> 1046:     cdef Coef_components _compiled_coef_components</pre>
<pre id='line1046' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1047")'> 1047: </pre>
<pre id='line1047' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1048")'> 1048:     def __cinit__(self, simulation, str name = "not set"):</pre>
<pre id='line1048' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1048
 *     cdef Coef_components _compiled_coef_components
 * 
 *     def __cinit__(self, simulation, str name = "not set"):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.raw_data = None
 *         self._compiled_components = NULL
 */

static int __pyx_pf_17shift_calculators_26Fast_ring_shift_calculator___cinit__(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_simulation, CYTHON_UNUSED PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1049")'> 1049:         self.raw_data = None</pre>
<pre id='line1049' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":1049
 * 
 *     def __cinit__(self, simulation, str name = "not set"):
 *         self.raw_data = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components = NULL
 *         self._num_components = 0
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->raw_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->raw_data);
  __pyx_v_self->raw_data = Py_None;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1050")'> 1050:         self._compiled_components = NULL</pre>
<pre id='line1050' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1050
 *     def __cinit__(self, simulation, str name = "not set"):
 *         self.raw_data = None
 *         self._compiled_components = NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components = 0
 * 
 */
  __pyx_v_self->_compiled_components = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1051")'> 1051:         self._num_components = 0</pre>
<pre id='line1051' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1051
 *         self.raw_data = None
 *         self._compiled_components = NULL
 *         self._num_components = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._compiled_ring_components = NULL
 */
  __pyx_v_self->_num_components = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1052")'> 1052: </pre>
<pre id='line1052' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1053")'> 1053:         self._compiled_ring_components = NULL</pre>
<pre id='line1053' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1053
 *         self._num_components = 0
 * 
 *         self._compiled_ring_components = NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_ring_components = 0
 *         self._raw_ring_component_data = None
 */
  __pyx_v_self->_compiled_ring_components = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1054")'> 1054:         self._num_ring_components = 0</pre>
<pre id='line1054' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1054
 * 
 *         self._compiled_ring_components = NULL
 *         self._num_ring_components = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._raw_ring_component_data = None
 * 
 */
  __pyx_v_self->_num_ring_components = 0;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1055")'> 1055:         self._raw_ring_component_data = None</pre>
<pre id='line1055' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":1055
 *         self._compiled_ring_components = NULL
 *         self._num_ring_components = 0
 *         self._raw_ring_component_data = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         #note this is not a raw array of structs it's a compiled python class
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_raw_ring_component_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_raw_ring_component_data);
  __pyx_v_self->_raw_ring_component_data = Py_None;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1056")'> 1056: </pre>
<pre id='line1056' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1057")'> 1057:         #note this is not a raw array of structs it's a compiled python class</pre>
<pre id='line1057' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1058")'> 1058:         self._compiled_coef_components = None</pre>
<pre id='line1058' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":1058
 * 
 *         #note this is not a raw array of structs it's a compiled python class
 *         self._compiled_coef_components = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._centre_cache = None
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_compiled_coef_components);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_compiled_coef_components));
  __pyx_v_self->_compiled_coef_components = ((struct __pyx_obj_17shift_calculators_Coef_components *)Py_None);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1059")'> 1059: </pre>
<pre id='line1059' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1060")'> 1060:         self._centre_cache = None</pre>
<pre id='line1060' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":1060
 *         self._compiled_coef_components = None
 * 
 *         self._centre_cache = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._normal_cache = None
 * 
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_centre_cache);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_centre_cache));
  __pyx_v_self->_centre_cache = ((struct __pyx_obj_17shift_calculators_Vec3_list *)Py_None);
</pre><pre class='line' style='background-color: #FFFF38' onclick='toggleDiv("line1061")'> 1061:         self._normal_cache = None</pre>
<pre id='line1061' class='code' style='background-color: #FFFF38'>
  /* "Cython_shift_calculator.pyx":1061
 * 
 *         self._centre_cache = None
 *         self._normal_cache = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __init__(self, simulation, str name = "not set"):
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_normal_cache);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_normal_cache));
  __pyx_v_self->_normal_cache = ((struct __pyx_obj_17shift_calculators_Vec3_list *)Py_None);

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_simulation = 0;
  PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__simulation,&__pyx_n_s__name,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject*)__pyx_kp_s_24);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__simulation)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1063; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_simulation = values[0];
    __pyx_v_name = ((PyObject*)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1063; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_shift_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&PyString_Type), 1, "name", 1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1063; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_shift_calculator_2__init__(((struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *)__pyx_v_self), __pyx_v_simulation, __pyx_v_name);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1062")'> 1062: </pre>
<pre id='line1062' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1063")'> 1063:     def __init__(self, simulation, str name = "not set"):</pre>
<pre id='line1063' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1063
 *         self._normal_cache = None
 * 
 *     def __init__(self, simulation, str name = "not set"):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         Base_shift_calculator.__init__(self,simulation, name)
 * 
 */

static int __pyx_pf_17shift_calculators_26Fast_ring_shift_calculator_2__init__(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *__pyx_v_self, PyObject *__pyx_v_simulation, PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line1064")'> 1064:         Base_shift_calculator.__init__(self,simulation, name)</pre>
<pre id='line1064' class='code' style='background-color: #FFFF3f'>
  /* "Cython_shift_calculator.pyx":1064
 * 
 *     def __init__(self, simulation, str name = "not set"):
 *         Base_shift_calculator.__init__(self,simulation, name)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Base_shift_calculator)), __pyx_n_s____init__);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1064; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1064; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simulation);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_simulation);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_simulation);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_name));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, ((PyObject *)__pyx_v_name));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_name));
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1064; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_shift_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1065")'> 1065: </pre>
<pre id='line1065' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1066")'> 1066:     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:</pre>
<pre id='line1066' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1066
 *         Base_shift_calculator.__init__(self,simulation, name)
 * 
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components =  <code><</code>Ring_target_component*> <code><</code>size_t> data
 *         self._num_components =  length
 */

static void __pyx_f_17shift_calculators_26Fast_ring_shift_calculator__bytes_to_components(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *__pyx_v_self, uintptr_t __pyx_v_data, uintptr_t __pyx_v_length) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1067")'> 1067:         self._compiled_components =  &lt;Ring_target_component*&gt; &lt;size_t&gt; data</pre>
<pre id='line1067' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1067
 * 
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:
 *         self._compiled_components =  <code><</code>Ring_target_component*> <code><</code>size_t> data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components =  length
 * 
 */
  __pyx_v_self->_compiled_components = ((struct __pyx_t_17shift_calculators_Ring_target_component *)((size_t)__pyx_v_data));
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1068")'> 1068:         self._num_components =  length</pre>
<pre id='line1068' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":1068
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:
 *         self._compiled_components =  <code><</code>Ring_target_component*> <code><</code>size_t> data
 *         self._num_components =  length             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_self->_num_components = __pyx_v_length;

}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_5_set_normal_cache(PyObject *__pyx_v_self, PyObject *__pyx_v_normals); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_5_set_normal_cache(PyObject *__pyx_v_self, PyObject *__pyx_v_normals) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_normal_cache (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_shift_calculator_4_set_normal_cache(((struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_normals));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1069")'> 1069: </pre>
<pre id='line1069' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1070")'> 1070: </pre>
<pre id='line1070' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1071")'> 1071: </pre>
<pre id='line1071' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1072")'> 1072: </pre>
<pre id='line1072' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1073")'> 1073: </pre>
<pre id='line1073' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1074")'> 1074:     def _set_normal_cache(self,normals):</pre>
<pre id='line1074' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1074
 * 
 * 
 *     def _set_normal_cache(self,normals):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._normal_cache = <code><</code>Vec3_list> normals
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_ring_shift_calculator_4_set_normal_cache(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *__pyx_v_self, PyObject *__pyx_v_normals) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_normal_cache", 0);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1075")'> 1075:         self._normal_cache = &lt;Vec3_list&gt; normals</pre>
<pre id='line1075' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":1075
 * 
 *     def _set_normal_cache(self,normals):
 *         self._normal_cache = <code><</code>Vec3_list> normals             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def _set_centre_cache(self,centres):
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)((struct __pyx_obj_17shift_calculators_Vec3_list *)__pyx_v_normals)));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_normals);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_normal_cache);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_normal_cache));
  __pyx_v_self->_normal_cache = ((struct __pyx_obj_17shift_calculators_Vec3_list *)__pyx_v_normals);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_7_set_centre_cache(PyObject *__pyx_v_self, PyObject *__pyx_v_centres); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_7_set_centre_cache(PyObject *__pyx_v_self, PyObject *__pyx_v_centres) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_centre_cache (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_shift_calculator_6_set_centre_cache(((struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_centres));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1076")'> 1076: </pre>
<pre id='line1076' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1077")'> 1077:     def _set_centre_cache(self,centres):</pre>
<pre id='line1077' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1077
 *         self._normal_cache = <code><</code>Vec3_list> normals
 * 
 *     def _set_centre_cache(self,centres):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._centre_cache = <code><</code>Vec3_list> centres
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_ring_shift_calculator_6_set_centre_cache(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *__pyx_v_self, PyObject *__pyx_v_centres) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_centre_cache", 0);
</pre><pre class='line' style='background-color: #FFFF37' onclick='toggleDiv("line1078")'> 1078:         self._centre_cache = &lt;Vec3_list&gt; centres</pre>
<pre id='line1078' class='code' style='background-color: #FFFF37'>
  /* "Cython_shift_calculator.pyx":1078
 * 
 *     def _set_centre_cache(self,centres):
 *         self._centre_cache = <code><</code>Vec3_list> centres             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def _set_coef_components(self,coef_components, component_offsets):
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)((struct __pyx_obj_17shift_calculators_Vec3_list *)__pyx_v_centres)));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_centres);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_centre_cache);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_centre_cache));
  __pyx_v_self->_centre_cache = ((struct __pyx_obj_17shift_calculators_Vec3_list *)__pyx_v_centres);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_9_set_coef_components(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_9_set_coef_components(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_coef_components = 0;
  PyObject *__pyx_v_component_offsets = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_coef_components (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__coef_components,&__pyx_n_s__component_offsets,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__coef_components)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__component_offsets)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_set_coef_components", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1080; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_set_coef_components") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1080; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_coef_components = values[0];
    __pyx_v_component_offsets = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_set_coef_components", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1080; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_shift_calculator._set_coef_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_shift_calculator_8_set_coef_components(((struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *)__pyx_v_self), __pyx_v_coef_components, __pyx_v_component_offsets);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1079")'> 1079: </pre>
<pre id='line1079' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1080")'> 1080:     def _set_coef_components(self,coef_components, component_offsets):</pre>
<pre id='line1080' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1080
 *         self._centre_cache = <code><</code>Vec3_list> centres
 * 
 *     def _set_coef_components(self,coef_components, component_offsets):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_coef_components = Coef_components(coef_components, component_offsets)
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_ring_shift_calculator_8_set_coef_components(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *__pyx_v_self, PyObject *__pyx_v_coef_components, PyObject *__pyx_v_component_offsets) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_coef_components", 0);
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line1081")'> 1081:         self._compiled_coef_components = Coef_components(coef_components, component_offsets)</pre>
<pre id='line1081' class='code' style='background-color: #FFFF4f'>
  /* "Cython_shift_calculator.pyx":1081
 * 
 *     def _set_coef_components(self,coef_components, component_offsets):
 *         self._compiled_coef_components = Coef_components(coef_components, component_offsets)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void _bytes_to_ring_components(self, data):
 */
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1081; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_coef_components);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_coef_components);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_coef_components);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_component_offsets);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_component_offsets);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_component_offsets);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Coef_components)), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1081; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_compiled_coef_components);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_compiled_coef_components));
  __pyx_v_self->_compiled_coef_components = ((struct __pyx_obj_17shift_calculators_Coef_components *)__pyx_t_2);
  __pyx_t_2 = 0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_shift_calculator._set_coef_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1082")'> 1082: </pre>
<pre id='line1082' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1083")'> 1083:     cdef void _bytes_to_ring_components(self, data):</pre>
<pre id='line1083' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1083
 *         self._compiled_coef_components = Coef_components(coef_components, component_offsets)
 * 
 *     cdef void _bytes_to_ring_components(self, data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._raw_ring_component_data =  data
 *         self._compiled_ring_components =  <code><</code>Ring_component*> <code><</code>size_t> ctypes.addressof(data)
 */

static void __pyx_f_17shift_calculators_26Fast_ring_shift_calculator__bytes_to_ring_components(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *__pyx_v_self, PyObject *__pyx_v_data) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_ring_components", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1084")'> 1084:         self._raw_ring_component_data =  data</pre>
<pre id='line1084' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":1084
 * 
 *     cdef void _bytes_to_ring_components(self, data):
 *         self._raw_ring_component_data =  data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_ring_components =  <code><</code>Ring_component*> <code><</code>size_t> ctypes.addressof(data)
 *         self._num_ring_components =  len(data)/ sizeof(Ring_component)
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_raw_ring_component_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_raw_ring_component_data);
  __pyx_v_self->_raw_ring_component_data = __pyx_v_data;
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line1085")'> 1085:         self._compiled_ring_components =  &lt;Ring_component*&gt; &lt;size_t&gt; ctypes.addressof(data)</pre>
<pre id='line1085' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":1085
 *     cdef void _bytes_to_ring_components(self, data):
 *         self._raw_ring_component_data =  data
 *         self._compiled_ring_components =  <code><</code>Ring_component*> <code><</code>size_t> ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_ring_components =  len(data)/ sizeof(Ring_component)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1085; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1085; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1085; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1085; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1085; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_self->_compiled_ring_components = ((struct __pyx_t_17shift_calculators_Ring_component *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line1086")'> 1086:         self._num_ring_components =  len(data)/ sizeof(Ring_component)</pre>
<pre id='line1086' class='code' style='background-color: #FFFF73'>
  /* "Cython_shift_calculator.pyx":1086
 *         self._raw_ring_component_data =  data
 *         self._compiled_ring_components =  <code><</code>Ring_component*> <code><</code>size_t> ctypes.addressof(data)
 *         self._num_ring_components =  len(data)/ sizeof(Ring_component)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1086; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_num_ring_components = (__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Ring_component)));

  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Fast_ring_shift_calculator._bytes_to_ring_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_11_set_ring_components(PyObject *__pyx_v_self, PyObject *__pyx_v_ring_components); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_11_set_ring_components(PyObject *__pyx_v_self, PyObject *__pyx_v_ring_components) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_ring_components (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_shift_calculator_10_set_ring_components(((struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_ring_components));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1087")'> 1087: </pre>
<pre id='line1087' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1088")'> 1088: </pre>
<pre id='line1088' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1089")'> 1089:     #TODO: not needed ?</pre>
<pre id='line1089' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1090")'> 1090:     def _set_ring_components(self,ring_components):</pre>
<pre id='line1090' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1090
 * 
 *     #TODO: not needed ?
 *     def _set_ring_components(self,ring_components):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self. _bytes_to_ring_components(ring_components)
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_ring_shift_calculator_10_set_ring_components(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *__pyx_v_self, PyObject *__pyx_v_ring_components) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_ring_components", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1091")'> 1091:         self. _bytes_to_ring_components(ring_components)</pre>
<pre id='line1091' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":1091
 *     #TODO: not needed ?
 *     def _set_ring_components(self,ring_components):
 *         self. _bytes_to_ring_components(ring_components)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  ((struct __pyx_vtabstruct_17shift_calculators_Fast_ring_shift_calculator *)__pyx_v_self->__pyx_base.__pyx_vtab)->_bytes_to_ring_components(__pyx_v_self, __pyx_v_ring_components);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1092")'> 1092: </pre>
<pre id='line1092' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1093")'> 1093: </pre>
<pre id='line1093' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1094")'> 1094: </pre>
<pre id='line1094' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1095")'> 1095:     @cython.profile(False)</pre>
<pre id='line1095' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1096")'> 1096:     cdef inline Vec3* _get_ring_normal(self, int ring_id) nogil:</pre>
<pre id='line1096' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1096
 * 
 *     @cython.profile(False)
 *     cdef inline Vec3* _get_ring_normal(self, int ring_id) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return  self._normal_cache.get(ring_id)
 * 
 */

static CYTHON_INLINE Vec3 *__pyx_f_17shift_calculators_26Fast_ring_shift_calculator__get_ring_normal(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *__pyx_v_self, int __pyx_v_ring_id) {
  Vec3 *__pyx_r;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1097")'> 1097:         return  self._normal_cache.get(ring_id)</pre>
<pre id='line1097' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1097
 *     @cython.profile(False)
 *     cdef inline Vec3* _get_ring_normal(self, int ring_id) nogil:
 *         return  self._normal_cache.get(ring_id)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     @cython.profile(False)
 */
  __pyx_r = __pyx_f_17shift_calculators_9Vec3_list_get(__pyx_v_self->_normal_cache, __pyx_v_ring_id);
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1098")'> 1098: </pre>
<pre id='line1098' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1099")'> 1099:     @cython.profile(False)</pre>
<pre id='line1099' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1100")'> 1100:     cdef inline Vec3* _get_ring_centre(self, int ring_id) nogil:</pre>
<pre id='line1100' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1100
 * 
 *     @cython.profile(False)
 *     cdef inline Vec3* _get_ring_centre(self, int ring_id) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return  self._centre_cache.get(ring_id)
 * 
 */

static CYTHON_INLINE Vec3 *__pyx_f_17shift_calculators_26Fast_ring_shift_calculator__get_ring_centre(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *__pyx_v_self, int __pyx_v_ring_id) {
  Vec3 *__pyx_r;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1101")'> 1101:         return  self._centre_cache.get(ring_id)</pre>
<pre id='line1101' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1101
 *     @cython.profile(False)
 *     cdef inline Vec3* _get_ring_centre(self, int ring_id) nogil:
 *         return  self._centre_cache.get(ring_id)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef float _calc_sub_component_shift(self, int target_atom_id, int ring_id, float coefficient) nogil:
 */
  __pyx_r = __pyx_f_17shift_calculators_9Vec3_list_get(__pyx_v_self->_centre_cache, __pyx_v_ring_id);
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1102")'> 1102: </pre>
<pre id='line1102' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1103")'> 1103:     cdef float _calc_sub_component_shift(self, int target_atom_id, int ring_id, float coefficient) nogil:</pre>
<pre id='line1103' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1103
 *         return  self._centre_cache.get(ring_id)
 * 
 *     cdef float _calc_sub_component_shift(self, int target_atom_id, int ring_id, float coefficient) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Vec3 target_atom_pos
 */

static float __pyx_f_17shift_calculators_26Fast_ring_shift_calculator__calc_sub_component_shift(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *__pyx_v_self, int __pyx_v_target_atom_id, int __pyx_v_ring_id, float __pyx_v_coefficient) {
  Vec3 __pyx_v_target_atom_pos;
  Vec3 __pyx_v_ring_centre;
  Vec3 __pyx_v_ring_normal;
  float __pyx_v_length_normal;
  Vec3 __pyx_v_direction_vector;
  float __pyx_v_distance;
  float __pyx_v_distance3;
  float __pyx_v_angle;
  float __pyx_v_contrib;
  float __pyx_r;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1104")'> 1104: </pre>
<pre id='line1104' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1105")'> 1105:         cdef Vec3 target_atom_pos</pre>
<pre id='line1105' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1106")'> 1106:         cdef Vec3 ring_centre</pre>
<pre id='line1106' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1107")'> 1107:         cdef Vec3 ring_normal</pre>
<pre id='line1107' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1108")'> 1108:         cdef float length_normal</pre>
<pre id='line1108' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1109")'> 1109:         cdef Vec3 direction_vector</pre>
<pre id='line1109' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1110")'> 1110:         cdef float distance, distance3, angle, contrib</pre>
<pre id='line1110' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1111")'> 1111: </pre>
<pre id='line1111' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1112")'> 1112:         target_atom_pos =  self._simulation[0].atomPos(target_atom_id)</pre>
<pre id='line1112' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1112
 *         cdef float distance, distance3, angle, contrib
 * 
 *         target_atom_pos =  self._simulation[0].atomPos(target_atom_id)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         ring_centre = self._get_ring_centre(ring_id)[0]
 * 
 */
  __pyx_v_target_atom_pos = (__pyx_v_self->__pyx_base._simulation[0]).atomPos(__pyx_v_target_atom_id);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1113")'> 1113:         ring_centre = self._get_ring_centre(ring_id)[0]</pre>
<pre id='line1113' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1113
 * 
 *         target_atom_pos =  self._simulation[0].atomPos(target_atom_id)
 *         ring_centre = self._get_ring_centre(ring_id)[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         #TODO add this to a cache the same way that camshift does
 */
  __pyx_v_ring_centre = (__pyx_f_17shift_calculators_26Fast_ring_shift_calculator__get_ring_centre(__pyx_v_self, __pyx_v_ring_id)[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1114")'> 1114: </pre>
<pre id='line1114' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1115")'> 1115:         #TODO add this to a cache the same way that camshift does</pre>
<pre id='line1115' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1116")'> 1116:         ring_normal = self._get_ring_normal(ring_id)[0]</pre>
<pre id='line1116' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1116
 * 
 *         #TODO add this to a cache the same way that camshift does
 *         ring_normal = self._get_ring_normal(ring_id)[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         length_normal = norm(ring_normal)
 * #
 */
  __pyx_v_ring_normal = (__pyx_f_17shift_calculators_26Fast_ring_shift_calculator__get_ring_normal(__pyx_v_self, __pyx_v_ring_id)[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1117")'> 1117:         length_normal = norm(ring_normal)</pre>
<pre id='line1117' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1117
 *         #TODO add this to a cache the same way that camshift does
 *         ring_normal = self._get_ring_normal(ring_id)[0]
 *         length_normal = norm(ring_normal)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #
 *         #correct name?
 */
  __pyx_v_length_normal = norm(__pyx_v_ring_normal);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1118")'> 1118: #</pre>
<pre id='line1118' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1119")'> 1119:         #correct name?</pre>
<pre id='line1119' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1120")'> 1120:         direction_vector = target_atom_pos - ring_centre</pre>
<pre id='line1120' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1120
 * #
 *         #correct name?
 *         direction_vector = target_atom_pos - ring_centre             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         distance = norm(direction_vector)
 */
  __pyx_v_direction_vector = (__pyx_v_target_atom_pos - __pyx_v_ring_centre);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1121")'> 1121: </pre>
<pre id='line1121' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1122")'> 1122:         distance = norm(direction_vector)</pre>
<pre id='line1122' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1122
 *         direction_vector = target_atom_pos - ring_centre
 * 
 *         distance = norm(direction_vector)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         distance3 = distance ** 3
 * 
 */
  __pyx_v_distance = norm(__pyx_v_direction_vector);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1123")'> 1123:         distance3 = distance ** 3</pre>
<pre id='line1123' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1123
 * 
 *         distance = norm(direction_vector)
 *         distance3 = distance ** 3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         angle = dot(direction_vector, ring_normal) / (distance * length_normal)
 */
  __pyx_v_distance3 = powf(__pyx_v_distance, 3.0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1124")'> 1124: </pre>
<pre id='line1124' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1125")'> 1125:         angle = dot(direction_vector, ring_normal) / (distance * length_normal)</pre>
<pre id='line1125' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1125
 *         distance3 = distance ** 3
 * 
 *         angle = dot(direction_vector, ring_normal) / (distance * length_normal)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         contrib = (1.0 - 3.0 * angle ** 2) / distance3
 * 
 */
  __pyx_v_angle = (dot(__pyx_v_direction_vector, __pyx_v_ring_normal) / (__pyx_v_distance * __pyx_v_length_normal));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1126")'> 1126:         contrib = (1.0 - 3.0 * angle ** 2) / distance3</pre>
<pre id='line1126' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1126
 * 
 *         angle = dot(direction_vector, ring_normal) / (distance * length_normal)
 *         contrib = (1.0 - 3.0 * angle ** 2) / distance3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         return contrib * coefficient
 */
  __pyx_v_contrib = ((1.0 - (3.0 * powf(__pyx_v_angle, 2.0))) / __pyx_v_distance3);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1127")'> 1127: </pre>
<pre id='line1127' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1128")'> 1128:         return contrib * coefficient</pre>
<pre id='line1128' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1128
 *         contrib = (1.0 - 3.0 * angle ** 2) / distance3
 * 
 *         return contrib * coefficient             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #
 */
  __pyx_r = (__pyx_v_contrib * __pyx_v_coefficient);
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1129")'> 1129: </pre>
<pre id='line1129' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1130")'> 1130: #</pre>
<pre id='line1130' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1131")'> 1131:     cdef void calc (self, cmap[int,uintptr_t] *components, CDSSharedVectorFloat shift_cache, int[:] component_to_target, int[:] active_components) nogil:</pre>
<pre id='line1131' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1131
 * 
 * #
 *     cdef void calc (self, cmap[int,uintptr_t] *components, CDSSharedVectorFloat shift_cache, int[:] component_to_target, int[:] active_components) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef CDSVector[double]  *results = shift_cache.get_data()
 *         cdef int target_atom_id
 */

static void __pyx_f_17shift_calculators_26Fast_ring_shift_calculator_calc(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *__pyx_v_self, std::map<code><</code>int,uintptr_t> *__pyx_v_components, struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_shift_cache, __Pyx_memviewslice __pyx_v_component_to_target, __Pyx_memviewslice __pyx_v_active_components) {
  CDSVector<code><</code>double> *__pyx_v_results;
  int __pyx_v_target_atom_id;
  int __pyx_v_atom_type_id;
  int __pyx_v_ring_id;
  float __pyx_v_coefficient;
  struct __pyx_t_17shift_calculators_Component_Offsets *__pyx_v_coeff_offset;
  struct __pyx_t_17shift_calculators_Coef_component *__pyx_v_coef_component;
  int __pyx_v_factor_index;
  int __pyx_v_component_index;
  int __pyx_v_offset;
  double __pyx_v_shift;
  int __pyx_v_coef_offset;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1132")'> 1132:         cdef CDSVector[double]  *results = shift_cache.get_data()</pre>
<pre id='line1132' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1132
 * #
 *     cdef void calc (self, cmap[int,uintptr_t] *components, CDSSharedVectorFloat shift_cache, int[:] component_to_target, int[:] active_components) nogil:
 *         cdef CDSVector[double]  *results = shift_cache.get_data()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int target_atom_id
 *         cdef int atom_type_id
 */
  __pyx_v_results = ((struct __pyx_vtabstruct_17shift_calculators_CDSSharedVectorFloat *)__pyx_v_shift_cache->__pyx_vtab)->get_data(__pyx_v_shift_cache);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1133")'> 1133:         cdef int target_atom_id</pre>
<pre id='line1133' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1134")'> 1134:         cdef int atom_type_id</pre>
<pre id='line1134' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1135")'> 1135:         cdef int ring_id</pre>
<pre id='line1135' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1136")'> 1136:         cdef float coefficient</pre>
<pre id='line1136' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1137")'> 1137:         cdef Component_Offsets* coeff_offset</pre>
<pre id='line1137' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1138")'> 1138:         cdef Coef_component* coef_component</pre>
<pre id='line1138' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1139")'> 1139: </pre>
<pre id='line1139' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1140")'> 1140:         cdef int factor_index</pre>
<pre id='line1140' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1141")'> 1141:         cdef int component_index</pre>
<pre id='line1141' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1142")'> 1142:         cdef int offset</pre>
<pre id='line1142' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1143")'> 1143: </pre>
<pre id='line1143' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1144")'> 1144:         self._set_components(components)</pre>
<pre id='line1144' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1144
 *         cdef int offset
 * 
 *         self._set_components(components)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         for factor_index in range(active_components.shape[0]):
 */
  ((struct __pyx_vtabstruct_17shift_calculators_Fast_ring_shift_calculator *)__pyx_v_self->__pyx_base.__pyx_vtab)->__pyx_base._set_components(((struct __pyx_obj_17shift_calculators_Base_shift_calculator *)__pyx_v_self), __pyx_v_components);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1145")'> 1145: </pre>
<pre id='line1145' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1146")'> 1146:         for factor_index in range(active_components.shape[0]):</pre>
<pre id='line1146' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1146
 *         self._set_components(components)
 * 
 *         for factor_index in range(active_components.shape[0]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             component_index = active_components[factor_index]
 * 
 */
  __pyx_t_1 = (__pyx_v_active_components.shape[0]);
  for (__pyx_t_2 = 0; __pyx_t_2 <code><</code> __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_factor_index = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1147")'> 1147:             component_index = active_components[factor_index]</pre>
<pre id='line1147' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1147
 * 
 *         for factor_index in range(active_components.shape[0]):
 *             component_index = active_components[factor_index]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             target_atom_id = self._compiled_components[component_index].target_atom_id
 */
    __pyx_t_3 = __pyx_v_factor_index;
    __pyx_v_component_index = (*((int *) ( /* dim=0 */ (__pyx_v_active_components.data + __pyx_t_3 * __pyx_v_active_components.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1148")'> 1148: </pre>
<pre id='line1148' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1149")'> 1149:             target_atom_id = self._compiled_components[component_index].target_atom_id</pre>
<pre id='line1149' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1149
 *             component_index = active_components[factor_index]
 * 
 *             target_atom_id = self._compiled_components[component_index].target_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             atom_type_id = self._compiled_components[component_index].atom_type_id
 * 
 */
    __pyx_t_4 = (__pyx_v_self->_compiled_components[__pyx_v_component_index]).target_atom_id;
    __pyx_v_target_atom_id = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1150")'> 1150:             atom_type_id = self._compiled_components[component_index].atom_type_id</pre>
<pre id='line1150' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1150
 * 
 *             target_atom_id = self._compiled_components[component_index].target_atom_id
 *             atom_type_id = self._compiled_components[component_index].atom_type_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             shift = 0.0
 */
    __pyx_t_4 = (__pyx_v_self->_compiled_components[__pyx_v_component_index]).atom_type_id;
    __pyx_v_atom_type_id = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1151")'> 1151: </pre>
<pre id='line1151' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1152")'> 1152:             shift = 0.0</pre>
<pre id='line1152' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1152
 *             atom_type_id = self._compiled_components[component_index].atom_type_id
 * 
 *             shift = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             coeff_offset =  self._compiled_coef_components.get_id_offsets(atom_type_id)
 */
    __pyx_v_shift = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1153")'> 1153: </pre>
<pre id='line1153' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1154")'> 1154:             coeff_offset =  self._compiled_coef_components.get_id_offsets(atom_type_id)</pre>
<pre id='line1154' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1154
 *             shift = 0.0
 * 
 *             coeff_offset =  self._compiled_coef_components.get_id_offsets(atom_type_id)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             for coef_offset in range(coeff_offset[0].offset,coeff_offset[0].offset+coeff_offset[0].length):
 */
    __pyx_v_coeff_offset = __pyx_f_17shift_calculators_15Coef_components_get_id_offsets(__pyx_v_self->_compiled_coef_components, __pyx_v_atom_type_id);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1155")'> 1155: </pre>
<pre id='line1155' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1156")'> 1156:             for coef_offset in range(coeff_offset[0].offset,coeff_offset[0].offset+coeff_offset[0].length):</pre>
<pre id='line1156' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1156
 *             coeff_offset =  self._compiled_coef_components.get_id_offsets(atom_type_id)
 * 
 *             for coef_offset in range(coeff_offset[0].offset,coeff_offset[0].offset+coeff_offset[0].length):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #                TODO: remove magic numbers or add structs
 *                 coef_component = self._compiled_coef_components.get_component(coef_offset)
 */
    __pyx_t_4 = ((__pyx_v_coeff_offset[0]).offset + (__pyx_v_coeff_offset[0]).length);
    for (__pyx_t_5 = (__pyx_v_coeff_offset[0]).offset; __pyx_t_5 <code><</code> __pyx_t_4; __pyx_t_5+=1) {
      __pyx_v_coef_offset = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1157")'> 1157: #                TODO: remove magic numbers or add structs</pre>
<pre id='line1157' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1158")'> 1158:                 coef_component = self._compiled_coef_components.get_component(coef_offset)</pre>
<pre id='line1158' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1158
 *             for coef_offset in range(coeff_offset[0].offset,coeff_offset[0].offset+coeff_offset[0].length):
 * #                TODO: remove magic numbers or add structs
 *                 coef_component = self._compiled_coef_components.get_component(coef_offset)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 ring_id = coef_component[0].ring_id
 */
      __pyx_v_coef_component = __pyx_f_17shift_calculators_15Coef_components_get_component(__pyx_v_self->_compiled_coef_components, __pyx_v_coef_offset);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1159")'> 1159: </pre>
<pre id='line1159' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1160")'> 1160:                 ring_id = coef_component[0].ring_id</pre>
<pre id='line1160' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1160
 *                 coef_component = self._compiled_coef_components.get_component(coef_offset)
 * 
 *                 ring_id = coef_component[0].ring_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 coefficient = coef_component[0].coefficient
 *                 shift += self._calc_sub_component_shift(target_atom_id,  ring_id, coefficient)
 */
      __pyx_t_6 = (__pyx_v_coef_component[0]).ring_id;
      __pyx_v_ring_id = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1161")'> 1161:                 coefficient = coef_component[0].coefficient</pre>
<pre id='line1161' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1161
 * 
 *                 ring_id = coef_component[0].ring_id
 *                 coefficient = coef_component[0].coefficient             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 shift += self._calc_sub_component_shift(target_atom_id,  ring_id, coefficient)
 * 
 */
      __pyx_t_7 = (__pyx_v_coef_component[0]).coefficient;
      __pyx_v_coefficient = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1162")'> 1162:                 shift += self._calc_sub_component_shift(target_atom_id,  ring_id, coefficient)</pre>
<pre id='line1162' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1162
 *                 ring_id = coef_component[0].ring_id
 *                 coefficient = coef_component[0].coefficient
 *                 shift += self._calc_sub_component_shift(target_atom_id,  ring_id, coefficient)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             offset = self.ensemble_array_offset(component_to_target[factor_index])
 */
      __pyx_v_shift = (__pyx_v_shift + ((struct __pyx_vtabstruct_17shift_calculators_Fast_ring_shift_calculator *)__pyx_v_self->__pyx_base.__pyx_vtab)->_calc_sub_component_shift(__pyx_v_self, __pyx_v_target_atom_id, __pyx_v_ring_id, __pyx_v_coefficient));
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1163")'> 1163: </pre>
<pre id='line1163' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1164")'> 1164:             offset = self.ensemble_array_offset(component_to_target[factor_index])</pre>
<pre id='line1164' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1164
 *                 shift += self._calc_sub_component_shift(target_atom_id,  ring_id, coefficient)
 * 
 *             offset = self.ensemble_array_offset(component_to_target[factor_index])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             results[0][offset] += shift
 * 
 */
    __pyx_t_4 = __pyx_v_factor_index;
    __pyx_v_offset = __pyx_f_17shift_calculators_21Base_shift_calculator_ensemble_array_offset(((struct __pyx_obj_17shift_calculators_Base_shift_calculator *)__pyx_v_self), (*((int *) ( /* dim=0 */ (__pyx_v_component_to_target.data + __pyx_t_4 * __pyx_v_component_to_target.strides[0]) ))));
</pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line1165")'> 1165:             results[0][offset] += shift</pre>
<pre id='line1165' class='code' style='background-color: #FFFF4d'>
    /* "Cython_shift_calculator.pyx":1165
 * 
 *             offset = self.ensemble_array_offset(component_to_target[factor_index])
 *             results[0][offset] += shift             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_t_8 = 0;
    __pyx_t_5 = __pyx_v_offset;
    ((__pyx_v_results[__pyx_t_8])[__pyx_t_5]) = (((__pyx_v_results[__pyx_t_8])[__pyx_t_5]) + __pyx_v_shift);
  }

}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_25Fast_ring_data_calculator_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_25Fast_ring_data_calculator_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_simulation = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__simulation,0};
    PyObject* values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__simulation)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1175; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 1) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
    }
    __pyx_v_simulation = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 1, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1175; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_data_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_25Fast_ring_data_calculator___init__(((struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *)__pyx_v_self), __pyx_v_simulation);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1166")'> 1166: </pre>
<pre id='line1166' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1167")'> 1167: </pre>
<pre id='line1167' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1168")'> 1168: #</pre>
<pre id='line1168' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1169")'> 1169: cdef int RING_ATOM_IDS = 1</pre>
<pre id='line1169' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1169
 * 
 * #
 * cdef int RING_ATOM_IDS = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef class Fast_ring_data_calculator:
 */
  __pyx_v_17shift_calculators_RING_ATOM_IDS = 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1170")'> 1170: </pre>
<pre id='line1170' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1171")'> 1171: cdef class Fast_ring_data_calculator:</pre>
<pre id='line1171' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1171
 * cdef int RING_ATOM_IDS = 1
 * 
 * cdef class Fast_ring_data_calculator:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef bint _verbose
 *     cdef EnsembleSimulation* _simulation
 */
struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator {
  PyObject_HEAD
  struct __pyx_vtabstruct_17shift_calculators_Fast_ring_data_calculator *__pyx_vtab;
  int _verbose;
  EnsembleSimulation *_simulation;
};


/* "Cython_shift_calculator.pyx":1171
 * cdef int RING_ATOM_IDS = 1
 * 
 * cdef class Fast_ring_data_calculator:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef bint _verbose
 *     cdef EnsembleSimulation* _simulation
 */

struct __pyx_vtabstruct_17shift_calculators_Fast_ring_data_calculator {
  void (*_calculate_one_ring_centre)(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *, PyObject *, Vec3 *);
  void (*_calculate_normal)(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *, int *, Vec3 *);
  void (*_calculate_one_ring_normal)(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *, PyObject *, Vec3 *);
  void (*_build_atom_triplet)(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *, PyObject *, int *);
  void (*_average_2_vec_3)(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *, Vec3 &, Vec3 &, Vec3 *);
};
static struct __pyx_vtabstruct_17shift_calculators_Fast_ring_data_calculator *__pyx_vtabptr_17shift_calculators_Fast_ring_data_calculator;
static CYTHON_INLINE void __pyx_f_17shift_calculators_25Fast_ring_data_calculator__calculate_one_ring_centre(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *, PyObject *, Vec3 *);
static CYTHON_INLINE void __pyx_f_17shift_calculators_25Fast_ring_data_calculator__calculate_normal(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *, int *, Vec3 *);
static CYTHON_INLINE void __pyx_f_17shift_calculators_25Fast_ring_data_calculator__calculate_one_ring_normal(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *, PyObject *, Vec3 *);
static CYTHON_INLINE void __pyx_f_17shift_calculators_25Fast_ring_data_calculator__build_atom_triplet(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *, PyObject *, int *);
static CYTHON_INLINE void __pyx_f_17shift_calculators_25Fast_ring_data_calculator__average_2_vec_3(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *, Vec3 &, Vec3 &, Vec3 *);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1172")'> 1172:     cdef bint _verbose</pre>
<pre id='line1172' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1173")'> 1173:     cdef EnsembleSimulation* _simulation</pre>
<pre id='line1173' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1174")'> 1174: </pre>
<pre id='line1174' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1175")'> 1175:     def __init__(self,simulation):</pre>
<pre id='line1175' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1175
 *     cdef EnsembleSimulation* _simulation
 * 
 *     def __init__(self,simulation):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._verbose = False
 *         self._simulation = simulationAsNative(simulation)
 */

static int __pyx_pf_17shift_calculators_25Fast_ring_data_calculator___init__(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *__pyx_v_self, PyObject *__pyx_v_simulation) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1176")'> 1176:         self._verbose = False</pre>
<pre id='line1176' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1176
 * 
 *     def __init__(self,simulation):
 *         self._verbose = False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._simulation = simulationAsNative(simulation)
 * 
 */
  __pyx_v_self->_verbose = 0;
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line1177")'> 1177:         self._simulation = simulationAsNative(simulation)</pre>
<pre id='line1177' class='code' style='background-color: #FFFFb6'>
  /* "Cython_shift_calculator.pyx":1177
 *     def __init__(self,simulation):
 *         self._verbose = False
 *         self._simulation = simulationAsNative(simulation)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_1 = __pyx_f_17shift_calculators_simulationAsNative(__pyx_v_simulation);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1177; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_simulation = __pyx_t_1;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_data_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_25Fast_ring_data_calculator_3set_verbose(PyObject *__pyx_v_self, PyObject *__pyx_v_on); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_25Fast_ring_data_calculator_3set_verbose(PyObject *__pyx_v_self, PyObject *__pyx_v_on) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_verbose (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_25Fast_ring_data_calculator_2set_verbose(((struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_on));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1178")'> 1178: </pre>
<pre id='line1178' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1179")'> 1179: </pre>
<pre id='line1179' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1180")'> 1180:     def set_verbose(self,on):</pre>
<pre id='line1180' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1180
 * 
 * 
 *     def set_verbose(self,on):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._verbose =  on
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_25Fast_ring_data_calculator_2set_verbose(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *__pyx_v_self, PyObject *__pyx_v_on) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_verbose", 0);
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line1181")'> 1181:         self._verbose =  on</pre>
<pre id='line1181' class='code' style='background-color: #FFFF6a'>
  /* "Cython_shift_calculator.pyx":1181
 * 
 *     def set_verbose(self,on):
 *         self._verbose =  on             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline void _calculate_one_ring_centre(self, ring_component, Vec3* result):
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_v_on);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_verbose = __pyx_t_1;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_data_calculator.set_verbose", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1182")'> 1182: </pre>
<pre id='line1182' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1183")'> 1183:     cdef inline void _calculate_one_ring_centre(self, ring_component, Vec3* result):</pre>
<pre id='line1183' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1183
 *         self._verbose =  on
 * 
 *     cdef inline void _calculate_one_ring_centre(self, ring_component, Vec3* result):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         atom_ids = ring_component[RING_ATOM_IDS]
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_25Fast_ring_data_calculator__calculate_one_ring_centre(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *__pyx_v_self, PyObject *__pyx_v_ring_component, Vec3 *__pyx_v_result) {
  PyObject *__pyx_v_atom_ids = NULL;
  float __pyx_v_num_atom_ids;
  int __pyx_v_atom_id;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calculate_one_ring_centre", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1184")'> 1184: </pre>
<pre id='line1184' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1185")'> 1185:         atom_ids = ring_component[RING_ATOM_IDS]</pre>
<pre id='line1185' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":1185
 *     cdef inline void _calculate_one_ring_centre(self, ring_component, Vec3* result):
 * 
 *         atom_ids = ring_component[RING_ATOM_IDS]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef float num_atom_ids = len(atom_ids)
 *         cdef Vec3 total
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_ring_component, __pyx_v_17shift_calculators_RING_ATOM_IDS, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_atom_ids = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1186")'> 1186:         cdef float num_atom_ids = len(atom_ids)</pre>
<pre id='line1186' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":1186
 * 
 *         atom_ids = ring_component[RING_ATOM_IDS]
 *         cdef float num_atom_ids = len(atom_ids)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3 total
 *         cdef int atom_id
 */
  __pyx_t_2 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_atom_ids);<span class='error_goto'> if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_num_atom_ids = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1187")'> 1187:         cdef Vec3 total</pre>
<pre id='line1187' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1188")'> 1188:         cdef int atom_id</pre>
<pre id='line1188' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1189")'> 1189: </pre>
<pre id='line1189' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1190")'> 1190:         result[0]=Vec3(0.0,0.0,0.0)</pre>
<pre id='line1190' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1190
 *         cdef int atom_id
 * 
 *         result[0]=Vec3(0.0,0.0,0.0)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for atom_id in atom_ids:
 *             result[0] += self._simulation.atomPos(atom_id)
 */
  (__pyx_v_result[0]) = Vec3(0.0, 0.0, 0.0);
</pre><pre class='line' style='background-color: #FFFF24' onclick='toggleDiv("line1191")'> 1191:         for atom_id in atom_ids:</pre>
<pre id='line1191' class='code' style='background-color: #FFFF24'>
  /* "Cython_shift_calculator.pyx":1191
 * 
 *         result[0]=Vec3(0.0,0.0,0.0)
 *         for atom_id in atom_ids:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             result[0] += self._simulation.atomPos(atom_id)
 * 
 */
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_atom_ids) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_atom_ids)) {
    __pyx_t_1 = __pyx_v_atom_ids; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_atom_ids);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext;
  }
  for (;;) {
    if (!__pyx_t_3 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_3 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    }
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_atom_id = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1192")'> 1192:             result[0] += self._simulation.atomPos(atom_id)</pre>
<pre id='line1192' class='code' style='background-color: #FFFFe7'>
    /* "Cython_shift_calculator.pyx":1192
 *         result[0]=Vec3(0.0,0.0,0.0)
 *         for atom_id in atom_ids:
 *             result[0] += self._simulation.atomPos(atom_id)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         operator_times(result[0],1.0/float(num_atom_ids))
 */
    (__pyx_v_result[0]) += __pyx_v_self->_simulation->atomPos(__pyx_v_atom_id);
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1193")'> 1193: </pre>
<pre id='line1193' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line1194")'> 1194:         operator_times(result[0],1.0/float(num_atom_ids))</pre>
<pre id='line1194' class='code' style='background-color: #FFFF9f'>
  /* "Cython_shift_calculator.pyx":1194
 *             result[0] += self._simulation.atomPos(atom_id)
 * 
 *         operator_times(result[0],1.0/float(num_atom_ids))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #
 */
  __pyx_f_17shift_calculators_operator_times((__pyx_v_result[0]), (1.0 / ((double)__pyx_v_num_atom_ids)));

  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Fast_ring_data_calculator._calculate_one_ring_centre", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_atom_ids);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1195")'> 1195: </pre>
<pre id='line1195' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1196")'> 1196: #</pre>
<pre id='line1196' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1197")'> 1197: </pre>
<pre id='line1197' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1198")'> 1198: </pre>
<pre id='line1198' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1199")'> 1199: </pre>
<pre id='line1199' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1200")'> 1200: #    def _check_ring_size_ok(self, atom_ids):</pre>
<pre id='line1200' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1201")'> 1201: #        num_atom_ids = len(atom_ids)</pre>
<pre id='line1201' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1202")'> 1202: #        if num_atom_ids &lt; 5 or num_atom_ids &gt; 6:</pre>
<pre id='line1202' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1203")'> 1203: #            template = "ring normals function is only implemented for 5 or six member rings i got %d atoms"</pre>
<pre id='line1203' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1204")'> 1204: #            msg = template % num_atom_ids</pre>
<pre id='line1204' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1205")'> 1205: #            raise Exception(msg)</pre>
<pre id='line1205' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1206")'> 1206: #</pre>
<pre id='line1206' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1207")'> 1207: </pre>
<pre id='line1207' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1208")'> 1208:     cdef inline void  _calculate_normal(self, int[3] atom_id_triplet, Vec3* result):</pre>
<pre id='line1208' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1208
 * #
 * 
 *     cdef inline void  _calculate_normal(self, int[3] atom_id_triplet, Vec3* result):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Vec3 normal
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_25Fast_ring_data_calculator__calculate_normal(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *__pyx_v_self, int *__pyx_v_atom_id_triplet, Vec3 *__pyx_v_result) {
  Vec3 __pyx_v_vec_1;
  Vec3 __pyx_v_vec_2;
  Vec3 __pyx_v_atom_vector_1;
  Vec3 __pyx_v_atom_vector_2;
  Vec3 __pyx_v_atom_vector_3;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calculate_normal", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1209")'> 1209: </pre>
<pre id='line1209' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1210")'> 1210:         cdef Vec3 normal</pre>
<pre id='line1210' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1211")'> 1211:         cdef Vec3 vec_1</pre>
<pre id='line1211' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1212")'> 1212:         cdef Vec3 vec_2</pre>
<pre id='line1212' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1213")'> 1213: </pre>
<pre id='line1213' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1214")'> 1214:         cdef Vec3 atom_vector_1, atom_vector_2, atom_vector_3</pre>
<pre id='line1214' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1215")'> 1215: </pre>
<pre id='line1215' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1216")'> 1216:         atom_vector_1 = self._simulation[0].atomPos(atom_id_triplet[0])</pre>
<pre id='line1216' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1216
 *         cdef Vec3 atom_vector_1, atom_vector_2, atom_vector_3
 * 
 *         atom_vector_1 = self._simulation[0].atomPos(atom_id_triplet[0])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         atom_vector_2 = self._simulation[0].atomPos(atom_id_triplet[1])
 *         atom_vector_3 = self._simulation[0].atomPos(atom_id_triplet[2])
 */
  __pyx_v_atom_vector_1 = (__pyx_v_self->_simulation[0]).atomPos((__pyx_v_atom_id_triplet[0]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1217")'> 1217:         atom_vector_2 = self._simulation[0].atomPos(atom_id_triplet[1])</pre>
<pre id='line1217' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1217
 * 
 *         atom_vector_1 = self._simulation[0].atomPos(atom_id_triplet[0])
 *         atom_vector_2 = self._simulation[0].atomPos(atom_id_triplet[1])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         atom_vector_3 = self._simulation[0].atomPos(atom_id_triplet[2])
 * 
 */
  __pyx_v_atom_vector_2 = (__pyx_v_self->_simulation[0]).atomPos((__pyx_v_atom_id_triplet[1]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1218")'> 1218:         atom_vector_3 = self._simulation[0].atomPos(atom_id_triplet[2])</pre>
<pre id='line1218' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1218
 *         atom_vector_1 = self._simulation[0].atomPos(atom_id_triplet[0])
 *         atom_vector_2 = self._simulation[0].atomPos(atom_id_triplet[1])
 *         atom_vector_3 = self._simulation[0].atomPos(atom_id_triplet[2])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         vec_1 =  atom_vector_1 -atom_vector_2
 */
  __pyx_v_atom_vector_3 = (__pyx_v_self->_simulation[0]).atomPos((__pyx_v_atom_id_triplet[2]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1219")'> 1219: </pre>
<pre id='line1219' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1220")'> 1220:         vec_1 =  atom_vector_1 -atom_vector_2</pre>
<pre id='line1220' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1220
 *         atom_vector_3 = self._simulation[0].atomPos(atom_id_triplet[2])
 * 
 *         vec_1 =  atom_vector_1 -atom_vector_2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         vec_2 =  atom_vector_3- atom_vector_2
 * 
 */
  __pyx_v_vec_1 = (__pyx_v_atom_vector_1 - __pyx_v_atom_vector_2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1221")'> 1221:         vec_2 =  atom_vector_3- atom_vector_2</pre>
<pre id='line1221' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1221
 * 
 *         vec_1 =  atom_vector_1 -atom_vector_2
 *         vec_2 =  atom_vector_3- atom_vector_2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         result[0] =  cross(vec_1,vec_2)
 */
  __pyx_v_vec_2 = (__pyx_v_atom_vector_3 - __pyx_v_atom_vector_2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1222")'> 1222: </pre>
<pre id='line1222' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1223")'> 1223:         result[0] =  cross(vec_1,vec_2)</pre>
<pre id='line1223' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":1223
 *         vec_2 =  atom_vector_3- atom_vector_2
 * 
 *         result[0] =  cross(vec_1,vec_2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     #TODO could try newells method http://www.opengl.org/wiki/Calculating_a_Surface_Normal
 */
  (__pyx_v_result[0]) = cross(__pyx_v_vec_1, __pyx_v_vec_2);

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1224")'> 1224: </pre>
<pre id='line1224' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1225")'> 1225:     #TODO could try newells method http://www.opengl.org/wiki/Calculating_a_Surface_Normal</pre>
<pre id='line1225' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1226")'> 1226:     cdef inline  void  _calculate_one_ring_normal(self, ring_component, Vec3* result):</pre>
<pre id='line1226' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1226
 * 
 *     #TODO could try newells method http://www.opengl.org/wiki/Calculating_a_Surface_Normal
 *     cdef inline  void  _calculate_one_ring_normal(self, ring_component, Vec3* result):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         atom_ids = ring_component[RING_ATOM_IDS]
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_25Fast_ring_data_calculator__calculate_one_ring_normal(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *__pyx_v_self, PyObject *__pyx_v_ring_component, Vec3 *__pyx_v_result) {
  PyObject *__pyx_v_atom_ids = NULL;
  int *__pyx_v_atom_triplet_1;
  int *__pyx_v_atom_triplet_2;
  Vec3 __pyx_v_normal_1;
  Vec3 __pyx_v_normal_2;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calculate_one_ring_normal", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1227")'> 1227: </pre>
<pre id='line1227' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1228")'> 1228:         atom_ids = ring_component[RING_ATOM_IDS]</pre>
<pre id='line1228' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":1228
 *     cdef inline  void  _calculate_one_ring_normal(self, ring_component, Vec3* result):
 * 
 *         atom_ids = ring_component[RING_ATOM_IDS]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #        self._check_ring_size_ok(atom_ids)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_ring_component, __pyx_v_17shift_calculators_RING_ATOM_IDS, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_atom_ids = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1229")'> 1229: #        self._check_ring_size_ok(atom_ids)</pre>
<pre id='line1229' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1230")'> 1230: </pre>
<pre id='line1230' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1231")'> 1231:         cdef int* atom_triplet_1 = [0,0,0]</pre>
<pre id='line1231' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1231
 * #        self._check_ring_size_ok(atom_ids)
 * 
 *         cdef int* atom_triplet_1 = [0,0,0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int* atom_triplet_2 = [0,0,0]
 *         self._build_atom_triplet(atom_ids[:3], atom_triplet_1)
 */
  __pyx_t_2[0] = 0;
  __pyx_t_2[1] = 0;
  __pyx_t_2[2] = 0;
  __pyx_v_atom_triplet_1 = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1232")'> 1232:         cdef int* atom_triplet_2 = [0,0,0]</pre>
<pre id='line1232' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1232
 * 
 *         cdef int* atom_triplet_1 = [0,0,0]
 *         cdef int* atom_triplet_2 = [0,0,0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._build_atom_triplet(atom_ids[:3], atom_triplet_1)
 *         self._build_atom_triplet(atom_ids[-3:], atom_triplet_2)
 */
  __pyx_t_3[0] = 0;
  __pyx_t_3[1] = 0;
  __pyx_t_3[2] = 0;
  __pyx_v_atom_triplet_2 = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line1233")'> 1233:         self._build_atom_triplet(atom_ids[:3], atom_triplet_1)</pre>
<pre id='line1233' class='code' style='background-color: #FFFF9f'>
  /* "Cython_shift_calculator.pyx":1233
 *         cdef int* atom_triplet_1 = [0,0,0]
 *         cdef int* atom_triplet_2 = [0,0,0]
 *         self._build_atom_triplet(atom_ids[:3], atom_triplet_1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._build_atom_triplet(atom_ids[-3:], atom_triplet_2)
 * 
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PySequence_GetSlice</span>(__pyx_v_atom_ids, 0, 3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_f_17shift_calculators_25Fast_ring_data_calculator__build_atom_triplet(__pyx_v_self, __pyx_t_1, __pyx_v_atom_triplet_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line1234")'> 1234:         self._build_atom_triplet(atom_ids[-3:], atom_triplet_2)</pre>
<pre id='line1234' class='code' style='background-color: #FFFF9f'>
  /* "Cython_shift_calculator.pyx":1234
 *         cdef int* atom_triplet_2 = [0,0,0]
 *         self._build_atom_triplet(atom_ids[:3], atom_triplet_1)
 *         self._build_atom_triplet(atom_ids[-3:], atom_triplet_2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PySequence_GetSlice</span>(__pyx_v_atom_ids, -3, PY_SSIZE_T_MAX);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_f_17shift_calculators_25Fast_ring_data_calculator__build_atom_triplet(__pyx_v_self, __pyx_t_1, __pyx_v_atom_triplet_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1235")'> 1235: </pre>
<pre id='line1235' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1236")'> 1236: </pre>
<pre id='line1236' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1237")'> 1237:         cdef Vec3 normal_1</pre>
<pre id='line1237' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1238")'> 1238:         self._calculate_normal(atom_triplet_1, &amp;normal_1)</pre>
<pre id='line1238' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1238
 * 
 *         cdef Vec3 normal_1
 *         self._calculate_normal(atom_triplet_1, &normal_1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3 normal_2
 *         self._calculate_normal(atom_triplet_2,  &normal_2)
 */
  __pyx_f_17shift_calculators_25Fast_ring_data_calculator__calculate_normal(__pyx_v_self, __pyx_v_atom_triplet_1, (&__pyx_v_normal_1));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1239")'> 1239:         cdef Vec3 normal_2</pre>
<pre id='line1239' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1240")'> 1240:         self._calculate_normal(atom_triplet_2,  &amp;normal_2)</pre>
<pre id='line1240' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1240
 *         self._calculate_normal(atom_triplet_1, &normal_1)
 *         cdef Vec3 normal_2
 *         self._calculate_normal(atom_triplet_2,  &normal_2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #         cdef Vec3_container result = Vec3_container()
 */
  __pyx_f_17shift_calculators_25Fast_ring_data_calculator__calculate_normal(__pyx_v_self, __pyx_v_atom_triplet_2, (&__pyx_v_normal_2));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1241")'> 1241: </pre>
<pre id='line1241' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1242")'> 1242: #         cdef Vec3_container result = Vec3_container()</pre>
<pre id='line1242' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1243")'> 1243:         self._average_2_vec_3(normal_1, normal_2, result)</pre>
<pre id='line1243' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":1243
 * 
 * #         cdef Vec3_container result = Vec3_container()
 *         self._average_2_vec_3(normal_1, normal_2, result)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #         result.set_vec3(average)
 * #         return result
 */
  __pyx_f_17shift_calculators_25Fast_ring_data_calculator__average_2_vec_3(__pyx_v_self, __pyx_v_normal_1, __pyx_v_normal_2, __pyx_v_result);

  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Fast_ring_data_calculator._calculate_one_ring_normal", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_atom_ids);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1244")'> 1244: #         result.set_vec3(average)</pre>
<pre id='line1244' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1245")'> 1245: #         return result</pre>
<pre id='line1245' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1246")'> 1246: </pre>
<pre id='line1246' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1247")'> 1247:     cdef inline void  _build_atom_triplet(self,atom_ids, int[3]&amp; result):</pre>
<pre id='line1247' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1247
 * #         return result
 * 
 *     cdef inline void  _build_atom_triplet(self,atom_ids, int[3]& result):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int i
 *         for i in range(3):
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_25Fast_ring_data_calculator__build_atom_triplet(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *__pyx_v_self, PyObject *__pyx_v_atom_ids, int *__pyx_v_result) {
  int __pyx_v_i;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_build_atom_triplet", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1248")'> 1248:         cdef int i</pre>
<pre id='line1248' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1249")'> 1249:         for i in range(3):</pre>
<pre id='line1249' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1249
 *     cdef inline void  _build_atom_triplet(self,atom_ids, int[3]& result):
 *         cdef int i
 *         for i in range(3):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             result[i] = atom_ids[i]
 * 
 */
  for (__pyx_t_1 = 0; __pyx_t_1 <code><</code> 3; __pyx_t_1+=1) {
    __pyx_v_i = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line1250")'> 1250:             result[i] = atom_ids[i]</pre>
<pre id='line1250' class='code' style='background-color: #FFFF5e'>
    /* "Cython_shift_calculator.pyx":1250
 *         cdef int i
 *         for i in range(3):
 *             result[i] = atom_ids[i]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_atom_ids, __pyx_v_i, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1250; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_3 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1250; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    (__pyx_v_result[__pyx_v_i]) = __pyx_t_3;
  }

  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Fast_ring_data_calculator._build_atom_triplet", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1251")'> 1251: </pre>
<pre id='line1251' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1252")'> 1252: </pre>
<pre id='line1252' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1253")'> 1253:     cdef inline void _average_2_vec_3(self, Vec3&amp; vector_1, Vec3&amp; vector_2, Vec3* result):</pre>
<pre id='line1253' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1253
 * 
 * 
 *     cdef inline void _average_2_vec_3(self, Vec3& vector_1, Vec3& vector_2, Vec3* result):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result[0] =  vector_1 + vector_2
 * 
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_25Fast_ring_data_calculator__average_2_vec_3(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *__pyx_v_self, Vec3 &__pyx_v_vector_1, Vec3 &__pyx_v_vector_2, Vec3 *__pyx_v_result) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_average_2_vec_3", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1254")'> 1254:         result[0] =  vector_1 + vector_2</pre>
<pre id='line1254' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1254
 * 
 *     cdef inline void _average_2_vec_3(self, Vec3& vector_1, Vec3& vector_2, Vec3* result):
 *         result[0] =  vector_1 + vector_2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         operator_times(result[0], 1.0/2.0)
 */
  (__pyx_v_result[0]) = (__pyx_v_vector_1 + __pyx_v_vector_2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1255")'> 1255: </pre>
<pre id='line1255' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2d' onclick='toggleDiv("line1256")'> 1256:         operator_times(result[0], 1.0/2.0)</pre>
<pre id='line1256' class='code' style='background-color: #FFFF2d'>
  /* "Cython_shift_calculator.pyx":1256
 *         result[0] =  vector_1 + vector_2
 * 
 *         operator_times(result[0], 1.0/2.0)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_f_17shift_calculators_operator_times((__pyx_v_result[0]), (1.0 / 2.0));

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_25Fast_ring_data_calculator_5__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_25Fast_ring_data_calculator_5__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_rings = 0;
  struct __pyx_obj_17shift_calculators_Vec3_list *__pyx_v_normals = 0;
  struct __pyx_obj_17shift_calculators_Vec3_list *__pyx_v_centres = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__call__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__rings,&__pyx_n_s__normals,&__pyx_n_s__centres,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__rings)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__normals)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 3, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1260; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__centres)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 3, 3, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1260; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__call__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1260; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_rings = values[0];
    __pyx_v_normals = ((struct __pyx_obj_17shift_calculators_Vec3_list *)values[1]);
    __pyx_v_centres = ((struct __pyx_obj_17shift_calculators_Vec3_list *)values[2]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1260; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_data_calculator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_normals), __pyx_ptype_17shift_calculators_Vec3_list, 1, "normals", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_centres), __pyx_ptype_17shift_calculators_Vec3_list, 1, "centres", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_25Fast_ring_data_calculator_4__call__(((struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *)__pyx_v_self), __pyx_v_rings, __pyx_v_normals, __pyx_v_centres);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1257")'> 1257: </pre>
<pre id='line1257' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1258")'> 1258: </pre>
<pre id='line1258' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1259")'> 1259:     @cython.profile(True)</pre>
<pre id='line1259' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1260")'> 1260:     def __call__(self, rings, Vec3_list normals, Vec3_list centres):</pre>
<pre id='line1260' class='code' style='background-color: #FFFFd4'>
/* "Cython_shift_calculator.pyx":1260
 * 
 *     @cython.profile(True)
 *     def __call__(self, rings, Vec3_list normals, Vec3_list centres):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #        cdef Vec3_container centre
 * #         cdef Vec3_container normal
 */

static PyObject *__pyx_pf_17shift_calculators_25Fast_ring_data_calculator_4__call__(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *__pyx_v_self, PyObject *__pyx_v_rings, struct __pyx_obj_17shift_calculators_Vec3_list *__pyx_v_normals, struct __pyx_obj_17shift_calculators_Vec3_list *__pyx_v_centres) {
  double __pyx_v_start_time;
  double __pyx_v_end_time;
  int __pyx_v_ring_id;
  PyObject *__pyx_v_ring_component = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__call__", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("__call__", __pyx_f[0], 1260);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1261")'> 1261: #        cdef Vec3_container centre</pre>
<pre id='line1261' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1262")'> 1262: #         cdef Vec3_container normal</pre>
<pre id='line1262' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1263")'> 1263:         cdef double start_time = 0.0</pre>
<pre id='line1263' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1263
 * #        cdef Vec3_container centre
 * #         cdef Vec3_container normal
 *         cdef double start_time = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef double end_time = 0.0
 * 
 */
  __pyx_v_start_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1264")'> 1264:         cdef double end_time = 0.0</pre>
<pre id='line1264' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1264
 * #         cdef Vec3_container normal
 *         cdef double start_time = 0.0
 *         cdef double end_time = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if self._verbose:
 */
  __pyx_v_end_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1265")'> 1265: </pre>
<pre id='line1265' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1266")'> 1266:         if self._verbose:</pre>
<pre id='line1266' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1266
 *         cdef double end_time = 0.0
 * 
 *         if self._verbose:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             start_time = time()
 * 
 */
  if (__pyx_v_self->_verbose) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line1267")'> 1267:             start_time = time()</pre>
<pre id='line1267' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":1267
 * 
 *         if self._verbose:
 *             start_time = time()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         normals.set_length(len(rings))
 */
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__time);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_start_time = __pyx_t_3;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1268")'> 1268: </pre>
<pre id='line1268' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line1269")'> 1269:         normals.set_length(len(rings))</pre>
<pre id='line1269' class='code' style='background-color: #FFFF9f'>
  /* "Cython_shift_calculator.pyx":1269
 *             start_time = time()
 * 
 *         normals.set_length(len(rings))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         centres.set_length(len(rings))
 *         cdef int ring_id
 */
  __pyx_t_4 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_rings);<span class='error_goto'> if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = ((struct __pyx_vtabstruct_17shift_calculators_Vec3_list *)__pyx_v_normals->__pyx_vtab)->set_length(__pyx_v_normals, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line1270")'> 1270:         centres.set_length(len(rings))</pre>
<pre id='line1270' class='code' style='background-color: #FFFF9f'>
  /* "Cython_shift_calculator.pyx":1270
 * 
 *         normals.set_length(len(rings))
 *         centres.set_length(len(rings))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int ring_id
 *         for ring_id,ring_component in enumerate(rings):
 */
  __pyx_t_4 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_rings);<span class='error_goto'> if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = ((struct __pyx_vtabstruct_17shift_calculators_Vec3_list *)__pyx_v_centres->__pyx_vtab)->set_length(__pyx_v_centres, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1271")'> 1271:         cdef int ring_id</pre>
<pre id='line1271' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line1272")'> 1272:         for ring_id,ring_component in enumerate(rings):</pre>
<pre id='line1272' class='code' style='background-color: #FFFF2a'>
  /* "Cython_shift_calculator.pyx":1272
 *         centres.set_length(len(rings))
 *         cdef int ring_id
 *         for ring_id,ring_component in enumerate(rings):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             ring_id = ring_component[0]
 * 
 */
  __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_rings) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_rings)) {
    __pyx_t_2 = __pyx_v_rings; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_4 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_rings);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_6 = Py_TYPE(__pyx_t_2)->tp_iternext;
  }
  for (;;) {
    if (!__pyx_t_6 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) {
      if (__pyx_t_4 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_6 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
      if (__pyx_t_4 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_1 = __pyx_t_6(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ring_component);
    __pyx_v_ring_component = __pyx_t_1;
    __pyx_t_1 = 0;
    __pyx_v_ring_id = __pyx_t_5;
    __pyx_t_5 = (__pyx_t_5 + 1);
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line1273")'> 1273:             ring_id = ring_component[0]</pre>
<pre id='line1273' class='code' style='background-color: #FFFF6e'>
    /* "Cython_shift_calculator.pyx":1273
 *         cdef int ring_id
 *         for ring_id,ring_component in enumerate(rings):
 *             ring_id = ring_component[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             self._calculate_one_ring_centre(ring_component, centres.get(ring_id))
 */
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_ring_component, 0, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_7 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_ring_id = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1274")'> 1274: </pre>
<pre id='line1274' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1275")'> 1275:             self._calculate_one_ring_centre(ring_component, centres.get(ring_id))</pre>
<pre id='line1275' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1275
 *             ring_id = ring_component[0]
 * 
 *             self._calculate_one_ring_centre(ring_component, centres.get(ring_id))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_f_17shift_calculators_25Fast_ring_data_calculator__calculate_one_ring_centre(__pyx_v_self, __pyx_v_ring_component, __pyx_f_17shift_calculators_9Vec3_list_get(__pyx_v_centres, __pyx_v_ring_id));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1276")'> 1276: </pre>
<pre id='line1276' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1277")'> 1277: </pre>
<pre id='line1277' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1278")'> 1278:             self._calculate_one_ring_normal(ring_component, normals.get(ring_id))</pre>
<pre id='line1278' class='code' style='background-color: #FFFFe7'>
    /* "Cython_shift_calculator.pyx":1278
 * 
 * 
 *             self._calculate_one_ring_normal(ring_component, normals.get(ring_id))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #             normal_component = ring_id, normal
 * #             normals.add_component(normal_component)
 */
    __pyx_f_17shift_calculators_25Fast_ring_data_calculator__calculate_one_ring_normal(__pyx_v_self, __pyx_v_ring_component, __pyx_f_17shift_calculators_9Vec3_list_get(__pyx_v_normals, __pyx_v_ring_id));
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1279")'> 1279: #             normal_component = ring_id, normal</pre>
<pre id='line1279' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1280")'> 1280: #             normals.add_component(normal_component)</pre>
<pre id='line1280' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1281")'> 1281: </pre>
<pre id='line1281' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1282")'> 1282:         if self._verbose:</pre>
<pre id='line1282' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1282
 * #             normals.add_component(normal_component)
 * 
 *         if self._verbose:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             end_time = time()
 *             print '   ring data centres: ',len(rings), ' normals ', len(normals), 'in', "%.17g" %  (end_time-start_time), "seconds"
 */
  if (__pyx_v_self->_verbose) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line1283")'> 1283:             end_time = time()</pre>
<pre id='line1283' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":1283
 * 
 *         if self._verbose:
 *             end_time = time()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print '   ring data centres: ',len(rings), ' normals ', len(normals), 'in', "%.17g" %  (end_time-start_time), "seconds"
 * 
 */
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__time);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_end_time = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF15' onclick='toggleDiv("line1284")'> 1284:             print '   ring data centres: ',len(rings), ' normals ', len(normals), 'in', "%.17g" %  (end_time-start_time), "seconds"</pre>
<pre id='line1284' class='code' style='background-color: #FFFF15'>
    /* "Cython_shift_calculator.pyx":1284
 *         if self._verbose:
 *             end_time = time()
 *             print '   ring data centres: ',len(rings), ' normals ', len(normals), 'in', "%.17g" %  (end_time-start_time), "seconds"             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef class Fast_non_bonded_calculator:
 */
    __pyx_t_4 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_rings);<span class='error_goto'> if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1284; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1284; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_4 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_v_normals));<span class='error_goto'> if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1284; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1284; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_end_time - __pyx_v_start_time));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1284; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_27), __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1284; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_9));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1284; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_25));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, ((PyObject *)__pyx_kp_s_25));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_25));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_26));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2, ((PyObject *)__pyx_kp_s_26));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_26));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 3, __pyx_t_2);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__in));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 4, ((PyObject *)__pyx_n_s__in));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__in));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 5, ((PyObject *)__pyx_t_9));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_9));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__seconds));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 6, ((PyObject *)__pyx_n_s__seconds));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__seconds));
    __pyx_t_1 = 0;
    __pyx_t_2 = 0;
    __pyx_t_9 = 0;
    if (<span class='pyx_c_api'>__Pyx_Print</span>(0, ((PyObject *)__pyx_t_8), 1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1284; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
    goto __pyx_L6;
  }
  __pyx_L6:;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_data_calculator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ring_component);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_26Fast_non_bonded_calculator_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_26Fast_non_bonded_calculator_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_simulation = 0;
  PyObject *__pyx_v_min_residue_seperation = 0;
  PyObject *__pyx_v_cutoff_distance = 0;
  PyObject *__pyx_v_jitter = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__simulation,&__pyx_n_s_28,&__pyx_n_s__cutoff_distance,&__pyx_n_s__jitter,0};
    PyObject* values[4] = {0,0,0,0};
    values[2] = __pyx_k_29;
    values[3] = __pyx_k_30;
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__simulation)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_28)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 2, 4, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1294; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__cutoff_distance);
          if (value) { values[2] = value; kw_args--; }
        }
        case  3:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__jitter);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1294; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_simulation = values[0];
    __pyx_v_min_residue_seperation = values[1];
    __pyx_v_cutoff_distance = values[2];
    __pyx_v_jitter = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 2, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1294; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_non_bonded_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_non_bonded_calculator___init__(((struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *)__pyx_v_self), __pyx_v_simulation, __pyx_v_min_residue_seperation, __pyx_v_cutoff_distance, __pyx_v_jitter);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1285")'> 1285: </pre>
<pre id='line1285' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1286")'> 1286: cdef class Fast_non_bonded_calculator:</pre>
<pre id='line1286' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1286
 *             print '   ring data centres: ',len(rings), ' normals ', len(normals), 'in', "%.17g" %  (end_time-start_time), "seconds"
 * 
 * cdef class Fast_non_bonded_calculator:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int _min_residue_seperation
 *     cdef float _cutoff_distance
 */
struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator {
  PyObject_HEAD
  struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_calculator *__pyx_vtab;
  int _min_residue_seperation;
  float _cutoff_distance;
  float _jitter;
  float _full_cutoff_distance;
  int _verbose;
  EnsembleSimulation *_simulation;
};


/* "Cython_shift_calculator.pyx":1286
 *             print '   ring data centres: ',len(rings), ' normals ', len(normals), 'in', "%.17g" %  (end_time-start_time), "seconds"
 * 
 * cdef class Fast_non_bonded_calculator:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int _min_residue_seperation
 *     cdef float _cutoff_distance
 */

struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_calculator {
  int (*_filter_by_residue)(struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *, char *, int, char *, int);
  int (*_is_non_bonded)(struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *, int, int);
  int (*_bytes_to_target_components)(struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *, PyObject *, struct __pyx_t_17shift_calculators_Non_bonded_target_component **);
  int (*_bytes_to_remote_components)(struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *, PyObject *, struct __pyx_t_17shift_calculators_Non_bonded_remote_atom_component **);
};
static struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_calculator *__pyx_vtabptr_17shift_calculators_Fast_non_bonded_calculator;
static CYTHON_INLINE int __pyx_f_17shift_calculators_26Fast_non_bonded_calculator__filter_by_residue(struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *, char *, int, char *, int);
static CYTHON_INLINE int __pyx_f_17shift_calculators_26Fast_non_bonded_calculator__is_non_bonded(struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *, int, int);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1287")'> 1287:     cdef int _min_residue_seperation</pre>
<pre id='line1287' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1288")'> 1288:     cdef float _cutoff_distance</pre>
<pre id='line1288' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1289")'> 1289:     cdef float _jitter</pre>
<pre id='line1289' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1290")'> 1290:     cdef float _full_cutoff_distance</pre>
<pre id='line1290' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1291")'> 1291:     cdef bint _verbose</pre>
<pre id='line1291' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1292")'> 1292:     cdef EnsembleSimulation* _simulation</pre>
<pre id='line1292' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1293")'> 1293: </pre>
<pre id='line1293' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line1294")'> 1294:     def __init__(self,simulation, min_residue_seperation,cutoff_distance=5.0,jitter=0.2):</pre>
<pre id='line1294' class='code' style='background-color: #FFFF7f'>
/* "Cython_shift_calculator.pyx":1294
 *     cdef EnsembleSimulation* _simulation
 * 
 *     def __init__(self,simulation, min_residue_seperation,cutoff_distance=5.0,jitter=0.2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._simulation = simulationAsNative(simulation)
 * 
 */

static int __pyx_pf_17shift_calculators_26Fast_non_bonded_calculator___init__(struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *__pyx_v_self, PyObject *__pyx_v_simulation, PyObject *__pyx_v_min_residue_seperation, PyObject *__pyx_v_cutoff_distance, PyObject *__pyx_v_jitter) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);

  /* "Cython_shift_calculator.pyx":1294
 *     cdef EnsembleSimulation* _simulation
 * 
 *     def __init__(self,simulation, min_residue_seperation,cutoff_distance=5.0,jitter=0.2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._simulation = simulationAsNative(simulation)
 * 
 */
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(5.0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_k_29 = __pyx_t_2;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(0.2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_k_30 = __pyx_t_2;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1295")'> 1295:         self._simulation = simulationAsNative(simulation)</pre>
<pre id='line1295' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1295
 * 
 *     def __init__(self,simulation, min_residue_seperation,cutoff_distance=5.0,jitter=0.2):
 *         self._simulation = simulationAsNative(simulation)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._min_residue_seperation =  min_residue_seperation
 */
  __pyx_t_1 = __pyx_f_17shift_calculators_simulationAsNative(__pyx_v_simulation);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_simulation = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1296")'> 1296: </pre>
<pre id='line1296' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line1297")'> 1297:         self._min_residue_seperation =  min_residue_seperation</pre>
<pre id='line1297' class='code' style='background-color: #FFFF7f'>
  /* "Cython_shift_calculator.pyx":1297
 *         self._simulation = simulationAsNative(simulation)
 * 
 *         self._min_residue_seperation =  min_residue_seperation             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._cutoff_distance =  cutoff_distance
 *         self._jitter = jitter
 */
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_min_residue_seperation);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1297; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_min_residue_seperation = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line1298")'> 1298:         self._cutoff_distance =  cutoff_distance</pre>
<pre id='line1298' class='code' style='background-color: #FFFF7f'>
  /* "Cython_shift_calculator.pyx":1298
 * 
 *         self._min_residue_seperation =  min_residue_seperation
 *         self._cutoff_distance =  cutoff_distance             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._jitter = jitter
 *         self._full_cutoff_distance =  self._cutoff_distance + self._jitter
 */
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_cutoff_distance);<span class='error_goto'> if (unlikely((__pyx_t_3 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1298; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_cutoff_distance = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line1299")'> 1299:         self._jitter = jitter</pre>
<pre id='line1299' class='code' style='background-color: #FFFF7f'>
  /* "Cython_shift_calculator.pyx":1299
 *         self._min_residue_seperation =  min_residue_seperation
 *         self._cutoff_distance =  cutoff_distance
 *         self._jitter = jitter             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._full_cutoff_distance =  self._cutoff_distance + self._jitter
 *         self._verbose =  False
 */
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_jitter);<span class='error_goto'> if (unlikely((__pyx_t_3 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_jitter = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1300")'> 1300:         self._full_cutoff_distance =  self._cutoff_distance + self._jitter</pre>
<pre id='line1300' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1300
 *         self._cutoff_distance =  cutoff_distance
 *         self._jitter = jitter
 *         self._full_cutoff_distance =  self._cutoff_distance + self._jitter             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._verbose =  False
 * 
 */
  __pyx_v_self->_full_cutoff_distance = (__pyx_v_self->_cutoff_distance + __pyx_v_self->_jitter);
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line1301")'> 1301:         self._verbose =  False</pre>
<pre id='line1301' class='code' style='background-color: #FFFFb6'>
  /* "Cython_shift_calculator.pyx":1301
 *         self._jitter = jitter
 *         self._full_cutoff_distance =  self._cutoff_distance + self._jitter
 *         self._verbose =  False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_self->_verbose = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_non_bonded_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_non_bonded_calculator_3set_verbose(PyObject *__pyx_v_self, PyObject *__pyx_v_on); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_non_bonded_calculator_3set_verbose(PyObject *__pyx_v_self, PyObject *__pyx_v_on) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_verbose (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_non_bonded_calculator_2set_verbose(((struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_on));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1302")'> 1302: </pre>
<pre id='line1302' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1303")'> 1303: </pre>
<pre id='line1303' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1304")'> 1304:     def set_verbose(self,on):</pre>
<pre id='line1304' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1304
 * 
 * 
 *     def set_verbose(self,on):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._verbose=on
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_non_bonded_calculator_2set_verbose(struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *__pyx_v_self, PyObject *__pyx_v_on) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_verbose", 0);
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line1305")'> 1305:         self._verbose=on</pre>
<pre id='line1305' class='code' style='background-color: #FFFF6a'>
  /* "Cython_shift_calculator.pyx":1305
 * 
 *     def set_verbose(self,on):
 *         self._verbose=on             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline bint _filter_by_residue(self, char* seg_1, int residue_1, char* seg_2, int residue_2):
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_v_on);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_verbose = __pyx_t_1;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_non_bonded_calculator.set_verbose", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1306")'> 1306: </pre>
<pre id='line1306' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1307")'> 1307:     cdef inline bint _filter_by_residue(self, char* seg_1, int residue_1, char* seg_2, int residue_2):</pre>
<pre id='line1307' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1307
 *         self._verbose=on
 * 
 *     cdef inline bint _filter_by_residue(self, char* seg_1, int residue_1, char* seg_2, int residue_2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int sequence_distance
 *         cdef bint result
 */

static CYTHON_INLINE int __pyx_f_17shift_calculators_26Fast_non_bonded_calculator__filter_by_residue(struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *__pyx_v_self, char *__pyx_v_seg_1, int __pyx_v_residue_1, char *__pyx_v_seg_2, int __pyx_v_residue_2) {
  int __pyx_v_sequence_distance;
  int __pyx_v_result;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_filter_by_residue", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1308")'> 1308:         cdef int sequence_distance</pre>
<pre id='line1308' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1309")'> 1309:         cdef bint result</pre>
<pre id='line1309' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1310")'> 1310: </pre>
<pre id='line1310' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1311")'> 1311:         result = False</pre>
<pre id='line1311' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1311
 *         cdef bint result
 * 
 *         result = False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if strcmp(seg_1, seg_2) == 0:
 */
  __pyx_v_result = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1312")'> 1312: </pre>
<pre id='line1312' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1313")'> 1313:         if strcmp(seg_1, seg_2) == 0:</pre>
<pre id='line1313' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1313
 *         result = False
 * 
 *         if strcmp(seg_1, seg_2) == 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             sequence_distance =abs(residue_1-residue_2)
 *             if sequence_distance <code><</code> self._min_residue_seperation:
 */
  __pyx_t_1 = (strcmp(__pyx_v_seg_1, __pyx_v_seg_2) == 0);
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1314")'> 1314:             sequence_distance =abs(residue_1-residue_2)</pre>
<pre id='line1314' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1314
 * 
 *         if strcmp(seg_1, seg_2) == 0:
 *             sequence_distance =abs(residue_1-residue_2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if sequence_distance <code><</code> self._min_residue_seperation:
 *                 result =True
 */
    __pyx_t_2 = __Pyx_abs_int((__pyx_v_residue_1 - __pyx_v_residue_2)); 
    __pyx_v_sequence_distance = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1315")'> 1315:             if sequence_distance &lt; self._min_residue_seperation:</pre>
<pre id='line1315' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1315
 *         if strcmp(seg_1, seg_2) == 0:
 *             sequence_distance =abs(residue_1-residue_2)
 *             if sequence_distance <code><</code> self._min_residue_seperation:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 result =True
 *         return result
 */
    __pyx_t_1 = (__pyx_v_sequence_distance <code><</code> __pyx_v_self->_min_residue_seperation);
    if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1316")'> 1316:                 result =True</pre>
<pre id='line1316' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1316
 *             sequence_distance =abs(residue_1-residue_2)
 *             if sequence_distance <code><</code> self._min_residue_seperation:
 *                 result =True             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return result
 * 
 */
      __pyx_v_result = 1;
      goto __pyx_L4;
    }
    __pyx_L4:;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1317")'> 1317:         return result</pre>
<pre id='line1317' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":1317
 *             if sequence_distance <code><</code> self._min_residue_seperation:
 *                 result =True
 *         return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline bint  _is_non_bonded(self, int atom_id_1, int atom_id_2):
 */
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1318")'> 1318: </pre>
<pre id='line1318' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1319")'> 1319:     cdef inline bint  _is_non_bonded(self, int atom_id_1, int atom_id_2):</pre>
<pre id='line1319' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1319
 *         return result
 * 
 *     cdef inline bint  _is_non_bonded(self, int atom_id_1, int atom_id_2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Atom atom_1, atom_2
 */

static CYTHON_INLINE int __pyx_f_17shift_calculators_26Fast_non_bonded_calculator__is_non_bonded(struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *__pyx_v_self, int __pyx_v_atom_id_1, int __pyx_v_atom_id_2) {
  Atom __pyx_v_atom_1;
  Atom __pyx_v_atom_2;
  char *__pyx_v_seg_1;
  char *__pyx_v_seg_2;
  int __pyx_v_residue_1;
  int __pyx_v_residue_2;
  int __pyx_v_is_non_bonded;
  float __pyx_v_distance;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_is_non_bonded", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1320")'> 1320: </pre>
<pre id='line1320' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1321")'> 1321:         cdef Atom atom_1, atom_2</pre>
<pre id='line1321' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1322")'> 1322:         cdef char *seg_1, *seg_2</pre>
<pre id='line1322' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1323")'> 1323:         cdef int residue_1, residue_2</pre>
<pre id='line1323' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1324")'> 1324:         cdef bint is_non_bonded</pre>
<pre id='line1324' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1325")'> 1325:         cdef float distance</pre>
<pre id='line1325' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1326")'> 1326: </pre>
<pre id='line1326' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1327")'> 1327:         atom_1 = self._simulation[0].atomByID(atom_id_1)</pre>
<pre id='line1327' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1327
 *         cdef float distance
 * 
 *         atom_1 = self._simulation[0].atomByID(atom_id_1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         atom_2 = self._simulation[0].atomByID(atom_id_2)
 * 
 */
  __pyx_v_atom_1 = (__pyx_v_self->_simulation[0]).atomByID(__pyx_v_atom_id_1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1328")'> 1328:         atom_2 = self._simulation[0].atomByID(atom_id_2)</pre>
<pre id='line1328' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1328
 * 
 *         atom_1 = self._simulation[0].atomByID(atom_id_1)
 *         atom_2 = self._simulation[0].atomByID(atom_id_2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         seg_1 =  <code><</code>char *>atom_1.segmentName()
 */
  __pyx_v_atom_2 = (__pyx_v_self->_simulation[0]).atomByID(__pyx_v_atom_id_2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1329")'> 1329: </pre>
<pre id='line1329' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1330")'> 1330:         seg_1 =  &lt;char *&gt;atom_1.segmentName()</pre>
<pre id='line1330' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1330
 *         atom_2 = self._simulation[0].atomByID(atom_id_2)
 * 
 *         seg_1 =  <code><</code>char *>atom_1.segmentName()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         residue_1 = atom_1.residueNum()
 * 
 */
  __pyx_v_seg_1 = ((char *)__pyx_v_atom_1.segmentName());
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1331")'> 1331:         residue_1 = atom_1.residueNum()</pre>
<pre id='line1331' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1331
 * 
 *         seg_1 =  <code><</code>char *>atom_1.segmentName()
 *         residue_1 = atom_1.residueNum()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         seg_2 = <code><</code>char*>atom_2.segmentName()
 */
  __pyx_v_residue_1 = __pyx_v_atom_1.residueNum();
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1332")'> 1332: </pre>
<pre id='line1332' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1333")'> 1333:         seg_2 = &lt;char*&gt;atom_2.segmentName()</pre>
<pre id='line1333' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1333
 *         residue_1 = atom_1.residueNum()
 * 
 *         seg_2 = <code><</code>char*>atom_2.segmentName()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         residue_2 =  atom_2.residueNum()
 * 
 */
  __pyx_v_seg_2 = ((char *)__pyx_v_atom_2.segmentName());
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1334")'> 1334:         residue_2 =  atom_2.residueNum()</pre>
<pre id='line1334' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1334
 * 
 *         seg_2 = <code><</code>char*>atom_2.segmentName()
 *         residue_2 =  atom_2.residueNum()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         is_non_bonded = True
 */
  __pyx_v_residue_2 = __pyx_v_atom_2.residueNum();
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1335")'> 1335: </pre>
<pre id='line1335' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1336")'> 1336:         is_non_bonded = True</pre>
<pre id='line1336' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1336
 *         residue_2 =  atom_2.residueNum()
 * 
 *         is_non_bonded = True             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if self._filter_by_residue(seg_1, residue_1, seg_2, residue_2):
 *             is_non_bonded = False
 */
  __pyx_v_is_non_bonded = 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1337")'> 1337:         if self._filter_by_residue(seg_1, residue_1, seg_2, residue_2):</pre>
<pre id='line1337' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1337
 * 
 *         is_non_bonded = True
 *         if self._filter_by_residue(seg_1, residue_1, seg_2, residue_2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             is_non_bonded = False
 *         else:
 */
  __pyx_t_1 = __pyx_f_17shift_calculators_26Fast_non_bonded_calculator__filter_by_residue(__pyx_v_self, __pyx_v_seg_1, __pyx_v_residue_1, __pyx_v_seg_2, __pyx_v_residue_2);
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1338")'> 1338:             is_non_bonded = False</pre>
<pre id='line1338' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1338
 *         is_non_bonded = True
 *         if self._filter_by_residue(seg_1, residue_1, seg_2, residue_2):
 *             is_non_bonded = False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             distance = norm(atom_1.pos() - atom_2.pos())
 */
    __pyx_v_is_non_bonded = 0;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1339")'> 1339:         else:</pre>
<pre id='line1339' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1340")'> 1340:             distance = norm(atom_1.pos() - atom_2.pos())</pre>
<pre id='line1340' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1340
 *             is_non_bonded = False
 *         else:
 *             distance = norm(atom_1.pos() - atom_2.pos())             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             is_non_bonded =  distance <code><</code> self._full_cutoff_distance
 *         return is_non_bonded
 */
    __pyx_v_distance = norm((__pyx_v_atom_1.pos() - __pyx_v_atom_2.pos()));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1341")'> 1341:             is_non_bonded =  distance &lt; self._full_cutoff_distance</pre>
<pre id='line1341' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1341
 *         else:
 *             distance = norm(atom_1.pos() - atom_2.pos())
 *             is_non_bonded =  distance <code><</code> self._full_cutoff_distance             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return is_non_bonded
 * 
 */
    __pyx_v_is_non_bonded = (__pyx_v_distance <code><</code> __pyx_v_self->_full_cutoff_distance);
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1342")'> 1342:         return is_non_bonded</pre>
<pre id='line1342' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":1342
 *             distance = norm(atom_1.pos() - atom_2.pos())
 *             is_non_bonded =  distance <code><</code> self._full_cutoff_distance
 *         return is_non_bonded             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #     cdef struct Non_bonded_target_component:
 */
  __pyx_r = __pyx_v_is_non_bonded;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1343")'> 1343: </pre>
<pre id='line1343' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1344")'> 1344: #     cdef struct Non_bonded_target_component:</pre>
<pre id='line1344' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1345")'> 1345: #       int target_atom_id</pre>
<pre id='line1345' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1346")'> 1346: #       int atom_type_id</pre>
<pre id='line1346' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1347")'> 1347: #</pre>
<pre id='line1347' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1348")'> 1348: # cdef struct Non_bonded_remote_atom_component:</pre>
<pre id='line1348' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1349")'> 1349: #       int remote_atom</pre>
<pre id='line1349' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1350")'> 1350: #       int chem_type[2] # one for each sphere</pre>
<pre id='line1350' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1351")'> 1351: </pre>
<pre id='line1351' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1352")'> 1352:     cdef   int _bytes_to_target_components(self, data, Non_bonded_target_component** target_pointer):</pre>
<pre id='line1352' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1352
 * #       int chem_type[2] # one for each sphere
 * 
 *     cdef   int _bytes_to_target_components(self, data, Non_bonded_target_component** target_pointer):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         target_pointer[0] =  <code><</code>Non_bonded_target_component*> <code><</code>size_t> ctypes.addressof(data)
 */

static int __pyx_f_17shift_calculators_26Fast_non_bonded_calculator__bytes_to_target_components(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *__pyx_v_self, PyObject *__pyx_v_data, struct __pyx_t_17shift_calculators_Non_bonded_target_component **__pyx_v_target_pointer) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_target_components", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1353")'> 1353: </pre>
<pre id='line1353' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line1354")'> 1354:         target_pointer[0] =  &lt;Non_bonded_target_component*&gt; &lt;size_t&gt; ctypes.addressof(data)</pre>
<pre id='line1354' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":1354
 *     cdef   int _bytes_to_target_components(self, data, Non_bonded_target_component** target_pointer):
 * 
 *         target_pointer[0] =  <code><</code>Non_bonded_target_component*> <code><</code>size_t> ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return len(data)/ sizeof(Non_bonded_target_component)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  (__pyx_v_target_pointer[0]) = ((struct __pyx_t_17shift_calculators_Non_bonded_target_component *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line1355")'> 1355:         return len(data)/ sizeof(Non_bonded_target_component)</pre>
<pre id='line1355' class='code' style='background-color: #FFFF79'>
  /* "Cython_shift_calculator.pyx":1355
 * 
 *         target_pointer[0] =  <code><</code>Non_bonded_target_component*> <code><</code>size_t> ctypes.addressof(data)
 *         return len(data)/ sizeof(Non_bonded_target_component)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef   int _bytes_to_remote_components(self, data, Non_bonded_remote_atom_component** remote_pointer):
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1355; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = (__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Non_bonded_target_component)));
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Fast_non_bonded_calculator._bytes_to_target_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1356")'> 1356: </pre>
<pre id='line1356' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1357")'> 1357:     cdef   int _bytes_to_remote_components(self, data, Non_bonded_remote_atom_component** remote_pointer):</pre>
<pre id='line1357' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1357
 *         return len(data)/ sizeof(Non_bonded_target_component)
 * 
 *     cdef   int _bytes_to_remote_components(self, data, Non_bonded_remote_atom_component** remote_pointer):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         remote_pointer[0] =  <code><</code>Non_bonded_remote_atom_component*> <code><</code>size_t> ctypes.addressof(data)
 */

static int __pyx_f_17shift_calculators_26Fast_non_bonded_calculator__bytes_to_remote_components(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *__pyx_v_self, PyObject *__pyx_v_data, struct __pyx_t_17shift_calculators_Non_bonded_remote_atom_component **__pyx_v_remote_pointer) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_remote_components", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1358")'> 1358: </pre>
<pre id='line1358' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line1359")'> 1359:         remote_pointer[0] =  &lt;Non_bonded_remote_atom_component*&gt; &lt;size_t&gt; ctypes.addressof(data)</pre>
<pre id='line1359' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":1359
 *     cdef   int _bytes_to_remote_components(self, data, Non_bonded_remote_atom_component** remote_pointer):
 * 
 *         remote_pointer[0] =  <code><</code>Non_bonded_remote_atom_component*> <code><</code>size_t> ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return len(data)/ sizeof(Non_bonded_remote_atom_component)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  (__pyx_v_remote_pointer[0]) = ((struct __pyx_t_17shift_calculators_Non_bonded_remote_atom_component *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFF27' onclick='toggleDiv("line1360")'> 1360:         return len(data)/ sizeof(Non_bonded_remote_atom_component)</pre>
<pre id='line1360' class='code' style='background-color: #FFFF27'>
  /* "Cython_shift_calculator.pyx":1360
 * 
 *         remote_pointer[0] =  <code><</code>Non_bonded_remote_atom_component*> <code><</code>size_t> ctypes.addressof(data)
 *         return len(data)/ sizeof(Non_bonded_remote_atom_component)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     @cython.profile(True)
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = (__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Non_bonded_remote_atom_component)));
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Fast_non_bonded_calculator._bytes_to_remote_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_non_bonded_calculator_5__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_non_bonded_calculator_5__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_atom_list_1 = 0;
  PyObject *__pyx_v_atom_list_2 = 0;
  struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_non_bonded_lists = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__call__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__atom_list_1,&__pyx_n_s__atom_list_2,&__pyx_n_s__non_bonded_lists,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__atom_list_1)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__atom_list_2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 3, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1363; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__non_bonded_lists)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 3, 3, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1363; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__call__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1363; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_atom_list_1 = values[0];
    __pyx_v_atom_list_2 = values[1];
    __pyx_v_non_bonded_lists = ((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)values[2]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1363; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_non_bonded_calculator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_non_bonded_lists), __pyx_ptype_17shift_calculators_Non_bonded_interaction_list, 1, "non_bonded_lists", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_non_bonded_calculator_4__call__(((struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *)__pyx_v_self), __pyx_v_atom_list_1, __pyx_v_atom_list_2, __pyx_v_non_bonded_lists);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1361")'> 1361: </pre>
<pre id='line1361' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1362")'> 1362:     @cython.profile(True)</pre>
<pre id='line1362' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1363")'> 1363:     def __call__(self, atom_list_1, atom_list_2,  Non_bonded_interaction_list non_bonded_lists):</pre>
<pre id='line1363' class='code' style='background-color: #FFFFd4'>
/* "Cython_shift_calculator.pyx":1363
 * 
 *     @cython.profile(True)
 *     def __call__(self, atom_list_1, atom_list_2,  Non_bonded_interaction_list non_bonded_lists):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if self._verbose:
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_non_bonded_calculator_4__call__(struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *__pyx_v_self, PyObject *__pyx_v_atom_list_1, PyObject *__pyx_v_atom_list_2, struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_non_bonded_lists) {
  struct __pyx_t_17shift_calculators_Non_bonded_target_component *__pyx_v_target_components;
  int __pyx_v_num_target_components;
  struct __pyx_t_17shift_calculators_Non_bonded_remote_atom_component *__pyx_v_remote_components;
  int __pyx_v_num_remote_components;
  double __pyx_v_start_time;
  double __pyx_v_end_time;
  int __pyx_v_i;
  int __pyx_v_atom_id_1;
  int __pyx_v_atom_id_2;
  int __pyx_v_j;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__call__", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("__call__", __pyx_f[0], 1363);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1364")'> 1364: </pre>
<pre id='line1364' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1365")'> 1365:         if self._verbose:</pre>
<pre id='line1365' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1365
 *     def __call__(self, atom_list_1, atom_list_2,  Non_bonded_interaction_list non_bonded_lists):
 * 
 *         if self._verbose:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print '***** BUILD NON BONDED ******'
 * 
 */
  if (__pyx_v_self->_verbose) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1366")'> 1366:             print '***** BUILD NON BONDED ******'</pre>
<pre id='line1366' class='code' style='background-color: #FFFFd4'>
    /* "Cython_shift_calculator.pyx":1366
 * 
 *         if self._verbose:
 *             print '***** BUILD NON BONDED ******'             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef  Non_bonded_target_component* target_components
 */
    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, ((PyObject *)__pyx_kp_s_31)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1367")'> 1367: </pre>
<pre id='line1367' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1368")'> 1368:         cdef  Non_bonded_target_component* target_components</pre>
<pre id='line1368' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1369")'> 1369:         cdef int num_target_components = self._bytes_to_target_components(atom_list_1,&amp;target_components)</pre>
<pre id='line1369' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1369
 * 
 *         cdef  Non_bonded_target_component* target_components
 *         cdef int num_target_components = self._bytes_to_target_components(atom_list_1,&target_components)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Non_bonded_remote_atom_component* remote_components
 */
  __pyx_v_num_target_components = ((struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_calculator *)__pyx_v_self->__pyx_vtab)->_bytes_to_target_components(__pyx_v_self, __pyx_v_atom_list_1, (&__pyx_v_target_components));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1370")'> 1370: </pre>
<pre id='line1370' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1371")'> 1371:         cdef Non_bonded_remote_atom_component* remote_components</pre>
<pre id='line1371' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1372")'> 1372:         cdef int num_remote_components = self._bytes_to_remote_components(atom_list_2,&amp;remote_components)</pre>
<pre id='line1372' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1372
 * 
 *         cdef Non_bonded_remote_atom_component* remote_components
 *         cdef int num_remote_components = self._bytes_to_remote_components(atom_list_2,&remote_components)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef double start_time = 0.0
 */
  __pyx_v_num_remote_components = ((struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_calculator *)__pyx_v_self->__pyx_vtab)->_bytes_to_remote_components(__pyx_v_self, __pyx_v_atom_list_2, (&__pyx_v_remote_components));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1373")'> 1373: </pre>
<pre id='line1373' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1374")'> 1374:         cdef double start_time = 0.0</pre>
<pre id='line1374' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1374
 *         cdef int num_remote_components = self._bytes_to_remote_components(atom_list_2,&remote_components)
 * 
 *         cdef double start_time = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef double end_time = 0.0
 *         if self._verbose:
 */
  __pyx_v_start_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1375")'> 1375:         cdef double end_time = 0.0</pre>
<pre id='line1375' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1375
 * 
 *         cdef double start_time = 0.0
 *         cdef double end_time = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if self._verbose:
 *             start_time = time()
 */
  __pyx_v_end_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1376")'> 1376:         if self._verbose:</pre>
<pre id='line1376' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1376
 *         cdef double start_time = 0.0
 *         cdef double end_time = 0.0
 *         if self._verbose:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             start_time = time()
 * 
 */
  if (__pyx_v_self->_verbose) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line1377")'> 1377:             start_time = time()</pre>
<pre id='line1377' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":1377
 *         cdef double end_time = 0.0
 *         if self._verbose:
 *             start_time = time()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__time);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_start_time = __pyx_t_3;
    goto __pyx_L4;
  }
  __pyx_L4:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1378")'> 1378: </pre>
<pre id='line1378' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1379")'> 1379: </pre>
<pre id='line1379' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1380")'> 1380:         cdef int i, atom_id_1, atom_id_2</pre>
<pre id='line1380' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1381")'> 1381: </pre>
<pre id='line1381' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line1382")'> 1382:         non_bonded_lists.clear()</pre>
<pre id='line1382' class='code' style='background-color: #FFFF73'>
  /* "Cython_shift_calculator.pyx":1382
 *         cdef int i, atom_id_1, atom_id_2
 * 
 *         non_bonded_lists.clear()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         for i in range(num_target_components):
 */
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_non_bonded_lists), __pyx_n_s__clear);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1382; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1382; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1383")'> 1383: </pre>
<pre id='line1383' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1384")'> 1384:         for i in range(num_target_components):</pre>
<pre id='line1384' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1384
 *         non_bonded_lists.clear()
 * 
 *         for i in range(num_target_components):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             atom_id_1 = target_components[i].target_atom_id
 * 
 */
  __pyx_t_4 = __pyx_v_num_target_components;
  for (__pyx_t_5 = 0; __pyx_t_5 <code><</code> __pyx_t_4; __pyx_t_5+=1) {
    __pyx_v_i = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1385")'> 1385:             atom_id_1 = target_components[i].target_atom_id</pre>
<pre id='line1385' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1385
 * 
 *         for i in range(num_target_components):
 *             atom_id_1 = target_components[i].target_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             for j in range(num_remote_components):
 */
    __pyx_t_6 = (__pyx_v_target_components[__pyx_v_i]).target_atom_id;
    __pyx_v_atom_id_1 = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1386")'> 1386: </pre>
<pre id='line1386' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1387")'> 1387:             for j in range(num_remote_components):</pre>
<pre id='line1387' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1387
 *             atom_id_1 = target_components[i].target_atom_id
 * 
 *             for j in range(num_remote_components):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 atom_id_2  = remote_components[j].remote_atom_id
 *                 if self._is_non_bonded(atom_id_1, atom_id_2):
 */
    __pyx_t_6 = __pyx_v_num_remote_components;
    for (__pyx_t_7 = 0; __pyx_t_7 <code><</code> __pyx_t_6; __pyx_t_7+=1) {
      __pyx_v_j = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1388")'> 1388:                 atom_id_2  = remote_components[j].remote_atom_id</pre>
<pre id='line1388' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1388
 * 
 *             for j in range(num_remote_components):
 *                 atom_id_2  = remote_components[j].remote_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if self._is_non_bonded(atom_id_1, atom_id_2):
 *                     non_bonded_lists.append(atom_id_1, i,j,i)
 */
      __pyx_t_8 = (__pyx_v_remote_components[__pyx_v_j]).remote_atom_id;
      __pyx_v_atom_id_2 = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1389")'> 1389:                 if self._is_non_bonded(atom_id_1, atom_id_2):</pre>
<pre id='line1389' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1389
 *             for j in range(num_remote_components):
 *                 atom_id_2  = remote_components[j].remote_atom_id
 *                 if self._is_non_bonded(atom_id_1, atom_id_2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     non_bonded_lists.append(atom_id_1, i,j,i)
 *         if self._verbose:
 */
      __pyx_t_9 = __pyx_f_17shift_calculators_26Fast_non_bonded_calculator__is_non_bonded(__pyx_v_self, __pyx_v_atom_id_1, __pyx_v_atom_id_2);
      if (__pyx_t_9) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1390")'> 1390:                     non_bonded_lists.append(atom_id_1, i,j,i)</pre>
<pre id='line1390' class='code' style='background-color: #FFFFff'>
        /* "Cython_shift_calculator.pyx":1390
 *                 atom_id_2  = remote_components[j].remote_atom_id
 *                 if self._is_non_bonded(atom_id_1, atom_id_2):
 *                     non_bonded_lists.append(atom_id_1, i,j,i)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if self._verbose:
 *             end_time = time()
 */
        __pyx_f_17shift_calculators_27Non_bonded_interaction_list_append(__pyx_v_non_bonded_lists, __pyx_v_atom_id_1, __pyx_v_i, __pyx_v_j, __pyx_v_i);
        goto __pyx_L9;
      }
      __pyx_L9:;
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1391")'> 1391:         if self._verbose:</pre>
<pre id='line1391' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1391
 *                 if self._is_non_bonded(atom_id_1, atom_id_2):
 *                     non_bonded_lists.append(atom_id_1, i,j,i)
 *         if self._verbose:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             end_time = time()
 *             print '   non bonded list targets: ',len(atom_list_1),' remotes: ', len(atom_list_2),' in', "%.17g" %  (end_time-start_time), "seconds"
 */
  if (__pyx_v_self->_verbose) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line1392")'> 1392:             end_time = time()</pre>
<pre id='line1392' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":1392
 *                     non_bonded_lists.append(atom_id_1, i,j,i)
 *         if self._verbose:
 *             end_time = time()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print '   non bonded list targets: ',len(atom_list_1),' remotes: ', len(atom_list_2),' in', "%.17g" %  (end_time-start_time), "seconds"
 * 
 */
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__time);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1392; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1392; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1392; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_end_time = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF1f' onclick='toggleDiv("line1393")'> 1393:             print '   non bonded list targets: ',len(atom_list_1),' remotes: ', len(atom_list_2),' in', "%.17g" %  (end_time-start_time), "seconds"</pre>
<pre id='line1393' class='code' style='background-color: #FFFF1f'>
    /* "Cython_shift_calculator.pyx":1393
 *         if self._verbose:
 *             end_time = time()
 *             print '   non bonded list targets: ',len(atom_list_1),' remotes: ', len(atom_list_2),' in', "%.17g" %  (end_time-start_time), "seconds"             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_t_10 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_atom_list_1);<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_10 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_atom_list_2);<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_end_time - __pyx_v_start_time));<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
    __pyx_t_12 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_27), __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_12));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_32));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, ((PyObject *)__pyx_kp_s_32));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_32));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_t_2);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_33));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 2, ((PyObject *)__pyx_kp_s_33));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_33));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 3, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_34));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 4, ((PyObject *)__pyx_kp_s_34));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_34));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 5, ((PyObject *)__pyx_t_12));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_12));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__seconds));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 6, ((PyObject *)__pyx_n_s__seconds));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__seconds));
    __pyx_t_2 = 0;
    __pyx_t_1 = 0;
    __pyx_t_12 = 0;
    if (<span class='pyx_c_api'>__Pyx_Print</span>(0, ((PyObject *)__pyx_t_11), 1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_11)); __pyx_t_11 = 0;
    goto __pyx_L10;
  }
  __pyx_L10:;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_non_bonded_calculator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_27Fast_energy_calculator_base_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_27Fast_energy_calculator_base_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) > 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) > 0) && unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__init__", 0))) return -1;
  __pyx_r = __pyx_pf_17shift_calculators_27Fast_energy_calculator_base___init__(((struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1394")'> 1394: </pre>
<pre id='line1394' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1395")'> 1395: </pre>
<pre id='line1395' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1396")'> 1396: cdef class Fast_energy_calculator_base:</pre>
<pre id='line1396' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1396
 * 
 * 
 * cdef class Fast_energy_calculator_base:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */

struct __pyx_vtabstruct_17shift_calculators_Fast_energy_calculator_base {
  struct __pyx_t_17shift_calculators_Constant_cache *(*_get_energy_terms)(struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *, int);
  float (*_get_calculated_atom_shift)(struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *, int);
  float (*_get_observed_atom_shift)(struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *, int);
  float (*_get_shift_difference)(struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *, int, int);
  float (*_adjust_shift)(struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *, float, float);
  void (*set_observed_shifts)(struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *, CDSVector<code><</code>float>);
  void (*set_calculated_shifts)(struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *, struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *);
};
static struct __pyx_vtabstruct_17shift_calculators_Fast_energy_calculator_base *__pyx_vtabptr_17shift_calculators_Fast_energy_calculator_base;
static CYTHON_INLINE float __pyx_f_17shift_calculators_27Fast_energy_calculator_base__get_calculated_atom_shift(struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *, int);
static CYTHON_INLINE float __pyx_f_17shift_calculators_27Fast_energy_calculator_base__get_observed_atom_shift(struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *, int);
static CYTHON_INLINE float __pyx_f_17shift_calculators_27Fast_energy_calculator_base__get_shift_difference(struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *, int, int);
static CYTHON_INLINE float __pyx_f_17shift_calculators_27Fast_energy_calculator_base__adjust_shift(struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *, float, float);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1397")'> 1397: </pre>
<pre id='line1397' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1398")'> 1398: </pre>
<pre id='line1398' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1399")'> 1399:     def __init__(self):</pre>
<pre id='line1399' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1399
 * 
 * 
 *     def __init__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._energy_term_cache =  NULL
 *         self._theory_shifts =   NULL
 */

static int __pyx_pf_17shift_calculators_27Fast_energy_calculator_base___init__(struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1400")'> 1400:         self._energy_term_cache =  NULL</pre>
<pre id='line1400' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1400
 * 
 *     def __init__(self):
 *         self._energy_term_cache =  NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._theory_shifts =   NULL
 *         self._verbose = False
 */
  __pyx_v_self->_energy_term_cache = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1401")'> 1401:         self._theory_shifts =   NULL</pre>
<pre id='line1401' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1401
 *     def __init__(self):
 *         self._energy_term_cache =  NULL
 *         self._theory_shifts =   NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._verbose = False
 *         self.calls = 0
 */
  __pyx_v_self->_theory_shifts = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1402")'> 1402:         self._verbose = False</pre>
<pre id='line1402' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1402
 *         self._energy_term_cache =  NULL
 *         self._theory_shifts =   NULL
 *         self._verbose = False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.calls = 0
 * 
 */
  __pyx_v_self->_verbose = 0;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1403")'> 1403:         self.calls = 0</pre>
<pre id='line1403' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":1403
 *         self._theory_shifts =   NULL
 *         self._verbose = False
 *         self.calls = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_self->calls = 0;

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_27Fast_energy_calculator_base_3set_verbose(PyObject *__pyx_v_self, PyObject *__pyx_v_on); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_27Fast_energy_calculator_base_3set_verbose(PyObject *__pyx_v_self, PyObject *__pyx_v_on) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_verbose (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_27Fast_energy_calculator_base_2set_verbose(((struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *)__pyx_v_self), ((PyObject *)__pyx_v_on));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1404")'> 1404: </pre>
<pre id='line1404' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1405")'> 1405: </pre>
<pre id='line1405' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1406")'> 1406:     def set_verbose(self,on):</pre>
<pre id='line1406' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1406
 * 
 * 
 *     def set_verbose(self,on):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._verbose = on
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_27Fast_energy_calculator_base_2set_verbose(struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *__pyx_v_self, PyObject *__pyx_v_on) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_verbose", 0);
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line1407")'> 1407:         self._verbose = on</pre>
<pre id='line1407' class='code' style='background-color: #FFFF6a'>
  /* "Cython_shift_calculator.pyx":1407
 * 
 *     def set_verbose(self,on):
 *         self._verbose = on             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void set_observed_shifts(self, CDSVector[float] observed_shifts) nogil:
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_v_on);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_verbose = __pyx_t_1;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_energy_calculator_base.set_verbose", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1408")'> 1408: </pre>
<pre id='line1408' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1409")'> 1409:     cdef void set_observed_shifts(self, CDSVector[float] observed_shifts) nogil:</pre>
<pre id='line1409' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1409
 *         self._verbose = on
 * 
 *     cdef void set_observed_shifts(self, CDSVector[float] observed_shifts) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._observed_shifts =  observed_shifts
 * 
 */

static void __pyx_f_17shift_calculators_27Fast_energy_calculator_base_set_observed_shifts(struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *__pyx_v_self, CDSVector<code><</code>float> __pyx_v_observed_shifts) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1410")'> 1410:         self._observed_shifts =  observed_shifts</pre>
<pre id='line1410' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1410
 * 
 *     cdef void set_observed_shifts(self, CDSVector[float] observed_shifts) nogil:
 *         self._observed_shifts =  observed_shifts             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void set_calculated_shifts(self, CDSSharedVectorFloat calculated_shifts) nogil:
 */
  __pyx_v_self->_observed_shifts = __pyx_v_observed_shifts;

}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1411")'> 1411: </pre>
<pre id='line1411' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1412")'> 1412:     cdef void set_calculated_shifts(self, CDSSharedVectorFloat calculated_shifts) nogil:</pre>
<pre id='line1412' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1412
 *         self._observed_shifts =  observed_shifts
 * 
 *     cdef void set_calculated_shifts(self, CDSSharedVectorFloat calculated_shifts) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._theory_shifts = calculated_shifts.get_data()
 * 
 */

static void __pyx_f_17shift_calculators_27Fast_energy_calculator_base_set_calculated_shifts(struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *__pyx_v_self, struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_calculated_shifts) {
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1413")'> 1413:         self._theory_shifts = calculated_shifts.get_data()</pre>
<pre id='line1413' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":1413
 * 
 *     cdef void set_calculated_shifts(self, CDSSharedVectorFloat calculated_shifts) nogil:
 *         self._theory_shifts = calculated_shifts.get_data()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def set_energy_term_cache(self, energy_term_cache ):
 */
  __pyx_v_self->_theory_shifts = ((struct __pyx_vtabstruct_17shift_calculators_CDSSharedVectorFloat *)__pyx_v_calculated_shifts->__pyx_vtab)->get_data(__pyx_v_calculated_shifts);

}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_27Fast_energy_calculator_base_5set_energy_term_cache(PyObject *__pyx_v_self, PyObject *__pyx_v_energy_term_cache); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_27Fast_energy_calculator_base_5set_energy_term_cache(PyObject *__pyx_v_self, PyObject *__pyx_v_energy_term_cache) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_energy_term_cache (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_27Fast_energy_calculator_base_4set_energy_term_cache(((struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *)__pyx_v_self), ((PyObject *)__pyx_v_energy_term_cache));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1414")'> 1414: </pre>
<pre id='line1414' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1415")'> 1415:     def set_energy_term_cache(self, energy_term_cache ):</pre>
<pre id='line1415' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1415
 *         self._theory_shifts = calculated_shifts.get_data()
 * 
 *     def set_energy_term_cache(self, energy_term_cache ):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._energy_term_cache =  <code><</code>Constant_cache*> <code><</code>size_t> ctypes.addressof(energy_term_cache)
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_27Fast_energy_calculator_base_4set_energy_term_cache(struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *__pyx_v_self, PyObject *__pyx_v_energy_term_cache) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_energy_term_cache", 0);
</pre><pre class='line' style='background-color: #FFFF33' onclick='toggleDiv("line1416")'> 1416:         self._energy_term_cache =  &lt;Constant_cache*&gt; &lt;size_t&gt; ctypes.addressof(energy_term_cache)</pre>
<pre id='line1416' class='code' style='background-color: #FFFF33'>
  /* "Cython_shift_calculator.pyx":1416
 * 
 *     def set_energy_term_cache(self, energy_term_cache ):
 *         self._energy_term_cache =  <code><</code>Constant_cache*> <code><</code>size_t> ctypes.addressof(energy_term_cache)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef Constant_cache* _get_energy_terms(self, int target_atom_index) nogil:
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1416; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1416; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1416; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_energy_term_cache);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_energy_term_cache);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_energy_term_cache);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1416; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1416; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_self->_energy_term_cache = ((struct __pyx_t_17shift_calculators_Constant_cache *)((size_t)__pyx_t_4));

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_energy_calculator_base.set_energy_term_cache", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1417")'> 1417: </pre>
<pre id='line1417' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1418")'> 1418:     cdef Constant_cache* _get_energy_terms(self, int target_atom_index) nogil:</pre>
<pre id='line1418' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1418
 *         self._energy_term_cache =  <code><</code>Constant_cache*> <code><</code>size_t> ctypes.addressof(energy_term_cache)
 * 
 *     cdef Constant_cache* _get_energy_terms(self, int target_atom_index) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return &self._energy_term_cache[target_atom_index]
 * 
 */

static struct __pyx_t_17shift_calculators_Constant_cache *__pyx_f_17shift_calculators_27Fast_energy_calculator_base__get_energy_terms(struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *__pyx_v_self, int __pyx_v_target_atom_index) {
  struct __pyx_t_17shift_calculators_Constant_cache *__pyx_r;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1419")'> 1419:         return &amp;self._energy_term_cache[target_atom_index]</pre>
<pre id='line1419' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1419
 * 
 *     cdef Constant_cache* _get_energy_terms(self, int target_atom_index) nogil:
 *         return &self._energy_term_cache[target_atom_index]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline float  _get_calculated_atom_shift(self, int index) nogil:
 */
  __pyx_r = (&(__pyx_v_self->_energy_term_cache[__pyx_v_target_atom_index]));
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1420")'> 1420: </pre>
<pre id='line1420' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1421")'> 1421:     cdef inline float  _get_calculated_atom_shift(self, int index) nogil:</pre>
<pre id='line1421' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1421
 *         return &self._energy_term_cache[target_atom_index]
 * 
 *     cdef inline float  _get_calculated_atom_shift(self, int index) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._theory_shifts[0][index]
 * 
 */

static CYTHON_INLINE float __pyx_f_17shift_calculators_27Fast_energy_calculator_base__get_calculated_atom_shift(struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *__pyx_v_self, int __pyx_v_index) {
  float __pyx_r;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1422")'> 1422:         return self._theory_shifts[0][index]</pre>
<pre id='line1422' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1422
 * 
 *     cdef inline float  _get_calculated_atom_shift(self, int index) nogil:
 *         return self._theory_shifts[0][index]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline float _get_observed_atom_shift(self, int index) nogil:
 */
  __pyx_r = ((__pyx_v_self->_theory_shifts[0])[__pyx_v_index]);
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1423")'> 1423: </pre>
<pre id='line1423' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1424")'> 1424:     cdef inline float _get_observed_atom_shift(self, int index) nogil:</pre>
<pre id='line1424' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1424
 *         return self._theory_shifts[0][index]
 * 
 *     cdef inline float _get_observed_atom_shift(self, int index) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._observed_shifts[index]
 * 
 */

static CYTHON_INLINE float __pyx_f_17shift_calculators_27Fast_energy_calculator_base__get_observed_atom_shift(struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *__pyx_v_self, int __pyx_v_index) {
  float __pyx_r;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1425")'> 1425:         return self._observed_shifts[index]</pre>
<pre id='line1425' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1425
 * 
 *     cdef inline float _get_observed_atom_shift(self, int index) nogil:
 *         return self._observed_shifts[index]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline float  _get_shift_difference(self, int target_atom_index, int index) nogil:
 */
  __pyx_r = (__pyx_v_self->_observed_shifts[__pyx_v_index]);
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1426")'> 1426: </pre>
<pre id='line1426' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1427")'> 1427:     cdef inline float  _get_shift_difference(self, int target_atom_index, int index) nogil:</pre>
<pre id='line1427' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1427
 *         return self._observed_shifts[index]
 * 
 *     cdef inline float  _get_shift_difference(self, int target_atom_index, int index) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef float theory_shift
 *         cdef float observed_shift
 */

static CYTHON_INLINE float __pyx_f_17shift_calculators_27Fast_energy_calculator_base__get_shift_difference(struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *__pyx_v_self, CYTHON_UNUSED int __pyx_v_target_atom_index, int __pyx_v_index) {
  float __pyx_v_theory_shift;
  float __pyx_v_observed_shift;
  float __pyx_r;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1428")'> 1428:         cdef float theory_shift</pre>
<pre id='line1428' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1429")'> 1429:         cdef float observed_shift</pre>
<pre id='line1429' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1430")'> 1430:         theory_shift = self._get_calculated_atom_shift(index)</pre>
<pre id='line1430' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1430
 *         cdef float theory_shift
 *         cdef float observed_shift
 *         theory_shift = self._get_calculated_atom_shift(index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         observed_shift = self._get_observed_atom_shift(index)
 */
  __pyx_v_theory_shift = __pyx_f_17shift_calculators_27Fast_energy_calculator_base__get_calculated_atom_shift(__pyx_v_self, __pyx_v_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1431")'> 1431: </pre>
<pre id='line1431' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1432")'> 1432:         observed_shift = self._get_observed_atom_shift(index)</pre>
<pre id='line1432' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1432
 *         theory_shift = self._get_calculated_atom_shift(index)
 * 
 *         observed_shift = self._get_observed_atom_shift(index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         return observed_shift - theory_shift
 */
  __pyx_v_observed_shift = __pyx_f_17shift_calculators_27Fast_energy_calculator_base__get_observed_atom_shift(__pyx_v_self, __pyx_v_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1433")'> 1433: </pre>
<pre id='line1433' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1434")'> 1434:         return observed_shift - theory_shift</pre>
<pre id='line1434' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1434
 *         observed_shift = self._get_observed_atom_shift(index)
 * 
 *         return observed_shift - theory_shift             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline float _adjust_shift(self, float shift_diff, float flat_bottom_shift_limit) nogil:
 */
  __pyx_r = (__pyx_v_observed_shift - __pyx_v_theory_shift);
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1435")'> 1435: </pre>
<pre id='line1435' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1436")'> 1436:     cdef inline float _adjust_shift(self, float shift_diff, float flat_bottom_shift_limit) nogil:</pre>
<pre id='line1436' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1436
 *         return observed_shift - theory_shift
 * 
 *     cdef inline float _adjust_shift(self, float shift_diff, float flat_bottom_shift_limit) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result  = 0.0
 *         if (shift_diff > 0.0):
 */

static CYTHON_INLINE float __pyx_f_17shift_calculators_27Fast_energy_calculator_base__adjust_shift(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *__pyx_v_self, float __pyx_v_shift_diff, float __pyx_v_flat_bottom_shift_limit) {
  double __pyx_v_result;
  float __pyx_r;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1437")'> 1437:         result  = 0.0</pre>
<pre id='line1437' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1437
 * 
 *     cdef inline float _adjust_shift(self, float shift_diff, float flat_bottom_shift_limit) nogil:
 *         result  = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if (shift_diff > 0.0):
 *             result = shift_diff-flat_bottom_shift_limit
 */
  __pyx_v_result = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1438")'> 1438:         if (shift_diff &gt; 0.0):</pre>
<pre id='line1438' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1438
 *     cdef inline float _adjust_shift(self, float shift_diff, float flat_bottom_shift_limit) nogil:
 *         result  = 0.0
 *         if (shift_diff > 0.0):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             result = shift_diff-flat_bottom_shift_limit
 *         else:
 */
  __pyx_t_1 = (__pyx_v_shift_diff > 0.0);
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1439")'> 1439:             result = shift_diff-flat_bottom_shift_limit</pre>
<pre id='line1439' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1439
 *         result  = 0.0
 *         if (shift_diff > 0.0):
 *             result = shift_diff-flat_bottom_shift_limit             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             result = shift_diff + flat_bottom_shift_limit
 */
    __pyx_v_result = (__pyx_v_shift_diff - __pyx_v_flat_bottom_shift_limit);
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1440")'> 1440:         else:</pre>
<pre id='line1440' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1441")'> 1441:             result = shift_diff + flat_bottom_shift_limit</pre>
<pre id='line1441' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1441
 *             result = shift_diff-flat_bottom_shift_limit
 *         else:
 *             result = shift_diff + flat_bottom_shift_limit             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return result
 * 
 */
    __pyx_v_result = (__pyx_v_shift_diff + __pyx_v_flat_bottom_shift_limit);
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line1442")'> 1442:         return result</pre>
<pre id='line1442' class='code' style='background-color: #FFFF73'>
  /* "Cython_shift_calculator.pyx":1442
 *         else:
 *             result = shift_diff + flat_bottom_shift_limit
 *         return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #     @cython.profile(True)
 */
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_22Fast_energy_calculator_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_22Fast_energy_calculator_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) > 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) > 0) && unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__init__", 0))) return -1;
  __pyx_r = __pyx_pf_17shift_calculators_22Fast_energy_calculator___init__(((struct __pyx_obj_17shift_calculators_Fast_energy_calculator *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1443")'> 1443: </pre>
<pre id='line1443' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1444")'> 1444: #     @cython.profile(True)</pre>
<pre id='line1444' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1445")'> 1445: #     def __call__(self, CDSVector[int] target_atom_ids, int[:] active_atom_ids=None):</pre>
<pre id='line1445' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1446")'> 1446: #         cdef double start_time = 0.0</pre>
<pre id='line1446' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1447")'> 1447: #         cdef double end_time = 0.0</pre>
<pre id='line1447' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1448")'> 1448: #</pre>
<pre id='line1448' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1449")'> 1449: #         if self._verbose:</pre>
<pre id='line1449' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1450")'> 1450: #             start_time = time()</pre>
<pre id='line1450' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1451")'> 1451: #</pre>
<pre id='line1451' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1452")'> 1452: #         result = self.calc(target_atom_ids, active_atom_ids)</pre>
<pre id='line1452' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1453")'> 1453: #</pre>
<pre id='line1453' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1454")'> 1454: #         if self._verbose:</pre>
<pre id='line1454' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1455")'> 1455: #             end_time = time()</pre>
<pre id='line1455' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1456")'> 1456: #             print '   energy calculator: ',target_atom_ids.size(),' in', "%.17g" %  (end_time-start_time), "seconds"</pre>
<pre id='line1456' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1457")'> 1457: #</pre>
<pre id='line1457' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1458")'> 1458: #         return result</pre>
<pre id='line1458' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1459")'> 1459: </pre>
<pre id='line1459' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1460")'> 1460: cdef class Fast_energy_calculator(Fast_energy_calculator_base):</pre>
<pre id='line1460' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1460
 * #         return result
 * 
 * cdef class Fast_energy_calculator(Fast_energy_calculator_base):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     def __init__(self):
 *         Fast_energy_calculator_base.__init__(self)
 */

struct __pyx_vtabstruct_17shift_calculators_Fast_energy_calculator {
  struct __pyx_vtabstruct_17shift_calculators_Fast_energy_calculator_base __pyx_base;
  float (*calcEnergy)(struct __pyx_obj_17shift_calculators_Fast_energy_calculator *, CDSVector<code><</code>int>, struct __pyx_opt_args_17shift_calculators_22Fast_energy_calculator_calcEnergy *__pyx_optional_args);
  float (*_calc_one_energy)(struct __pyx_obj_17shift_calculators_Fast_energy_calculator *, int, int);
};
static struct __pyx_vtabstruct_17shift_calculators_Fast_energy_calculator *__pyx_vtabptr_17shift_calculators_Fast_energy_calculator;
static CYTHON_INLINE float __pyx_f_17shift_calculators_22Fast_energy_calculator__calc_one_energy(struct __pyx_obj_17shift_calculators_Fast_energy_calculator *, int, int);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1461")'> 1461:     def __init__(self):</pre>
<pre id='line1461' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1461
 * 
 * cdef class Fast_energy_calculator(Fast_energy_calculator_base):
 *     def __init__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         Fast_energy_calculator_base.__init__(self)
 * 
 */

static int __pyx_pf_17shift_calculators_22Fast_energy_calculator___init__(struct __pyx_obj_17shift_calculators_Fast_energy_calculator *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line1462")'> 1462:         Fast_energy_calculator_base.__init__(self)</pre>
<pre id='line1462' class='code' style='background-color: #FFFF46'>
  /* "Cython_shift_calculator.pyx":1462
 * cdef class Fast_energy_calculator(Fast_energy_calculator_base):
 *     def __init__(self):
 *         Fast_energy_calculator_base.__init__(self)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef float calcEnergy(Fast_energy_calculator self, CDSVector[int] target_atom_ids, CDSVector[int] *active_atom_ids=NULL):
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Fast_energy_calculator_base)), __pyx_n_s____init__);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1462; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1462; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_self));
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1462; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_energy_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1463")'> 1463: </pre>
<pre id='line1463' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1464")'> 1464:     cdef float calcEnergy(Fast_energy_calculator self, CDSVector[int] target_atom_ids, CDSVector[int] *active_atom_ids=NULL):</pre>
<pre id='line1464' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1464
 *         Fast_energy_calculator_base.__init__(self)
 * 
 *     cdef float calcEnergy(Fast_energy_calculator self, CDSVector[int] target_atom_ids, CDSVector[int] *active_atom_ids=NULL):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef float energy
 */

static float __pyx_f_17shift_calculators_22Fast_energy_calculator_calcEnergy(struct __pyx_obj_17shift_calculators_Fast_energy_calculator *__pyx_v_self, CDSVector<code><</code>int> __pyx_v_target_atom_ids, struct __pyx_opt_args_17shift_calculators_22Fast_energy_calculator_calcEnergy *__pyx_optional_args) {
  CDSVector<code><</code>int> *__pyx_v_active_atom_ids = ((CDSVector<code><</code>int> *)NULL);
  float __pyx_v_energy;
  int __pyx_v_active_atom_id;
  int __pyx_v_target_atom_id;
  int __pyx_v_i;
  float __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calcEnergy", 0);
  if (__pyx_optional_args) {
    if (__pyx_optional_args->__pyx_n > 0) {
      __pyx_v_active_atom_ids = __pyx_optional_args->active_atom_ids;
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1465")'> 1465: </pre>
<pre id='line1465' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1466")'> 1466:         cdef float energy</pre>
<pre id='line1466' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1467")'> 1467:         cdef int active_atom_id</pre>
<pre id='line1467' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1468")'> 1468:         cdef int target_atom_id</pre>
<pre id='line1468' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1469")'> 1469: </pre>
<pre id='line1469' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1470")'> 1470: </pre>
<pre id='line1470' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1471")'> 1471: </pre>
<pre id='line1471' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1472")'> 1472:         energy = 0.0</pre>
<pre id='line1472' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1472
 * 
 * 
 *         energy = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if active_atom_ids == NULL:
 */
  __pyx_v_energy = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1473")'> 1473: </pre>
<pre id='line1473' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1474")'> 1474:         if active_atom_ids == NULL:</pre>
<pre id='line1474' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1474
 *         energy = 0.0
 * 
 *         if active_atom_ids == NULL:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for i in range(target_atom_ids.size()):
 *                 target_atom_id = target_atom_ids[i]
 */
  __pyx_t_1 = (__pyx_v_active_atom_ids == NULL);
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1475")'> 1475:             for i in range(target_atom_ids.size()):</pre>
<pre id='line1475' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1475
 * 
 *         if active_atom_ids == NULL:
 *             for i in range(target_atom_ids.size()):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 target_atom_id = target_atom_ids[i]
 * 
 */
    __pyx_t_2 = __pyx_v_target_atom_ids.size();
    for (__pyx_t_3 = 0; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
      __pyx_v_i = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1476")'> 1476:                 target_atom_id = target_atom_ids[i]</pre>
<pre id='line1476' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1476
 *         if active_atom_ids == NULL:
 *             for i in range(target_atom_ids.size()):
 *                 target_atom_id = target_atom_ids[i]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 energy += self._calc_one_energy(target_atom_id, i)
 */
      __pyx_v_target_atom_id = (__pyx_v_target_atom_ids[__pyx_v_i]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1477")'> 1477: </pre>
<pre id='line1477' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1478")'> 1478:                 energy += self._calc_one_energy(target_atom_id, i)</pre>
<pre id='line1478' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1478
 *                 target_atom_id = target_atom_ids[i]
 * 
 *                 energy += self._calc_one_energy(target_atom_id, i)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             for i in  range(active_atom_ids[0].size()):
 */
      __pyx_v_energy = (__pyx_v_energy + __pyx_f_17shift_calculators_22Fast_energy_calculator__calc_one_energy(__pyx_v_self, __pyx_v_target_atom_id, __pyx_v_i));
    }
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1479")'> 1479:         else:</pre>
<pre id='line1479' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1480")'> 1480:             for i in  range(active_atom_ids[0].size()):</pre>
<pre id='line1480' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1480
 *                 energy += self._calc_one_energy(target_atom_id, i)
 *         else:
 *             for i in  range(active_atom_ids[0].size()):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 active_atom_id = active_atom_ids[0][i]
 *                 target_atom_id = target_atom_ids[active_atom_id]
 */
    __pyx_t_2 = (__pyx_v_active_atom_ids[0]).size();
    for (__pyx_t_3 = 0; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
      __pyx_v_i = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1481")'> 1481:                 active_atom_id = active_atom_ids[0][i]</pre>
<pre id='line1481' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1481
 *         else:
 *             for i in  range(active_atom_ids[0].size()):
 *                 active_atom_id = active_atom_ids[0][i]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 target_atom_id = target_atom_ids[active_atom_id]
 * 
 */
      __pyx_v_active_atom_id = ((__pyx_v_active_atom_ids[0])[__pyx_v_i]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1482")'> 1482:                 target_atom_id = target_atom_ids[active_atom_id]</pre>
<pre id='line1482' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1482
 *             for i in  range(active_atom_ids[0].size()):
 *                 active_atom_id = active_atom_ids[0][i]
 *                 target_atom_id = target_atom_ids[active_atom_id]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 energy += self._calc_one_energy(target_atom_id, active_atom_id)
 */
      __pyx_v_target_atom_id = (__pyx_v_target_atom_ids[__pyx_v_active_atom_id]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1483")'> 1483: </pre>
<pre id='line1483' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1484")'> 1484:                 energy += self._calc_one_energy(target_atom_id, active_atom_id)</pre>
<pre id='line1484' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1484
 *                 target_atom_id = target_atom_ids[active_atom_id]
 * 
 *                 energy += self._calc_one_energy(target_atom_id, active_atom_id)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
      __pyx_v_energy = (__pyx_v_energy + __pyx_f_17shift_calculators_22Fast_energy_calculator__calc_one_energy(__pyx_v_self, __pyx_v_target_atom_id, __pyx_v_active_atom_id));
    }
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1485")'> 1485: </pre>
<pre id='line1485' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1486")'> 1486: </pre>
<pre id='line1486' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1487")'> 1487: </pre>
<pre id='line1487' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1488")'> 1488:         self.calls += 1</pre>
<pre id='line1488' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1488
 * 
 * 
 *         self.calls += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return energy
 * 
 */
  __pyx_v_self->__pyx_base.calls = (__pyx_v_self->__pyx_base.calls + 1);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1489")'> 1489:         return energy</pre>
<pre id='line1489' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":1489
 * 
 *         self.calls += 1
 *         return energy             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline float _calc_one_energy(self, int target_atom_index, int index):
 */
  __pyx_r = __pyx_v_energy;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1490")'> 1490: </pre>
<pre id='line1490' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1491")'> 1491:     cdef inline float _calc_one_energy(self, int target_atom_index, int index):</pre>
<pre id='line1491' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1491
 *         return energy
 * 
 *     cdef inline float _calc_one_energy(self, int target_atom_index, int index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef float flat_bottom_shift_limit
 *         cdef float adjusted_shift_diff
 */

static CYTHON_INLINE float __pyx_f_17shift_calculators_22Fast_energy_calculator__calc_one_energy(struct __pyx_obj_17shift_calculators_Fast_energy_calculator *__pyx_v_self, int __pyx_v_target_atom_index, int __pyx_v_index) {
  float __pyx_v_flat_bottom_shift_limit;
  float __pyx_v_adjusted_shift_diff;
  float __pyx_v_end_harmonic;
  float __pyx_v_scale_harmonic;
  float __pyx_v_tanh_amplitude;
  float __pyx_v_tanh_elongation;
  float __pyx_v_tanh_y_offset;
  float __pyx_v_tanh_argument;
  float __pyx_v_energy;
  float __pyx_v_shift_diff;
  struct __pyx_t_17shift_calculators_Constant_cache *__pyx_v_energy_terms;
  float __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calc_one_energy", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1492")'> 1492:         cdef float flat_bottom_shift_limit</pre>
<pre id='line1492' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1493")'> 1493:         cdef float adjusted_shift_diff</pre>
<pre id='line1493' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1494")'> 1494:         cdef float end_harmonic</pre>
<pre id='line1494' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1495")'> 1495:         cdef float scale_harmonic</pre>
<pre id='line1495' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1496")'> 1496:         cdef float tanh_amplitude</pre>
<pre id='line1496' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1497")'> 1497:         cdef float tanh_elongation</pre>
<pre id='line1497' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1498")'> 1498:         cdef float tanh_y_offset</pre>
<pre id='line1498' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1499")'> 1499:         cdef float tanh_argument</pre>
<pre id='line1499' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1500")'> 1500:         cdef float energy</pre>
<pre id='line1500' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1501")'> 1501:         cdef float shift_diff</pre>
<pre id='line1501' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1502")'> 1502: </pre>
<pre id='line1502' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1503")'> 1503: </pre>
<pre id='line1503' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1504")'> 1504: </pre>
<pre id='line1504' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1505")'> 1505: </pre>
<pre id='line1505' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1506")'> 1506: </pre>
<pre id='line1506' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1507")'> 1507:         cdef float shift_diffs</pre>
<pre id='line1507' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1508")'> 1508:         cdef Constant_cache* energy_terms</pre>
<pre id='line1508' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1509")'> 1509: </pre>
<pre id='line1509' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1510")'> 1510:         shift_diff = self._get_shift_difference(target_atom_index, index)</pre>
<pre id='line1510' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1510
 *         cdef Constant_cache* energy_terms
 * 
 *         shift_diff = self._get_shift_difference(target_atom_index, index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         energy_terms = self._get_energy_terms(index)
 * 
 */
  __pyx_v_shift_diff = ((struct __pyx_vtabstruct_17shift_calculators_Fast_energy_calculator *)__pyx_v_self->__pyx_base.__pyx_vtab)->__pyx_base._get_shift_difference(((struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *)__pyx_v_self), __pyx_v_target_atom_index, __pyx_v_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1511")'> 1511:         energy_terms = self._get_energy_terms(index)</pre>
<pre id='line1511' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1511
 * 
 *         shift_diff = self._get_shift_difference(target_atom_index, index)
 *         energy_terms = self._get_energy_terms(index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         flat_bottom_shift_limit = energy_terms[0].flat_bottom_shift_limit
 */
  __pyx_v_energy_terms = ((struct __pyx_vtabstruct_17shift_calculators_Fast_energy_calculator *)__pyx_v_self->__pyx_base.__pyx_vtab)->__pyx_base._get_energy_terms(((struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *)__pyx_v_self), __pyx_v_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1512")'> 1512: </pre>
<pre id='line1512' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1513")'> 1513:         flat_bottom_shift_limit = energy_terms[0].flat_bottom_shift_limit</pre>
<pre id='line1513' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1513
 *         energy_terms = self._get_energy_terms(index)
 * 
 *         flat_bottom_shift_limit = energy_terms[0].flat_bottom_shift_limit             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         energy = 0.0
 */
  __pyx_t_1 = (__pyx_v_energy_terms[0]).flat_bottom_shift_limit;
  __pyx_v_flat_bottom_shift_limit = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1514")'> 1514: </pre>
<pre id='line1514' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1515")'> 1515:         energy = 0.0</pre>
<pre id='line1515' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1515
 *         flat_bottom_shift_limit = energy_terms[0].flat_bottom_shift_limit
 * 
 *         energy = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if fabs(shift_diff) > flat_bottom_shift_limit:
 *             adjusted_shift_diff = self._adjust_shift(shift_diff, flat_bottom_shift_limit)
 */
  __pyx_v_energy = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1516")'> 1516:         if fabs(shift_diff) &gt; flat_bottom_shift_limit:</pre>
<pre id='line1516' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1516
 * 
 *         energy = 0.0
 *         if fabs(shift_diff) > flat_bottom_shift_limit:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             adjusted_shift_diff = self._adjust_shift(shift_diff, flat_bottom_shift_limit)
 * 
 */
  __pyx_t_2 = (fabs(__pyx_v_shift_diff) > __pyx_v_flat_bottom_shift_limit);
  if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1517")'> 1517:             adjusted_shift_diff = self._adjust_shift(shift_diff, flat_bottom_shift_limit)</pre>
<pre id='line1517' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1517
 *         energy = 0.0
 *         if fabs(shift_diff) > flat_bottom_shift_limit:
 *             adjusted_shift_diff = self._adjust_shift(shift_diff, flat_bottom_shift_limit)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             end_harmonic = energy_terms[0].end_harmonic
 */
    __pyx_v_adjusted_shift_diff = ((struct __pyx_vtabstruct_17shift_calculators_Fast_energy_calculator *)__pyx_v_self->__pyx_base.__pyx_vtab)->__pyx_base._adjust_shift(((struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *)__pyx_v_self), __pyx_v_shift_diff, __pyx_v_flat_bottom_shift_limit);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1518")'> 1518: </pre>
<pre id='line1518' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1519")'> 1519:             end_harmonic = energy_terms[0].end_harmonic</pre>
<pre id='line1519' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1519
 *             adjusted_shift_diff = self._adjust_shift(shift_diff, flat_bottom_shift_limit)
 * 
 *             end_harmonic = energy_terms[0].end_harmonic             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             scale_harmonic = energy_terms[0].scale_harmonic
 * 
 */
    __pyx_t_1 = (__pyx_v_energy_terms[0]).end_harmonic;
    __pyx_v_end_harmonic = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1520")'> 1520:             scale_harmonic = energy_terms[0].scale_harmonic</pre>
<pre id='line1520' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1520
 * 
 *             end_harmonic = energy_terms[0].end_harmonic
 *             scale_harmonic = energy_terms[0].scale_harmonic             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_t_1 = (__pyx_v_energy_terms[0]).scale_harmonic;
    __pyx_v_scale_harmonic = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1521")'> 1521: </pre>
<pre id='line1521' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1522")'> 1522: </pre>
<pre id='line1522' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1523")'> 1523:             if adjusted_shift_diff &lt; end_harmonic:</pre>
<pre id='line1523' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1523
 * 
 * 
 *             if adjusted_shift_diff <code><</code> end_harmonic:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 energy += (adjusted_shift_diff/scale_harmonic)**2
 *             else:
 */
    __pyx_t_2 = (__pyx_v_adjusted_shift_diff <code><</code> __pyx_v_end_harmonic);
    if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1524")'> 1524:                 energy += (adjusted_shift_diff/scale_harmonic)**2</pre>
<pre id='line1524' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1524
 * 
 *             if adjusted_shift_diff <code><</code> end_harmonic:
 *                 energy += (adjusted_shift_diff/scale_harmonic)**2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 tanh_amplitude = energy_terms[0].tanh_amplitude
 */
      __pyx_v_energy = (__pyx_v_energy + powf((__pyx_v_adjusted_shift_diff / __pyx_v_scale_harmonic), 2.0));
      goto __pyx_L4;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1525")'> 1525:             else:</pre>
<pre id='line1525' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1526")'> 1526:                 tanh_amplitude = energy_terms[0].tanh_amplitude</pre>
<pre id='line1526' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1526
 *                 energy += (adjusted_shift_diff/scale_harmonic)**2
 *             else:
 *                 tanh_amplitude = energy_terms[0].tanh_amplitude             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 tanh_elongation = energy_terms[0].tanh_elongation
 *                 tanh_y_offset = energy_terms[0].tanh_y_offset
 */
      __pyx_t_1 = (__pyx_v_energy_terms[0]).tanh_amplitude;
      __pyx_v_tanh_amplitude = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1527")'> 1527:                 tanh_elongation = energy_terms[0].tanh_elongation</pre>
<pre id='line1527' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1527
 *             else:
 *                 tanh_amplitude = energy_terms[0].tanh_amplitude
 *                 tanh_elongation = energy_terms[0].tanh_elongation             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 tanh_y_offset = energy_terms[0].tanh_y_offset
 * 
 */
      __pyx_t_1 = (__pyx_v_energy_terms[0]).tanh_elongation;
      __pyx_v_tanh_elongation = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1528")'> 1528:                 tanh_y_offset = energy_terms[0].tanh_y_offset</pre>
<pre id='line1528' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1528
 *                 tanh_amplitude = energy_terms[0].tanh_amplitude
 *                 tanh_elongation = energy_terms[0].tanh_elongation
 *                 tanh_y_offset = energy_terms[0].tanh_y_offset             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 tanh_argument = tanh_elongation * (adjusted_shift_diff - end_harmonic)
 */
      __pyx_t_1 = (__pyx_v_energy_terms[0]).tanh_y_offset;
      __pyx_v_tanh_y_offset = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1529")'> 1529: </pre>
<pre id='line1529' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1530")'> 1530:                 tanh_argument = tanh_elongation * (adjusted_shift_diff - end_harmonic)</pre>
<pre id='line1530' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1530
 *                 tanh_y_offset = energy_terms[0].tanh_y_offset
 * 
 *                 tanh_argument = tanh_elongation * (adjusted_shift_diff - end_harmonic)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 energy += tanh_amplitude * tanh(tanh_argument) + tanh_y_offset;
 * 
 */
      __pyx_v_tanh_argument = (__pyx_v_tanh_elongation * (__pyx_v_adjusted_shift_diff - __pyx_v_end_harmonic));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1531")'> 1531:                 energy += tanh_amplitude * tanh(tanh_argument) + tanh_y_offset;</pre>
<pre id='line1531' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1531
 * 
 *                 tanh_argument = tanh_elongation * (adjusted_shift_diff - end_harmonic)
 *                 energy += tanh_amplitude * tanh(tanh_argument) + tanh_y_offset;             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
      __pyx_v_energy = (__pyx_v_energy + ((__pyx_v_tanh_amplitude * tanh(__pyx_v_tanh_argument)) + __pyx_v_tanh_y_offset));
    }
    __pyx_L4:;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1532")'> 1532: </pre>
<pre id='line1532' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1533")'> 1533: </pre>
<pre id='line1533' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1534")'> 1534:         return energy</pre>
<pre id='line1534' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":1534
 * 
 * 
 *         return energy             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef class Fast_force_factor_calculator(Fast_energy_calculator_base):
 */
  __pyx_r = __pyx_v_energy;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1535")'> 1535: </pre>
<pre id='line1535' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1536")'> 1536: cdef class Fast_force_factor_calculator(Fast_energy_calculator_base):</pre>
<pre id='line1536' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1536
 *         return energy
 * 
 * cdef class Fast_force_factor_calculator(Fast_energy_calculator_base):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #     @cython.profile(True)
 */

struct __pyx_vtabstruct_17shift_calculators_Fast_force_factor_calculator {
  struct __pyx_vtabstruct_17shift_calculators_Fast_energy_calculator_base __pyx_base;
  void (*calcFactors)(struct __pyx_obj_17shift_calculators_Fast_force_factor_calculator *, CDSVector<code><</code>int>, CDSVector<code><</code>float> *, struct __pyx_opt_args_17shift_calculators_28Fast_force_factor_calculator_calcFactors *__pyx_optional_args);
  float (*_calc_one_force_factor)(struct __pyx_obj_17shift_calculators_Fast_force_factor_calculator *, int, int);
};
static struct __pyx_vtabstruct_17shift_calculators_Fast_force_factor_calculator *__pyx_vtabptr_17shift_calculators_Fast_force_factor_calculator;
static CYTHON_INLINE float __pyx_f_17shift_calculators_28Fast_force_factor_calculator__calc_one_force_factor(struct __pyx_obj_17shift_calculators_Fast_force_factor_calculator *, int, int);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1537")'> 1537: </pre>
<pre id='line1537' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1538")'> 1538: #     @cython.profile(True)</pre>
<pre id='line1538' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1539")'> 1539: #     def __call__(self, int[:] target_atom_ids, float[:] result, CDSVector[int] *active_atom_ids):</pre>
<pre id='line1539' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1540")'> 1540: #         cdef double start_time =0.0</pre>
<pre id='line1540' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1541")'> 1541: #         cdef double end_time =0.0</pre>
<pre id='line1541' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1542")'> 1542: #</pre>
<pre id='line1542' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1543")'> 1543: #         if self._verbose:</pre>
<pre id='line1543' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1544")'> 1544: #             start_time = time()</pre>
<pre id='line1544' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1545")'> 1545: #</pre>
<pre id='line1545' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1546")'> 1546: #         self.calc( target_atom_ids, result,  active_atom_ids)</pre>
<pre id='line1546' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1547")'> 1547: #</pre>
<pre id='line1547' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1548")'> 1548: #         if self._verbose:</pre>
<pre id='line1548' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1549")'> 1549: #             end_time = time()</pre>
<pre id='line1549' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1550")'> 1550: #             print '   force factors : ',len(target_atom_ids),' in', "%.17g" %  (end_time-start_time), "seconds"</pre>
<pre id='line1550' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1551")'> 1551: </pre>
<pre id='line1551' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1552")'> 1552:     cdef void calcFactors(self, CDSVector[int] target_atom_ids, CDSVector[float] *result, CDSVector[int] *active_atom_ids=NULL) nogil:</pre>
<pre id='line1552' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1552
 * #             print '   force factors : ',len(target_atom_ids),' in', "%.17g" %  (end_time-start_time), "seconds"
 * 
 *     cdef void calcFactors(self, CDSVector[int] target_atom_ids, CDSVector[float] *result, CDSVector[int] *active_atom_ids=NULL) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *        #TODO: shouldn't be allocated each time
 *         cdef int target_atom_id
 */

static void __pyx_f_17shift_calculators_28Fast_force_factor_calculator_calcFactors(struct __pyx_obj_17shift_calculators_Fast_force_factor_calculator *__pyx_v_self, CDSVector<code><</code>int> __pyx_v_target_atom_ids, CDSVector<code><</code>float> *__pyx_v_result, struct __pyx_opt_args_17shift_calculators_28Fast_force_factor_calculator_calcFactors *__pyx_optional_args) {
  CDSVector<code><</code>int> *__pyx_v_active_atom_ids = ((CDSVector<code><</code>int> *)NULL);
  int __pyx_v_target_atom_id;
  int __pyx_v_active_atom_id;
  int __pyx_v_i;
  if (__pyx_optional_args) {
    if (__pyx_optional_args->__pyx_n > 0) {
      __pyx_v_active_atom_ids = __pyx_optional_args->active_atom_ids;
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1553")'> 1553:        #TODO: shouldn't be allocated each time</pre>
<pre id='line1553' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1554")'> 1554:         cdef int target_atom_id</pre>
<pre id='line1554' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1555")'> 1555:         cdef int active_atom_id</pre>
<pre id='line1555' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1556")'> 1556:         cdef int i</pre>
<pre id='line1556' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1557")'> 1557: </pre>
<pre id='line1557' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1558")'> 1558:         if active_atom_ids == NULL:</pre>
<pre id='line1558' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1558
 *         cdef int i
 * 
 *         if active_atom_ids == NULL:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for i in range(target_atom_ids.size()):
 *                 target_atom_id = target_atom_ids[i]
 */
  __pyx_t_1 = (__pyx_v_active_atom_ids == NULL);
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1559")'> 1559:             for i in range(target_atom_ids.size()):</pre>
<pre id='line1559' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1559
 * 
 *         if active_atom_ids == NULL:
 *             for i in range(target_atom_ids.size()):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 target_atom_id = target_atom_ids[i]
 *                 result[0][i] = self._calc_one_force_factor(target_atom_id, i)
 */
    __pyx_t_2 = __pyx_v_target_atom_ids.size();
    for (__pyx_t_3 = 0; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
      __pyx_v_i = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1560")'> 1560:                 target_atom_id = target_atom_ids[i]</pre>
<pre id='line1560' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1560
 *         if active_atom_ids == NULL:
 *             for i in range(target_atom_ids.size()):
 *                 target_atom_id = target_atom_ids[i]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 result[0][i] = self._calc_one_force_factor(target_atom_id, i)
 *         else:
 */
      __pyx_v_target_atom_id = (__pyx_v_target_atom_ids[__pyx_v_i]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1561")'> 1561:                 result[0][i] = self._calc_one_force_factor(target_atom_id, i)</pre>
<pre id='line1561' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1561
 *             for i in range(target_atom_ids.size()):
 *                 target_atom_id = target_atom_ids[i]
 *                 result[0][i] = self._calc_one_force_factor(target_atom_id, i)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             for i in  range(active_atom_ids.size()):
 */
      ((__pyx_v_result[0])[__pyx_v_i]) = __pyx_f_17shift_calculators_28Fast_force_factor_calculator__calc_one_force_factor(__pyx_v_self, __pyx_v_target_atom_id, __pyx_v_i);
    }
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1562")'> 1562:         else:</pre>
<pre id='line1562' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1563")'> 1563:             for i in  range(active_atom_ids.size()):</pre>
<pre id='line1563' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1563
 *                 result[0][i] = self._calc_one_force_factor(target_atom_id, i)
 *         else:
 *             for i in  range(active_atom_ids.size()):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 active_atom_id = active_atom_ids[0][i]
 *                 target_atom_id = target_atom_ids[active_atom_id]
 */
    __pyx_t_2 = __pyx_v_active_atom_ids->size();
    for (__pyx_t_3 = 0; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
      __pyx_v_i = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1564")'> 1564:                 active_atom_id = active_atom_ids[0][i]</pre>
<pre id='line1564' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1564
 *         else:
 *             for i in  range(active_atom_ids.size()):
 *                 active_atom_id = active_atom_ids[0][i]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 target_atom_id = target_atom_ids[active_atom_id]
 * 
 */
      __pyx_v_active_atom_id = ((__pyx_v_active_atom_ids[0])[__pyx_v_i]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1565")'> 1565:                 target_atom_id = target_atom_ids[active_atom_id]</pre>
<pre id='line1565' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1565
 *             for i in  range(active_atom_ids.size()):
 *                 active_atom_id = active_atom_ids[0][i]
 *                 target_atom_id = target_atom_ids[active_atom_id]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 result[0][i] = self._calc_one_force_factor(target_atom_id, active_atom_id)
 */
      __pyx_v_target_atom_id = (__pyx_v_target_atom_ids[__pyx_v_active_atom_id]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1566")'> 1566: </pre>
<pre id='line1566' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1567")'> 1567:                 result[0][i] = self._calc_one_force_factor(target_atom_id, active_atom_id)</pre>
<pre id='line1567' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1567
 *                 target_atom_id = target_atom_ids[active_atom_id]
 * 
 *                 result[0][i] = self._calc_one_force_factor(target_atom_id, active_atom_id)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
      ((__pyx_v_result[0])[__pyx_v_i]) = __pyx_f_17shift_calculators_28Fast_force_factor_calculator__calc_one_force_factor(__pyx_v_self, __pyx_v_target_atom_id, __pyx_v_active_atom_id);
    }
  }
  __pyx_L3:;

}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1568")'> 1568: </pre>
<pre id='line1568' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1569")'> 1569: </pre>
<pre id='line1569' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1570")'> 1570: </pre>
<pre id='line1570' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1571")'> 1571:     cdef inline float _calc_one_force_factor(self, int target_atom_id, int i) nogil:</pre>
<pre id='line1571' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1571
 * 
 * 
 *     cdef inline float _calc_one_force_factor(self, int target_atom_id, int i) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef float factor
 */

static CYTHON_INLINE float __pyx_f_17shift_calculators_28Fast_force_factor_calculator__calc_one_force_factor(struct __pyx_obj_17shift_calculators_Fast_force_factor_calculator *__pyx_v_self, int __pyx_v_target_atom_id, int __pyx_v_i) {
  float __pyx_v_factor;
  float __pyx_v_shift_diff;
  float __pyx_v_flat_bottom_shift_limit;
  struct __pyx_t_17shift_calculators_Constant_cache *__pyx_v_energy_terms;
  float __pyx_v_adjusted_shift_diff;
  float __pyx_v_end_harmonic;
  float __pyx_v_scale_harmonic;
  float __pyx_v_sqr_scale_harmonic;
  float __pyx_v_weight;
  float __pyx_v_tanh_amplitude;
  float __pyx_v_tanh_elongation;
  double __pyx_v_fact;
  float __pyx_r;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1572")'> 1572: </pre>
<pre id='line1572' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1573")'> 1573:         cdef float factor</pre>
<pre id='line1573' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1574")'> 1574:         cdef float shift_diff</pre>
<pre id='line1574' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1575")'> 1575:         cdef float flat_bottom_shift_limit</pre>
<pre id='line1575' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1576")'> 1576:         cdef Constant_cache* energy_terms</pre>
<pre id='line1576' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1577")'> 1577:         cdef float adjusted_shift_diff</pre>
<pre id='line1577' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1578")'> 1578:         cdef float end_harmonic</pre>
<pre id='line1578' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1579")'> 1579:         cdef float scale_harmonic</pre>
<pre id='line1579' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1580")'> 1580:         cdef float sqr_scale_harmonic</pre>
<pre id='line1580' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1581")'> 1581:         cdef float weight</pre>
<pre id='line1581' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1582")'> 1582:         cdef float tanh_amplitude</pre>
<pre id='line1582' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1583")'> 1583:         cdef float tanh_elongation</pre>
<pre id='line1583' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1584")'> 1584: </pre>
<pre id='line1584' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1585")'> 1585:         factor = 0.0</pre>
<pre id='line1585' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1585
 *         cdef float tanh_elongation
 * 
 *         factor = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_factor = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1586")'> 1586: </pre>
<pre id='line1586' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1587")'> 1587: </pre>
<pre id='line1587' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1588")'> 1588:         shift_diff = self._get_shift_difference(target_atom_id, i)</pre>
<pre id='line1588' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1588
 * 
 * 
 *         shift_diff = self._get_shift_difference(target_atom_id, i)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         energy_terms = self._get_energy_terms(i)
 * 
 */
  __pyx_v_shift_diff = ((struct __pyx_vtabstruct_17shift_calculators_Fast_force_factor_calculator *)__pyx_v_self->__pyx_base.__pyx_vtab)->__pyx_base._get_shift_difference(((struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *)__pyx_v_self), __pyx_v_target_atom_id, __pyx_v_i);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1589")'> 1589:         energy_terms = self._get_energy_terms(i)</pre>
<pre id='line1589' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1589
 * 
 *         shift_diff = self._get_shift_difference(target_atom_id, i)
 *         energy_terms = self._get_energy_terms(i)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_energy_terms = ((struct __pyx_vtabstruct_17shift_calculators_Fast_force_factor_calculator *)__pyx_v_self->__pyx_base.__pyx_vtab)->__pyx_base._get_energy_terms(((struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *)__pyx_v_self), __pyx_v_i);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1590")'> 1590: </pre>
<pre id='line1590' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1591")'> 1591: </pre>
<pre id='line1591' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1592")'> 1592:         flat_bottom_shift_limit = energy_terms[0].flat_bottom_shift_limit</pre>
<pre id='line1592' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1592
 * 
 * 
 *         flat_bottom_shift_limit = energy_terms[0].flat_bottom_shift_limit             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if fabs(shift_diff) > flat_bottom_shift_limit:
 */
  __pyx_t_1 = (__pyx_v_energy_terms[0]).flat_bottom_shift_limit;
  __pyx_v_flat_bottom_shift_limit = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1593")'> 1593: </pre>
<pre id='line1593' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1594")'> 1594:         if fabs(shift_diff) &gt; flat_bottom_shift_limit:</pre>
<pre id='line1594' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1594
 *         flat_bottom_shift_limit = energy_terms[0].flat_bottom_shift_limit
 * 
 *         if fabs(shift_diff) > flat_bottom_shift_limit:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             adjusted_shift_diff = self._adjust_shift(shift_diff, flat_bottom_shift_limit)
 *             end_harmonic = energy_terms[0].end_harmonic
 */
  __pyx_t_2 = (fabs(__pyx_v_shift_diff) > __pyx_v_flat_bottom_shift_limit);
  if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1595")'> 1595:             adjusted_shift_diff = self._adjust_shift(shift_diff, flat_bottom_shift_limit)</pre>
<pre id='line1595' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1595
 * 
 *         if fabs(shift_diff) > flat_bottom_shift_limit:
 *             adjusted_shift_diff = self._adjust_shift(shift_diff, flat_bottom_shift_limit)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             end_harmonic = energy_terms[0].end_harmonic
 *             scale_harmonic = energy_terms[0].scale_harmonic
 */
    __pyx_v_adjusted_shift_diff = ((struct __pyx_vtabstruct_17shift_calculators_Fast_force_factor_calculator *)__pyx_v_self->__pyx_base.__pyx_vtab)->__pyx_base._adjust_shift(((struct __pyx_obj_17shift_calculators_Fast_energy_calculator_base *)__pyx_v_self), __pyx_v_shift_diff, __pyx_v_flat_bottom_shift_limit);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1596")'> 1596:             end_harmonic = energy_terms[0].end_harmonic</pre>
<pre id='line1596' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1596
 *         if fabs(shift_diff) > flat_bottom_shift_limit:
 *             adjusted_shift_diff = self._adjust_shift(shift_diff, flat_bottom_shift_limit)
 *             end_harmonic = energy_terms[0].end_harmonic             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             scale_harmonic = energy_terms[0].scale_harmonic
 *             sqr_scale_harmonic = scale_harmonic**2
 */
    __pyx_t_1 = (__pyx_v_energy_terms[0]).end_harmonic;
    __pyx_v_end_harmonic = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1597")'> 1597:             scale_harmonic = energy_terms[0].scale_harmonic</pre>
<pre id='line1597' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1597
 *             adjusted_shift_diff = self._adjust_shift(shift_diff, flat_bottom_shift_limit)
 *             end_harmonic = energy_terms[0].end_harmonic
 *             scale_harmonic = energy_terms[0].scale_harmonic             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             sqr_scale_harmonic = scale_harmonic**2
 * 
 */
    __pyx_t_1 = (__pyx_v_energy_terms[0]).scale_harmonic;
    __pyx_v_scale_harmonic = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1598")'> 1598:             sqr_scale_harmonic = scale_harmonic**2</pre>
<pre id='line1598' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1598
 *             end_harmonic = energy_terms[0].end_harmonic
 *             scale_harmonic = energy_terms[0].scale_harmonic
 *             sqr_scale_harmonic = scale_harmonic**2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             weight = energy_terms[0].weight
 */
    __pyx_v_sqr_scale_harmonic = powf(__pyx_v_scale_harmonic, 2.0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1599")'> 1599: </pre>
<pre id='line1599' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1600")'> 1600:             weight = energy_terms[0].weight</pre>
<pre id='line1600' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1600
 *             sqr_scale_harmonic = scale_harmonic**2
 * 
 *             weight = energy_terms[0].weight             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             tanh_amplitude = energy_terms[0].tanh_amplitude
 */
    __pyx_t_1 = (__pyx_v_energy_terms[0]).weight;
    __pyx_v_weight = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1601")'> 1601: </pre>
<pre id='line1601' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1602")'> 1602:             tanh_amplitude = energy_terms[0].tanh_amplitude</pre>
<pre id='line1602' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1602
 *             weight = energy_terms[0].weight
 * 
 *             tanh_amplitude = energy_terms[0].tanh_amplitude             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             tanh_elongation = energy_terms[0].tanh_elongation
 * 
 */
    __pyx_t_1 = (__pyx_v_energy_terms[0]).tanh_amplitude;
    __pyx_v_tanh_amplitude = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1603")'> 1603:             tanh_elongation = energy_terms[0].tanh_elongation</pre>
<pre id='line1603' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1603
 * 
 *             tanh_amplitude = energy_terms[0].tanh_amplitude
 *             tanh_elongation = energy_terms[0].tanh_elongation             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             # TODO: add factor and lambda to give fact
 */
    __pyx_t_1 = (__pyx_v_energy_terms[0]).tanh_elongation;
    __pyx_v_tanh_elongation = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1604")'> 1604: </pre>
<pre id='line1604' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1605")'> 1605:             # TODO: add factor and lambda to give fact</pre>
<pre id='line1605' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1606")'> 1606:             fact =1.0</pre>
<pre id='line1606' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1606
 * 
 *             # TODO: add factor and lambda to give fact
 *             fact =1.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if adjusted_shift_diff <code><</code> end_harmonic:
 *                 factor = 2.0 * weight * adjusted_shift_diff * fact / sqr_scale_harmonic;
 */
    __pyx_v_fact = 1.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1607")'> 1607:             if adjusted_shift_diff &lt; end_harmonic:</pre>
<pre id='line1607' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1607
 *             # TODO: add factor and lambda to give fact
 *             fact =1.0
 *             if adjusted_shift_diff <code><</code> end_harmonic:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 factor = 2.0 * weight * adjusted_shift_diff * fact / sqr_scale_harmonic;
 *             else:
 */
    __pyx_t_2 = (__pyx_v_adjusted_shift_diff <code><</code> __pyx_v_end_harmonic);
    if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1608")'> 1608:                 factor = 2.0 * weight * adjusted_shift_diff * fact / sqr_scale_harmonic;</pre>
<pre id='line1608' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1608
 *             fact =1.0
 *             if adjusted_shift_diff <code><</code> end_harmonic:
 *                 factor = 2.0 * weight * adjusted_shift_diff * fact / sqr_scale_harmonic;             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 factor = weight * tanh_amplitude * tanh_elongation / (cosh(tanh_elongation * (adjusted_shift_diff - end_harmonic)))**2.0 * fact;
 */
      __pyx_v_factor = ((((2.0 * __pyx_v_weight) * __pyx_v_adjusted_shift_diff) * __pyx_v_fact) / __pyx_v_sqr_scale_harmonic);
      goto __pyx_L4;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1609")'> 1609:             else:</pre>
<pre id='line1609' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1610")'> 1610:                 factor = weight * tanh_amplitude * tanh_elongation / (cosh(tanh_elongation * (adjusted_shift_diff - end_harmonic)))**2.0 * fact;</pre>
<pre id='line1610' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1610
 *                 factor = 2.0 * weight * adjusted_shift_diff * fact / sqr_scale_harmonic;
 *             else:
 *                 factor = weight * tanh_amplitude * tanh_elongation / (cosh(tanh_elongation * (adjusted_shift_diff - end_harmonic)))**2.0 * fact;             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return factor
 * 
 */
      __pyx_v_factor = ((((__pyx_v_weight * __pyx_v_tanh_amplitude) * __pyx_v_tanh_elongation) / pow(cosh((__pyx_v_tanh_elongation * (__pyx_v_adjusted_shift_diff - __pyx_v_end_harmonic))), 2.0)) * __pyx_v_fact);
    }
    __pyx_L4:;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1611")'> 1611:         return factor</pre>
<pre id='line1611' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1611
 *             else:
 *                 factor = weight * tanh_amplitude * tanh_elongation / (cosh(tanh_elongation * (adjusted_shift_diff - end_harmonic)))**2.0 * fact;
 *         return factor             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_r = __pyx_v_factor;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_21Base_force_calculator_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_21Base_force_calculator_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED PyObject *__pyx_v_potential = 0;
  PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__potential,&__pyx_n_s__name,0};
    PyObject* values[2] = {0,0};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1612")'> 1612: </pre>
<pre id='line1612' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1613")'> 1613: </pre>
<pre id='line1613' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1614")'> 1614: cdef class Base_force_calculator:</pre>
<pre id='line1614' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1614
 * 
 * 
 * cdef class Base_force_calculator:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __init__(self,potential=None, name= "not set"):
 */

struct __pyx_vtabstruct_17shift_calculators_Base_force_calculator {
  void (*_bytes_to_components)(struct __pyx_obj_17shift_calculators_Base_force_calculator *, uintptr_t, uintptr_t);
  void (*_set_components)(struct __pyx_obj_17shift_calculators_Base_force_calculator *, std::map<code><</code>int,uintptr_t> *);
  void (*calc)(struct __pyx_obj_17shift_calculators_Base_force_calculator *, std::map<code><</code>int,uintptr_t> *, __Pyx_memviewslice, CDSVector<code><</code>float>, struct __pyx_obj_17shift_calculators_Out_array *, struct __pyx_opt_args_17shift_calculators_21Base_force_calculator_calc *__pyx_optional_args);
  void (*_do_calc_components)(struct __pyx_obj_17shift_calculators_Base_force_calculator *, __Pyx_memviewslice, CDSVector<code><</code>float>, struct __pyx_obj_17shift_calculators_Out_array *);
};
static struct __pyx_vtabstruct_17shift_calculators_Base_force_calculator *__pyx_vtabptr_17shift_calculators_Base_force_calculator;

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1615")'> 1615: </pre>
<pre id='line1615' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line1616")'> 1616:     def __init__(self,potential=None, name= "not set"):</pre>
<pre id='line1616' class='code' style='background-color: #FFFF3f'>
    /* "Cython_shift_calculator.pyx":1616
 * cdef class Base_force_calculator:
 * 
 *     def __init__(self,potential=None, name= "not set"):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._verbose = False
 * 
 */
    values[0] = ((PyObject *)Py_None);
    values[1] = ((PyObject *)__pyx_kp_s_24);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__potential);
          if (value) { values[0] = value; kw_args--; }
        }
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1616; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_potential = values[0];
    __pyx_v_name = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 0, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1616; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Base_force_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_21Base_force_calculator___init__(((struct __pyx_obj_17shift_calculators_Base_force_calculator *)__pyx_v_self), __pyx_v_potential, __pyx_v_name);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

static int __pyx_pf_17shift_calculators_21Base_force_calculator___init__(struct __pyx_obj_17shift_calculators_Base_force_calculator *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_potential, PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1617")'> 1617:         self._verbose = False</pre>
<pre id='line1617' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1617
 * 
 *     def __init__(self,potential=None, name= "not set"):
 *         self._verbose = False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_self->_verbose = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1618")'> 1618: </pre>
<pre id='line1618' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1619")'> 1619: </pre>
<pre id='line1619' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line1620")'> 1620:         self._name = name</pre>
<pre id='line1620' class='code' style='background-color: #FFFF62'>
  /* "Cython_shift_calculator.pyx":1620
 * 
 * 
 *         self._name = name             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  if (!(likely(<span class='py_c_api'>PyString_CheckExact</span>(__pyx_v_name))||((__pyx_v_name) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected str, got %.200s", Py_TYPE(__pyx_v_name)->tp_name), 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1620; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_name);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_name);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_name);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_name));
  __pyx_v_self->_name = ((PyObject*)__pyx_v_name);

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Base_force_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_21Base_force_calculator_3set_verbose(PyObject *__pyx_v_self, PyObject *__pyx_v_on); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_21Base_force_calculator_3set_verbose(PyObject *__pyx_v_self, PyObject *__pyx_v_on) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_verbose (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_21Base_force_calculator_2set_verbose(((struct __pyx_obj_17shift_calculators_Base_force_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_on));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1621")'> 1621: </pre>
<pre id='line1621' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1622")'> 1622: </pre>
<pre id='line1622' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1623")'> 1623:     def set_verbose(self,on):</pre>
<pre id='line1623' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1623
 * 
 * 
 *     def set_verbose(self,on):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._verbose = on
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_21Base_force_calculator_2set_verbose(struct __pyx_obj_17shift_calculators_Base_force_calculator *__pyx_v_self, PyObject *__pyx_v_on) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_verbose", 0);
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line1624")'> 1624:         self._verbose = on</pre>
<pre id='line1624' class='code' style='background-color: #FFFF6a'>
  /* "Cython_shift_calculator.pyx":1624
 * 
 *     def set_verbose(self,on):
 *         self._verbose = on             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_v_on);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1624; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_verbose = __pyx_t_1;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Base_force_calculator.set_verbose", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1625")'> 1625: </pre>
<pre id='line1625' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1626")'> 1626:     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:</pre>
<pre id='line1626' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1626
 *         self._verbose = on
 * 
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         with gil:
 *             print >> sys.stderr, "please implement _bytes_to_components, this is a pure virtual function"
 */

static void __pyx_f_17shift_calculators_21Base_force_calculator__bytes_to_components(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Base_force_calculator *__pyx_v_self, CYTHON_UNUSED uintptr_t __pyx_v_data, CYTHON_UNUSED uintptr_t __pyx_v_length) {
  #ifdef WITH_THREAD
  PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
  #endif
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_components", 0);
  #ifdef WITH_THREAD
  PyGILState_Release(__pyx_gilstate_save);
  #endif
  /*try:*/ {
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line1627")'> 1627:         with gil:</pre>
<pre id='line1627' class='code' style='background-color: #FFFFb6'>
    /* "Cython_shift_calculator.pyx":1627
 * 
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:
 *         with gil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print >> sys.stderr, "please implement _bytes_to_components, this is a pure virtual function"
 *             sys.exit(-1)
 */
    {
        #ifdef WITH_THREAD
        PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
        #endif
        /*try:*/ {

        /* "Cython_shift_calculator.pyx":1627
 * 
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:
 *         with gil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print >> sys.stderr, "please implement _bytes_to_components, this is a pure virtual function"
 *             sys.exit(-1)
 */
        /*finally:*/ {
          int __pyx_why;
          __pyx_why = 0; goto __pyx_L8;
          __pyx_L7: __pyx_why = 4; goto __pyx_L8;
          __pyx_L8:;
          #ifdef WITH_THREAD
          PyGILState_Release(__pyx_gilstate_save);
          #endif
          switch (__pyx_why) {
            case 4: goto __pyx_L4;
          }
        }
    }
  }
  /*finally:*/ {
    int __pyx_why;
    __pyx_why = 0; goto __pyx_L5;
    __pyx_L4: __pyx_why = 4; goto __pyx_L5;
    __pyx_L5:;
    #ifdef WITH_THREAD
    __pyx_gilstate_save = PyGILState_Ensure();
    #endif
    switch (__pyx_why) {
      case 4: goto __pyx_L1_error;
    }
  }

  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Base_force_calculator._bytes_to_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  #ifdef WITH_THREAD
  PyGILState_Release(__pyx_gilstate_save);
  #endif
}
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line1628")'> 1628:             print &gt;&gt; sys.stderr, "please implement _bytes_to_components, this is a pure virtual function"</pre>
<pre id='line1628' class='code' style='background-color: #FFFF79'>
          /* "Cython_shift_calculator.pyx":1628
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:
 *         with gil:
 *             print >> sys.stderr, "please implement _bytes_to_components, this is a pure virtual function"             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             sys.exit(-1)
 * 
 */
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__sys);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1628; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__stderr);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1628; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(__pyx_t_2, ((PyObject *)__pyx_kp_s_20)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1628; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line1629")'> 1629:             sys.exit(-1)</pre>
<pre id='line1629' class='code' style='background-color: #FFFF55'>
          /* "Cython_shift_calculator.pyx":1629
 *         with gil:
 *             print >> sys.stderr, "please implement _bytes_to_components, this is a pure virtual function"
 *             sys.exit(-1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void _set_components(self, cmap[int, uintptr_t] *components) nogil:
 */
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__sys);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1629; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
          __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__exit);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1629; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_k_tuple_35), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1629; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        }

  /* "Cython_shift_calculator.pyx":1629
 *         with gil:
 *             print >> sys.stderr, "please implement _bytes_to_components, this is a pure virtual function"
 *             sys.exit(-1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void _set_components(self, cmap[int, uintptr_t] *components) nogil:
 */
  __pyx_k_tuple_35 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_neg_1);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_35)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1629; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_35);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_35));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1630")'> 1630: </pre>
<pre id='line1630' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1631")'> 1631:     cdef void _set_components(self, cmap[int, uintptr_t] *components) nogil:</pre>
<pre id='line1631' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1631
 *             sys.exit(-1)
 * 
 *     cdef void _set_components(self, cmap[int, uintptr_t] *components) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._bytes_to_components(components[0][ATOM], components[0][NATOM])
 */

static void __pyx_f_17shift_calculators_21Base_force_calculator__set_components(struct __pyx_obj_17shift_calculators_Base_force_calculator *__pyx_v_self, std::map<code><</code>int,uintptr_t> *__pyx_v_components) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1632")'> 1632: </pre>
<pre id='line1632' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1633")'> 1633:         self._bytes_to_components(components[0][ATOM], components[0][NATOM])</pre>
<pre id='line1633' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1633
 *     cdef void _set_components(self, cmap[int, uintptr_t] *components) nogil:
 * 
 *         self._bytes_to_components(components[0][ATOM], components[0][NATOM])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._simulation = <code><</code>EnsembleSimulation*><code><</code>size_t>components[0][SIMU]
 * 
 */
  ((struct __pyx_vtabstruct_17shift_calculators_Base_force_calculator *)__pyx_v_self->__pyx_vtab)->_bytes_to_components(__pyx_v_self, ((__pyx_v_components[0])[__pyx_v_17shift_calculators_ATOM]), ((__pyx_v_components[0])[__pyx_v_17shift_calculators_NATOM]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1634")'> 1634:         self._simulation = &lt;EnsembleSimulation*&gt;&lt;size_t&gt;components[0][SIMU]</pre>
<pre id='line1634' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1634
 * 
 *         self._bytes_to_components(components[0][ATOM], components[0][NATOM])
 *         self._simulation = <code><</code>EnsembleSimulation*><code><</code>size_t>components[0][SIMU]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_self->_simulation = ((EnsembleSimulation *)((size_t)((__pyx_v_components[0])[__pyx_v_17shift_calculators_SIMU])));

}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1635")'> 1635: </pre>
<pre id='line1635' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1636")'> 1636: </pre>
<pre id='line1636' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1637")'> 1637: #    TODO should most probably be a fixed array</pre>
<pre id='line1637' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1638")'> 1638:     @cython.profile(True)</pre>
<pre id='line1638' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1639")'> 1639:     cdef void calc(self, cmap[int,uintptr_t] *components, int[:] component_to_result, CDSVector[float] force_factors, Out_array forces, int[:] active_components=None) nogil:</pre>
<pre id='line1639' class='code' style='background-color: #FFFFd4'>
/* "Cython_shift_calculator.pyx":1639
 * #    TODO should most probably be a fixed array
 *     @cython.profile(True)
 *     cdef void calc(self, cmap[int,uintptr_t] *components, int[:] component_to_result, CDSVector[float] force_factors, Out_array forces, int[:] active_components=None) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */

static void __pyx_f_17shift_calculators_21Base_force_calculator_calc(struct __pyx_obj_17shift_calculators_Base_force_calculator *__pyx_v_self, std::map<code><</code>int,uintptr_t> *__pyx_v_components, __Pyx_memviewslice __pyx_v_component_to_result, CDSVector<code><</code>float> __pyx_v_force_factors, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces, struct __pyx_opt_args_17shift_calculators_21Base_force_calculator_calc *__pyx_optional_args) {
  __Pyx_memviewslice __pyx_v_active_components = __pyx_k_36;
  if (__pyx_optional_args) {
    if (__pyx_optional_args->__pyx_n > 0) {
      __pyx_v_active_components = __pyx_optional_args->active_components;
    }
  }

  /* "Cython_shift_calculator.pyx":1639
 * #    TODO should most probably be a fixed array
 *     @cython.profile(True)
 *     cdef void calc(self, cmap[int,uintptr_t] *components, int[:] component_to_result, CDSVector[float] force_factors, Out_array forces, int[:] active_components=None) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(Py_None);
  if (unlikely(!__pyx_t_3.memview))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_k_36 = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1640")'> 1640: </pre>
<pre id='line1640' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1641")'> 1641: </pre>
<pre id='line1641' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1642")'> 1642:         self._set_components(components)</pre>
<pre id='line1642' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1642
 * 
 * 
 *         self._set_components(components)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #        TODO rename component to result to something better
 *         self._active_components = active_components
 */
  ((struct __pyx_vtabstruct_17shift_calculators_Base_force_calculator *)__pyx_v_self->__pyx_vtab)->_set_components(__pyx_v_self, __pyx_v_components);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1643")'> 1643: #        TODO rename component to result to something better</pre>
<pre id='line1643' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1644")'> 1644:         self._active_components = active_components</pre>
<pre id='line1644' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1644
 *         self._set_components(components)
 * #        TODO rename component to result to something better
 *         self._active_components = active_components             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._do_calc_components(component_to_result, force_factors, forces)
 * 
 */
  __PYX_XDEC_MEMVIEW(&__pyx_v_self->_active_components, 0);
  __PYX_INC_MEMVIEW(&__pyx_v_active_components, 1);
  __pyx_v_self->_active_components = __pyx_v_active_components;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1645")'> 1645:         self._do_calc_components(component_to_result, force_factors, forces)</pre>
<pre id='line1645' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1645
 * #        TODO rename component to result to something better
 *         self._active_components = active_components
 *         self._do_calc_components(component_to_result, force_factors, forces)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #        component_target_atom_ids = components.get_component_atom_ids()
 */
  ((struct __pyx_vtabstruct_17shift_calculators_Base_force_calculator *)__pyx_v_self->__pyx_vtab)->_do_calc_components(__pyx_v_self, __pyx_v_component_to_result, __pyx_v_force_factors, __pyx_v_forces);

}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1646")'> 1646: </pre>
<pre id='line1646' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1647")'> 1647: #        component_target_atom_ids = components.get_component_atom_ids()</pre>
<pre id='line1647' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1648")'> 1648: #        for i,target_atom_id in enumerate(target_atom_ids):</pre>
<pre id='line1648' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1649")'> 1649: #            if target_atom_id in component_target_atom_ids:</pre>
<pre id='line1649' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1650")'> 1650: #                try:</pre>
<pre id='line1650' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1651")'> 1651: #                    index_range = components.get_component_range(target_atom_id)</pre>
<pre id='line1651' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1652")'> 1652: #                except ValueError:</pre>
<pre id='line1652' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1653")'> 1653: #                    print "warning atom is not in list", target_atom_id, Atom_utils._get_atom_info_from_index(target_atom_id),self._name</pre>
<pre id='line1653' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1654")'> 1654: #                    index_range = []</pre>
<pre id='line1654' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1655")'> 1655: #                for index in range(*index_range):</pre>
<pre id='line1655' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1656")'> 1656: </pre>
<pre id='line1656' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1657")'> 1657: </pre>
<pre id='line1657' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1658")'> 1658:     cdef void _do_calc_components(self, int[:] component_to_result,  CDSVector[float] force_factors, Out_array force) nogil:</pre>
<pre id='line1658' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1658
 * 
 * 
 *     cdef void _do_calc_components(self, int[:] component_to_result,  CDSVector[float] force_factors, Out_array force) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         with gil:
 *             raise Exception("this should not be called!")
 */

static void __pyx_f_17shift_calculators_21Base_force_calculator__do_calc_components(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Base_force_calculator *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_component_to_result, CDSVector<code><</code>float> __pyx_v_force_factors, CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_force) {
  #ifdef WITH_THREAD
  PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
  #endif
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_do_calc_components", 0);
  #ifdef WITH_THREAD
  PyGILState_Release(__pyx_gilstate_save);
  #endif
  /*try:*/ {
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line1659")'> 1659:         with gil:</pre>
<pre id='line1659' class='code' style='background-color: #FFFF66'>
    /* "Cython_shift_calculator.pyx":1659
 * 
 *     cdef void _do_calc_components(self, int[:] component_to_result,  CDSVector[float] force_factors, Out_array force) nogil:
 *         with gil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             raise Exception("this should not be called!")
 * 
 */
    {
        #ifdef WITH_THREAD
        PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
        #endif
        /*try:*/ {

        /* "Cython_shift_calculator.pyx":1659
 * 
 *     cdef void _do_calc_components(self, int[:] component_to_result,  CDSVector[float] force_factors, Out_array force) nogil:
 *         with gil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             raise Exception("this should not be called!")
 * 
 */
        /*finally:*/ {
          int __pyx_why;
          __pyx_why = 0; goto __pyx_L8;
          __pyx_L7: __pyx_why = 4; goto __pyx_L8;
          __pyx_L8:;
          #ifdef WITH_THREAD
          PyGILState_Release(__pyx_gilstate_save);
          #endif
          switch (__pyx_why) {
            case 4: goto __pyx_L4;
          }
        }
    }
  }
  /*finally:*/ {
    int __pyx_why;
    __pyx_why = 0; goto __pyx_L5;
    __pyx_L4: __pyx_why = 4; goto __pyx_L5;
    __pyx_L5:;
    #ifdef WITH_THREAD
    __pyx_gilstate_save = PyGILState_Ensure();
    #endif
    switch (__pyx_why) {
      case 4: goto __pyx_L1_error;
    }
  }

  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Base_force_calculator._do_calc_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  #ifdef WITH_THREAD
  PyGILState_Release(__pyx_gilstate_save);
  #endif
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_46Fast_distance_based_potential_force_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_46Fast_distance_based_potential_force_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) > 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) > 0) && unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__cinit__", 0))) return -1;
  __pyx_r = __pyx_pf_17shift_calculators_46Fast_distance_based_potential_force_calculator___cinit__(((struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line1660")'> 1660:             raise Exception("this should not be called!")</pre>
<pre id='line1660' class='code' style='background-color: #FFFF6e'>
          /* "Cython_shift_calculator.pyx":1660
 *     cdef void _do_calc_components(self, int[:] component_to_result,  CDSVector[float] force_factors, Out_array force) nogil:
 *         with gil:
 *             raise Exception("this should not be called!")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
          __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_Exception, ((PyObject *)__pyx_k_tuple_38), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1660; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1660; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
        }

  /* "Cython_shift_calculator.pyx":1660
 *     cdef void _do_calc_components(self, int[:] component_to_result,  CDSVector[float] force_factors, Out_array force) nogil:
 *         with gil:
 *             raise Exception("this should not be called!")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_k_tuple_38 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_37));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_38)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_38);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_38));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1661")'> 1661: </pre>
<pre id='line1661' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1662")'> 1662: </pre>
<pre id='line1662' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1663")'> 1663: </pre>
<pre id='line1663' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1664")'> 1664: </pre>
<pre id='line1664' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1665")'> 1665: cdef class Fast_distance_based_potential_force_calculator(Base_force_calculator):</pre>
<pre id='line1665' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1665
 * 
 * 
 * cdef class Fast_distance_based_potential_force_calculator(Base_force_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator {
  struct __pyx_obj_17shift_calculators_Base_force_calculator __pyx_base;
  int _target_atom_index;
  int _distance_atom_index_1;
  int _distance_atom_index_2;
  int _exponent_index;
  int _coefficient_index;
  int _smoothed;
  float _smoothing_factor;
  float _cutoff;
  struct __pyx_t_17shift_calculators_Distance_component *_compiled_components;
  int _num_components;
  PyObject *raw_data;
};


/* "Cython_shift_calculator.pyx":1665
 * 
 * 
 * cdef class Fast_distance_based_potential_force_calculator(Base_force_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */

struct __pyx_vtabstruct_17shift_calculators_Fast_distance_based_potential_force_calculator {
  struct __pyx_vtabstruct_17shift_calculators_Base_force_calculator __pyx_base;
  Vec3 (*_xyz_distances)(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *, int, int);
  float (*_sum_xyz_distances_2)(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *, int, int);
  float (*_cython_calc_single_force_factor)(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *, int, float);
  void (*_distance_calc_single_force_set)(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *, int, float, struct __pyx_obj_17shift_calculators_Out_array *);
};
static struct __pyx_vtabstruct_17shift_calculators_Fast_distance_based_potential_force_calculator *__pyx_vtabptr_17shift_calculators_Fast_distance_based_potential_force_calculator;
static CYTHON_INLINE Vec3 __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__xyz_distances(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *, int, int);
static CYTHON_INLINE float __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__sum_xyz_distances_2(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *, int, int);
static CYTHON_INLINE float __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__cython_calc_single_force_factor(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *, int, float);
static CYTHON_INLINE void __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__distance_calc_single_force_set(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *, int, float, struct __pyx_obj_17shift_calculators_Out_array *);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1666")'> 1666: </pre>
<pre id='line1666' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1667")'> 1667: </pre>
<pre id='line1667' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1668")'> 1668: </pre>
<pre id='line1668' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1669")'> 1669:     cdef int  _target_atom_index</pre>
<pre id='line1669' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1670")'> 1670:     cdef int  _distance_atom_index_1</pre>
<pre id='line1670' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1671")'> 1671:     cdef int  _distance_atom_index_2</pre>
<pre id='line1671' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1672")'> 1672:     cdef int  _exponent_index</pre>
<pre id='line1672' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1673")'> 1673:     cdef int  _coefficient_index</pre>
<pre id='line1673' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1674")'> 1674:     cdef bint  _smoothed</pre>
<pre id='line1674' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1675")'> 1675:     cdef float _smoothing_factor</pre>
<pre id='line1675' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1676")'> 1676:     cdef float _cutoff</pre>
<pre id='line1676' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1677")'> 1677:     cdef Distance_component* _compiled_components</pre>
<pre id='line1677' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1678")'> 1678:     cdef int _num_components</pre>
<pre id='line1678' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1679")'> 1679:     cdef object raw_data</pre>
<pre id='line1679' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1680")'> 1680: </pre>
<pre id='line1680' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1681")'> 1681:     def __cinit__(self):</pre>
<pre id='line1681' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1681
 *     cdef object raw_data
 * 
 *     def __cinit__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components  = NULL
 *         self._num_components =  0
 */

static int __pyx_pf_17shift_calculators_46Fast_distance_based_potential_force_calculator___cinit__(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1682")'> 1682:         self._compiled_components  = NULL</pre>
<pre id='line1682' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1682
 * 
 *     def __cinit__(self):
 *         self._compiled_components  = NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components =  0
 * 
 */
  __pyx_v_self->_compiled_components = NULL;
</pre><pre class='line' style='background-color: #FFFF32' onclick='toggleDiv("line1683")'> 1683:         self._num_components =  0</pre>
<pre id='line1683' class='code' style='background-color: #FFFF32'>
  /* "Cython_shift_calculator.pyx":1683
 *     def __cinit__(self):
 *         self._compiled_components  = NULL
 *         self._num_components =  0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __init__(self, bint smoothed, name="Not set"):
 */
  __pyx_v_self->_num_components = 0;

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_46Fast_distance_based_potential_force_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_46Fast_distance_based_potential_force_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_smoothed;
  PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__smoothed,&__pyx_n_s__name,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject *)__pyx_kp_s_39);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__smoothed)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1685; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_smoothed = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_smoothed == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1685; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_name = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1685; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_distance_based_potential_force_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_46Fast_distance_based_potential_force_calculator_2__init__(((struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *)__pyx_v_self), __pyx_v_smoothed, __pyx_v_name);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1684")'> 1684: </pre>
<pre id='line1684' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1685")'> 1685:     def __init__(self, bint smoothed, name="Not set"):</pre>
<pre id='line1685' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1685
 *         self._num_components =  0
 * 
 *     def __init__(self, bint smoothed, name="Not set"):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         super(Fast_distance_based_potential_force_calculator, self).__init__(name=name)
 *         self._smoothed =  smoothed
 */

static int __pyx_pf_17shift_calculators_46Fast_distance_based_potential_force_calculator_2__init__(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *__pyx_v_self, int __pyx_v_smoothed, PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFF34' onclick='toggleDiv("line1686")'> 1686:         super(Fast_distance_based_potential_force_calculator, self).__init__(name=name)</pre>
<pre id='line1686' class='code' style='background-color: #FFFF34'>
  /* "Cython_shift_calculator.pyx":1686
 * 
 *     def __init__(self, bint smoothed, name="Not set"):
 *         super(Fast_distance_based_potential_force_calculator, self).__init__(name=name)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._smoothed =  smoothed
 *         self._smoothing_factor =  DEFAULT_SMOOTHING_FACTOR
 */
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1686; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Fast_distance_based_potential_force_calculator)));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Fast_distance_based_potential_force_calculator)));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Fast_distance_based_potential_force_calculator)));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_self));
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_super, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1686; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s____init__);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1686; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1686; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, ((PyObject *)__pyx_n_s__name), __pyx_v_name) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1686; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), ((PyObject *)__pyx_t_2));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1686; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1687")'> 1687:         self._smoothed =  smoothed</pre>
<pre id='line1687' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1687
 *     def __init__(self, bint smoothed, name="Not set"):
 *         super(Fast_distance_based_potential_force_calculator, self).__init__(name=name)
 *         self._smoothed =  smoothed             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._smoothing_factor =  DEFAULT_SMOOTHING_FACTOR
 *         self._cutoff =  DEFAULT_CUTOFF
 */
  __pyx_v_self->_smoothed = __pyx_v_smoothed;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1688")'> 1688:         self._smoothing_factor =  DEFAULT_SMOOTHING_FACTOR</pre>
<pre id='line1688' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1688
 *         super(Fast_distance_based_potential_force_calculator, self).__init__(name=name)
 *         self._smoothed =  smoothed
 *         self._smoothing_factor =  DEFAULT_SMOOTHING_FACTOR             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._cutoff =  DEFAULT_CUTOFF
 * 
 */
  __pyx_v_self->_smoothing_factor = __pyx_v_17shift_calculators_DEFAULT_SMOOTHING_FACTOR;
</pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line1689")'> 1689:         self._cutoff =  DEFAULT_CUTOFF</pre>
<pre id='line1689' class='code' style='background-color: #FFFF96'>
  /* "Cython_shift_calculator.pyx":1689
 *         self._smoothed =  smoothed
 *         self._smoothing_factor =  DEFAULT_SMOOTHING_FACTOR
 *         self._cutoff =  DEFAULT_CUTOFF             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def set_cutoff(self, cutoff):
 */
  __pyx_v_self->_cutoff = __pyx_v_17shift_calculators_DEFAULT_CUTOFF;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_distance_based_potential_force_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_46Fast_distance_based_potential_force_calculator_5set_cutoff(PyObject *__pyx_v_self, PyObject *__pyx_v_cutoff); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_46Fast_distance_based_potential_force_calculator_5set_cutoff(PyObject *__pyx_v_self, PyObject *__pyx_v_cutoff) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_cutoff (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_46Fast_distance_based_potential_force_calculator_4set_cutoff(((struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_cutoff));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1690")'> 1690: </pre>
<pre id='line1690' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1691")'> 1691:     def set_cutoff(self, cutoff):</pre>
<pre id='line1691' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1691
 *         self._cutoff =  DEFAULT_CUTOFF
 * 
 *     def set_cutoff(self, cutoff):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._cutoff =  cutoff
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_46Fast_distance_based_potential_force_calculator_4set_cutoff(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *__pyx_v_self, PyObject *__pyx_v_cutoff) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_cutoff", 0);
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line1692")'> 1692:         self._cutoff =  cutoff</pre>
<pre id='line1692' class='code' style='background-color: #FFFF66'>
  /* "Cython_shift_calculator.pyx":1692
 * 
 *     def set_cutoff(self, cutoff):
 *         self._cutoff =  cutoff             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def set_smoothing_factor(self,smoothing_factor):
 */
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_cutoff);<span class='error_goto'> if (unlikely((__pyx_t_1 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1692; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_cutoff = __pyx_t_1;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_distance_based_potential_force_calculator.set_cutoff", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_46Fast_distance_based_potential_force_calculator_7set_smoothing_factor(PyObject *__pyx_v_self, PyObject *__pyx_v_smoothing_factor); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_46Fast_distance_based_potential_force_calculator_7set_smoothing_factor(PyObject *__pyx_v_self, PyObject *__pyx_v_smoothing_factor) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_smoothing_factor (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_46Fast_distance_based_potential_force_calculator_6set_smoothing_factor(((struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_smoothing_factor));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1693")'> 1693: </pre>
<pre id='line1693' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1694")'> 1694:     def set_smoothing_factor(self,smoothing_factor):</pre>
<pre id='line1694' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1694
 *         self._cutoff =  cutoff
 * 
 *     def set_smoothing_factor(self,smoothing_factor):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._smoothing_factor = smoothing_factor
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_46Fast_distance_based_potential_force_calculator_6set_smoothing_factor(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *__pyx_v_self, PyObject *__pyx_v_smoothing_factor) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_smoothing_factor", 0);
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line1695")'> 1695:         self._smoothing_factor = smoothing_factor</pre>
<pre id='line1695' class='code' style='background-color: #FFFF6a'>
  /* "Cython_shift_calculator.pyx":1695
 * 
 *     def set_smoothing_factor(self,smoothing_factor):
 *         self._smoothing_factor = smoothing_factor             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_smoothing_factor);<span class='error_goto'> if (unlikely((__pyx_t_1 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1695; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_smoothing_factor = __pyx_t_1;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_distance_based_potential_force_calculator.set_smoothing_factor", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1696")'> 1696: </pre>
<pre id='line1696' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1697")'> 1697: </pre>
<pre id='line1697' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1698")'> 1698: </pre>
<pre id='line1698' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1699")'> 1699:     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:</pre>
<pre id='line1699' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1699
 * 
 * 
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components =  <code><</code>Distance_component*> <code><</code>size_t> data
 *         self._num_components =  length
 */

static void __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__bytes_to_components(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *__pyx_v_self, uintptr_t __pyx_v_data, uintptr_t __pyx_v_length) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1700")'> 1700:         self._compiled_components =  &lt;Distance_component*&gt; &lt;size_t&gt; data</pre>
<pre id='line1700' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1700
 * 
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:
 *         self._compiled_components =  <code><</code>Distance_component*> <code><</code>size_t> data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components =  length
 * 
 */
  __pyx_v_self->_compiled_components = ((struct __pyx_t_17shift_calculators_Distance_component *)((size_t)__pyx_v_data));
</pre><pre class='line' style='background-color: #FFFF22' onclick='toggleDiv("line1701")'> 1701:         self._num_components =  length</pre>
<pre id='line1701' class='code' style='background-color: #FFFF22'>
  /* "Cython_shift_calculator.pyx":1701
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:
 *         self._compiled_components =  <code><</code>Distance_component*> <code><</code>size_t> data
 *         self._num_components =  length             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_self->_num_components = __pyx_v_length;

}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_46Fast_distance_based_potential_force_calculator_9_calc_single_force_set(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_46Fast_distance_based_potential_force_calculator_9_calc_single_force_set(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_index;
  float __pyx_v_factor;
  struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calc_single_force_set (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__index,&__pyx_n_s__factor,&__pyx_n_s__forces,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__index)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__factor)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calc_single_force_set", 1, 3, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1705; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__forces)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calc_single_force_set", 1, 3, 3, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1705; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_calc_single_force_set") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1705; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_index = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_index == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1705; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_factor = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_factor == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1705; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_forces = ((struct __pyx_obj_17shift_calculators_Out_array *)values[2]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calc_single_force_set", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1705; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_distance_based_potential_force_calculator._calc_single_force_set", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_forces), __pyx_ptype_17shift_calculators_Out_array, 1, "forces", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1705; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_46Fast_distance_based_potential_force_calculator_8_calc_single_force_set(((struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *)__pyx_v_self), __pyx_v_index, __pyx_v_factor, __pyx_v_forces);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1702")'> 1702: </pre>
<pre id='line1702' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1703")'> 1703: </pre>
<pre id='line1703' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1704")'> 1704: #   TODO: generalise this based on compiled components</pre>
<pre id='line1704' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1705")'> 1705:     def _calc_single_force_set(self, int index, float factor, Out_array forces):</pre>
<pre id='line1705' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1705
 * 
 * #   TODO: generalise this based on compiled components
 *     def _calc_single_force_set(self, int index, float factor, Out_array forces):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         #TODO tidy this up a hack for the test suite
 *         cdef Distance_component* saved_component_list = self._compiled_components
 */

static PyObject *__pyx_pf_17shift_calculators_46Fast_distance_based_potential_force_calculator_8_calc_single_force_set(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *__pyx_v_self, int __pyx_v_index, float __pyx_v_factor, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces) {
  struct __pyx_t_17shift_calculators_Distance_component *__pyx_v_saved_component_list;
  int __pyx_v_saved_num_components;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calc_single_force_set", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1706")'> 1706:         #TODO tidy this up a hack for the test suite</pre>
<pre id='line1706' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1707")'> 1707:         cdef Distance_component* saved_component_list = self._compiled_components</pre>
<pre id='line1707' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1707
 *     def _calc_single_force_set(self, int index, float factor, Out_array forces):
 *         #TODO tidy this up a hack for the test suite
 *         cdef Distance_component* saved_component_list = self._compiled_components             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int saved_num_components = self._num_components
 * 
 */
  __pyx_t_1 = __pyx_v_self->_compiled_components;
  __pyx_v_saved_component_list = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1708")'> 1708:         cdef int saved_num_components = self._num_components</pre>
<pre id='line1708' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1708
 *         #TODO tidy this up a hack for the test suite
 *         cdef Distance_component* saved_component_list = self._compiled_components
 *         cdef int saved_num_components = self._num_components             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._num_components  = 1
 */
  __pyx_t_2 = __pyx_v_self->_num_components;
  __pyx_v_saved_num_components = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1709")'> 1709: </pre>
<pre id='line1709' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1710")'> 1710:         self._num_components  = 1</pre>
<pre id='line1710' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1710
 *         cdef int saved_num_components = self._num_components
 * 
 *         self._num_components  = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components = &saved_component_list[index]
 * 
 */
  __pyx_v_self->_num_components = 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1711")'> 1711:         self._compiled_components = &amp;saved_component_list[index]</pre>
<pre id='line1711' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1711
 * 
 *         self._num_components  = 1
 *         self._compiled_components = &saved_component_list[index]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._distance_calc_single_force_set(0,factor,forces)
 */
  __pyx_v_self->_compiled_components = (&(__pyx_v_saved_component_list[__pyx_v_index]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1712")'> 1712: </pre>
<pre id='line1712' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1713")'> 1713:         self._distance_calc_single_force_set(0,factor,forces)</pre>
<pre id='line1713' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1713
 *         self._compiled_components = &saved_component_list[index]
 * 
 *         self._distance_calc_single_force_set(0,factor,forces)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._compiled_components = saved_component_list
 */
  __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__distance_calc_single_force_set(__pyx_v_self, 0, __pyx_v_factor, __pyx_v_forces);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1714")'> 1714: </pre>
<pre id='line1714' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1715")'> 1715:         self._compiled_components = saved_component_list</pre>
<pre id='line1715' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1715
 *         self._distance_calc_single_force_set(0,factor,forces)
 * 
 *         self._compiled_components = saved_component_list             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components = saved_num_components
 * 
 */
  __pyx_v_self->_compiled_components = __pyx_v_saved_component_list;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1716")'> 1716:         self._num_components = saved_num_components</pre>
<pre id='line1716' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":1716
 * 
 *         self._compiled_components = saved_component_list
 *         self._num_components = saved_num_components             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_self->_num_components = __pyx_v_saved_num_components;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1717")'> 1717: </pre>
<pre id='line1717' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1718")'> 1718: </pre>
<pre id='line1718' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1719")'> 1719:     @cython.profile(False)</pre>
<pre id='line1719' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1720")'> 1720:     cdef inline Vec3 _xyz_distances(self, int target_atom, int distance_atom):</pre>
<pre id='line1720' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1720
 * 
 *     @cython.profile(False)
 *     cdef inline Vec3 _xyz_distances(self, int target_atom, int distance_atom):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3 target_pos, distant_pos
 * 
 */

static CYTHON_INLINE Vec3 __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__xyz_distances(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *__pyx_v_self, int __pyx_v_target_atom, int __pyx_v_distance_atom) {
  Vec3 __pyx_v_target_pos;
  Vec3 __pyx_v_distant_pos;
  Vec3 __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_xyz_distances", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1721")'> 1721:         cdef Vec3 target_pos, distant_pos</pre>
<pre id='line1721' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1722")'> 1722: </pre>
<pre id='line1722' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1723")'> 1723: </pre>
<pre id='line1723' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1724")'> 1724:         target_pos = self._simulation[0].atomPos(target_atom)</pre>
<pre id='line1724' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1724
 * 
 * 
 *         target_pos = self._simulation[0].atomPos(target_atom)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         distant_pos =   self._simulation[0].atomPos(distance_atom)
 * 
 */
  __pyx_v_target_pos = (__pyx_v_self->__pyx_base._simulation[0]).atomPos(__pyx_v_target_atom);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1725")'> 1725:         distant_pos =   self._simulation[0].atomPos(distance_atom)</pre>
<pre id='line1725' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1725
 * 
 *         target_pos = self._simulation[0].atomPos(target_atom)
 *         distant_pos =   self._simulation[0].atomPos(distance_atom)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         return target_pos - distant_pos
 */
  __pyx_v_distant_pos = (__pyx_v_self->__pyx_base._simulation[0]).atomPos(__pyx_v_distance_atom);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1726")'> 1726: </pre>
<pre id='line1726' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1727")'> 1727:         return target_pos - distant_pos</pre>
<pre id='line1727' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":1727
 *         distant_pos =   self._simulation[0].atomPos(distance_atom)
 * 
 *         return target_pos - distant_pos             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     @cython.profile(False)
 */
  __pyx_r = (__pyx_v_target_pos - __pyx_v_distant_pos);
  goto __pyx_L0;

  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1728")'> 1728: </pre>
<pre id='line1728' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1729")'> 1729:     @cython.profile(False)</pre>
<pre id='line1729' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1730")'> 1730:     cdef inline float _sum_xyz_distances_2(self, int target_atom, int distance_atom):</pre>
<pre id='line1730' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1730
 * 
 *     @cython.profile(False)
 *     cdef inline float _sum_xyz_distances_2(self, int target_atom, int distance_atom):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3 target_pos, distant_pos, distance
 *         cdef float result =0.0
 */

static CYTHON_INLINE float __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__sum_xyz_distances_2(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *__pyx_v_self, int __pyx_v_target_atom, int __pyx_v_distance_atom) {
  Vec3 __pyx_v_target_pos;
  Vec3 __pyx_v_distant_pos;
  Vec3 __pyx_v_distance;
  float __pyx_v_result;
  int __pyx_v_i;
  float __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_sum_xyz_distances_2", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1731")'> 1731:         cdef Vec3 target_pos, distant_pos, distance</pre>
<pre id='line1731' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1732")'> 1732:         cdef float result =0.0</pre>
<pre id='line1732' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1732
 *     cdef inline float _sum_xyz_distances_2(self, int target_atom, int distance_atom):
 *         cdef Vec3 target_pos, distant_pos, distance
 *         cdef float result =0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int i
 * 
 */
  __pyx_v_result = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1733")'> 1733:         cdef int i</pre>
<pre id='line1733' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1734")'> 1734: </pre>
<pre id='line1734' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1735")'> 1735:         target_pos =   self._simulation[0].atomPos(target_atom)</pre>
<pre id='line1735' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1735
 *         cdef int i
 * 
 *         target_pos =   self._simulation[0].atomPos(target_atom)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         distant_pos =  self._simulation[0].atomPos(distance_atom)
 * 
 */
  __pyx_v_target_pos = (__pyx_v_self->__pyx_base._simulation[0]).atomPos(__pyx_v_target_atom);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1736")'> 1736:         distant_pos =  self._simulation[0].atomPos(distance_atom)</pre>
<pre id='line1736' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1736
 * 
 *         target_pos =   self._simulation[0].atomPos(target_atom)
 *         distant_pos =  self._simulation[0].atomPos(distance_atom)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         distance = Vec3(target_pos - distant_pos)
 */
  __pyx_v_distant_pos = (__pyx_v_self->__pyx_base._simulation[0]).atomPos(__pyx_v_distance_atom);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1737")'> 1737: </pre>
<pre id='line1737' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1738")'> 1738:         distance = Vec3(target_pos - distant_pos)</pre>
<pre id='line1738' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1738
 *         distant_pos =  self._simulation[0].atomPos(distance_atom)
 * 
 *         distance = Vec3(target_pos - distant_pos)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         for i in range(3):
 */
  __pyx_v_distance = Vec3((__pyx_v_target_pos - __pyx_v_distant_pos));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1739")'> 1739: </pre>
<pre id='line1739' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1740")'> 1740:         for i in range(3):</pre>
<pre id='line1740' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1740
 *         distance = Vec3(target_pos - distant_pos)
 * 
 *         for i in range(3):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             result += distance[i] * distance[i]
 * 
 */
  for (__pyx_t_1 = 0; __pyx_t_1 <code><</code> 3; __pyx_t_1+=1) {
    __pyx_v_i = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1741")'> 1741:             result += distance[i] * distance[i]</pre>
<pre id='line1741' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1741
 * 
 *         for i in range(3):
 *             result += distance[i] * distance[i]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         return result
 */
    __pyx_v_result = (__pyx_v_result + ((__pyx_v_distance[__pyx_v_i]) * (__pyx_v_distance[__pyx_v_i])));
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1742")'> 1742: </pre>
<pre id='line1742' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF28' onclick='toggleDiv("line1743")'> 1743:         return result</pre>
<pre id='line1743' class='code' style='background-color: #FFFF28'>
  /* "Cython_shift_calculator.pyx":1743
 *             result += distance[i] * distance[i]
 * 
 *         return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def _calc_single_force_factor(self, int index, float factor):
 */
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_46Fast_distance_based_potential_force_calculator_11_calc_single_force_factor(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_46Fast_distance_based_potential_force_calculator_11_calc_single_force_factor(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_index;
  float __pyx_v_factor;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calc_single_force_factor (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__index,&__pyx_n_s__factor,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__index)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__factor)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calc_single_force_factor", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1745; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_calc_single_force_factor") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1745; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_index = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_index == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1745; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_factor = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_factor == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1745; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calc_single_force_factor", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1745; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_distance_based_potential_force_calculator._calc_single_force_factor", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_46Fast_distance_based_potential_force_calculator_10_calc_single_force_factor(((struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *)__pyx_v_self), __pyx_v_index, __pyx_v_factor);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1744")'> 1744: </pre>
<pre id='line1744' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1745")'> 1745:     def _calc_single_force_factor(self, int index, float factor):</pre>
<pre id='line1745' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1745
 *         return result
 * 
 *     def _calc_single_force_factor(self, int index, float factor):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._cython_calc_single_force_factor(index, factor)
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_46Fast_distance_based_potential_force_calculator_10_calc_single_force_factor(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *__pyx_v_self, int __pyx_v_index, float __pyx_v_factor) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calc_single_force_factor", 0);
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line1746")'> 1746:         return self._cython_calc_single_force_factor(index, factor)</pre>
<pre id='line1746' class='code' style='background-color: #FFFF79'>
  /* "Cython_shift_calculator.pyx":1746
 * 
 *     def _calc_single_force_factor(self, int index, float factor):
 *         return self._cython_calc_single_force_factor(index, factor)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void _do_calc_components(self, int[:] component_to_result, CDSVector[float] force_factors, Out_array force) nogil:
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__cython_calc_single_force_factor(__pyx_v_self, __pyx_v_index, __pyx_v_factor));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1746; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_distance_based_potential_force_calculator._calc_single_force_factor", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1747")'> 1747: </pre>
<pre id='line1747' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1748")'> 1748:     cdef void _do_calc_components(self, int[:] component_to_result, CDSVector[float] force_factors, Out_array force) nogil:</pre>
<pre id='line1748' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1748
 *         return self._cython_calc_single_force_factor(index, factor)
 * 
 *     cdef void _do_calc_components(self, int[:] component_to_result, CDSVector[float] force_factors, Out_array force) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int factor_index
 *         cdef int component_index
 */

static void __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__do_calc_components(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *__pyx_v_self, __Pyx_memviewslice __pyx_v_component_to_result, CDSVector<code><</code>float> __pyx_v_force_factors, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_force) {
  int __pyx_v_factor_index;
  int __pyx_v_component_index;
  #ifdef WITH_THREAD
  PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
  #endif
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_do_calc_components", 0);
  #ifdef WITH_THREAD
  PyGILState_Release(__pyx_gilstate_save);
  #endif
  /*try:*/ {
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line1749")'> 1749:         cdef int factor_index</pre>
<pre id='line1749' class='code' style='background-color: #FFFFc4'>
  /* "Cython_shift_calculator.pyx":1749
 * 
 *     cdef void _do_calc_components(self, int[:] component_to_result, CDSVector[float] force_factors, Out_array force) nogil:
 *         cdef int factor_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int component_index
 * 
 */
  /*finally:*/ {
    int __pyx_why;
    __pyx_why = 0; goto __pyx_L5;
    __pyx_L4: __pyx_why = 4; goto __pyx_L5;
    __pyx_L5:;
    #ifdef WITH_THREAD
    __pyx_gilstate_save = PyGILState_Ensure();
    #endif
    switch (__pyx_why) {
      case 4: goto __pyx_L1_error;
    }
  }

  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Fast_distance_based_potential_force_calculator._do_calc_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  #ifdef WITH_THREAD
  PyGILState_Release(__pyx_gilstate_save);
  #endif
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1750")'> 1750:         cdef int component_index</pre>
<pre id='line1750' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1751")'> 1751: </pre>
<pre id='line1751' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1752")'> 1752:         with gil:</pre>
<pre id='line1752' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1752
 *         cdef int component_index
 * 
 *         with gil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for factor_index in range(len(self._active_components)):
 *                 component_index = self._active_components[factor_index]
 */
    {
        #ifdef WITH_THREAD
        PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
        #endif
        /*try:*/ {

        /* "Cython_shift_calculator.pyx":1752
 *         cdef int component_index
 * 
 *         with gil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for factor_index in range(len(self._active_components)):
 *                 component_index = self._active_components[factor_index]
 */
        /*finally:*/ {
          int __pyx_why;
          __pyx_why = 0; goto __pyx_L8;
          __pyx_L7: __pyx_why = 4; goto __pyx_L8;
          __pyx_L8:;
          #ifdef WITH_THREAD
          PyGILState_Release(__pyx_gilstate_save);
          #endif
          switch (__pyx_why) {
            case 4: goto __pyx_L4;
          }
        }
    }
  }
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line1753")'> 1753:             for factor_index in range(len(self._active_components)):</pre>
<pre id='line1753' class='code' style='background-color: #FFFF79'>
          /* "Cython_shift_calculator.pyx":1753
 * 
 *         with gil:
 *             for factor_index in range(len(self._active_components)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 component_index = self._active_components[factor_index]
 *                 self._distance_calc_single_force_set(component_index,force_factors[component_to_result[factor_index]],force)
 */
          if (unlikely(!__pyx_v_self->__pyx_base._active_components.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1753; __pyx_clineno = __LINE__; goto __pyx_L7;}}
          __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->__pyx_base._active_components, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1753; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          __pyx_t_2 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1753; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          for (__pyx_t_3 = 0; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
            __pyx_v_factor_index = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1754")'> 1754:                 component_index = self._active_components[factor_index]</pre>
<pre id='line1754' class='code' style='background-color: #FFFFaa'>
            /* "Cython_shift_calculator.pyx":1754
 *         with gil:
 *             for factor_index in range(len(self._active_components)):
 *                 component_index = self._active_components[factor_index]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._distance_calc_single_force_set(component_index,force_factors[component_to_result[factor_index]],force)
 * 
 */
            if (unlikely(!__pyx_v_self->__pyx_base._active_components.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1754; __pyx_clineno = __LINE__; goto __pyx_L7;}}
            __pyx_t_4 = __pyx_v_factor_index;
            __pyx_v_component_index = (*((int *) ( /* dim=0 */ (__pyx_v_self->__pyx_base._active_components.data + __pyx_t_4 * __pyx_v_self->__pyx_base._active_components.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1755")'> 1755:                 self._distance_calc_single_force_set(component_index,force_factors[component_to_result[factor_index]],force)</pre>
<pre id='line1755' class='code' style='background-color: #FFFFff'>
            /* "Cython_shift_calculator.pyx":1755
 *             for factor_index in range(len(self._active_components)):
 *                 component_index = self._active_components[factor_index]
 *                 self._distance_calc_single_force_set(component_index,force_factors[component_to_result[factor_index]],force)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #         for i in range(self._num_components):
 */
            __pyx_t_5 = __pyx_v_factor_index;
            __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__distance_calc_single_force_set(__pyx_v_self, __pyx_v_component_index, (__pyx_v_force_factors[(*((int *) ( /* dim=0 */ (__pyx_v_component_to_result.data + __pyx_t_5 * __pyx_v_component_to_result.strides[0]) )))]), __pyx_v_force);
          }
        }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1756")'> 1756: </pre>
<pre id='line1756' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1757")'> 1757: #         for i in range(self._num_components):</pre>
<pre id='line1757' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1758")'> 1758: #             self._distance_calc_single_force_set(i,force_factors[component_to_result[i]],force)</pre>
<pre id='line1758' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1759")'> 1759: </pre>
<pre id='line1759' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1760")'> 1760: </pre>
<pre id='line1760' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1761")'> 1761:     @cython.profile(False)</pre>
<pre id='line1761' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1762")'> 1762:     cdef inline float _cython_calc_single_force_factor(self, int index, float factor):</pre>
<pre id='line1762' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1762
 * 
 *     @cython.profile(False)
 *     cdef inline float _cython_calc_single_force_factor(self, int index, float factor):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef target_distant_atom atom_ids
 * #        cdef coefficient_exponent coef_exp
 */

static CYTHON_INLINE float __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__cython_calc_single_force_factor(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *__pyx_v_self, int __pyx_v_index, float __pyx_v_factor) {
  float __pyx_v_exponent;
  float __pyx_v_full_factor;
  float __pyx_v_force_factor;
  float __pyx_v_ratio;
  float __pyx_v_pre_exponent;
  float __pyx_v_reduced_exponent;
  float __pyx_v_sum_xyz_distances_2;
  float __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_cython_calc_single_force_factor", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1763")'> 1763:         cdef target_distant_atom atom_ids</pre>
<pre id='line1763' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1764")'> 1764: #        cdef coefficient_exponent coef_exp</pre>
<pre id='line1764' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1765")'> 1765:         cdef float exponent</pre>
<pre id='line1765' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1766")'> 1766: </pre>
<pre id='line1766' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1767")'> 1767:         cdef float full_factor, force_factor</pre>
<pre id='line1767' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1768")'> 1768:         cdef float ratio, pre_exponent, reduced_exponent, sum_xyz_distances_2</pre>
<pre id='line1768' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1769")'> 1769: </pre>
<pre id='line1769' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1770")'> 1770: #        atom_ids = self._get_target_and_distant_atom_ids(index)</pre>
<pre id='line1770' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1771")'> 1771: </pre>
<pre id='line1771' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1772")'> 1772:         sum_xyz_distances_2 = self._sum_xyz_distances_2(self._compiled_components[index].remote_atom_1, self._compiled_components[index].remote_atom_2)</pre>
<pre id='line1772' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1772
 * #        atom_ids = self._get_target_and_distant_atom_ids(index)
 * 
 *         sum_xyz_distances_2 = self._sum_xyz_distances_2(self._compiled_components[index].remote_atom_1, self._compiled_components[index].remote_atom_2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #
 *         full_factor= factor *  self._compiled_components[index].coefficient
 */
  __pyx_v_sum_xyz_distances_2 = __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__sum_xyz_distances_2(__pyx_v_self, (__pyx_v_self->_compiled_components[__pyx_v_index]).remote_atom_1, (__pyx_v_self->_compiled_components[__pyx_v_index]).remote_atom_2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1773")'> 1773: #</pre>
<pre id='line1773' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1774")'> 1774:         full_factor= factor *  self._compiled_components[index].coefficient</pre>
<pre id='line1774' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1774
 *         sum_xyz_distances_2 = self._sum_xyz_distances_2(self._compiled_components[index].remote_atom_1, self._compiled_components[index].remote_atom_2)
 * #
 *         full_factor= factor *  self._compiled_components[index].coefficient             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         exponent =  self._compiled_components[index].exponent
 */
  __pyx_v_full_factor = (__pyx_v_factor * (__pyx_v_self->_compiled_components[__pyx_v_index]).coefficient);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1775")'> 1775: </pre>
<pre id='line1775' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1776")'> 1776:         exponent =  self._compiled_components[index].exponent</pre>
<pre id='line1776' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1776
 *         full_factor= factor *  self._compiled_components[index].coefficient
 * 
 *         exponent =  self._compiled_components[index].exponent             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if self._smoothed:
 *             ratio = sum_xyz_distances_2 / (self._cutoff**2)
 */
  __pyx_t_1 = (__pyx_v_self->_compiled_components[__pyx_v_index]).exponent;
  __pyx_v_exponent = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1777")'> 1777:         if self._smoothed:</pre>
<pre id='line1777' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1777
 * 
 *         exponent =  self._compiled_components[index].exponent
 *         if self._smoothed:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             ratio = sum_xyz_distances_2 / (self._cutoff**2)
 *             ratio =  ratio**4
 */
  if (__pyx_v_self->_smoothed) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1778")'> 1778:             ratio = sum_xyz_distances_2 / (self._cutoff**2)</pre>
<pre id='line1778' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1778
 *         exponent =  self._compiled_components[index].exponent
 *         if self._smoothed:
 *             ratio = sum_xyz_distances_2 / (self._cutoff**2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             ratio =  ratio**4
 *             pre_exponent = exponent - (exponent + 8.0) * ratio
 */
    __pyx_v_ratio = (__pyx_v_sum_xyz_distances_2 / powf(__pyx_v_self->_cutoff, 2.0));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1779")'> 1779:             ratio =  ratio**4</pre>
<pre id='line1779' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1779
 *         if self._smoothed:
 *             ratio = sum_xyz_distances_2 / (self._cutoff**2)
 *             ratio =  ratio**4             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             pre_exponent = exponent - (exponent + 8.0) * ratio
 *         else:
 */
    __pyx_v_ratio = powf(__pyx_v_ratio, 4.0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1780")'> 1780:             pre_exponent = exponent - (exponent + 8.0) * ratio</pre>
<pre id='line1780' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1780
 *             ratio = sum_xyz_distances_2 / (self._cutoff**2)
 *             ratio =  ratio**4
 *             pre_exponent = exponent - (exponent + 8.0) * ratio             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             pre_exponent = exponent
 */
    __pyx_v_pre_exponent = (__pyx_v_exponent - ((__pyx_v_exponent + 8.0) * __pyx_v_ratio));
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1781")'> 1781:         else:</pre>
<pre id='line1781' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1782")'> 1782:             pre_exponent = exponent</pre>
<pre id='line1782' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1782
 *             pre_exponent = exponent - (exponent + 8.0) * ratio
 *         else:
 *             pre_exponent = exponent             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         reduced_exponent = (exponent - 2.0) / 2.0
 */
    __pyx_v_pre_exponent = __pyx_v_exponent;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1783")'> 1783: </pre>
<pre id='line1783' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1784")'> 1784:         reduced_exponent = (exponent - 2.0) / 2.0</pre>
<pre id='line1784' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1784
 *             pre_exponent = exponent
 * 
 *         reduced_exponent = (exponent - 2.0) / 2.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         force_factor = full_factor *  pre_exponent * sum_xyz_distances_2 ** reduced_exponent
 */
  __pyx_v_reduced_exponent = ((__pyx_v_exponent - 2.0) / 2.0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1785")'> 1785: </pre>
<pre id='line1785' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1786")'> 1786:         force_factor = full_factor *  pre_exponent * sum_xyz_distances_2 ** reduced_exponent</pre>
<pre id='line1786' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1786
 *         reduced_exponent = (exponent - 2.0) / 2.0
 * 
 *         force_factor = full_factor *  pre_exponent * sum_xyz_distances_2 ** reduced_exponent             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         return force_factor
 */
  __pyx_v_force_factor = ((__pyx_v_full_factor * __pyx_v_pre_exponent) * powf(__pyx_v_sum_xyz_distances_2, __pyx_v_reduced_exponent));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1787")'> 1787: </pre>
<pre id='line1787' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1788")'> 1788:         return force_factor</pre>
<pre id='line1788' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":1788
 *         force_factor = full_factor *  pre_exponent * sum_xyz_distances_2 ** reduced_exponent
 * 
 *         return force_factor             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_r = __pyx_v_force_factor;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1789")'> 1789: </pre>
<pre id='line1789' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1790")'> 1790: </pre>
<pre id='line1790' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1791")'> 1791: </pre>
<pre id='line1791' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1792")'> 1792: </pre>
<pre id='line1792' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1793")'> 1793: </pre>
<pre id='line1793' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1794")'> 1794: #    def _calc_single_force_set(self, int index, float factor, object forces):</pre>
<pre id='line1794' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1795")'> 1795: #        self._cython_calc_single_force_set(index, factor, forces)</pre>
<pre id='line1795' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1796")'> 1796: </pre>
<pre id='line1796' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1797")'> 1797:     @cython.profile(False)</pre>
<pre id='line1797' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1798")'> 1798:     cdef inline void _distance_calc_single_force_set(self,int index, float factor, Out_array forces):</pre>
<pre id='line1798' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1798
 * 
 *     @cython.profile(False)
 *     cdef inline void _distance_calc_single_force_set(self,int index, float factor, Out_array forces):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #        cdef target_distant_atom atom_ids
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__distance_calc_single_force_set(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *__pyx_v_self, int __pyx_v_index, float __pyx_v_factor, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces) {
  Vec3 __pyx_v_xyz_distances;
  float __pyx_v_force_factor;
  Vec3 __pyx_v_target_forces;
  Vec3 __pyx_v_distant_forces;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_distance_calc_single_force_set", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1799")'> 1799: </pre>
<pre id='line1799' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1800")'> 1800: #        cdef target_distant_atom atom_ids</pre>
<pre id='line1800' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1801")'> 1801:         cdef Vec3 xyz_distances</pre>
<pre id='line1801' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1802")'> 1802:         cdef float force_factor, distance</pre>
<pre id='line1802' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1803")'> 1803:         cdef Vec3 result</pre>
<pre id='line1803' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1804")'> 1804: </pre>
<pre id='line1804' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1805")'> 1805: #        atom_ids =  self._get_target_and_distant_atom_ids(index)</pre>
<pre id='line1805' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1806")'> 1806: #</pre>
<pre id='line1806' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1807")'> 1807: ##        print atom_ids.target_atom_id,atom_ids.distant_atom_id</pre>
<pre id='line1807' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1808")'> 1808:         xyz_distances  = self._xyz_distances(self._compiled_components[index].remote_atom_1,self._compiled_components[index].remote_atom_2)</pre>
<pre id='line1808' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1808
 * #
 * ##        print atom_ids.target_atom_id,atom_ids.distant_atom_id
 *         xyz_distances  = self._xyz_distances(self._compiled_components[index].remote_atom_1,self._compiled_components[index].remote_atom_2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         force_factor  = self._cython_calc_single_force_factor(index, factor)
 */
  __pyx_v_xyz_distances = __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__xyz_distances(__pyx_v_self, (__pyx_v_self->_compiled_components[__pyx_v_index]).remote_atom_1, (__pyx_v_self->_compiled_components[__pyx_v_index]).remote_atom_2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1809")'> 1809: </pre>
<pre id='line1809' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1810")'> 1810:         force_factor  = self._cython_calc_single_force_factor(index, factor)</pre>
<pre id='line1810' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1810
 *         xyz_distances  = self._xyz_distances(self._compiled_components[index].remote_atom_1,self._compiled_components[index].remote_atom_2)
 * 
 *         force_factor  = self._cython_calc_single_force_factor(index, factor)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Vec3 target_forces = xyz_distances
 */
  __pyx_v_force_factor = __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__cython_calc_single_force_factor(__pyx_v_self, __pyx_v_index, __pyx_v_factor);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1811")'> 1811: </pre>
<pre id='line1811' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1812")'> 1812:         cdef Vec3 target_forces = xyz_distances</pre>
<pre id='line1812' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1812
 *         force_factor  = self._cython_calc_single_force_factor(index, factor)
 * 
 *         cdef Vec3 target_forces = xyz_distances             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(target_forces, -force_factor)
 * 
 */
  __pyx_v_target_forces = __pyx_v_xyz_distances;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1813")'> 1813:         operator_times(target_forces, -force_factor)</pre>
<pre id='line1813' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1813
 * 
 *         cdef Vec3 target_forces = xyz_distances
 *         operator_times(target_forces, -force_factor)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Vec3 distant_forces = xyz_distances
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_target_forces, (-__pyx_v_force_factor));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1814")'> 1814: </pre>
<pre id='line1814' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1815")'> 1815:         cdef Vec3 distant_forces = xyz_distances</pre>
<pre id='line1815' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1815
 *         operator_times(target_forces, -force_factor)
 * 
 *         cdef Vec3 distant_forces = xyz_distances             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(distant_forces, force_factor)
 * #
 */
  __pyx_v_distant_forces = __pyx_v_xyz_distances;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1816")'> 1816:         operator_times(distant_forces, force_factor)</pre>
<pre id='line1816' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1816
 * 
 *         cdef Vec3 distant_forces = xyz_distances
 *         operator_times(distant_forces, force_factor)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #
 *         forces.add(self._compiled_components[index].remote_atom_1,target_forces)
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_distant_forces, __pyx_v_force_factor);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1817")'> 1817: #</pre>
<pre id='line1817' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1818")'> 1818:         forces.add(self._compiled_components[index].remote_atom_1,target_forces)</pre>
<pre id='line1818' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1818
 *         operator_times(distant_forces, force_factor)
 * #
 *         forces.add(self._compiled_components[index].remote_atom_1,target_forces)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         forces.add(self._compiled_components[index].remote_atom_2,distant_forces)
 * 
 */
  __pyx_f_17shift_calculators_9Out_array_add(__pyx_v_forces, (__pyx_v_self->_compiled_components[__pyx_v_index]).remote_atom_1, __pyx_v_target_forces);
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line1819")'> 1819:         forces.add(self._compiled_components[index].remote_atom_2,distant_forces)</pre>
<pre id='line1819' class='code' style='background-color: #FFFF6e'>
  /* "Cython_shift_calculator.pyx":1819
 * #
 *         forces.add(self._compiled_components[index].remote_atom_1,target_forces)
 *         forces.add(self._compiled_components[index].remote_atom_2,distant_forces)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_f_17shift_calculators_9Out_array_add(__pyx_v_forces, (__pyx_v_self->_compiled_components[__pyx_v_index]).remote_atom_2, __pyx_v_distant_forces);

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_32Fast_non_bonded_force_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_32Fast_non_bonded_force_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) > 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) > 0) && unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__cinit__", 0))) return -1;
  __pyx_r = __pyx_pf_17shift_calculators_32Fast_non_bonded_force_calculator___cinit__(((struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1820")'> 1820: </pre>
<pre id='line1820' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1821")'> 1821: </pre>
<pre id='line1821' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1822")'> 1822: </pre>
<pre id='line1822' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1823")'> 1823: </pre>
<pre id='line1823' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1824")'> 1824: </pre>
<pre id='line1824' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1825")'> 1825: cdef class Fast_non_bonded_force_calculator(Fast_distance_based_potential_force_calculator):</pre>
<pre id='line1825' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1825
 * 
 * 
 * cdef class Fast_non_bonded_force_calculator(Fast_distance_based_potential_force_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef float _nb_cutoff
 */
struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator {
  struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator __pyx_base;
  float _nb_cutoff;
  struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *_non_bonded_list;
  PyObject *_raw_target_data;
  struct __pyx_t_17shift_calculators_Non_bonded_target_component *_compiled_target_components;
  int _num_target_components;
  PyObject *_raw_remote_data;
  struct __pyx_t_17shift_calculators_Non_bonded_remote_atom_component *_compiled_remote_components;
  int _num_remote_components;
  PyObject *_raw_coefficient_data;
  struct __pyx_t_17shift_calculators_Nonbonded_coefficient_component *_compiled_coefficient_components;
  int _num_coefficient_components;
  int _component_offset;
};


/* "Cython_shift_calculator.pyx":1825
 * 
 * 
 * cdef class Fast_non_bonded_force_calculator(Fast_distance_based_potential_force_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef float _nb_cutoff
 */

struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_force_calculator {
  struct __pyx_vtabstruct_17shift_calculators_Fast_distance_based_potential_force_calculator __pyx_base;
  void (*_bytes_to_remote_components)(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *, uintptr_t, uintptr_t);
  void (*_bytes_to_nonbonded_coefficient_components)(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *, uintptr_t, uintptr_t);
  void (*_set_the_component)(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *, int, int, float, float);
  void (*_calc_one_component)(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *, int, int, __Pyx_memviewslice, CDSVector<code><</code>float>, struct __pyx_obj_17shift_calculators_Out_array *);
  void (*_cython_build_component)(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *, int, int);
};
static struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_force_calculator *__pyx_vtabptr_17shift_calculators_Fast_non_bonded_force_calculator;
static CYTHON_INLINE void __pyx_f_17shift_calculators_32Fast_non_bonded_force_calculator__set_the_component(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *, int, int, float, float);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1826")'> 1826: </pre>
<pre id='line1826' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1827")'> 1827:     cdef float _nb_cutoff</pre>
<pre id='line1827' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1828")'> 1828: </pre>
<pre id='line1828' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1829")'> 1829:     cdef Non_bonded_interaction_list _non_bonded_list</pre>
<pre id='line1829' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1830")'> 1830: </pre>
<pre id='line1830' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1831")'> 1831: </pre>
<pre id='line1831' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1832")'> 1832:     #TODO: can we use memory views here...</pre>
<pre id='line1832' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1833")'> 1833:     cdef object _raw_target_data</pre>
<pre id='line1833' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1834")'> 1834:     cdef Non_bonded_target_component* _compiled_target_components</pre>
<pre id='line1834' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1835")'> 1835:     cdef int _num_target_components</pre>
<pre id='line1835' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1836")'> 1836: </pre>
<pre id='line1836' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1837")'> 1837: </pre>
<pre id='line1837' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1838")'> 1838:     #TODO: can we use memory views here...</pre>
<pre id='line1838' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1839")'> 1839:     cdef object _raw_remote_data</pre>
<pre id='line1839' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1840")'> 1840:     cdef Non_bonded_remote_atom_component* _compiled_remote_components</pre>
<pre id='line1840' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1841")'> 1841:     cdef int _num_remote_components</pre>
<pre id='line1841' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1842")'> 1842: </pre>
<pre id='line1842' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1843")'> 1843:     cdef object _raw_coefficient_data</pre>
<pre id='line1843' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1844")'> 1844:     cdef Nonbonded_coefficient_component* _compiled_coefficient_components</pre>
<pre id='line1844' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1845")'> 1845:     cdef int _num_coefficient_components</pre>
<pre id='line1845' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1846")'> 1846: </pre>
<pre id='line1846' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1847")'> 1847:     cdef int _component_offset</pre>
<pre id='line1847' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1848")'> 1848: </pre>
<pre id='line1848' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1849")'> 1849:     def __cinit__(self):</pre>
<pre id='line1849' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1849
 *     cdef int _component_offset
 * 
 *     def __cinit__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._non_bonded_list = None
 *         self._compiled_target_components =  NULL
 */

static int __pyx_pf_17shift_calculators_32Fast_non_bonded_force_calculator___cinit__(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1850")'> 1850:         self._non_bonded_list = None</pre>
<pre id='line1850' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":1850
 * 
 *     def __cinit__(self):
 *         self._non_bonded_list = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_target_components =  NULL
 *         self._compiled_remote_components = NULL
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_non_bonded_list);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_non_bonded_list));
  __pyx_v_self->_non_bonded_list = ((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)Py_None);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1851")'> 1851:         self._compiled_target_components =  NULL</pre>
<pre id='line1851' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1851
 *     def __cinit__(self):
 *         self._non_bonded_list = None
 *         self._compiled_target_components =  NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_remote_components = NULL
 *         self._compiled_coefficient_components = NULL
 */
  __pyx_v_self->_compiled_target_components = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1852")'> 1852:         self._compiled_remote_components = NULL</pre>
<pre id='line1852' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1852
 *         self._non_bonded_list = None
 *         self._compiled_target_components =  NULL
 *         self._compiled_remote_components = NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_coefficient_components = NULL
 *         self._component_offset = 0
 */
  __pyx_v_self->_compiled_remote_components = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1853")'> 1853:         self._compiled_coefficient_components = NULL</pre>
<pre id='line1853' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1853
 *         self._compiled_target_components =  NULL
 *         self._compiled_remote_components = NULL
 *         self._compiled_coefficient_components = NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._component_offset = 0
 * 
 */
  __pyx_v_self->_compiled_coefficient_components = NULL;
</pre><pre class='line' style='background-color: #FFFF2e' onclick='toggleDiv("line1854")'> 1854:         self._component_offset = 0</pre>
<pre id='line1854' class='code' style='background-color: #FFFF2e'>
  /* "Cython_shift_calculator.pyx":1854
 *         self._compiled_remote_components = NULL
 *         self._compiled_coefficient_components = NULL
 *         self._component_offset = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __init__(self, bint smoothed, str name):
 */
  __pyx_v_self->_component_offset = 0;

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_32Fast_non_bonded_force_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_32Fast_non_bonded_force_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_smoothed;
  PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__smoothed,&__pyx_n_s__name,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__smoothed)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1856; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1856; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_smoothed = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_smoothed == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1856; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_name = ((PyObject*)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1856; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_non_bonded_force_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&PyString_Type), 1, "name", 1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1856; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_32Fast_non_bonded_force_calculator_2__init__(((struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *)__pyx_v_self), __pyx_v_smoothed, __pyx_v_name);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1855")'> 1855: </pre>
<pre id='line1855' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1856")'> 1856:     def __init__(self, bint smoothed, str name):</pre>
<pre id='line1856' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1856
 *         self._component_offset = 0
 * 
 *     def __init__(self, bint smoothed, str name):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         super(Fast_non_bonded_force_calculator, self).__init__(smoothed,name)
 *         global DEFAULT_NB_CUTOFF
 */

static int __pyx_pf_17shift_calculators_32Fast_non_bonded_force_calculator_2__init__(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *__pyx_v_self, int __pyx_v_smoothed, PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFF31' onclick='toggleDiv("line1857")'> 1857:         super(Fast_non_bonded_force_calculator, self).__init__(smoothed,name)</pre>
<pre id='line1857' class='code' style='background-color: #FFFF31'>
  /* "Cython_shift_calculator.pyx":1857
 * 
 *     def __init__(self, bint smoothed, str name):
 *         super(Fast_non_bonded_force_calculator, self).__init__(smoothed,name)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         global DEFAULT_NB_CUTOFF
 *         self._nb_cutoff = DEFAULT_NB_CUTOFF
 */
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1857; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Fast_non_bonded_force_calculator)));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Fast_non_bonded_force_calculator)));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Fast_non_bonded_force_calculator)));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_self));
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_super, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1857; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s____init__);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1857; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(__pyx_v_smoothed);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1857; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1857; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_name));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, ((PyObject *)__pyx_v_name));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_name));
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1857; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1858")'> 1858:         global DEFAULT_NB_CUTOFF</pre>
<pre id='line1858' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1859")'> 1859:         self._nb_cutoff = DEFAULT_NB_CUTOFF</pre>
<pre id='line1859' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1859
 *         super(Fast_non_bonded_force_calculator, self).__init__(smoothed,name)
 *         global DEFAULT_NB_CUTOFF
 *         self._nb_cutoff = DEFAULT_NB_CUTOFF             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components =  <code><</code>Distance_component*>malloc(sizeof(Distance_component))
 * 
 */
  __pyx_v_self->_nb_cutoff = __pyx_v_17shift_calculators_DEFAULT_NB_CUTOFF;
</pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line1860")'> 1860:         self._compiled_components =  &lt;Distance_component*&gt;malloc(sizeof(Distance_component))</pre>
<pre id='line1860' class='code' style='background-color: #FFFF96'>
  /* "Cython_shift_calculator.pyx":1860
 *         global DEFAULT_NB_CUTOFF
 *         self._nb_cutoff = DEFAULT_NB_CUTOFF
 *         self._compiled_components =  <code><</code>Distance_component*>malloc(sizeof(Distance_component))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #     todo free!!
 */
  __pyx_v_self->__pyx_base._compiled_components = ((struct __pyx_t_17shift_calculators_Distance_component *)malloc((sizeof(struct __pyx_t_17shift_calculators_Distance_component))));

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_non_bonded_force_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_32Fast_non_bonded_force_calculator_5set_verbose(PyObject *__pyx_v_self, PyObject *__pyx_v_on); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_32Fast_non_bonded_force_calculator_5set_verbose(PyObject *__pyx_v_self, PyObject *__pyx_v_on) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_verbose (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_32Fast_non_bonded_force_calculator_4set_verbose(((struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_on));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1861")'> 1861: </pre>
<pre id='line1861' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1862")'> 1862: #     todo free!!</pre>
<pre id='line1862' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1863")'> 1863:     def set_verbose(self,on):</pre>
<pre id='line1863' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1863
 * 
 * #     todo free!!
 *     def set_verbose(self,on):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._verbose = on
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_32Fast_non_bonded_force_calculator_4set_verbose(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *__pyx_v_self, PyObject *__pyx_v_on) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_verbose", 0);
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line1864")'> 1864:         self._verbose = on</pre>
<pre id='line1864' class='code' style='background-color: #FFFF6a'>
  /* "Cython_shift_calculator.pyx":1864
 * #     todo free!!
 *     def set_verbose(self,on):
 *         self._verbose = on             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     #TODO: use global version
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_v_on);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1864; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->__pyx_base.__pyx_base._verbose = __pyx_t_1;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_non_bonded_force_calculator.set_verbose", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1865")'> 1865: </pre>
<pre id='line1865' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1866")'> 1866:     #TODO: use global version</pre>
<pre id='line1866' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1867")'> 1867:     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:</pre>
<pre id='line1867' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1867
 * 
 *     #TODO: use global version
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._compiled_target_components =  <code><</code>Non_bonded_target_component*> <code><</code>size_t> data
 */

static void __pyx_f_17shift_calculators_32Fast_non_bonded_force_calculator__bytes_to_components(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *__pyx_v_self, uintptr_t __pyx_v_data, uintptr_t __pyx_v_length) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1868")'> 1868: </pre>
<pre id='line1868' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1869")'> 1869:         self._compiled_target_components =  &lt;Non_bonded_target_component*&gt; &lt;size_t&gt; data</pre>
<pre id='line1869' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1869
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:
 * 
 *         self._compiled_target_components =  <code><</code>Non_bonded_target_component*> <code><</code>size_t> data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_target_components =  length
 * 
 */
  __pyx_v_self->_compiled_target_components = ((struct __pyx_t_17shift_calculators_Non_bonded_target_component *)((size_t)__pyx_v_data));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1870")'> 1870:         self._num_target_components =  length</pre>
<pre id='line1870' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1870
 * 
 *         self._compiled_target_components =  <code><</code>Non_bonded_target_component*> <code><</code>size_t> data
 *         self._num_target_components =  length             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     #TODO: use global version
 */
  __pyx_v_self->_num_target_components = __pyx_v_length;

}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1871")'> 1871: </pre>
<pre id='line1871' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1872")'> 1872:     #TODO: use global version</pre>
<pre id='line1872' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1873")'> 1873:     cdef void _bytes_to_remote_components(self, uintptr_t data, uintptr_t length) nogil:</pre>
<pre id='line1873' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1873
 * 
 *     #TODO: use global version
 *     cdef void _bytes_to_remote_components(self, uintptr_t data, uintptr_t length) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_remote_components =  <code><</code>Non_bonded_remote_atom_component*> <code><</code>size_t> data
 *         self._num_remote_components =  length
 */

static void __pyx_f_17shift_calculators_32Fast_non_bonded_force_calculator__bytes_to_remote_components(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *__pyx_v_self, uintptr_t __pyx_v_data, uintptr_t __pyx_v_length) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1874")'> 1874:         self._compiled_remote_components =  &lt;Non_bonded_remote_atom_component*&gt; &lt;size_t&gt; data</pre>
<pre id='line1874' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1874
 *     #TODO: use global version
 *     cdef void _bytes_to_remote_components(self, uintptr_t data, uintptr_t length) nogil:
 *         self._compiled_remote_components =  <code><</code>Non_bonded_remote_atom_component*> <code><</code>size_t> data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_remote_components =  length
 * 
 */
  __pyx_v_self->_compiled_remote_components = ((struct __pyx_t_17shift_calculators_Non_bonded_remote_atom_component *)((size_t)__pyx_v_data));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1875")'> 1875:         self._num_remote_components =  length</pre>
<pre id='line1875' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1875
 *     cdef void _bytes_to_remote_components(self, uintptr_t data, uintptr_t length) nogil:
 *         self._compiled_remote_components =  <code><</code>Non_bonded_remote_atom_component*> <code><</code>size_t> data
 *         self._num_remote_components =  length             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void _bytes_to_nonbonded_coefficient_components(self, uintptr_t data, uintptr_t length) nogil:
 */
  __pyx_v_self->_num_remote_components = __pyx_v_length;

}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1876")'> 1876: </pre>
<pre id='line1876' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1877")'> 1877:     cdef void _bytes_to_nonbonded_coefficient_components(self, uintptr_t data, uintptr_t length) nogil:</pre>
<pre id='line1877' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1877
 *         self._num_remote_components =  length
 * 
 *     cdef void _bytes_to_nonbonded_coefficient_components(self, uintptr_t data, uintptr_t length) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_coefficient_components =  <code><</code>Nonbonded_coefficient_component*> <code><</code>size_t> data
 *         self._num_coefficient_components =  length
 */

static void __pyx_f_17shift_calculators_32Fast_non_bonded_force_calculator__bytes_to_nonbonded_coefficient_components(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *__pyx_v_self, uintptr_t __pyx_v_data, uintptr_t __pyx_v_length) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1878")'> 1878:         self._compiled_coefficient_components =  &lt;Nonbonded_coefficient_component*&gt; &lt;size_t&gt; data</pre>
<pre id='line1878' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1878
 * 
 *     cdef void _bytes_to_nonbonded_coefficient_components(self, uintptr_t data, uintptr_t length) nogil:
 *         self._compiled_coefficient_components =  <code><</code>Nonbonded_coefficient_component*> <code><</code>size_t> data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_coefficient_components =  length
 * 
 */
  __pyx_v_self->_compiled_coefficient_components = ((struct __pyx_t_17shift_calculators_Nonbonded_coefficient_component *)((size_t)__pyx_v_data));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1879")'> 1879:         self._num_coefficient_components =  length</pre>
<pre id='line1879' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1879
 *     cdef void _bytes_to_nonbonded_coefficient_components(self, uintptr_t data, uintptr_t length) nogil:
 *         self._compiled_coefficient_components =  <code><</code>Nonbonded_coefficient_component*> <code><</code>size_t> data
 *         self._num_coefficient_components =  length             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     #TODO: call super?
 */
  __pyx_v_self->_num_coefficient_components = __pyx_v_length;

}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1880")'> 1880: </pre>
<pre id='line1880' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1881")'> 1881:     #TODO: call super?</pre>
<pre id='line1881' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1882")'> 1882:     cdef void _set_components(self, cmap[int, uintptr_t] *components) nogil:</pre>
<pre id='line1882' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1882
 * 
 *     #TODO: call super?
 *     cdef void _set_components(self, cmap[int, uintptr_t] *components) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         Fast_distance_based_potential_force_calculator._set_components(self,components)
 * 
 */

static void __pyx_f_17shift_calculators_32Fast_non_bonded_force_calculator__set_components(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *__pyx_v_self, std::map<code><</code>int,uintptr_t> *__pyx_v_components) {
  #ifdef WITH_THREAD
  PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
  #endif
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_components", 0);
  #ifdef WITH_THREAD
  PyGILState_Release(__pyx_gilstate_save);
  #endif
  /*try:*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1883")'> 1883:         Fast_distance_based_potential_force_calculator._set_components(self,components)</pre>
<pre id='line1883' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1883
 *     #TODO: call super?
 *     cdef void _set_components(self, cmap[int, uintptr_t] *components) nogil:
 *         Fast_distance_based_potential_force_calculator._set_components(self,components)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         with gil:
 */
    __pyx_vtabptr_17shift_calculators_Fast_distance_based_potential_force_calculator->__pyx_base._set_components(((struct __pyx_obj_17shift_calculators_Base_force_calculator *)__pyx_v_self), __pyx_v_components);

  /* "Cython_shift_calculator.pyx":1883
 *     #TODO: call super?
 *     cdef void _set_components(self, cmap[int, uintptr_t] *components) nogil:
 *         Fast_distance_based_potential_force_calculator._set_components(self,components)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         with gil:
 */
  /*finally:*/ {
    #ifdef WITH_THREAD
    __pyx_gilstate_save = PyGILState_Ensure();
    #endif
  }

  #ifdef WITH_THREAD
  PyGILState_Release(__pyx_gilstate_save);
  #endif
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1884")'> 1884: </pre>
<pre id='line1884' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1885")'> 1885:         with gil:</pre>
<pre id='line1885' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1885
 *         Fast_distance_based_potential_force_calculator._set_components(self,components)
 * 
 *         with gil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._non_bonded_list =  <code><</code>Non_bonded_interaction_list>components[0][NBLT]
 *         self._bytes_to_remote_components(components[0][NBRM], components[0][NNBRM])
 */
    {
        #ifdef WITH_THREAD
        PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
        #endif
        /*try:*/ {

        /* "Cython_shift_calculator.pyx":1885
 *         Fast_distance_based_potential_force_calculator._set_components(self,components)
 * 
 *         with gil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._non_bonded_list =  <code><</code>Non_bonded_interaction_list>components[0][NBLT]
 *         self._bytes_to_remote_components(components[0][NBRM], components[0][NNBRM])
 */
        /*finally:*/ {
          #ifdef WITH_THREAD
          PyGILState_Release(__pyx_gilstate_save);
          #endif
        }
    }
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1886")'> 1886:             self._non_bonded_list =  &lt;Non_bonded_interaction_list&gt;components[0][NBLT]</pre>
<pre id='line1886' class='code' style='background-color: #FFFFd4'>
          /* "Cython_shift_calculator.pyx":1886
 * 
 *         with gil:
 *             self._non_bonded_list =  <code><</code>Non_bonded_interaction_list>components[0][NBLT]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._bytes_to_remote_components(components[0][NBRM], components[0][NNBRM])
 *         self._bytes_to_nonbonded_coefficient_components(components[0][COEF],components[0][NCOEF])
 */
          __pyx_t_1 = ((__pyx_v_components[0])[__pyx_v_17shift_calculators_NBLT]);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)__pyx_t_1)));
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_1));
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_non_bonded_list);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_non_bonded_list));
          __pyx_v_self->_non_bonded_list = ((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)__pyx_t_1);
        }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1887")'> 1887:         self._bytes_to_remote_components(components[0][NBRM], components[0][NNBRM])</pre>
<pre id='line1887' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1887
 *         with gil:
 *             self._non_bonded_list =  <code><</code>Non_bonded_interaction_list>components[0][NBLT]
 *         self._bytes_to_remote_components(components[0][NBRM], components[0][NNBRM])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._bytes_to_nonbonded_coefficient_components(components[0][COEF],components[0][NCOEF])
 * 
 */
    ((struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_force_calculator *)__pyx_v_self->__pyx_base.__pyx_base.__pyx_vtab)->_bytes_to_remote_components(__pyx_v_self, ((__pyx_v_components[0])[__pyx_v_17shift_calculators_NBRM]), ((__pyx_v_components[0])[__pyx_v_17shift_calculators_NNBRM]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1888")'> 1888:         self._bytes_to_nonbonded_coefficient_components(components[0][COEF],components[0][NCOEF])</pre>
<pre id='line1888' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1888
 *             self._non_bonded_list =  <code><</code>Non_bonded_interaction_list>components[0][NBLT]
 *         self._bytes_to_remote_components(components[0][NBRM], components[0][NNBRM])
 *         self._bytes_to_nonbonded_coefficient_components(components[0][COEF],components[0][NCOEF])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #         if 'ACTI' in components:
 */
    ((struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_force_calculator *)__pyx_v_self->__pyx_base.__pyx_base.__pyx_vtab)->_bytes_to_nonbonded_coefficient_components(__pyx_v_self, ((__pyx_v_components[0])[__pyx_v_17shift_calculators_COEF]), ((__pyx_v_components[0])[__pyx_v_17shift_calculators_NCOEF]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1889")'> 1889: </pre>
<pre id='line1889' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1890")'> 1890: #         if 'ACTI' in components:</pre>
<pre id='line1890' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1891")'> 1891: #             self._active_components = components['ACTI']</pre>
<pre id='line1891' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1892")'> 1892:         self._component_offset = components[0][OFFS]</pre>
<pre id='line1892' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1892
 * #         if 'ACTI' in components:
 * #             self._active_components = components['ACTI']
 *         self._component_offset = components[0][OFFS]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline void _set_the_component(self, int target_atom_index,int remote_atom_index, float coefficient,float exponent):
 */
    __pyx_v_self->_component_offset = ((__pyx_v_components[0])[__pyx_v_17shift_calculators_OFFS]);
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1893")'> 1893: </pre>
<pre id='line1893' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1894")'> 1894:     cdef inline void _set_the_component(self, int target_atom_index,int remote_atom_index, float coefficient,float exponent):</pre>
<pre id='line1894' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1894
 *         self._component_offset = components[0][OFFS]
 * 
 *     cdef inline void _set_the_component(self, int target_atom_index,int remote_atom_index, float coefficient,float exponent):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components[0].target_atom =target_atom_index
 *         self._compiled_components[0].remote_atom_1 =target_atom_index
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_32Fast_non_bonded_force_calculator__set_the_component(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *__pyx_v_self, int __pyx_v_target_atom_index, int __pyx_v_remote_atom_index, float __pyx_v_coefficient, float __pyx_v_exponent) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_the_component", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1895")'> 1895:         self._compiled_components[0].target_atom =target_atom_index</pre>
<pre id='line1895' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1895
 * 
 *     cdef inline void _set_the_component(self, int target_atom_index,int remote_atom_index, float coefficient,float exponent):
 *         self._compiled_components[0].target_atom =target_atom_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components[0].remote_atom_1 =target_atom_index
 *         self._compiled_components[0].remote_atom_2 =remote_atom_index
 */
  (__pyx_v_self->__pyx_base._compiled_components[0]).target_atom = __pyx_v_target_atom_index;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1896")'> 1896:         self._compiled_components[0].remote_atom_1 =target_atom_index</pre>
<pre id='line1896' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1896
 *     cdef inline void _set_the_component(self, int target_atom_index,int remote_atom_index, float coefficient,float exponent):
 *         self._compiled_components[0].target_atom =target_atom_index
 *         self._compiled_components[0].remote_atom_1 =target_atom_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components[0].remote_atom_2 =remote_atom_index
 *         self._compiled_components[0].coefficient =coefficient
 */
  (__pyx_v_self->__pyx_base._compiled_components[0]).remote_atom_1 = __pyx_v_target_atom_index;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1897")'> 1897:         self._compiled_components[0].remote_atom_2 =remote_atom_index</pre>
<pre id='line1897' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1897
 *         self._compiled_components[0].target_atom =target_atom_index
 *         self._compiled_components[0].remote_atom_1 =target_atom_index
 *         self._compiled_components[0].remote_atom_2 =remote_atom_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components[0].coefficient =coefficient
 *         self._compiled_components[0].exponent =exponent
 */
  (__pyx_v_self->__pyx_base._compiled_components[0]).remote_atom_2 = __pyx_v_remote_atom_index;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1898")'> 1898:         self._compiled_components[0].coefficient =coefficient</pre>
<pre id='line1898' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1898
 *         self._compiled_components[0].remote_atom_1 =target_atom_index
 *         self._compiled_components[0].remote_atom_2 =remote_atom_index
 *         self._compiled_components[0].coefficient =coefficient             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components[0].exponent =exponent
 * 
 */
  (__pyx_v_self->__pyx_base._compiled_components[0]).coefficient = __pyx_v_coefficient;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1899")'> 1899:         self._compiled_components[0].exponent =exponent</pre>
<pre id='line1899' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":1899
 *         self._compiled_components[0].remote_atom_2 =remote_atom_index
 *         self._compiled_components[0].coefficient =coefficient
 *         self._compiled_components[0].exponent =exponent             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  (__pyx_v_self->__pyx_base._compiled_components[0]).exponent = __pyx_v_exponent;

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1900")'> 1900: </pre>
<pre id='line1900' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1901")'> 1901: </pre>
<pre id='line1901' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1902")'> 1902: </pre>
<pre id='line1902' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1903")'> 1903:     cdef void _do_calc_components(self, int[:] component_to_result, CDSVector[float] force_factors, Out_array force) nogil:</pre>
<pre id='line1903' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1903
 * 
 * 
 *     cdef void _do_calc_components(self, int[:] component_to_result, CDSVector[float] force_factors, Out_array force) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef int factor_index
 */

static void __pyx_f_17shift_calculators_32Fast_non_bonded_force_calculator__do_calc_components(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *__pyx_v_self, __Pyx_memviewslice __pyx_v_component_to_result, CDSVector<code><</code>float> __pyx_v_force_factors, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_force) {
  int __pyx_v_factor_index;
  PyObject *__pyx_v_non_bonded_index = NULL;
  #ifdef WITH_THREAD
  PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
  #endif
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_do_calc_components", 0);
  #ifdef WITH_THREAD
  PyGILState_Release(__pyx_gilstate_save);
  #endif
  /*try:*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1904")'> 1904: </pre>
<pre id='line1904' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line1905")'> 1905:         cdef int factor_index</pre>
<pre id='line1905' class='code' style='background-color: #FFFFb6'>
  /* "Cython_shift_calculator.pyx":1905
 *     cdef void _do_calc_components(self, int[:] component_to_result, CDSVector[float] force_factors, Out_array force) nogil:
 * 
 *         cdef int factor_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         with gil:
 */
  /*finally:*/ {
    int __pyx_why;
    __pyx_why = 0; goto __pyx_L5;
    __pyx_L4: __pyx_why = 4; goto __pyx_L5;
    __pyx_L5:;
    #ifdef WITH_THREAD
    __pyx_gilstate_save = PyGILState_Ensure();
    #endif
    switch (__pyx_why) {
      case 4: goto __pyx_L1_error;
    }
  }

  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Fast_non_bonded_force_calculator._do_calc_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_non_bonded_index);
  #ifdef WITH_THREAD
  PyGILState_Release(__pyx_gilstate_save);
  #endif
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1906")'> 1906: </pre>
<pre id='line1906' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1907")'> 1907:         with gil:</pre>
<pre id='line1907' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1907
 *         cdef int factor_index
 * 
 *         with gil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             if self._active_components ==  None:
 */
    {
        #ifdef WITH_THREAD
        PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
        #endif
        /*try:*/ {

        /* "Cython_shift_calculator.pyx":1907
 *         cdef int factor_index
 * 
 *         with gil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             if self._active_components ==  None:
 */
        /*finally:*/ {
          int __pyx_why;
          __pyx_why = 0; goto __pyx_L8;
          __pyx_L7: __pyx_why = 4; goto __pyx_L8;
          __pyx_L8:;
          #ifdef WITH_THREAD
          PyGILState_Release(__pyx_gilstate_save);
          #endif
          switch (__pyx_why) {
            case 4: goto __pyx_L4;
          }
        }
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1908")'> 1908: </pre>
<pre id='line1908' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1909")'> 1909:             if self._active_components ==  None:</pre>
<pre id='line1909' class='code' style='background-color: #FFFFaa'>
          /* "Cython_shift_calculator.pyx":1909
 *         with gil:
 * 
 *             if self._active_components ==  None:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for factor_index  in range(self._non_bonded_list.get_length()):
 *                     non_bonded_index  = factor_index
 */
          if (unlikely(!__pyx_v_self->__pyx_base.__pyx_base._active_components.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1909; __pyx_clineno = __LINE__; goto __pyx_L7;}}
          __pyx_t_1 = (((PyObject *) __pyx_v_self->__pyx_base.__pyx_base._active_components.memview) == Py_None);
          if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1910")'> 1910:                 for factor_index  in range(self._non_bonded_list.get_length()):</pre>
<pre id='line1910' class='code' style='background-color: #FFFFff'>
            /* "Cython_shift_calculator.pyx":1910
 * 
 *             if self._active_components ==  None:
 *                 for factor_index  in range(self._non_bonded_list.get_length()):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     non_bonded_index  = factor_index
 *                     self._calc_one_component(factor_index, non_bonded_index, component_to_result, force_factors, force)
 */
            __pyx_t_2 = ((struct __pyx_vtabstruct_17shift_calculators_Non_bonded_interaction_list *)__pyx_v_self->_non_bonded_list->__pyx_vtab)->get_length(__pyx_v_self->_non_bonded_list);
            for (__pyx_t_3 = 0; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
              __pyx_v_factor_index = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line1911")'> 1911:                     non_bonded_index  = factor_index</pre>
<pre id='line1911' class='code' style='background-color: #FFFF9f'>
              /* "Cython_shift_calculator.pyx":1911
 *             if self._active_components ==  None:
 *                 for factor_index  in range(self._non_bonded_list.get_length()):
 *                     non_bonded_index  = factor_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     self._calc_one_component(factor_index, non_bonded_index, component_to_result, force_factors, force)
 *             else:
 */
              __pyx_t_4 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_factor_index);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1911; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_non_bonded_index);
              __pyx_v_non_bonded_index = __pyx_t_4;
              __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line1912")'> 1912:                     self._calc_one_component(factor_index, non_bonded_index, component_to_result, force_factors, force)</pre>
<pre id='line1912' class='code' style='background-color: #FFFF7f'>
              /* "Cython_shift_calculator.pyx":1912
 *                 for factor_index  in range(self._non_bonded_list.get_length()):
 *                     non_bonded_index  = factor_index
 *                     self._calc_one_component(factor_index, non_bonded_index, component_to_result, force_factors, force)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 for factor_index  in range(self._active_components.shape[0]):
 */
              __pyx_t_5 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_non_bonded_index);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1912; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
              ((struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_force_calculator *)__pyx_v_self->__pyx_base.__pyx_base.__pyx_vtab)->_calc_one_component(__pyx_v_self, __pyx_v_factor_index, __pyx_t_5, __pyx_v_component_to_result, __pyx_v_force_factors, __pyx_v_force);
            }
            goto __pyx_L9;
          }
          /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1913")'> 1913:             else:</pre>
<pre id='line1913' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1914")'> 1914:                 for factor_index  in range(self._active_components.shape[0]):</pre>
<pre id='line1914' class='code' style='background-color: #FFFFaa'>
            /* "Cython_shift_calculator.pyx":1914
 *                     self._calc_one_component(factor_index, non_bonded_index, component_to_result, force_factors, force)
 *             else:
 *                 for factor_index  in range(self._active_components.shape[0]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     non_bonded_index = self._active_components[factor_index]
 *                     self._calc_one_component(factor_index, non_bonded_index, component_to_result, force_factors, force)
 */
            if (unlikely(!__pyx_v_self->__pyx_base.__pyx_base._active_components.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1914; __pyx_clineno = __LINE__; goto __pyx_L7;}}
            __pyx_t_6 = (__pyx_v_self->__pyx_base.__pyx_base._active_components.shape[0]);
            for (__pyx_t_2 = 0; __pyx_t_2 <code><</code> __pyx_t_6; __pyx_t_2+=1) {
              __pyx_v_factor_index = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line1915")'> 1915:                     non_bonded_index = self._active_components[factor_index]</pre>
<pre id='line1915' class='code' style='background-color: #FFFF79'>
              /* "Cython_shift_calculator.pyx":1915
 *             else:
 *                 for factor_index  in range(self._active_components.shape[0]):
 *                     non_bonded_index = self._active_components[factor_index]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     self._calc_one_component(factor_index, non_bonded_index, component_to_result, force_factors, force)
 * 
 */
              if (unlikely(!__pyx_v_self->__pyx_base.__pyx_base._active_components.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1915; __pyx_clineno = __LINE__; goto __pyx_L7;}}
              __pyx_t_3 = __pyx_v_factor_index;
              __pyx_t_4 = <span class='py_c_api'>PyInt_FromLong</span>((*((int *) ( /* dim=0 */ (__pyx_v_self->__pyx_base.__pyx_base._active_components.data + __pyx_t_3 * __pyx_v_self->__pyx_base.__pyx_base._active_components.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1915; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_non_bonded_index);
              __pyx_v_non_bonded_index = __pyx_t_4;
              __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line1916")'> 1916:                     self._calc_one_component(factor_index, non_bonded_index, component_to_result, force_factors, force)</pre>
<pre id='line1916' class='code' style='background-color: #FFFF7f'>
              /* "Cython_shift_calculator.pyx":1916
 *                 for factor_index  in range(self._active_components.shape[0]):
 *                     non_bonded_index = self._active_components[factor_index]
 *                     self._calc_one_component(factor_index, non_bonded_index, component_to_result, force_factors, force)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void _calc_one_component(self, int factor_index, int non_bonded_index, int[:] component_to_result, CDSVector[float] force_factors, Out_array force):
 */
              __pyx_t_5 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_non_bonded_index);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1916; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
              ((struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_force_calculator *)__pyx_v_self->__pyx_base.__pyx_base.__pyx_vtab)->_calc_one_component(__pyx_v_self, __pyx_v_factor_index, __pyx_t_5, __pyx_v_component_to_result, __pyx_v_force_factors, __pyx_v_force);
            }
          }
          __pyx_L9:;
        }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1917")'> 1917: </pre>
<pre id='line1917' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1918")'> 1918:     cdef void _calc_one_component(self, int factor_index, int non_bonded_index, int[:] component_to_result, CDSVector[float] force_factors, Out_array force):</pre>
<pre id='line1918' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1918
 *                     self._calc_one_component(factor_index, non_bonded_index, component_to_result, force_factors, force)
 * 
 *     cdef void _calc_one_component(self, int factor_index, int non_bonded_index, int[:] component_to_result, CDSVector[float] force_factors, Out_array force):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef double start_time = 0.0
 *         cdef double end_time = 0.0
 */

static void __pyx_f_17shift_calculators_32Fast_non_bonded_force_calculator__calc_one_component(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *__pyx_v_self, CYTHON_UNUSED int __pyx_v_factor_index, int __pyx_v_non_bonded_index, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_component_to_result, CDSVector<code><</code>float> __pyx_v_force_factors, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_force) {
  CYTHON_UNUSED double __pyx_v_start_time;
  CYTHON_UNUSED double __pyx_v_end_time;
  struct __pyx_t_17shift_calculators_Component_index_pair *__pyx_v_non_bonded_pair;
  int __pyx_v_target_component_index;
  int __pyx_v_remote_component_index;
  int __pyx_v_target_index;
  int __pyx_v_remote_index;
  float __pyx_v_distance;
  int __pyx_v_component_offset;
  long __pyx_v_i;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calc_one_component", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1919")'> 1919:         cdef double start_time = 0.0</pre>
<pre id='line1919' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1919
 * 
 *     cdef void _calc_one_component(self, int factor_index, int non_bonded_index, int[:] component_to_result, CDSVector[float] force_factors, Out_array force):
 *         cdef double start_time = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef double end_time = 0.0
 * 
 */
  __pyx_v_start_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1920")'> 1920:         cdef double end_time = 0.0</pre>
<pre id='line1920' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1920
 *     cdef void _calc_one_component(self, int factor_index, int non_bonded_index, int[:] component_to_result, CDSVector[float] force_factors, Out_array force):
 *         cdef double start_time = 0.0
 *         cdef double end_time = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Component_index_pair* non_bonded_pair
 */
  __pyx_v_end_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1921")'> 1921: </pre>
<pre id='line1921' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1922")'> 1922:         cdef Component_index_pair* non_bonded_pair</pre>
<pre id='line1922' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1923")'> 1923: </pre>
<pre id='line1923' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1924")'> 1924:         cdef int target_component_index</pre>
<pre id='line1924' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1925")'> 1925:         cdef int remote_component_index</pre>
<pre id='line1925' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1926")'> 1926: </pre>
<pre id='line1926' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1927")'> 1927:         cdef int target_index</pre>
<pre id='line1927' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1928")'> 1928:         cdef int remote_index</pre>
<pre id='line1928' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1929")'> 1929: </pre>
<pre id='line1929' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1930")'> 1930:         cdef float distance</pre>
<pre id='line1930' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1931")'> 1931:         non_bonded_pair  =  self._non_bonded_list.get(non_bonded_index)</pre>
<pre id='line1931' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1931
 * 
 *         cdef float distance
 *         non_bonded_pair  =  self._non_bonded_list.get(non_bonded_index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         target_component_index = non_bonded_pair[0].target_index
 */
  __pyx_v_non_bonded_pair = __pyx_f_17shift_calculators_27Non_bonded_interaction_list_get(__pyx_v_self->_non_bonded_list, __pyx_v_non_bonded_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1932")'> 1932: </pre>
<pre id='line1932' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1933")'> 1933:         target_component_index = non_bonded_pair[0].target_index</pre>
<pre id='line1933' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1933
 *         non_bonded_pair  =  self._non_bonded_list.get(non_bonded_index)
 * 
 *         target_component_index = non_bonded_pair[0].target_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         remote_component_index = non_bonded_pair[0].remote_index
 *         component_offset = self._component_offset + non_bonded_pair[0].component_index
 */
  __pyx_t_1 = (__pyx_v_non_bonded_pair[0]).target_index;
  __pyx_v_target_component_index = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1934")'> 1934:         remote_component_index = non_bonded_pair[0].remote_index</pre>
<pre id='line1934' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1934
 * 
 *         target_component_index = non_bonded_pair[0].target_index
 *         remote_component_index = non_bonded_pair[0].remote_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         component_offset = self._component_offset + non_bonded_pair[0].component_index
 * 
 */
  __pyx_t_1 = (__pyx_v_non_bonded_pair[0]).remote_index;
  __pyx_v_remote_component_index = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1935")'> 1935:         component_offset = self._component_offset + non_bonded_pair[0].component_index</pre>
<pre id='line1935' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1935
 *         target_component_index = non_bonded_pair[0].target_index
 *         remote_component_index = non_bonded_pair[0].remote_index
 *         component_offset = self._component_offset + non_bonded_pair[0].component_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         target_index  = self._compiled_target_components[target_component_index].target_atom_id
 */
  __pyx_v_component_offset = (__pyx_v_self->_component_offset + (__pyx_v_non_bonded_pair[0]).component_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1936")'> 1936: </pre>
<pre id='line1936' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1937")'> 1937:         target_index  = self._compiled_target_components[target_component_index].target_atom_id</pre>
<pre id='line1937' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1937
 *         component_offset = self._component_offset + non_bonded_pair[0].component_index
 * 
 *         target_index  = self._compiled_target_components[target_component_index].target_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         remote_index = self._compiled_remote_components[remote_component_index].remote_atom_id
 *         distance = calc_distance_simulation(self._simulation, target_index, remote_index)
 */
  __pyx_t_1 = (__pyx_v_self->_compiled_target_components[__pyx_v_target_component_index]).target_atom_id;
  __pyx_v_target_index = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1938")'> 1938:         remote_index = self._compiled_remote_components[remote_component_index].remote_atom_id</pre>
<pre id='line1938' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1938
 * 
 *         target_index  = self._compiled_target_components[target_component_index].target_atom_id
 *         remote_index = self._compiled_remote_components[remote_component_index].remote_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         distance = calc_distance_simulation(self._simulation, target_index, remote_index)
 *         if distance <code><</code> self._nb_cutoff:
 */
  __pyx_t_1 = (__pyx_v_self->_compiled_remote_components[__pyx_v_remote_component_index]).remote_atom_id;
  __pyx_v_remote_index = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1939")'> 1939:         distance = calc_distance_simulation(self._simulation, target_index, remote_index)</pre>
<pre id='line1939' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1939
 *         target_index  = self._compiled_target_components[target_component_index].target_atom_id
 *         remote_index = self._compiled_remote_components[remote_component_index].remote_atom_id
 *         distance = calc_distance_simulation(self._simulation, target_index, remote_index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if distance <code><</code> self._nb_cutoff:
 *             for i in range(2):
 */
  __pyx_v_distance = __pyx_f_17shift_calculators_calc_distance_simulation(__pyx_v_self->__pyx_base.__pyx_base._simulation, __pyx_v_target_index, __pyx_v_remote_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1940")'> 1940:         if distance &lt; self._nb_cutoff:</pre>
<pre id='line1940' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1940
 *         remote_index = self._compiled_remote_components[remote_component_index].remote_atom_id
 *         distance = calc_distance_simulation(self._simulation, target_index, remote_index)
 *         if distance <code><</code> self._nb_cutoff:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for i in range(2):
 *                     self._cython_build_component(non_bonded_index, i)
 */
  __pyx_t_2 = (__pyx_v_distance <code><</code> __pyx_v_self->_nb_cutoff);
  if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1941")'> 1941:             for i in range(2):</pre>
<pre id='line1941' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1941
 *         distance = calc_distance_simulation(self._simulation, target_index, remote_index)
 *         if distance <code><</code> self._nb_cutoff:
 *             for i in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     self._cython_build_component(non_bonded_index, i)
 *                     self._distance_calc_single_force_set(0, force_factors[component_offset] , force)
 */
    for (__pyx_t_3 = 0; __pyx_t_3 <code><</code> 2; __pyx_t_3+=1) {
      __pyx_v_i = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1942")'> 1942:                     self._cython_build_component(non_bonded_index, i)</pre>
<pre id='line1942' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1942
 *         if distance <code><</code> self._nb_cutoff:
 *             for i in range(2):
 *                     self._cython_build_component(non_bonded_index, i)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     self._distance_calc_single_force_set(0, force_factors[component_offset] , force)
 * 
 */
      ((struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_force_calculator *)__pyx_v_self->__pyx_base.__pyx_base.__pyx_vtab)->_cython_build_component(__pyx_v_self, __pyx_v_non_bonded_index, __pyx_v_i);
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line1943")'> 1943:                     self._distance_calc_single_force_set(0, force_factors[component_offset] , force)</pre>
<pre id='line1943' class='code' style='background-color: #FFFF3b'>
      /* "Cython_shift_calculator.pyx":1943
 *             for i in range(2):
 *                     self._cython_build_component(non_bonded_index, i)
 *                     self._distance_calc_single_force_set(0, force_factors[component_offset] , force)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def  _build_component(self, non_bonded_index, i):
 */
      __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__distance_calc_single_force_set(((struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *)__pyx_v_self), 0, (__pyx_v_force_factors[__pyx_v_component_offset]), __pyx_v_force);
    }
    goto __pyx_L3;
  }
  __pyx_L3:;

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_32Fast_non_bonded_force_calculator_7_build_component(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_32Fast_non_bonded_force_calculator_7_build_component(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_non_bonded_index = 0;
  PyObject *__pyx_v_i = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_build_component (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__non_bonded_index,&__pyx_n_s__i,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__non_bonded_index)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__i)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_build_component", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1945; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_build_component") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1945; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_non_bonded_index = values[0];
    __pyx_v_i = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_build_component", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1945; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_non_bonded_force_calculator._build_component", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_32Fast_non_bonded_force_calculator_6_build_component(((struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *)__pyx_v_self), __pyx_v_non_bonded_index, __pyx_v_i);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1944")'> 1944: </pre>
<pre id='line1944' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1945")'> 1945:     def  _build_component(self, non_bonded_index, i):</pre>
<pre id='line1945' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1945
 *                     self._distance_calc_single_force_set(0, force_factors[component_offset] , force)
 * 
 *     def  _build_component(self, non_bonded_index, i):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._cython_build_component(non_bonded_index, i)
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_32Fast_non_bonded_force_calculator_6_build_component(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *__pyx_v_self, PyObject *__pyx_v_non_bonded_index, PyObject *__pyx_v_i) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_build_component", 0);
</pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line1946")'> 1946:         self._cython_build_component(non_bonded_index, i)</pre>
<pre id='line1946' class='code' style='background-color: #FFFF4b'>
  /* "Cython_shift_calculator.pyx":1946
 * 
 *     def  _build_component(self, non_bonded_index, i):
 *         self._cython_build_component(non_bonded_index, i)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void  _cython_build_component(self, int non_bonded_index, int i):
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_non_bonded_index);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1946; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1946; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  ((struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_force_calculator *)__pyx_v_self->__pyx_base.__pyx_base.__pyx_vtab)->_cython_build_component(__pyx_v_self, __pyx_t_1, __pyx_t_2);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_non_bonded_force_calculator._build_component", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1947")'> 1947: </pre>
<pre id='line1947' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1948")'> 1948:     cdef void  _cython_build_component(self, int non_bonded_index, int i):</pre>
<pre id='line1948' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1948
 *         self._cython_build_component(non_bonded_index, i)
 * 
 *     cdef void  _cython_build_component(self, int non_bonded_index, int i):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Component_index_pair* non_bonded_pair
 * 
 */

static void __pyx_f_17shift_calculators_32Fast_non_bonded_force_calculator__cython_build_component(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *__pyx_v_self, int __pyx_v_non_bonded_index, int __pyx_v_i) {
  struct __pyx_t_17shift_calculators_Component_index_pair *__pyx_v_non_bonded_pair;
  int __pyx_v_target_component_index;
  int __pyx_v_remote_component_index;
  int __pyx_v_target_index;
  int __pyx_v_remote_index;
  int __pyx_v_chem_type_id;
  CYTHON_UNUSED float __pyx_v_default_smoothing_factor;
  int __pyx_v_atom_1_coefficent_offset;
  float __pyx_v_coefficient;
  float __pyx_v_exponent;
  struct __pyx_t_17shift_calculators_Nonbonded_coefficient_component *__pyx_v_coefficient_component;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_cython_build_component", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1949")'> 1949:         cdef Component_index_pair* non_bonded_pair</pre>
<pre id='line1949' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1950")'> 1950: </pre>
<pre id='line1950' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1951")'> 1951:         cdef int target_component_index</pre>
<pre id='line1951' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1952")'> 1952:         cdef int remote_component_index</pre>
<pre id='line1952' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1953")'> 1953: </pre>
<pre id='line1953' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1954")'> 1954:         cdef int target_index</pre>
<pre id='line1954' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1955")'> 1955:         cdef int remote_index</pre>
<pre id='line1955' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1956")'> 1956: </pre>
<pre id='line1956' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1957")'> 1957:         cdef float distance</pre>
<pre id='line1957' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1958")'> 1958: </pre>
<pre id='line1958' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1959")'> 1959:         cdef int chem_type_id</pre>
<pre id='line1959' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1960")'> 1960: </pre>
<pre id='line1960' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1961")'> 1961:         cdef float default_smoothing_factor = self._smoothing_factor</pre>
<pre id='line1961' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1961
 *         cdef int chem_type_id
 * 
 *         cdef float default_smoothing_factor = self._smoothing_factor             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef float smoothing_factor
 * 
 */
  __pyx_t_1 = __pyx_v_self->__pyx_base._smoothing_factor;
  __pyx_v_default_smoothing_factor = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1962")'> 1962:         cdef float smoothing_factor</pre>
<pre id='line1962' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1963")'> 1963: </pre>
<pre id='line1963' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1964")'> 1964:         cdef float ratio</pre>
<pre id='line1964' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1965")'> 1965: </pre>
<pre id='line1965' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1966")'> 1966: </pre>
<pre id='line1966' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1967")'> 1967:         cdef int atom_1_coefficent_offset</pre>
<pre id='line1967' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1968")'> 1968: </pre>
<pre id='line1968' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1969")'> 1969:         cdef float coefficient,exponent</pre>
<pre id='line1969' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1970")'> 1970: </pre>
<pre id='line1970' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1971")'> 1971:         cdef Nonbonded_coefficient_component* coefficent_component</pre>
<pre id='line1971' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1972")'> 1972:         cdef bint result</pre>
<pre id='line1972' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1973")'> 1973: </pre>
<pre id='line1973' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1974")'> 1974:         non_bonded_pair  =  self._non_bonded_list.get(non_bonded_index)</pre>
<pre id='line1974' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1974
 *         cdef bint result
 * 
 *         non_bonded_pair  =  self._non_bonded_list.get(non_bonded_index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         target_component_index = non_bonded_pair[0].target_index
 */
  __pyx_v_non_bonded_pair = __pyx_f_17shift_calculators_27Non_bonded_interaction_list_get(__pyx_v_self->_non_bonded_list, __pyx_v_non_bonded_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1975")'> 1975: </pre>
<pre id='line1975' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1976")'> 1976:         target_component_index = non_bonded_pair[0].target_index</pre>
<pre id='line1976' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1976
 *         non_bonded_pair  =  self._non_bonded_list.get(non_bonded_index)
 * 
 *         target_component_index = non_bonded_pair[0].target_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         remote_component_index = non_bonded_pair[0].remote_index
 * 
 */
  __pyx_t_2 = (__pyx_v_non_bonded_pair[0]).target_index;
  __pyx_v_target_component_index = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1977")'> 1977:         remote_component_index = non_bonded_pair[0].remote_index</pre>
<pre id='line1977' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1977
 * 
 *         target_component_index = non_bonded_pair[0].target_index
 *         remote_component_index = non_bonded_pair[0].remote_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         target_index  = self._compiled_target_components[target_component_index].target_atom_id
 */
  __pyx_t_2 = (__pyx_v_non_bonded_pair[0]).remote_index;
  __pyx_v_remote_component_index = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1978")'> 1978: </pre>
<pre id='line1978' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1979")'> 1979:         target_index  = self._compiled_target_components[target_component_index].target_atom_id</pre>
<pre id='line1979' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1979
 *         remote_component_index = non_bonded_pair[0].remote_index
 * 
 *         target_index  = self._compiled_target_components[target_component_index].target_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         remote_index = self._compiled_remote_components[remote_component_index].remote_atom_id
 *         atom_1_coefficent_offset = self._compiled_target_components[target_component_index].atom_type_id
 */
  __pyx_t_2 = (__pyx_v_self->_compiled_target_components[__pyx_v_target_component_index]).target_atom_id;
  __pyx_v_target_index = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1980")'> 1980:         remote_index = self._compiled_remote_components[remote_component_index].remote_atom_id</pre>
<pre id='line1980' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1980
 * 
 *         target_index  = self._compiled_target_components[target_component_index].target_atom_id
 *         remote_index = self._compiled_remote_components[remote_component_index].remote_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         atom_1_coefficent_offset = self._compiled_target_components[target_component_index].atom_type_id
 * 
 */
  __pyx_t_2 = (__pyx_v_self->_compiled_remote_components[__pyx_v_remote_component_index]).remote_atom_id;
  __pyx_v_remote_index = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1981")'> 1981:         atom_1_coefficent_offset = self._compiled_target_components[target_component_index].atom_type_id</pre>
<pre id='line1981' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1981
 *         target_index  = self._compiled_target_components[target_component_index].target_atom_id
 *         remote_index = self._compiled_remote_components[remote_component_index].remote_atom_id
 *         atom_1_coefficent_offset = self._compiled_target_components[target_component_index].atom_type_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         chem_type_id = self._compiled_remote_components[remote_component_index].chem_type[i]
 */
  __pyx_t_2 = (__pyx_v_self->_compiled_target_components[__pyx_v_target_component_index]).atom_type_id;
  __pyx_v_atom_1_coefficent_offset = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1982")'> 1982: </pre>
<pre id='line1982' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1983")'> 1983:         chem_type_id = self._compiled_remote_components[remote_component_index].chem_type[i]</pre>
<pre id='line1983' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1983
 *         atom_1_coefficent_offset = self._compiled_target_components[target_component_index].atom_type_id
 * 
 *         chem_type_id = self._compiled_remote_components[remote_component_index].chem_type[i]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         coefficient_component = &self._compiled_coefficient_components[chem_type_id]
 */
  __pyx_v_chem_type_id = ((__pyx_v_self->_compiled_remote_components[__pyx_v_remote_component_index]).chem_type[__pyx_v_i]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1984")'> 1984: </pre>
<pre id='line1984' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1985")'> 1985:         coefficient_component = &amp;self._compiled_coefficient_components[chem_type_id]</pre>
<pre id='line1985' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1985
 *         chem_type_id = self._compiled_remote_components[remote_component_index].chem_type[i]
 * 
 *         coefficient_component = &self._compiled_coefficient_components[chem_type_id]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         exponent = coefficient_component[0].exponent
 */
  __pyx_v_coefficient_component = (&(__pyx_v_self->_compiled_coefficient_components[__pyx_v_chem_type_id]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1986")'> 1986: </pre>
<pre id='line1986' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1987")'> 1987:         exponent = coefficient_component[0].exponent</pre>
<pre id='line1987' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1987
 *         coefficient_component = &self._compiled_coefficient_components[chem_type_id]
 * 
 *         exponent = coefficient_component[0].exponent             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         coefficient  = coefficient_component[0].coefficients[atom_1_coefficent_offset]
 */
  __pyx_t_1 = (__pyx_v_coefficient_component[0]).exponent;
  __pyx_v_exponent = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1988")'> 1988: </pre>
<pre id='line1988' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1989")'> 1989:         coefficient  = coefficient_component[0].coefficients[atom_1_coefficent_offset]</pre>
<pre id='line1989' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1989
 *         exponent = coefficient_component[0].exponent
 * 
 *         coefficient  = coefficient_component[0].coefficients[atom_1_coefficent_offset]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._set_the_component(target_index,remote_index,coefficient,exponent)
 */
  __pyx_v_coefficient = ((__pyx_v_coefficient_component[0]).coefficients[__pyx_v_atom_1_coefficent_offset]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1990")'> 1990: </pre>
<pre id='line1990' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1991")'> 1991:         self._set_the_component(target_index,remote_index,coefficient,exponent)</pre>
<pre id='line1991' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":1991
 *         coefficient  = coefficient_component[0].coefficients[atom_1_coefficent_offset]
 * 
 *         self._set_the_component(target_index,remote_index,coefficient,exponent)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_f_17shift_calculators_32Fast_non_bonded_force_calculator__set_the_component(__pyx_v_self, __pyx_v_target_index, __pyx_v_remote_index, __pyx_v_coefficient, __pyx_v_exponent);

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1992")'> 1992: </pre>
<pre id='line1992' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1993")'> 1993: </pre>
<pre id='line1993' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1994")'> 1994: </pre>
<pre id='line1994' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1995")'> 1995: cdef class Fast_dihedral_force_calculator(Base_force_calculator):</pre>
<pre id='line1995' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1995
 * 
 * 
 * cdef class Fast_dihedral_force_calculator(Base_force_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef Dihedral_component* _compiled_components
 */
struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator {
  struct __pyx_obj_17shift_calculators_Base_force_calculator __pyx_base;
  struct __pyx_t_17shift_calculators_Dihedral_component *_compiled_components;
  int _num_components;
  PyObject *raw_data;
};


/* "Cython_shift_calculator.pyx":1995
 * 
 * 
 * cdef class Fast_dihedral_force_calculator(Base_force_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef Dihedral_component* _compiled_components
 */

struct __pyx_vtabstruct_17shift_calculators_Fast_dihedral_force_calculator {
  struct __pyx_vtabstruct_17shift_calculators_Base_force_calculator __pyx_base;
  struct __pyx_t_17shift_calculators_dihedral_ids (*_get_dihedral_atom_ids)(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *, int);
  struct __pyx_t_17shift_calculators_dihedral_parameters (*_get_parameters)(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *, int);
  float (*_get_coefficient)(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *, int);
  float (*_cython_calc_single_force_factor)(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *, int);
  void (*_dihedral_calc_single_force_set)(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *, int, float, struct __pyx_obj_17shift_calculators_Out_array *);
};
static struct __pyx_vtabstruct_17shift_calculators_Fast_dihedral_force_calculator *__pyx_vtabptr_17shift_calculators_Fast_dihedral_force_calculator;
static CYTHON_INLINE struct __pyx_t_17shift_calculators_dihedral_ids __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__get_dihedral_atom_ids(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *, int);
static CYTHON_INLINE struct __pyx_t_17shift_calculators_dihedral_parameters __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__get_parameters(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *, int);
static CYTHON_INLINE float __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__get_coefficient(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *, int);
static CYTHON_INLINE float __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__cython_calc_single_force_factor(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *, int);
static CYTHON_INLINE void __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__dihedral_calc_single_force_set(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *, int, float, struct __pyx_obj_17shift_calculators_Out_array *);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1996")'> 1996: </pre>
<pre id='line1996' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1997")'> 1997:     cdef Dihedral_component* _compiled_components</pre>
<pre id='line1997' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1998")'> 1998:     cdef int _num_components</pre>
<pre id='line1998' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1999")'> 1999:     cdef object raw_data</pre>
<pre id='line1999' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2000")'> 2000: </pre>
<pre id='line2000' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2001")'> 2001:     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:</pre>
<pre id='line2001' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2001
 *     cdef object raw_data
 * 
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._compiled_components =  <code><</code>Dihedral_component*> <code><</code>size_t> data
 */

static void __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__bytes_to_components(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *__pyx_v_self, uintptr_t __pyx_v_data, uintptr_t __pyx_v_length) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2002")'> 2002: </pre>
<pre id='line2002' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2003")'> 2003:         self._compiled_components =  &lt;Dihedral_component*&gt; &lt;size_t&gt; data</pre>
<pre id='line2003' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2003
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:
 * 
 *         self._compiled_components =  <code><</code>Dihedral_component*> <code><</code>size_t> data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components =  length
 * 
 */
  __pyx_v_self->_compiled_components = ((struct __pyx_t_17shift_calculators_Dihedral_component *)((size_t)__pyx_v_data));
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line2004")'> 2004:         self._num_components =  length</pre>
<pre id='line2004' class='code' style='background-color: #FFFF73'>
  /* "Cython_shift_calculator.pyx":2004
 * 
 *         self._compiled_components =  <code><</code>Dihedral_component*> <code><</code>size_t> data
 *         self._num_components =  length             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_self->_num_components = __pyx_v_length;

}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_30Fast_dihedral_force_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_30Fast_dihedral_force_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) > 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) > 0) && unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__cinit__", 0))) return -1;
  __pyx_r = __pyx_pf_17shift_calculators_30Fast_dihedral_force_calculator___cinit__(((struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2005")'> 2005: </pre>
<pre id='line2005' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2006")'> 2006: </pre>
<pre id='line2006' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2007")'> 2007:     def __cinit__(self):</pre>
<pre id='line2007' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2007
 * 
 * 
 *     def __cinit__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components = NULL
 *         self._num_components = 0
 */

static int __pyx_pf_17shift_calculators_30Fast_dihedral_force_calculator___cinit__(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2008")'> 2008:         self._compiled_components = NULL</pre>
<pre id='line2008' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2008
 * 
 *     def __cinit__(self):
 *         self._compiled_components = NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components = 0
 * 
 */
  __pyx_v_self->_compiled_components = NULL;
</pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line2009")'> 2009:         self._num_components = 0</pre>
<pre id='line2009' class='code' style='background-color: #FFFF4b'>
  /* "Cython_shift_calculator.pyx":2009
 *     def __cinit__(self):
 *         self._compiled_components = NULL
 *         self._num_components = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __init__(self,name="not set"):
 */
  __pyx_v_self->_num_components = 0;

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_30Fast_dihedral_force_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_30Fast_dihedral_force_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__name,0};
    PyObject* values[1] = {0};
    values[0] = ((PyObject *)__pyx_kp_s_24);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2011; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_name = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 0, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2011; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_dihedral_force_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_30Fast_dihedral_force_calculator_2__init__(((struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *)__pyx_v_self), __pyx_v_name);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2010")'> 2010: </pre>
<pre id='line2010' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2011")'> 2011:     def __init__(self,name="not set"):</pre>
<pre id='line2011' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2011
 *         self._num_components = 0
 * 
 *     def __init__(self,name="not set"):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         Base_force_calculator.__init__(self,name=name)
 *         self.raw_data =  None
 */

static int __pyx_pf_17shift_calculators_30Fast_dihedral_force_calculator_2__init__(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *__pyx_v_self, PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line2012")'> 2012:         Base_force_calculator.__init__(self,name=name)</pre>
<pre id='line2012' class='code' style='background-color: #FFFF3e'>
  /* "Cython_shift_calculator.pyx":2012
 * 
 *     def __init__(self,name="not set"):
 *         Base_force_calculator.__init__(self,name=name)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.raw_data =  None
 * 
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Base_force_calculator)), __pyx_n_s____init__);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2012; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2012; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_self));
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2012; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, ((PyObject *)__pyx_n_s__name), __pyx_v_name) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2012; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), ((PyObject *)__pyx_t_3));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2012; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF86' onclick='toggleDiv("line2013")'> 2013:         self.raw_data =  None</pre>
<pre id='line2013' class='code' style='background-color: #FFFF86'>
  /* "Cython_shift_calculator.pyx":2013
 *     def __init__(self,name="not set"):
 *         Base_force_calculator.__init__(self,name=name)
 *         self.raw_data =  None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->raw_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->raw_data);
  __pyx_v_self->raw_data = Py_None;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_dihedral_force_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2014")'> 2014: </pre>
<pre id='line2014' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2015")'> 2015: </pre>
<pre id='line2015' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2016")'> 2016: </pre>
<pre id='line2016' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2017")'> 2017: #     TODO: remove this is no longer needed</pre>
<pre id='line2017' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2018")'> 2018:     @cython.profile(False)</pre>
<pre id='line2018' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2019")'> 2019:     cdef inline dihedral_ids _get_dihedral_atom_ids(self, int index):</pre>
<pre id='line2019' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2019
 * #     TODO: remove this is no longer needed
 *     @cython.profile(False)
 *     cdef inline dihedral_ids _get_dihedral_atom_ids(self, int index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef dihedral_ids result
 * 
 */

static CYTHON_INLINE struct __pyx_t_17shift_calculators_dihedral_ids __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__get_dihedral_atom_ids(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *__pyx_v_self, int __pyx_v_index) {
  struct __pyx_t_17shift_calculators_dihedral_ids __pyx_v_result;
  struct __pyx_t_17shift_calculators_dihedral_ids __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_get_dihedral_atom_ids", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2020")'> 2020:         cdef dihedral_ids result</pre>
<pre id='line2020' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2021")'> 2021: </pre>
<pre id='line2021' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2022")'> 2022:         result.atom_id_1 = self._compiled_components[index].dihedral_atoms[0]</pre>
<pre id='line2022' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2022
 *         cdef dihedral_ids result
 * 
 *         result.atom_id_1 = self._compiled_components[index].dihedral_atoms[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.atom_id_2 = self._compiled_components[index].dihedral_atoms[1]
 *         result.atom_id_3 = self._compiled_components[index].dihedral_atoms[2]
 */
  __pyx_v_result.atom_id_1 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).dihedral_atoms[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2023")'> 2023:         result.atom_id_2 = self._compiled_components[index].dihedral_atoms[1]</pre>
<pre id='line2023' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2023
 * 
 *         result.atom_id_1 = self._compiled_components[index].dihedral_atoms[0]
 *         result.atom_id_2 = self._compiled_components[index].dihedral_atoms[1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.atom_id_3 = self._compiled_components[index].dihedral_atoms[2]
 *         result.atom_id_4 = self._compiled_components[index].dihedral_atoms[3]
 */
  __pyx_v_result.atom_id_2 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).dihedral_atoms[1]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2024")'> 2024:         result.atom_id_3 = self._compiled_components[index].dihedral_atoms[2]</pre>
<pre id='line2024' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2024
 *         result.atom_id_1 = self._compiled_components[index].dihedral_atoms[0]
 *         result.atom_id_2 = self._compiled_components[index].dihedral_atoms[1]
 *         result.atom_id_3 = self._compiled_components[index].dihedral_atoms[2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.atom_id_4 = self._compiled_components[index].dihedral_atoms[3]
 * 
 */
  __pyx_v_result.atom_id_3 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).dihedral_atoms[2]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2025")'> 2025:         result.atom_id_4 = self._compiled_components[index].dihedral_atoms[3]</pre>
<pre id='line2025' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2025
 *         result.atom_id_2 = self._compiled_components[index].dihedral_atoms[1]
 *         result.atom_id_3 = self._compiled_components[index].dihedral_atoms[2]
 *         result.atom_id_4 = self._compiled_components[index].dihedral_atoms[3]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         return result
 */
  __pyx_v_result.atom_id_4 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).dihedral_atoms[3]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2026")'> 2026: </pre>
<pre id='line2026' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line2027")'> 2027:         return result</pre>
<pre id='line2027' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":2027
 *         result.atom_id_4 = self._compiled_components[index].dihedral_atoms[3]
 * 
 *         return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     #TODO: remove this an correct order of parameters!
 */
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;

  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2028")'> 2028: </pre>
<pre id='line2028' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2029")'> 2029:     #TODO: remove this an correct order of parameters!</pre>
<pre id='line2029' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2030")'> 2030:     @cython.profile(False)</pre>
<pre id='line2030' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2031")'> 2031:     cdef inline dihedral_parameters _get_parameters(self, int index):</pre>
<pre id='line2031' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2031
 *     #TODO: remove this an correct order of parameters!
 *     @cython.profile(False)
 *     cdef inline dihedral_parameters _get_parameters(self, int index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef dihedral_parameters result
 */

static CYTHON_INLINE struct __pyx_t_17shift_calculators_dihedral_parameters __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__get_parameters(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *__pyx_v_self, int __pyx_v_index) {
  struct __pyx_t_17shift_calculators_dihedral_parameters __pyx_v_result;
  struct __pyx_t_17shift_calculators_dihedral_parameters __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_get_parameters", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2032")'> 2032: </pre>
<pre id='line2032' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2033")'> 2033:         cdef dihedral_parameters result</pre>
<pre id='line2033' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2034")'> 2034: </pre>
<pre id='line2034' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2035")'> 2035:         result.param_0 = self._compiled_components[index].parameters[0]</pre>
<pre id='line2035' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2035
 *         cdef dihedral_parameters result
 * 
 *         result.param_0 = self._compiled_components[index].parameters[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.param_1 = self._compiled_components[index].parameters[3]
 *         result.param_2 = self._compiled_components[index].parameters[1]
 */
  __pyx_v_result.param_0 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).parameters[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2036")'> 2036:         result.param_1 = self._compiled_components[index].parameters[3]</pre>
<pre id='line2036' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2036
 * 
 *         result.param_0 = self._compiled_components[index].parameters[0]
 *         result.param_1 = self._compiled_components[index].parameters[3]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.param_2 = self._compiled_components[index].parameters[1]
 *         result.param_3 = self._compiled_components[index].parameters[4]
 */
  __pyx_v_result.param_1 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).parameters[3]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2037")'> 2037:         result.param_2 = self._compiled_components[index].parameters[1]</pre>
<pre id='line2037' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2037
 *         result.param_0 = self._compiled_components[index].parameters[0]
 *         result.param_1 = self._compiled_components[index].parameters[3]
 *         result.param_2 = self._compiled_components[index].parameters[1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.param_3 = self._compiled_components[index].parameters[4]
 *         result.param_4 = self._compiled_components[index].parameters[2]
 */
  __pyx_v_result.param_2 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).parameters[1]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2038")'> 2038:         result.param_3 = self._compiled_components[index].parameters[4]</pre>
<pre id='line2038' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2038
 *         result.param_1 = self._compiled_components[index].parameters[3]
 *         result.param_2 = self._compiled_components[index].parameters[1]
 *         result.param_3 = self._compiled_components[index].parameters[4]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.param_4 = self._compiled_components[index].parameters[2]
 * 
 */
  __pyx_v_result.param_3 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).parameters[4]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2039")'> 2039:         result.param_4 = self._compiled_components[index].parameters[2]</pre>
<pre id='line2039' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2039
 *         result.param_2 = self._compiled_components[index].parameters[1]
 *         result.param_3 = self._compiled_components[index].parameters[4]
 *         result.param_4 = self._compiled_components[index].parameters[2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_result.param_4 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).parameters[2]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2040")'> 2040: </pre>
<pre id='line2040' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2041")'> 2041: </pre>
<pre id='line2041' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2042")'> 2042: </pre>
<pre id='line2042' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2043")'> 2043: </pre>
<pre id='line2043' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line2044")'> 2044:         return result</pre>
<pre id='line2044' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":2044
 * 
 * 
 *         return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     @cython.profile(False)
 */
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;

  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2045")'> 2045: </pre>
<pre id='line2045' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2046")'> 2046:     @cython.profile(False)</pre>
<pre id='line2046' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2047")'> 2047:     cdef inline float _get_coefficient(self, int index):</pre>
<pre id='line2047' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2047
 * 
 *     @cython.profile(False)
 *     cdef inline float _get_coefficient(self, int index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._compiled_components[index].coefficient
 * 
 */

static CYTHON_INLINE float __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__get_coefficient(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *__pyx_v_self, int __pyx_v_index) {
  float __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_get_coefficient", 0);
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line2048")'> 2048:         return self._compiled_components[index].coefficient</pre>
<pre id='line2048' class='code' style='background-color: #FFFF66'>
  /* "Cython_shift_calculator.pyx":2048
 *     @cython.profile(False)
 *     cdef inline float _get_coefficient(self, int index):
 *         return self._compiled_components[index].coefficient             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #    TODO make this consistent with the distance forces factor
 */
  __pyx_r = (__pyx_v_self->_compiled_components[__pyx_v_index]).coefficient;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_30Fast_dihedral_force_calculator_5_calc_single_force_factor(PyObject *__pyx_v_self, PyObject *__pyx_arg_index); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_30Fast_dihedral_force_calculator_5_calc_single_force_factor(PyObject *__pyx_v_self, PyObject *__pyx_arg_index) {
  int __pyx_v_index;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calc_single_force_factor (wrapper)", 0);
  assert(__pyx_arg_index); {
    __pyx_v_index = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_arg_index);<span class='error_goto'> if (unlikely((__pyx_v_index == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2051; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_dihedral_force_calculator._calc_single_force_factor", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_30Fast_dihedral_force_calculator_4_calc_single_force_factor(((struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *)__pyx_v_self), ((int)__pyx_v_index));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2049")'> 2049: </pre>
<pre id='line2049' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2050")'> 2050: #    TODO make this consistent with the distance forces factor</pre>
<pre id='line2050' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2051")'> 2051:     def _calc_single_force_factor(self, int index):</pre>
<pre id='line2051' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2051
 * 
 * #    TODO make this consistent with the distance forces factor
 *     def _calc_single_force_factor(self, int index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._cython_calc_single_force_factor(index)
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_30Fast_dihedral_force_calculator_4_calc_single_force_factor(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *__pyx_v_self, int __pyx_v_index) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calc_single_force_factor", 0);
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line2052")'> 2052:         return self._cython_calc_single_force_factor(index)</pre>
<pre id='line2052' class='code' style='background-color: #FFFF79'>
  /* "Cython_shift_calculator.pyx":2052
 * #    TODO make this consistent with the distance forces factor
 *     def _calc_single_force_factor(self, int index):
 *         return self._cython_calc_single_force_factor(index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void _do_calc_components(self, int[:] component_to_result, CDSVector[float] force_factors, Out_array force) nogil:
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__cython_calc_single_force_factor(__pyx_v_self, __pyx_v_index));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2052; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_dihedral_force_calculator._calc_single_force_factor", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2053")'> 2053: </pre>
<pre id='line2053' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2054")'> 2054:     cdef void _do_calc_components(self, int[:] component_to_result, CDSVector[float] force_factors, Out_array force) nogil:</pre>
<pre id='line2054' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2054
 *         return self._cython_calc_single_force_factor(index)
 * 
 *     cdef void _do_calc_components(self, int[:] component_to_result, CDSVector[float] force_factors, Out_array force) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int factor_index
 *         cdef int component_index
 */

static void __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__do_calc_components(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *__pyx_v_self, __Pyx_memviewslice __pyx_v_component_to_result, CDSVector<code><</code>float> __pyx_v_force_factors, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_force) {
  int __pyx_v_factor_index;
  int __pyx_v_component_index;
  #ifdef WITH_THREAD
  PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
  #endif
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_do_calc_components", 0);
  #ifdef WITH_THREAD
  PyGILState_Release(__pyx_gilstate_save);
  #endif
  /*try:*/ {
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line2055")'> 2055:         cdef int factor_index</pre>
<pre id='line2055' class='code' style='background-color: #FFFFc4'>
  /* "Cython_shift_calculator.pyx":2055
 * 
 *     cdef void _do_calc_components(self, int[:] component_to_result, CDSVector[float] force_factors, Out_array force) nogil:
 *         cdef int factor_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int component_index
 * 
 */
  /*finally:*/ {
    int __pyx_why;
    __pyx_why = 0; goto __pyx_L5;
    __pyx_L4: __pyx_why = 4; goto __pyx_L5;
    __pyx_L5:;
    #ifdef WITH_THREAD
    __pyx_gilstate_save = PyGILState_Ensure();
    #endif
    switch (__pyx_why) {
      case 4: goto __pyx_L1_error;
    }
  }

  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Fast_dihedral_force_calculator._do_calc_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  #ifdef WITH_THREAD
  PyGILState_Release(__pyx_gilstate_save);
  #endif
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2056")'> 2056:         cdef int component_index</pre>
<pre id='line2056' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2057")'> 2057: </pre>
<pre id='line2057' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2058")'> 2058:         with gil:</pre>
<pre id='line2058' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2058
 *         cdef int component_index
 * 
 *         with gil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for factor_index in range(len(self._active_components)):
 *                 component_index = self._active_components[factor_index]
 */
    {
        #ifdef WITH_THREAD
        PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
        #endif
        /*try:*/ {

        /* "Cython_shift_calculator.pyx":2058
 *         cdef int component_index
 * 
 *         with gil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for factor_index in range(len(self._active_components)):
 *                 component_index = self._active_components[factor_index]
 */
        /*finally:*/ {
          int __pyx_why;
          __pyx_why = 0; goto __pyx_L8;
          __pyx_L7: __pyx_why = 4; goto __pyx_L8;
          __pyx_L8:;
          #ifdef WITH_THREAD
          PyGILState_Release(__pyx_gilstate_save);
          #endif
          switch (__pyx_why) {
            case 4: goto __pyx_L4;
          }
        }
    }
  }
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line2059")'> 2059:             for factor_index in range(len(self._active_components)):</pre>
<pre id='line2059' class='code' style='background-color: #FFFF79'>
          /* "Cython_shift_calculator.pyx":2059
 * 
 *         with gil:
 *             for factor_index in range(len(self._active_components)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 component_index = self._active_components[factor_index]
 *                 self._dihedral_calc_single_force_set(component_index,force_factors[component_to_result[factor_index]],force)
 */
          if (unlikely(!__pyx_v_self->__pyx_base._active_components.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2059; __pyx_clineno = __LINE__; goto __pyx_L7;}}
          __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->__pyx_base._active_components, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2059; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          __pyx_t_2 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2059; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          for (__pyx_t_3 = 0; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
            __pyx_v_factor_index = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line2060")'> 2060:                 component_index = self._active_components[factor_index]</pre>
<pre id='line2060' class='code' style='background-color: #FFFFaa'>
            /* "Cython_shift_calculator.pyx":2060
 *         with gil:
 *             for factor_index in range(len(self._active_components)):
 *                 component_index = self._active_components[factor_index]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._dihedral_calc_single_force_set(component_index,force_factors[component_to_result[factor_index]],force)
 * 
 */
            if (unlikely(!__pyx_v_self->__pyx_base._active_components.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2060; __pyx_clineno = __LINE__; goto __pyx_L7;}}
            __pyx_t_4 = __pyx_v_factor_index;
            __pyx_v_component_index = (*((int *) ( /* dim=0 */ (__pyx_v_self->__pyx_base._active_components.data + __pyx_t_4 * __pyx_v_self->__pyx_base._active_components.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2061")'> 2061:                 self._dihedral_calc_single_force_set(component_index,force_factors[component_to_result[factor_index]],force)</pre>
<pre id='line2061' class='code' style='background-color: #FFFFff'>
            /* "Cython_shift_calculator.pyx":2061
 *             for factor_index in range(len(self._active_components)):
 *                 component_index = self._active_components[factor_index]
 *                 self._dihedral_calc_single_force_set(component_index,force_factors[component_to_result[factor_index]],force)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
            __pyx_t_5 = __pyx_v_factor_index;
            __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__dihedral_calc_single_force_set(__pyx_v_self, __pyx_v_component_index, (__pyx_v_force_factors[(*((int *) ( /* dim=0 */ (__pyx_v_component_to_result.data + __pyx_t_5 * __pyx_v_component_to_result.strides[0]) )))]), __pyx_v_force);
          }
        }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2062")'> 2062: </pre>
<pre id='line2062' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2063")'> 2063: </pre>
<pre id='line2063' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2064")'> 2064: </pre>
<pre id='line2064' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2065")'> 2065:     cdef inline float _cython_calc_single_force_factor(self, int index):</pre>
<pre id='line2065' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2065
 * 
 * 
 *     cdef inline float _cython_calc_single_force_factor(self, int index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef dihedral_ids dihedral_atom_ids
 */

static CYTHON_INLINE float __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__cython_calc_single_force_factor(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *__pyx_v_self, int __pyx_v_index) {
  struct __pyx_t_17shift_calculators_dihedral_ids __pyx_v_dihedral_atom_ids;
  struct __pyx_t_17shift_calculators_dihedral_parameters __pyx_v_params;
  float __pyx_v_angle;
  float __pyx_v_result;
  float __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_cython_calc_single_force_factor", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2066")'> 2066: </pre>
<pre id='line2066' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2067")'> 2067:         cdef dihedral_ids dihedral_atom_ids</pre>
<pre id='line2067' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2068")'> 2068:         cdef dihedral_parameters params</pre>
<pre id='line2068' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2069")'> 2069: </pre>
<pre id='line2069' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2070")'> 2070:         cdef float angle,result</pre>
<pre id='line2070' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2071")'> 2071: </pre>
<pre id='line2071' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2072")'> 2072: </pre>
<pre id='line2072' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2073")'> 2073:         dihedral_atom_ids  = dihedral_atom_ids= self._get_dihedral_atom_ids(index)</pre>
<pre id='line2073' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2073
 * 
 * 
 *         dihedral_atom_ids  = dihedral_atom_ids= self._get_dihedral_atom_ids(index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         params = self._get_parameters(index)
 */
  __pyx_t_1 = __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__get_dihedral_atom_ids(__pyx_v_self, __pyx_v_index);
  __pyx_v_dihedral_atom_ids = __pyx_t_1;
  __pyx_v_dihedral_atom_ids = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2074")'> 2074: </pre>
<pre id='line2074' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2075")'> 2075:         params = self._get_parameters(index)</pre>
<pre id='line2075' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2075
 *         dihedral_atom_ids  = dihedral_atom_ids= self._get_dihedral_atom_ids(index)
 * 
 *         params = self._get_parameters(index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         angle = calc_dihedral_angle_simulation(self._simulation, dihedral_atom_ids)
 */
  __pyx_v_params = __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__get_parameters(__pyx_v_self, __pyx_v_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2076")'> 2076: </pre>
<pre id='line2076' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2077")'> 2077:         angle = calc_dihedral_angle_simulation(self._simulation, dihedral_atom_ids)</pre>
<pre id='line2077' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2077
 *         params = self._get_parameters(index)
 * 
 *         angle = calc_dihedral_angle_simulation(self._simulation, dihedral_atom_ids)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         result = -3.0 * params.param_0 * sin(3.0 * angle + params.param_1) - \
 */
  __pyx_v_angle = __pyx_f_17shift_calculators_calc_dihedral_angle_simulation(__pyx_v_self->__pyx_base._simulation, __pyx_v_dihedral_atom_ids);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2078")'> 2078: </pre>
<pre id='line2078' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2079")'> 2079:         result = -3.0 * params.param_0 * sin(3.0 * angle + params.param_1) - \</pre>
<pre id='line2079' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2080")'> 2080:                         params.param_2 * sin(angle + params.param_3)</pre>
<pre id='line2080' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2080
 * 
 *         result = -3.0 * params.param_0 * sin(3.0 * angle + params.param_1) - \
 *                         params.param_2 * sin(angle + params.param_3)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return result
 * 
 */
  __pyx_v_result = (((-3.0 * __pyx_v_params.param_0) * sin(((3.0 * __pyx_v_angle) + __pyx_v_params.param_1))) - (__pyx_v_params.param_2 * sin((__pyx_v_angle + __pyx_v_params.param_3))));
</pre><pre class='line' style='background-color: #FFFF22' onclick='toggleDiv("line2081")'> 2081:         return result</pre>
<pre id='line2081' class='code' style='background-color: #FFFF22'>
  /* "Cython_shift_calculator.pyx":2081
 *         result = -3.0 * params.param_0 * sin(3.0 * angle + params.param_1) - \
 *                         params.param_2 * sin(angle + params.param_3)
 *         return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_30Fast_dihedral_force_calculator_7_calc_single_force_set(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_30Fast_dihedral_force_calculator_7_calc_single_force_set(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_index;
  float __pyx_v_factor;
  struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calc_single_force_set (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__index,&__pyx_n_s__factor,&__pyx_n_s__forces,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__index)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__factor)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calc_single_force_set", 1, 3, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2085; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__forces)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calc_single_force_set", 1, 3, 3, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2085; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_calc_single_force_set") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2085; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_index = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_index == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2085; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_factor = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_factor == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2085; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_forces = ((struct __pyx_obj_17shift_calculators_Out_array *)values[2]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calc_single_force_set", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2085; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_dihedral_force_calculator._calc_single_force_set", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_forces), __pyx_ptype_17shift_calculators_Out_array, 1, "forces", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2085; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_30Fast_dihedral_force_calculator_6_calc_single_force_set(((struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *)__pyx_v_self), __pyx_v_index, __pyx_v_factor, __pyx_v_forces);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2082")'> 2082: </pre>
<pre id='line2082' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2083")'> 2083: </pre>
<pre id='line2083' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2084")'> 2084: </pre>
<pre id='line2084' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2085")'> 2085:     def _calc_single_force_set(self, int index, float factor, Out_array forces):</pre>
<pre id='line2085' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2085
 * 
 * 
 *     def _calc_single_force_set(self, int index, float factor, Out_array forces):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         #TODO tidy this up a hack for the test suite
 *         cdef Dihedral_component* saved_component_list = self._compiled_components
 */

static PyObject *__pyx_pf_17shift_calculators_30Fast_dihedral_force_calculator_6_calc_single_force_set(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *__pyx_v_self, int __pyx_v_index, float __pyx_v_factor, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces) {
  struct __pyx_t_17shift_calculators_Dihedral_component *__pyx_v_saved_component_list;
  int __pyx_v_saved_num_components;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calc_single_force_set", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2086")'> 2086:         #TODO tidy this up a hack for the test suite</pre>
<pre id='line2086' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2087")'> 2087:         cdef Dihedral_component* saved_component_list = self._compiled_components</pre>
<pre id='line2087' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2087
 *     def _calc_single_force_set(self, int index, float factor, Out_array forces):
 *         #TODO tidy this up a hack for the test suite
 *         cdef Dihedral_component* saved_component_list = self._compiled_components             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int saved_num_components = self._num_components
 * 
 */
  __pyx_t_1 = __pyx_v_self->_compiled_components;
  __pyx_v_saved_component_list = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2088")'> 2088:         cdef int saved_num_components = self._num_components</pre>
<pre id='line2088' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2088
 *         #TODO tidy this up a hack for the test suite
 *         cdef Dihedral_component* saved_component_list = self._compiled_components
 *         cdef int saved_num_components = self._num_components             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._num_components  = 1
 */
  __pyx_t_2 = __pyx_v_self->_num_components;
  __pyx_v_saved_num_components = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2089")'> 2089: </pre>
<pre id='line2089' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2090")'> 2090:         self._num_components  = 1</pre>
<pre id='line2090' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2090
 *         cdef int saved_num_components = self._num_components
 * 
 *         self._num_components  = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components = &saved_component_list[index]
 * 
 */
  __pyx_v_self->_num_components = 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2091")'> 2091:         self._compiled_components = &amp;saved_component_list[index]</pre>
<pre id='line2091' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2091
 * 
 *         self._num_components  = 1
 *         self._compiled_components = &saved_component_list[index]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._dihedral_calc_single_force_set(0,factor,forces)
 */
  __pyx_v_self->_compiled_components = (&(__pyx_v_saved_component_list[__pyx_v_index]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2092")'> 2092: </pre>
<pre id='line2092' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2093")'> 2093:         self._dihedral_calc_single_force_set(0,factor,forces)</pre>
<pre id='line2093' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2093
 *         self._compiled_components = &saved_component_list[index]
 * 
 *         self._dihedral_calc_single_force_set(0,factor,forces)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._compiled_components = saved_component_list
 */
  __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__dihedral_calc_single_force_set(__pyx_v_self, 0, __pyx_v_factor, __pyx_v_forces);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2094")'> 2094: </pre>
<pre id='line2094' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2095")'> 2095:         self._compiled_components = saved_component_list</pre>
<pre id='line2095' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2095
 *         self._dihedral_calc_single_force_set(0,factor,forces)
 * 
 *         self._compiled_components = saved_component_list             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components = saved_num_components
 * 
 */
  __pyx_v_self->_compiled_components = __pyx_v_saved_component_list;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2096")'> 2096:         self._num_components = saved_num_components</pre>
<pre id='line2096' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":2096
 * 
 *         self._compiled_components = saved_component_list
 *         self._num_components = saved_num_components             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_self->_num_components = __pyx_v_saved_num_components;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2097")'> 2097: </pre>
<pre id='line2097' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2098")'> 2098: </pre>
<pre id='line2098' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2099")'> 2099:     cdef inline void _dihedral_calc_single_force_set(self, int index, float factor, Out_array forces):</pre>
<pre id='line2099' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2099
 * 
 * 
 *     cdef inline void _dihedral_calc_single_force_set(self, int index, float factor, Out_array forces):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3 r1, r2, r4, temp
 *         cdef Vec3 n1, n2
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__dihedral_calc_single_force_set(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *__pyx_v_self, int __pyx_v_index, float __pyx_v_factor, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces) {
  Vec3 __pyx_v_r1;
  Vec3 __pyx_v_r2;
  Vec3 __pyx_v_r4;
  Vec3 __pyx_v_n1;
  Vec3 __pyx_v_n2;
  float __pyx_v_weight;
  float __pyx_v_factor_1;
  float __pyx_v_factor_2;
  float __pyx_v_factor_3;
  Vec3 __pyx_v_F2;
  Vec3 __pyx_v_F3;
  float __pyx_v_dihedral_factor;
  struct __pyx_t_17shift_calculators_dihedral_ids __pyx_v_atom_ids;
  float __pyx_v_r2_length;
  float __pyx_v_r2_length_2;
  Vec3 __pyx_v_v1;
  Vec3 __pyx_v_v2;
  Vec3 __pyx_v_v3;
  Vec3 __pyx_v_v4;
  Vec3 __pyx_v_r3;
  Vec3 __pyx_v_F1;
  Vec3 __pyx_v_F4;
  Vec3 __pyx_v_T1;
  Vec3 __pyx_v_T2;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_dihedral_calc_single_force_set", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2100")'> 2100:         cdef Vec3 r1, r2, r4, temp</pre>
<pre id='line2100' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2101")'> 2101:         cdef Vec3 n1, n2</pre>
<pre id='line2101' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2102")'> 2102:         cdef float weight</pre>
<pre id='line2102' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2103")'> 2103:         cdef float factor_1, factor_2, factor_3</pre>
<pre id='line2103' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2104")'> 2104:         cdef Vec3 F2, F3,</pre>
<pre id='line2104' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2105")'> 2105:         cdef Vec3 T3, T4</pre>
<pre id='line2105' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2106")'> 2106: </pre>
<pre id='line2106' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2107")'> 2107:         cdef float dihedral_factor = self._cython_calc_single_force_factor(index)</pre>
<pre id='line2107' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2107
 *         cdef Vec3 T3, T4
 * 
 *         cdef float dihedral_factor = self._cython_calc_single_force_factor(index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef dihedral_ids atom_ids = self._get_dihedral_atom_ids(index)
 * 
 */
  __pyx_v_dihedral_factor = __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__cython_calc_single_force_factor(__pyx_v_self, __pyx_v_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2108")'> 2108:         cdef dihedral_ids atom_ids = self._get_dihedral_atom_ids(index)</pre>
<pre id='line2108' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2108
 * 
 *         cdef float dihedral_factor = self._cython_calc_single_force_factor(index)
 *         cdef dihedral_ids atom_ids = self._get_dihedral_atom_ids(index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef float r2_length, r2_length_2
 */
  __pyx_v_atom_ids = __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__get_dihedral_atom_ids(__pyx_v_self, __pyx_v_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2109")'> 2109: </pre>
<pre id='line2109' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2110")'> 2110:         cdef float r2_length, r2_length_2</pre>
<pre id='line2110' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2111")'> 2111: </pre>
<pre id='line2111' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2112")'> 2112:         v1 = self._simulation[0].atomPos(atom_ids.atom_id_1)</pre>
<pre id='line2112' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2112
 *         cdef float r2_length, r2_length_2
 * 
 *         v1 = self._simulation[0].atomPos(atom_ids.atom_id_1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         v2 = self._simulation[0].atomPos(atom_ids.atom_id_2)
 *         v3 = self._simulation[0].atomPos(atom_ids.atom_id_3)
 */
  __pyx_v_v1 = (__pyx_v_self->__pyx_base._simulation[0]).atomPos(__pyx_v_atom_ids.atom_id_1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2113")'> 2113:         v2 = self._simulation[0].atomPos(atom_ids.atom_id_2)</pre>
<pre id='line2113' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2113
 * 
 *         v1 = self._simulation[0].atomPos(atom_ids.atom_id_1)
 *         v2 = self._simulation[0].atomPos(atom_ids.atom_id_2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         v3 = self._simulation[0].atomPos(atom_ids.atom_id_3)
 *         v4 = self._simulation[0].atomPos(atom_ids.atom_id_4)
 */
  __pyx_v_v2 = (__pyx_v_self->__pyx_base._simulation[0]).atomPos(__pyx_v_atom_ids.atom_id_2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2114")'> 2114:         v3 = self._simulation[0].atomPos(atom_ids.atom_id_3)</pre>
<pre id='line2114' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2114
 *         v1 = self._simulation[0].atomPos(atom_ids.atom_id_1)
 *         v2 = self._simulation[0].atomPos(atom_ids.atom_id_2)
 *         v3 = self._simulation[0].atomPos(atom_ids.atom_id_3)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         v4 = self._simulation[0].atomPos(atom_ids.atom_id_4)
 * 
 */
  __pyx_v_v3 = (__pyx_v_self->__pyx_base._simulation[0]).atomPos(__pyx_v_atom_ids.atom_id_3);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2115")'> 2115:         v4 = self._simulation[0].atomPos(atom_ids.atom_id_4)</pre>
<pre id='line2115' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2115
 *         v2 = self._simulation[0].atomPos(atom_ids.atom_id_2)
 *         v3 = self._simulation[0].atomPos(atom_ids.atom_id_3)
 *         v4 = self._simulation[0].atomPos(atom_ids.atom_id_4)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         r1 = v1 - v2
 */
  __pyx_v_v4 = (__pyx_v_self->__pyx_base._simulation[0]).atomPos(__pyx_v_atom_ids.atom_id_4);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2116")'> 2116: </pre>
<pre id='line2116' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2117")'> 2117:         r1 = v1 - v2</pre>
<pre id='line2117' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2117
 *         v4 = self._simulation[0].atomPos(atom_ids.atom_id_4)
 * 
 *         r1 = v1 - v2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         r2 = v3 - v2
 * 
 */
  __pyx_v_r1 = (__pyx_v_v1 - __pyx_v_v2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2118")'> 2118:         r2 = v3 - v2</pre>
<pre id='line2118' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2118
 * 
 *         r1 = v1 - v2
 *         r2 = v3 - v2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Vec3 r3 = r2
 */
  __pyx_v_r2 = (__pyx_v_v3 - __pyx_v_v2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2119")'> 2119: </pre>
<pre id='line2119' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2120")'> 2120:         cdef Vec3 r3 = r2</pre>
<pre id='line2120' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2120
 *         r2 = v3 - v2
 * 
 *         cdef Vec3 r3 = r2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(r3, -1)
 * 
 */
  __pyx_v_r3 = __pyx_v_r2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2121")'> 2121:         operator_times(r3, -1)</pre>
<pre id='line2121' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2121
 * 
 *         cdef Vec3 r3 = r2
 *         operator_times(r3, -1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         r4 = v4 - v3
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_r3, -1.0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2122")'> 2122: </pre>
<pre id='line2122' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2123")'> 2123:         r4 = v4 - v3</pre>
<pre id='line2123' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2123
 *         operator_times(r3, -1)
 * 
 *         r4 = v4 - v3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #        print vec3_as_tuple(r1), vec3_as_tuple(r2), vec3_as_tuple(r3), vec3_as_tuple(r4)
 */
  __pyx_v_r4 = (__pyx_v_v4 - __pyx_v_v3);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2124")'> 2124: </pre>
<pre id='line2124' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2125")'> 2125: #        print vec3_as_tuple(r1), vec3_as_tuple(r2), vec3_as_tuple(r3), vec3_as_tuple(r4)</pre>
<pre id='line2125' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2126")'> 2126: </pre>
<pre id='line2126' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2127")'> 2127:         # compute normal vector to plane containing v1, v2, and v3</pre>
<pre id='line2127' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2128")'> 2128:         n1 = cross(r1, r2)</pre>
<pre id='line2128' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2128
 * 
 *         # compute normal vector to plane containing v1, v2, and v3
 *         n1 = cross(r1, r2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         # compute normal vector to plane containing v2, v3, and v4
 *         n2 = cross(r3, r4)
 */
  __pyx_v_n1 = cross(__pyx_v_r1, __pyx_v_r2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2129")'> 2129:         # compute normal vector to plane containing v2, v3, and v4</pre>
<pre id='line2129' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2130")'> 2130:         n2 = cross(r3, r4)</pre>
<pre id='line2130' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2130
 *         n1 = cross(r1, r2)
 *         # compute normal vector to plane containing v2, v3, and v4
 *         n2 = cross(r3, r4)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         r2_length = calc_distance_simulation(self._simulation, atom_ids.atom_id_2,atom_ids.atom_id_3)
 */
  __pyx_v_n2 = cross(__pyx_v_r3, __pyx_v_r4);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2131")'> 2131: </pre>
<pre id='line2131' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2132")'> 2132:         r2_length = calc_distance_simulation(self._simulation, atom_ids.atom_id_2,atom_ids.atom_id_3)</pre>
<pre id='line2132' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2132
 *         n2 = cross(r3, r4)
 * 
 *         r2_length = calc_distance_simulation(self._simulation, atom_ids.atom_id_2,atom_ids.atom_id_3)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         r2_length_2 = r2_length*r2_length
 * 
 */
  __pyx_v_r2_length = __pyx_f_17shift_calculators_calc_distance_simulation(__pyx_v_self->__pyx_base._simulation, __pyx_v_atom_ids.atom_id_2, __pyx_v_atom_ids.atom_id_3);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2133")'> 2133:         r2_length_2 = r2_length*r2_length</pre>
<pre id='line2133' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2133
 * 
 *         r2_length = calc_distance_simulation(self._simulation, atom_ids.atom_id_2,atom_ids.atom_id_3)
 *         r2_length_2 = r2_length*r2_length             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_r2_length_2 = (__pyx_v_r2_length * __pyx_v_r2_length);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2134")'> 2134: </pre>
<pre id='line2134' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2135")'> 2135: </pre>
<pre id='line2135' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2136")'> 2136:         weight = factor * self._get_coefficient(index)</pre>
<pre id='line2136' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2136
 * 
 * 
 *         weight = factor * self._get_coefficient(index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_weight = (__pyx_v_factor * __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__get_coefficient(__pyx_v_self, __pyx_v_index));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2137")'> 2137: </pre>
<pre id='line2137' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2138")'> 2138: </pre>
<pre id='line2138' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2139")'> 2139: </pre>
<pre id='line2139' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2140")'> 2140: #        // force calculation according to Bekker, Berendsen and van Gunsteren (1995),</pre>
<pre id='line2140' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2141")'> 2141: #        // Journal of Computational Chemistry 16, pp. 527-533:</pre>
<pre id='line2141' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2142")'> 2142: ##        // Force and virial of torsional-angle-dependent potentials.</pre>
<pre id='line2142' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2143")'> 2143:         factor_1 = dihedral_factor * r2_length</pre>
<pre id='line2143' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2143
 * #        // Journal of Computational Chemistry 16, pp. 527-533:
 * ##        // Force and virial of torsional-angle-dependent potentials.
 *         factor_1 = dihedral_factor * r2_length             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Vec3 F1 = n1
 */
  __pyx_v_factor_1 = (__pyx_v_dihedral_factor * __pyx_v_r2_length);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2144")'> 2144: </pre>
<pre id='line2144' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2145")'> 2145:         cdef Vec3 F1 = n1</pre>
<pre id='line2145' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2145
 *         factor_1 = dihedral_factor * r2_length
 * 
 *         cdef Vec3 F1 = n1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(F1, (-factor_1 / norm(n1)**2))
 * 
 */
  __pyx_v_F1 = __pyx_v_n1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2146")'> 2146:         operator_times(F1, (-factor_1 / norm(n1)**2))</pre>
<pre id='line2146' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2146
 * 
 *         cdef Vec3 F1 = n1
 *         operator_times(F1, (-factor_1 / norm(n1)**2))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Vec3 F4 = n2
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_F1, ((-__pyx_v_factor_1) / powf(norm(__pyx_v_n1), 2.0)));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2147")'> 2147: </pre>
<pre id='line2147' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2148")'> 2148:         cdef Vec3 F4 = n2</pre>
<pre id='line2148' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2148
 *         operator_times(F1, (-factor_1 / norm(n1)**2))
 * 
 *         cdef Vec3 F4 = n2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(F4, ( factor_1 / norm(n2)**2))
 * 
 */
  __pyx_v_F4 = __pyx_v_n2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2149")'> 2149:         operator_times(F4, ( factor_1 / norm(n2)**2))</pre>
<pre id='line2149' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2149
 * 
 *         cdef Vec3 F4 = n2
 *         operator_times(F4, ( factor_1 / norm(n2)**2))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         factor_2 = dot(r1, r2) / r2_length_2
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_F4, (__pyx_v_factor_1 / powf(norm(__pyx_v_n2), 2.0)));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2150")'> 2150: </pre>
<pre id='line2150' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2151")'> 2151:         factor_2 = dot(r1, r2) / r2_length_2</pre>
<pre id='line2151' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2151
 *         operator_times(F4, ( factor_1 / norm(n2)**2))
 * 
 *         factor_2 = dot(r1, r2) / r2_length_2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         factor_3 = dot(r3, r4) / r2_length_2
 * 
 */
  __pyx_v_factor_2 = (dot(__pyx_v_r1, __pyx_v_r2) / __pyx_v_r2_length_2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2152")'> 2152:         factor_3 = dot(r3, r4) / r2_length_2</pre>
<pre id='line2152' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2152
 * 
 *         factor_2 = dot(r1, r2) / r2_length_2
 *         factor_3 = dot(r3, r4) / r2_length_2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Vec3 T1 = F1
 */
  __pyx_v_factor_3 = (dot(__pyx_v_r3, __pyx_v_r4) / __pyx_v_r2_length_2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2153")'> 2153: </pre>
<pre id='line2153' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2154")'> 2154:         cdef Vec3 T1 = F1</pre>
<pre id='line2154' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2154
 *         factor_3 = dot(r3, r4) / r2_length_2
 * 
 *         cdef Vec3 T1 = F1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(T1,  (factor_2-1))
 * 
 */
  __pyx_v_T1 = __pyx_v_F1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2155")'> 2155:         operator_times(T1,  (factor_2-1))</pre>
<pre id='line2155' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2155
 * 
 *         cdef Vec3 T1 = F1
 *         operator_times(T1,  (factor_2-1))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Vec3 T2 = F4
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_T1, (__pyx_v_factor_2 - 1.0));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2156")'> 2156: </pre>
<pre id='line2156' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2157")'> 2157:         cdef Vec3 T2 = F4</pre>
<pre id='line2157' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2157
 *         operator_times(T1,  (factor_2-1))
 * 
 *         cdef Vec3 T2 = F4             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(T2,  -factor_3)
 * 
 */
  __pyx_v_T2 = __pyx_v_F4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2158")'> 2158:         operator_times(T2,  -factor_3)</pre>
<pre id='line2158' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2158
 * 
 *         cdef Vec3 T2 = F4
 *         operator_times(T2,  -factor_3)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         F2 = T1 + T2
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_T2, (-__pyx_v_factor_3));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2159")'> 2159: </pre>
<pre id='line2159' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2160")'> 2160:         F2 = T1 + T2</pre>
<pre id='line2160' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2160
 *         operator_times(T2,  -factor_3)
 * 
 *         F2 = T1 + T2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         T1 = F1
 */
  __pyx_v_F2 = (__pyx_v_T1 + __pyx_v_T2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2161")'> 2161: </pre>
<pre id='line2161' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2162")'> 2162:         T1 = F1</pre>
<pre id='line2162' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2162
 *         F2 = T1 + T2
 * 
 *         T1 = F1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(T1,  -factor_2)
 * 
 */
  __pyx_v_T1 = __pyx_v_F1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2163")'> 2163:         operator_times(T1,  -factor_2)</pre>
<pre id='line2163' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2163
 * 
 *         T1 = F1
 *         operator_times(T1,  -factor_2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         T2 = F4
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_T1, (-__pyx_v_factor_2));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2164")'> 2164: </pre>
<pre id='line2164' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2165")'> 2165:         T2 = F4</pre>
<pre id='line2165' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2165
 *         operator_times(T1,  -factor_2)
 * 
 *         T2 = F4             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(T2, (factor_3 -1))
 * 
 */
  __pyx_v_T2 = __pyx_v_F4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2166")'> 2166:         operator_times(T2, (factor_3 -1))</pre>
<pre id='line2166' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2166
 * 
 *         T2 = F4
 *         operator_times(T2, (factor_3 -1))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         F3 = T1 + T2
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_T2, (__pyx_v_factor_3 - 1.0));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2167")'> 2167: </pre>
<pre id='line2167' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2168")'> 2168:         F3 = T1 + T2</pre>
<pre id='line2168' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2168
 *         operator_times(T2, (factor_3 -1))
 * 
 *         F3 = T1 + T2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #        print vec3_as_tuple(F1), vec3_as_tuple(F2), vec3_as_tuple(F3), vec3_as_tuple(F4)
 */
  __pyx_v_F3 = (__pyx_v_T1 + __pyx_v_T2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2169")'> 2169: </pre>
<pre id='line2169' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2170")'> 2170: #        print vec3_as_tuple(F1), vec3_as_tuple(F2), vec3_as_tuple(F3), vec3_as_tuple(F4)</pre>
<pre id='line2170' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2171")'> 2171: #        // assign forces</pre>
<pre id='line2171' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2172")'> 2172: #        force_triplet_1 = self._get_or_make_target_force_triplet(forces, atom_ids.atom_id_1)</pre>
<pre id='line2172' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2173")'> 2173: #        force_triplet_2 = self._get_or_make_target_force_triplet(forces, atom_ids.atom_id_2)</pre>
<pre id='line2173' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2174")'> 2174: #        force_triplet_3 = self._get_or_make_target_force_triplet(forces, atom_ids.atom_id_3)</pre>
<pre id='line2174' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2175")'> 2175: #        force_triplet_4 = self._get_or_make_target_force_triplet(forces, atom_ids.atom_id_4)</pre>
<pre id='line2175' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2176")'> 2176: </pre>
<pre id='line2176' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2177")'> 2177:         operator_times(F1, weight)</pre>
<pre id='line2177' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2177
 * #        force_triplet_4 = self._get_or_make_target_force_triplet(forces, atom_ids.atom_id_4)
 * 
 *         operator_times(F1, weight)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(F2, weight)
 *         operator_times(F3, weight)
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_F1, __pyx_v_weight);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2178")'> 2178:         operator_times(F2, weight)</pre>
<pre id='line2178' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2178
 * 
 *         operator_times(F1, weight)
 *         operator_times(F2, weight)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(F3, weight)
 *         operator_times(F4, weight)
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_F2, __pyx_v_weight);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2179")'> 2179:         operator_times(F3, weight)</pre>
<pre id='line2179' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2179
 *         operator_times(F1, weight)
 *         operator_times(F2, weight)
 *         operator_times(F3, weight)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(F4, weight)
 * 
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_F3, __pyx_v_weight);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2180")'> 2180:         operator_times(F4, weight)</pre>
<pre id='line2180' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2180
 *         operator_times(F2, weight)
 *         operator_times(F3, weight)
 *         operator_times(F4, weight)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         forces.add(atom_ids.atom_id_1,F1)
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_F4, __pyx_v_weight);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2181")'> 2181: </pre>
<pre id='line2181' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2182")'> 2182:         forces.add(atom_ids.atom_id_1,F1)</pre>
<pre id='line2182' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2182
 *         operator_times(F4, weight)
 * 
 *         forces.add(atom_ids.atom_id_1,F1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         forces.add(atom_ids.atom_id_2,F2)
 *         forces.add(atom_ids.atom_id_3,F3)
 */
  __pyx_f_17shift_calculators_9Out_array_add(__pyx_v_forces, __pyx_v_atom_ids.atom_id_1, __pyx_v_F1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2183")'> 2183:         forces.add(atom_ids.atom_id_2,F2)</pre>
<pre id='line2183' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2183
 * 
 *         forces.add(atom_ids.atom_id_1,F1)
 *         forces.add(atom_ids.atom_id_2,F2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         forces.add(atom_ids.atom_id_3,F3)
 *         forces.add(atom_ids.atom_id_4,F4)
 */
  __pyx_f_17shift_calculators_9Out_array_add(__pyx_v_forces, __pyx_v_atom_ids.atom_id_2, __pyx_v_F2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2184")'> 2184:         forces.add(atom_ids.atom_id_3,F3)</pre>
<pre id='line2184' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2184
 *         forces.add(atom_ids.atom_id_1,F1)
 *         forces.add(atom_ids.atom_id_2,F2)
 *         forces.add(atom_ids.atom_id_3,F3)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         forces.add(atom_ids.atom_id_4,F4)
 * 
 */
  __pyx_f_17shift_calculators_9Out_array_add(__pyx_v_forces, __pyx_v_atom_ids.atom_id_3, __pyx_v_F3);
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line2185")'> 2185:         forces.add(atom_ids.atom_id_4,F4)</pre>
<pre id='line2185' class='code' style='background-color: #FFFF6e'>
  /* "Cython_shift_calculator.pyx":2185
 *         forces.add(atom_ids.atom_id_2,F2)
 *         forces.add(atom_ids.atom_id_3,F3)
 *         forces.add(atom_ids.atom_id_4,F4)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_f_17shift_calculators_9Out_array_add(__pyx_v_forces, __pyx_v_atom_ids.atom_id_4, __pyx_v_F4);

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_26Fast_ring_force_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_26Fast_ring_force_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) > 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) > 0) && unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__cinit__", 0))) return -1;
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_force_calculator___cinit__(((struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2186")'> 2186: </pre>
<pre id='line2186' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2187")'> 2187: </pre>
<pre id='line2187' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2188")'> 2188: cdef struct Ring_target_component:</pre>
<pre id='line2188' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2188
 * 
 * 
 * cdef struct Ring_target_component:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *       int target_atom_id
 *       int atom_type_id
 */
struct __pyx_t_17shift_calculators_Ring_target_component {
  int target_atom_id;
  int atom_type_id;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2189")'> 2189:       int target_atom_id</pre>
<pre id='line2189' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2190")'> 2190:       int atom_type_id</pre>
<pre id='line2190' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2191")'> 2191: </pre>
<pre id='line2191' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2192")'> 2192: cdef struct Ring_component:</pre>
<pre id='line2192' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2192
 *       int atom_type_id
 * 
 * cdef struct Ring_component:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     int ring_id
 *     int num_atoms
 */
struct __pyx_t_17shift_calculators_Ring_component {
  int ring_id;
  int num_atoms;
  int atom_ids[6];
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2193")'> 2193:     int ring_id</pre>
<pre id='line2193' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2194")'> 2194:     int num_atoms</pre>
<pre id='line2194' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2195")'> 2195:     int[6] atom_ids</pre>
<pre id='line2195' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2196")'> 2196: </pre>
<pre id='line2196' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2197")'> 2197: #cdef int RING_ATOM_IDS = 1</pre>
<pre id='line2197' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2198")'> 2198: cdef class Fast_ring_force_calculator(Base_force_calculator):</pre>
<pre id='line2198' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2198
 * 
 * #cdef int RING_ATOM_IDS = 1
 * cdef class Fast_ring_force_calculator(Base_force_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator {
  struct __pyx_obj_17shift_calculators_Base_force_calculator __pyx_base;
  struct __pyx_obj_17shift_calculators_Vec3_list *_centre_cache;
  struct __pyx_obj_17shift_calculators_Vec3_list *_normal_cache;
  struct __pyx_t_17shift_calculators_Ring_target_component *_compiled_components;
  int _num_components;
  struct __pyx_t_17shift_calculators_Ring_component *_compiled_ring_components;
  int _num_ring_components;
  PyObject *_raw_ring_component_data;
  PyObject *raw_data;
  struct __pyx_obj_17shift_calculators_Coef_components *_compiled_coef_components;
};


/* "Cython_shift_calculator.pyx":2198
 * 
 * #cdef int RING_ATOM_IDS = 1
 * cdef class Fast_ring_force_calculator(Base_force_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */

struct __pyx_vtabstruct_17shift_calculators_Fast_ring_force_calculator {
  struct __pyx_vtabstruct_17shift_calculators_Base_force_calculator __pyx_base;
  void (*_bytes_to_ring_components)(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *, PyObject *);
  Vec3 *(*_get_ring_normal)(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *, int);
  Vec3 *(*_get_ring_centre)(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *, int);
  void (*_ring_calc_single_force_set)(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *, int, float, struct __pyx_obj_17shift_calculators_Out_array *);
  void (*_calculate_single_ring_forces)(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *, int, int, struct __pyx_t_17shift_calculators_Coef_component *, float, struct __pyx_obj_17shift_calculators_Out_array *);
  void (*_build_cython_force_terms)(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *, int, int, struct __pyx_t_17shift_calculators_Ring_force_sub_terms &);
  void (*_cython_calc_target_atom_forces)(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *, int, float, struct __pyx_t_17shift_calculators_Ring_force_sub_terms &, struct __pyx_obj_17shift_calculators_Out_array *);
  void (*_cython_calculate_ring_forces)(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *, int, int, float, struct __pyx_t_17shift_calculators_Ring_force_sub_terms, struct __pyx_obj_17shift_calculators_Out_array *);
};
static struct __pyx_vtabstruct_17shift_calculators_Fast_ring_force_calculator *__pyx_vtabptr_17shift_calculators_Fast_ring_force_calculator;
static CYTHON_INLINE Vec3 *__pyx_f_17shift_calculators_26Fast_ring_force_calculator__get_ring_normal(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *, int);
static CYTHON_INLINE Vec3 *__pyx_f_17shift_calculators_26Fast_ring_force_calculator__get_ring_centre(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *, int);
static CYTHON_INLINE void __pyx_f_17shift_calculators_26Fast_ring_force_calculator__ring_calc_single_force_set(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *, int, float, struct __pyx_obj_17shift_calculators_Out_array *);
static CYTHON_INLINE void __pyx_f_17shift_calculators_26Fast_ring_force_calculator__build_cython_force_terms(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *, int, int, struct __pyx_t_17shift_calculators_Ring_force_sub_terms &);
static CYTHON_INLINE void __pyx_f_17shift_calculators_26Fast_ring_force_calculator__cython_calc_target_atom_forces(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *, int, float, struct __pyx_t_17shift_calculators_Ring_force_sub_terms &, struct __pyx_obj_17shift_calculators_Out_array *);
static CYTHON_INLINE void __pyx_f_17shift_calculators_26Fast_ring_force_calculator__cython_calculate_ring_forces(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *, int, int, float, struct __pyx_t_17shift_calculators_Ring_force_sub_terms, struct __pyx_obj_17shift_calculators_Out_array *);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2199")'> 2199: </pre>
<pre id='line2199' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2200")'> 2200: </pre>
<pre id='line2200' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2201")'> 2201:     cdef Vec3_list _centre_cache</pre>
<pre id='line2201' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2202")'> 2202:     cdef Vec3_list _normal_cache</pre>
<pre id='line2202' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2203")'> 2203: </pre>
<pre id='line2203' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2204")'> 2204:     cdef Ring_target_component* _compiled_components</pre>
<pre id='line2204' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2205")'> 2205:     cdef int _num_components</pre>
<pre id='line2205' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2206")'> 2206: </pre>
<pre id='line2206' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2207")'> 2207:     cdef Ring_component* _compiled_ring_components</pre>
<pre id='line2207' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2208")'> 2208:     cdef int _num_ring_components</pre>
<pre id='line2208' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2209")'> 2209:     cdef object _raw_ring_component_data</pre>
<pre id='line2209' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2210")'> 2210: </pre>
<pre id='line2210' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2211")'> 2211:     cdef object raw_data</pre>
<pre id='line2211' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2212")'> 2212: </pre>
<pre id='line2212' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2213")'> 2213:     cdef Coef_components _compiled_coef_components</pre>
<pre id='line2213' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2214")'> 2214: </pre>
<pre id='line2214' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2215")'> 2215: </pre>
<pre id='line2215' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2216")'> 2216:     def __cinit__(self):</pre>
<pre id='line2216' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2216
 * 
 * 
 *     def __cinit__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.raw_data =  None
 *         self._compiled_components = NULL
 */

static int __pyx_pf_17shift_calculators_26Fast_ring_force_calculator___cinit__(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2217")'> 2217:         self.raw_data =  None</pre>
<pre id='line2217' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":2217
 * 
 *     def __cinit__(self):
 *         self.raw_data =  None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components = NULL
 *         self._num_components = 0
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->raw_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->raw_data);
  __pyx_v_self->raw_data = Py_None;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2218")'> 2218:         self._compiled_components = NULL</pre>
<pre id='line2218' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2218
 *     def __cinit__(self):
 *         self.raw_data =  None
 *         self._compiled_components = NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components = 0
 * 
 */
  __pyx_v_self->_compiled_components = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2219")'> 2219:         self._num_components = 0</pre>
<pre id='line2219' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2219
 *         self.raw_data =  None
 *         self._compiled_components = NULL
 *         self._num_components = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._raw_ring_component_data = None
 */
  __pyx_v_self->_num_components = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2220")'> 2220: </pre>
<pre id='line2220' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2221")'> 2221:         self._raw_ring_component_data = None</pre>
<pre id='line2221' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":2221
 *         self._num_components = 0
 * 
 *         self._raw_ring_component_data = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_ring_components = NULL
 *         self._num_ring_components = 0
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_raw_ring_component_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_raw_ring_component_data);
  __pyx_v_self->_raw_ring_component_data = Py_None;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2222")'> 2222:         self._compiled_ring_components = NULL</pre>
<pre id='line2222' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2222
 * 
 *         self._raw_ring_component_data = None
 *         self._compiled_ring_components = NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_ring_components = 0
 * 
 */
  __pyx_v_self->_compiled_ring_components = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2223")'> 2223:         self._num_ring_components = 0</pre>
<pre id='line2223' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2223
 *         self._raw_ring_component_data = None
 *         self._compiled_ring_components = NULL
 *         self._num_ring_components = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         #note this is not a raw array of structs it's a compiled python class
 */
  __pyx_v_self->_num_ring_components = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2224")'> 2224: </pre>
<pre id='line2224' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2225")'> 2225:         #note this is not a raw array of structs it's a compiled python class</pre>
<pre id='line2225' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2226")'> 2226:         self._compiled_coef_components = None</pre>
<pre id='line2226' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":2226
 * 
 *         #note this is not a raw array of structs it's a compiled python class
 *         self._compiled_coef_components = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._centre_cache = None
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_compiled_coef_components);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_compiled_coef_components));
  __pyx_v_self->_compiled_coef_components = ((struct __pyx_obj_17shift_calculators_Coef_components *)Py_None);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2227")'> 2227: </pre>
<pre id='line2227' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2228")'> 2228:         self._centre_cache = None</pre>
<pre id='line2228' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":2228
 *         self._compiled_coef_components = None
 * 
 *         self._centre_cache = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._normal_cache = None
 * 
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_centre_cache);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_centre_cache));
  __pyx_v_self->_centre_cache = ((struct __pyx_obj_17shift_calculators_Vec3_list *)Py_None);
</pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line2229")'> 2229:         self._normal_cache = None</pre>
<pre id='line2229' class='code' style='background-color: #FFFF46'>
  /* "Cython_shift_calculator.pyx":2229
 * 
 *         self._centre_cache = None
 *         self._normal_cache = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __init__(self,name="not set"):
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_normal_cache);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_normal_cache));
  __pyx_v_self->_normal_cache = ((struct __pyx_obj_17shift_calculators_Vec3_list *)Py_None);

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_26Fast_ring_force_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_26Fast_ring_force_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__name,0};
    PyObject* values[1] = {0};
    values[0] = ((PyObject *)__pyx_kp_s_24);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2231; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_name = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 0, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2231; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_force_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_force_calculator_2__init__(((struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *)__pyx_v_self), __pyx_v_name);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2230")'> 2230: </pre>
<pre id='line2230' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2231")'> 2231:     def __init__(self,name="not set"):</pre>
<pre id='line2231' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2231
 *         self._normal_cache = None
 * 
 *     def __init__(self,name="not set"):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         super(Fast_ring_force_calculator, self).__init__(name=name)
 * 
 */

static int __pyx_pf_17shift_calculators_26Fast_ring_force_calculator_2__init__(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFF2e' onclick='toggleDiv("line2232")'> 2232:         super(Fast_ring_force_calculator, self).__init__(name=name)</pre>
<pre id='line2232' class='code' style='background-color: #FFFF2e'>
  /* "Cython_shift_calculator.pyx":2232
 * 
 *     def __init__(self,name="not set"):
 *         super(Fast_ring_force_calculator, self).__init__(name=name)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:
 */
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Fast_ring_force_calculator)));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Fast_ring_force_calculator)));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Fast_ring_force_calculator)));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_self));
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_super, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s____init__);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, ((PyObject *)__pyx_n_s__name), __pyx_v_name) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), ((PyObject *)__pyx_t_2));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_force_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2233")'> 2233: </pre>
<pre id='line2233' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2234")'> 2234:     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:</pre>
<pre id='line2234' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2234
 *         super(Fast_ring_force_calculator, self).__init__(name=name)
 * 
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components =  <code><</code>Ring_target_component*> <code><</code>size_t> data
 *         self._num_components =  length
 */

static void __pyx_f_17shift_calculators_26Fast_ring_force_calculator__bytes_to_components(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, uintptr_t __pyx_v_data, uintptr_t __pyx_v_length) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2235")'> 2235:         self._compiled_components =  &lt;Ring_target_component*&gt; &lt;size_t&gt; data</pre>
<pre id='line2235' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2235
 * 
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:
 *         self._compiled_components =  <code><</code>Ring_target_component*> <code><</code>size_t> data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components =  length
 * 
 */
  __pyx_v_self->_compiled_components = ((struct __pyx_t_17shift_calculators_Ring_target_component *)((size_t)__pyx_v_data));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2236")'> 2236:         self._num_components =  length</pre>
<pre id='line2236' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2236
 *     cdef void _bytes_to_components(self, uintptr_t data, uintptr_t length) nogil:
 *         self._compiled_components =  <code><</code>Ring_target_component*> <code><</code>size_t> data
 *         self._num_components =  length             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void _bytes_to_ring_components(self, data):
 */
  __pyx_v_self->_num_components = __pyx_v_length;

}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2237")'> 2237: </pre>
<pre id='line2237' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2238")'> 2238:     cdef void _bytes_to_ring_components(self, data):</pre>
<pre id='line2238' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2238
 *         self._num_components =  length
 * 
 *     cdef void _bytes_to_ring_components(self, data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._raw_ring_component_data =  data
 *         self._compiled_ring_components =  <code><</code>Ring_component*> <code><</code>size_t> ctypes.addressof(data)
 */

static void __pyx_f_17shift_calculators_26Fast_ring_force_calculator__bytes_to_ring_components(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, PyObject *__pyx_v_data) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_ring_components", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2239")'> 2239:         self._raw_ring_component_data =  data</pre>
<pre id='line2239' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":2239
 * 
 *     cdef void _bytes_to_ring_components(self, data):
 *         self._raw_ring_component_data =  data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_ring_components =  <code><</code>Ring_component*> <code><</code>size_t> ctypes.addressof(data)
 *         self._num_ring_components =  len(data)/ sizeof(Ring_component)
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_raw_ring_component_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_raw_ring_component_data);
  __pyx_v_self->_raw_ring_component_data = __pyx_v_data;
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line2240")'> 2240:         self._compiled_ring_components =  &lt;Ring_component*&gt; &lt;size_t&gt; ctypes.addressof(data)</pre>
<pre id='line2240' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":2240
 *     cdef void _bytes_to_ring_components(self, data):
 *         self._raw_ring_component_data =  data
 *         self._compiled_ring_components =  <code><</code>Ring_component*> <code><</code>size_t> ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_ring_components =  len(data)/ sizeof(Ring_component)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_self->_compiled_ring_components = ((struct __pyx_t_17shift_calculators_Ring_component *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line2241")'> 2241:         self._num_ring_components =  len(data)/ sizeof(Ring_component)</pre>
<pre id='line2241' class='code' style='background-color: #FFFF30'>
  /* "Cython_shift_calculator.pyx":2241
 *         self._raw_ring_component_data =  data
 *         self._compiled_ring_components =  <code><</code>Ring_component*> <code><</code>size_t> ctypes.addressof(data)
 *         self._num_ring_components =  len(data)/ sizeof(Ring_component)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2241; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_num_ring_components = (__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Ring_component)));

  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Fast_ring_force_calculator._bytes_to_ring_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_5_set_coef_components(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_5_set_coef_components(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_coef_components = 0;
  PyObject *__pyx_v_components = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_coef_components (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__coef_components,&__pyx_n_s__components,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__coef_components)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__components)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_set_coef_components", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2244; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_set_coef_components") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2244; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_coef_components = values[0];
    __pyx_v_components = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_set_coef_components", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2244; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_force_calculator._set_coef_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_force_calculator_4_set_coef_components(((struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *)__pyx_v_self), __pyx_v_coef_components, __pyx_v_components);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2242")'> 2242: </pre>
<pre id='line2242' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2243")'> 2243: </pre>
<pre id='line2243' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2244")'> 2244:     def _set_coef_components(self,coef_components, components):</pre>
<pre id='line2244' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2244
 * 
 * 
 *     def _set_coef_components(self,coef_components, components):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_coef_components = Coef_components(coef_components, components)
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_ring_force_calculator_4_set_coef_components(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, PyObject *__pyx_v_coef_components, PyObject *__pyx_v_components) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_coef_components", 0);
</pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line2245")'> 2245:         self._compiled_coef_components = Coef_components(coef_components, components)</pre>
<pre id='line2245' class='code' style='background-color: #FFFF4d'>
  /* "Cython_shift_calculator.pyx":2245
 * 
 *     def _set_coef_components(self,coef_components, components):
 *         self._compiled_coef_components = Coef_components(coef_components, components)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def _set_ring_components(self,ring_components):
 */
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_coef_components);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_coef_components);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_coef_components);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_components);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_components);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_components);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Coef_components)), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_compiled_coef_components);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_compiled_coef_components));
  __pyx_v_self->_compiled_coef_components = ((struct __pyx_obj_17shift_calculators_Coef_components *)__pyx_t_2);
  __pyx_t_2 = 0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_force_calculator._set_coef_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_7_set_ring_components(PyObject *__pyx_v_self, PyObject *__pyx_v_ring_components); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_7_set_ring_components(PyObject *__pyx_v_self, PyObject *__pyx_v_ring_components) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_ring_components (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_force_calculator_6_set_ring_components(((struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_ring_components));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2246")'> 2246: </pre>
<pre id='line2246' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2247")'> 2247:     def _set_ring_components(self,ring_components):</pre>
<pre id='line2247' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2247
 *         self._compiled_coef_components = Coef_components(coef_components, components)
 * 
 *     def _set_ring_components(self,ring_components):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self. _bytes_to_ring_components(ring_components)
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_ring_force_calculator_6_set_ring_components(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, PyObject *__pyx_v_ring_components) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_ring_components", 0);
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line2248")'> 2248:         self. _bytes_to_ring_components(ring_components)</pre>
<pre id='line2248' class='code' style='background-color: #FFFFc4'>
  /* "Cython_shift_calculator.pyx":2248
 * 
 *     def _set_ring_components(self,ring_components):
 *         self. _bytes_to_ring_components(ring_components)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  ((struct __pyx_vtabstruct_17shift_calculators_Fast_ring_force_calculator *)__pyx_v_self->__pyx_base.__pyx_vtab)->_bytes_to_ring_components(__pyx_v_self, __pyx_v_ring_components);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_9_set_normal_cache(PyObject *__pyx_v_self, PyObject *__pyx_v_normals); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_9_set_normal_cache(PyObject *__pyx_v_self, PyObject *__pyx_v_normals) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_normal_cache (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_force_calculator_8_set_normal_cache(((struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_normals));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2249")'> 2249: </pre>
<pre id='line2249' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2250")'> 2250: </pre>
<pre id='line2250' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2251")'> 2251: </pre>
<pre id='line2251' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2252")'> 2252:     def _set_normal_cache(self,normals):</pre>
<pre id='line2252' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2252
 * 
 * 
 *     def _set_normal_cache(self,normals):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._normal_cache = <code><</code>Vec3_list> normals
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_ring_force_calculator_8_set_normal_cache(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, PyObject *__pyx_v_normals) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_normal_cache", 0);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line2253")'> 2253:         self._normal_cache = &lt;Vec3_list&gt; normals</pre>
<pre id='line2253' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":2253
 * 
 *     def _set_normal_cache(self,normals):
 *         self._normal_cache = <code><</code>Vec3_list> normals             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def _set_centre_cache(self,centres):
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)((struct __pyx_obj_17shift_calculators_Vec3_list *)__pyx_v_normals)));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_normals);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_normal_cache);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_normal_cache));
  __pyx_v_self->_normal_cache = ((struct __pyx_obj_17shift_calculators_Vec3_list *)__pyx_v_normals);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_11_set_centre_cache(PyObject *__pyx_v_self, PyObject *__pyx_v_centres); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_11_set_centre_cache(PyObject *__pyx_v_self, PyObject *__pyx_v_centres) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_centre_cache (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_force_calculator_10_set_centre_cache(((struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_centres));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2254")'> 2254: </pre>
<pre id='line2254' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2255")'> 2255:     def _set_centre_cache(self,centres):</pre>
<pre id='line2255' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2255
 *         self._normal_cache = <code><</code>Vec3_list> normals
 * 
 *     def _set_centre_cache(self,centres):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._centre_cache = <code><</code>Vec3_list> centres
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_ring_force_calculator_10_set_centre_cache(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, PyObject *__pyx_v_centres) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_centre_cache", 0);
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line2256")'> 2256:         self._centre_cache = &lt;Vec3_list&gt; centres</pre>
<pre id='line2256' class='code' style='background-color: #FFFFb6'>
  /* "Cython_shift_calculator.pyx":2256
 * 
 *     def _set_centre_cache(self,centres):
 *         self._centre_cache = <code><</code>Vec3_list> centres             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)((struct __pyx_obj_17shift_calculators_Vec3_list *)__pyx_v_centres)));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_centres);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_centre_cache);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_centre_cache));
  __pyx_v_self->_centre_cache = ((struct __pyx_obj_17shift_calculators_Vec3_list *)__pyx_v_centres);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2257")'> 2257: </pre>
<pre id='line2257' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2258")'> 2258: </pre>
<pre id='line2258' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2259")'> 2259:     @cython.profile(False)</pre>
<pre id='line2259' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2260")'> 2260:     cdef inline Vec3* _get_ring_normal(self, int ring_id) nogil:</pre>
<pre id='line2260' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2260
 * 
 *     @cython.profile(False)
 *     cdef inline Vec3* _get_ring_normal(self, int ring_id) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return  self._normal_cache.get(ring_id)
 * 
 */

static CYTHON_INLINE Vec3 *__pyx_f_17shift_calculators_26Fast_ring_force_calculator__get_ring_normal(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, int __pyx_v_ring_id) {
  Vec3 *__pyx_r;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2261")'> 2261:         return  self._normal_cache.get(ring_id)</pre>
<pre id='line2261' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2261
 *     @cython.profile(False)
 *     cdef inline Vec3* _get_ring_normal(self, int ring_id) nogil:
 *         return  self._normal_cache.get(ring_id)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     @cython.profile(False)
 */
  __pyx_r = __pyx_f_17shift_calculators_9Vec3_list_get(__pyx_v_self->_normal_cache, __pyx_v_ring_id);
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2262")'> 2262: </pre>
<pre id='line2262' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2263")'> 2263:     @cython.profile(False)</pre>
<pre id='line2263' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2264")'> 2264:     cdef inline Vec3* _get_ring_centre(self, int ring_id) nogil:</pre>
<pre id='line2264' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2264
 * 
 *     @cython.profile(False)
 *     cdef inline Vec3* _get_ring_centre(self, int ring_id) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return  self._centre_cache.get(ring_id)
 * 
 */

static CYTHON_INLINE Vec3 *__pyx_f_17shift_calculators_26Fast_ring_force_calculator__get_ring_centre(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, int __pyx_v_ring_id) {
  Vec3 *__pyx_r;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2265")'> 2265:         return  self._centre_cache.get(ring_id)</pre>
<pre id='line2265' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2265
 *     @cython.profile(False)
 *     cdef inline Vec3* _get_ring_centre(self, int ring_id) nogil:
 *         return  self._centre_cache.get(ring_id)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_r = __pyx_f_17shift_calculators_9Vec3_list_get(__pyx_v_self->_centre_cache, __pyx_v_ring_id);
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2266")'> 2266: </pre>
<pre id='line2266' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2267")'> 2267: </pre>
<pre id='line2267' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2268")'> 2268: #    @cython.profile(False)</pre>
<pre id='line2268' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2269")'> 2269: #    cdef inline target_type _get_target_and_type(self,int index):</pre>
<pre id='line2269' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2270")'> 2270: #        component = self._get_component(index)</pre>
<pre id='line2270' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2271")'> 2271: ##        TODO: this needs to contain better names a union?</pre>
<pre id='line2271' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2272")'> 2272: #        cdef target_type result</pre>
<pre id='line2272' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2273")'> 2273: #        result.target_atom_id = component[0]</pre>
<pre id='line2273' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2274")'> 2274: #        result.atom_type_id = component[1]</pre>
<pre id='line2274' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2275")'> 2275: #</pre>
<pre id='line2275' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2276")'> 2276: #        return result#</pre>
<pre id='line2276' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2277")'> 2277: </pre>
<pre id='line2277' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2278")'> 2278: </pre>
<pre id='line2278' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2279")'> 2279:     cdef inline void _do_calc_components(self, int[:] component_to_result, CDSVector[float] force_factors, Out_array force) nogil:</pre>
<pre id='line2279' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2279
 * 
 * 
 *     cdef inline void _do_calc_components(self, int[:] component_to_result, CDSVector[float] force_factors, Out_array force) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int factor_index
 *         cdef int component_index
 */

static void __pyx_f_17shift_calculators_26Fast_ring_force_calculator__do_calc_components(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, __Pyx_memviewslice __pyx_v_component_to_result, CDSVector<code><</code>float> __pyx_v_force_factors, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_force) {
  int __pyx_v_factor_index;
  int __pyx_v_component_index;
  #ifdef WITH_THREAD
  PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
  #endif
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_do_calc_components", 0);
  #ifdef WITH_THREAD
  PyGILState_Release(__pyx_gilstate_save);
  #endif
  /*try:*/ {
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line2280")'> 2280:         cdef int factor_index</pre>
<pre id='line2280' class='code' style='background-color: #FFFFc4'>
  /* "Cython_shift_calculator.pyx":2280
 * 
 *     cdef inline void _do_calc_components(self, int[:] component_to_result, CDSVector[float] force_factors, Out_array force) nogil:
 *         cdef int factor_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int component_index
 * 
 */
  /*finally:*/ {
    int __pyx_why;
    __pyx_why = 0; goto __pyx_L5;
    __pyx_L4: __pyx_why = 4; goto __pyx_L5;
    __pyx_L5:;
    #ifdef WITH_THREAD
    __pyx_gilstate_save = PyGILState_Ensure();
    #endif
    switch (__pyx_why) {
      case 4: goto __pyx_L1_error;
    }
  }

  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Fast_ring_force_calculator._do_calc_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  #ifdef WITH_THREAD
  PyGILState_Release(__pyx_gilstate_save);
  #endif
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2281")'> 2281:         cdef int component_index</pre>
<pre id='line2281' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2282")'> 2282: </pre>
<pre id='line2282' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2283")'> 2283: </pre>
<pre id='line2283' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2284")'> 2284:         with gil:</pre>
<pre id='line2284' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2284
 * 
 * 
 *         with gil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for factor_index in range(len(self._active_components)):
 *                 component_index = self._active_components[factor_index]
 */
    {
        #ifdef WITH_THREAD
        PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
        #endif
        /*try:*/ {

        /* "Cython_shift_calculator.pyx":2284
 * 
 * 
 *         with gil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for factor_index in range(len(self._active_components)):
 *                 component_index = self._active_components[factor_index]
 */
        /*finally:*/ {
          int __pyx_why;
          __pyx_why = 0; goto __pyx_L8;
          __pyx_L7: __pyx_why = 4; goto __pyx_L8;
          __pyx_L8:;
          #ifdef WITH_THREAD
          PyGILState_Release(__pyx_gilstate_save);
          #endif
          switch (__pyx_why) {
            case 4: goto __pyx_L4;
          }
        }
    }
  }
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line2285")'> 2285:             for factor_index in range(len(self._active_components)):</pre>
<pre id='line2285' class='code' style='background-color: #FFFF79'>
          /* "Cython_shift_calculator.pyx":2285
 * 
 *         with gil:
 *             for factor_index in range(len(self._active_components)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 component_index = self._active_components[factor_index]
 *                 self._ring_calc_single_force_set(component_index,force_factors[component_to_result[factor_index]],force)
 */
          if (unlikely(!__pyx_v_self->__pyx_base._active_components.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2285; __pyx_clineno = __LINE__; goto __pyx_L7;}}
          __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->__pyx_base._active_components, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2285; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          __pyx_t_2 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2285; __pyx_clineno = __LINE__; goto __pyx_L7;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          for (__pyx_t_3 = 0; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
            __pyx_v_factor_index = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line2286")'> 2286:                 component_index = self._active_components[factor_index]</pre>
<pre id='line2286' class='code' style='background-color: #FFFFaa'>
            /* "Cython_shift_calculator.pyx":2286
 *         with gil:
 *             for factor_index in range(len(self._active_components)):
 *                 component_index = self._active_components[factor_index]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._ring_calc_single_force_set(component_index,force_factors[component_to_result[factor_index]],force)
 * 
 */
            if (unlikely(!__pyx_v_self->__pyx_base._active_components.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2286; __pyx_clineno = __LINE__; goto __pyx_L7;}}
            __pyx_t_4 = __pyx_v_factor_index;
            __pyx_v_component_index = (*((int *) ( /* dim=0 */ (__pyx_v_self->__pyx_base._active_components.data + __pyx_t_4 * __pyx_v_self->__pyx_base._active_components.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2287")'> 2287:                 self._ring_calc_single_force_set(component_index,force_factors[component_to_result[factor_index]],force)</pre>
<pre id='line2287' class='code' style='background-color: #FFFFff'>
            /* "Cython_shift_calculator.pyx":2287
 *             for factor_index in range(len(self._active_components)):
 *                 component_index = self._active_components[factor_index]
 *                 self._ring_calc_single_force_set(component_index,force_factors[component_to_result[factor_index]],force)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline void _ring_calc_single_force_set(self,  int index, float force_factor, Out_array forces):
 */
            __pyx_t_5 = __pyx_v_factor_index;
            __pyx_f_17shift_calculators_26Fast_ring_force_calculator__ring_calc_single_force_set(__pyx_v_self, __pyx_v_component_index, (__pyx_v_force_factors[(*((int *) ( /* dim=0 */ (__pyx_v_component_to_result.data + __pyx_t_5 * __pyx_v_component_to_result.strides[0]) )))]), __pyx_v_force);
          }
        }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2288")'> 2288: </pre>
<pre id='line2288' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2289")'> 2289:     cdef inline void _ring_calc_single_force_set(self,  int index, float force_factor, Out_array forces):</pre>
<pre id='line2289' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2289
 *                 self._ring_calc_single_force_set(component_index,force_factors[component_to_result[factor_index]],force)
 * 
 *     cdef inline void _ring_calc_single_force_set(self,  int index, float force_factor, Out_array forces):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int atom_type_id  = self._compiled_components[index].atom_type_id
 *         cdef Component_Offsets* coeff_offset =  self._compiled_coef_components.get_id_offsets(atom_type_id)
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_26Fast_ring_force_calculator__ring_calc_single_force_set(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, int __pyx_v_index, float __pyx_v_force_factor, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces) {
  int __pyx_v_atom_type_id;
  struct __pyx_t_17shift_calculators_Component_Offsets *__pyx_v_coeff_offset;
  struct __pyx_t_17shift_calculators_Coef_component *__pyx_v_coef_component;
  int __pyx_v_coef_offset;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_ring_calc_single_force_set", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2290")'> 2290:         cdef int atom_type_id  = self._compiled_components[index].atom_type_id</pre>
<pre id='line2290' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2290
 * 
 *     cdef inline void _ring_calc_single_force_set(self,  int index, float force_factor, Out_array forces):
 *         cdef int atom_type_id  = self._compiled_components[index].atom_type_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Component_Offsets* coeff_offset =  self._compiled_coef_components.get_id_offsets(atom_type_id)
 *         cdef Coef_component* coef_component
 */
  __pyx_t_1 = (__pyx_v_self->_compiled_components[__pyx_v_index]).atom_type_id;
  __pyx_v_atom_type_id = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2291")'> 2291:         cdef Component_Offsets* coeff_offset =  self._compiled_coef_components.get_id_offsets(atom_type_id)</pre>
<pre id='line2291' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2291
 *     cdef inline void _ring_calc_single_force_set(self,  int index, float force_factor, Out_array forces):
 *         cdef int atom_type_id  = self._compiled_components[index].atom_type_id
 *         cdef Component_Offsets* coeff_offset =  self._compiled_coef_components.get_id_offsets(atom_type_id)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Coef_component* coef_component
 * 
 */
  __pyx_v_coeff_offset = __pyx_f_17shift_calculators_15Coef_components_get_id_offsets(__pyx_v_self->_compiled_coef_components, __pyx_v_atom_type_id);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2292")'> 2292:         cdef Coef_component* coef_component</pre>
<pre id='line2292' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2293")'> 2293: </pre>
<pre id='line2293' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2294")'> 2294:         for coef_offset in range(coeff_offset[0].offset,coeff_offset[0].offset+coeff_offset[0].length):</pre>
<pre id='line2294' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2294
 *         cdef Coef_component* coef_component
 * 
 *         for coef_offset in range(coeff_offset[0].offset,coeff_offset[0].offset+coeff_offset[0].length):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #           TODO: remove magic numbers or add structs
 *             coef_component = self._compiled_coef_components.get_component(coef_offset)
 */
  __pyx_t_1 = ((__pyx_v_coeff_offset[0]).offset + (__pyx_v_coeff_offset[0]).length);
  for (__pyx_t_2 = (__pyx_v_coeff_offset[0]).offset; __pyx_t_2 <code><</code> __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_coef_offset = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2295")'> 2295: #           TODO: remove magic numbers or add structs</pre>
<pre id='line2295' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2296")'> 2296:             coef_component = self._compiled_coef_components.get_component(coef_offset)</pre>
<pre id='line2296' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2296
 *         for coef_offset in range(coeff_offset[0].offset,coeff_offset[0].offset+coeff_offset[0].length):
 * #           TODO: remove magic numbers or add structs
 *             coef_component = self._compiled_coef_components.get_component(coef_offset)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._calculate_single_ring_forces(self._compiled_components[index].target_atom_id, self._compiled_components[index].atom_type_id, coef_component, force_factor, forces)
 * 
 */
    __pyx_v_coef_component = __pyx_f_17shift_calculators_15Coef_components_get_component(__pyx_v_self->_compiled_coef_components, __pyx_v_coef_offset);
</pre><pre class='line' style='background-color: #FFFF18' onclick='toggleDiv("line2297")'> 2297:             self._calculate_single_ring_forces(self._compiled_components[index].target_atom_id, self._compiled_components[index].atom_type_id, coef_component, force_factor, forces)</pre>
<pre id='line2297' class='code' style='background-color: #FFFF18'>
    /* "Cython_shift_calculator.pyx":2297
 * #           TODO: remove magic numbers or add structs
 *             coef_component = self._compiled_coef_components.get_component(coef_offset)
 *             self._calculate_single_ring_forces(self._compiled_components[index].target_atom_id, self._compiled_components[index].atom_type_id, coef_component, force_factor, forces)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def _calculate_ring_forces(self, int atom_type_id, int ring_id, float force_factor, Python_ring_force_sub_terms python_sub_terms,Out_array forces):
 */
    ((struct __pyx_vtabstruct_17shift_calculators_Fast_ring_force_calculator *)__pyx_v_self->__pyx_base.__pyx_vtab)->_calculate_single_ring_forces(__pyx_v_self, (__pyx_v_self->_compiled_components[__pyx_v_index]).target_atom_id, (__pyx_v_self->_compiled_components[__pyx_v_index]).atom_type_id, __pyx_v_coef_component, __pyx_v_force_factor, __pyx_v_forces);
  }

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_13_calculate_ring_forces(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_13_calculate_ring_forces(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_atom_type_id;
  int __pyx_v_ring_id;
  float __pyx_v_force_factor;
  struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms *__pyx_v_python_sub_terms = 0;
  struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calculate_ring_forces (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__atom_type_id,&__pyx_n_s__ring_id,&__pyx_n_s__force_factor,&__pyx_n_s__python_sub_terms,&__pyx_n_s__forces,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__atom_type_id)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__ring_id)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calculate_ring_forces", 1, 5, 5, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2299; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__force_factor)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calculate_ring_forces", 1, 5, 5, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2299; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__python_sub_terms)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calculate_ring_forces", 1, 5, 5, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2299; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__forces)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calculate_ring_forces", 1, 5, 5, 4);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2299; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_calculate_ring_forces") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2299; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 5) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
    }
    __pyx_v_atom_type_id = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_atom_type_id == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2299; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_ring_id = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_ring_id == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2299; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_force_factor = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_force_factor == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2299; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_python_sub_terms = ((struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms *)values[3]);
    __pyx_v_forces = ((struct __pyx_obj_17shift_calculators_Out_array *)values[4]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calculate_ring_forces", 1, 5, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2299; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_force_calculator._calculate_ring_forces", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_python_sub_terms), __pyx_ptype_17shift_calculators_Python_ring_force_sub_terms, 1, "python_sub_terms", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_forces), __pyx_ptype_17shift_calculators_Out_array, 1, "forces", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_force_calculator_12_calculate_ring_forces(((struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *)__pyx_v_self), __pyx_v_atom_type_id, __pyx_v_ring_id, __pyx_v_force_factor, __pyx_v_python_sub_terms, __pyx_v_forces);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2298")'> 2298: </pre>
<pre id='line2298' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2299")'> 2299:     def _calculate_ring_forces(self, int atom_type_id, int ring_id, float force_factor, Python_ring_force_sub_terms python_sub_terms,Out_array forces):</pre>
<pre id='line2299' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2299
 *             self._calculate_single_ring_forces(self._compiled_components[index].target_atom_id, self._compiled_components[index].atom_type_id, coef_component, force_factor, forces)
 * 
 *     def _calculate_ring_forces(self, int atom_type_id, int ring_id, float force_factor, Python_ring_force_sub_terms python_sub_terms,Out_array forces):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Ring_force_sub_terms  terms  =  python_sub_terms.get_terms()
 *         self._cython_calculate_ring_forces(atom_type_id, ring_id, force_factor, terms, forces)
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_ring_force_calculator_12_calculate_ring_forces(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, int __pyx_v_atom_type_id, int __pyx_v_ring_id, float __pyx_v_force_factor, struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms *__pyx_v_python_sub_terms, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces) {
  struct __pyx_t_17shift_calculators_Ring_force_sub_terms __pyx_v_terms;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calculate_ring_forces", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2300")'> 2300:         cdef Ring_force_sub_terms  terms  =  python_sub_terms.get_terms()</pre>
<pre id='line2300' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2300
 * 
 *     def _calculate_ring_forces(self, int atom_type_id, int ring_id, float force_factor, Python_ring_force_sub_terms python_sub_terms,Out_array forces):
 *         cdef Ring_force_sub_terms  terms  =  python_sub_terms.get_terms()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._cython_calculate_ring_forces(atom_type_id, ring_id, force_factor, terms, forces)
 * 
 */
  __pyx_v_terms = ((struct __pyx_vtabstruct_17shift_calculators_Python_ring_force_sub_terms *)__pyx_v_python_sub_terms->__pyx_vtab)->get_terms(__pyx_v_python_sub_terms);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2301")'> 2301:         self._cython_calculate_ring_forces(atom_type_id, ring_id, force_factor, terms, forces)</pre>
<pre id='line2301' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":2301
 *     def _calculate_ring_forces(self, int atom_type_id, int ring_id, float force_factor, Python_ring_force_sub_terms python_sub_terms,Out_array forces):
 *         cdef Ring_force_sub_terms  terms  =  python_sub_terms.get_terms()
 *         self._cython_calculate_ring_forces(atom_type_id, ring_id, force_factor, terms, forces)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void _calculate_single_ring_forces(self, int target_atom_id, int atom_type_id, Coef_component* coef_component, float force_factor,Out_array forces):
 */
  __pyx_f_17shift_calculators_26Fast_ring_force_calculator__cython_calculate_ring_forces(__pyx_v_self, __pyx_v_atom_type_id, __pyx_v_ring_id, __pyx_v_force_factor, __pyx_v_terms, __pyx_v_forces);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2302")'> 2302: </pre>
<pre id='line2302' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2303")'> 2303:     cdef void _calculate_single_ring_forces(self, int target_atom_id, int atom_type_id, Coef_component* coef_component, float force_factor,Out_array forces):</pre>
<pre id='line2303' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2303
 *         self._cython_calculate_ring_forces(atom_type_id, ring_id, force_factor, terms, forces)
 * 
 *     cdef void _calculate_single_ring_forces(self, int target_atom_id, int atom_type_id, Coef_component* coef_component, float force_factor,Out_array forces):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Ring_force_sub_terms force_terms
 */

static void __pyx_f_17shift_calculators_26Fast_ring_force_calculator__calculate_single_ring_forces(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, int __pyx_v_target_atom_id, int __pyx_v_atom_type_id, struct __pyx_t_17shift_calculators_Coef_component *__pyx_v_coef_component, float __pyx_v_force_factor, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces) {
  struct __pyx_t_17shift_calculators_Ring_force_sub_terms __pyx_v_force_terms;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calculate_single_ring_forces", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2304")'> 2304: </pre>
<pre id='line2304' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2305")'> 2305:         cdef Ring_force_sub_terms force_terms</pre>
<pre id='line2305' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2306")'> 2306:         self._build_cython_force_terms(target_atom_id, coef_component.ring_id, force_terms)</pre>
<pre id='line2306' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2306
 * 
 *         cdef Ring_force_sub_terms force_terms
 *         self._build_cython_force_terms(target_atom_id, coef_component.ring_id, force_terms)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._cython_calc_target_atom_forces(target_atom_id, force_factor * coef_component.coefficient, force_terms, forces)
 */
  __pyx_f_17shift_calculators_26Fast_ring_force_calculator__build_cython_force_terms(__pyx_v_self, __pyx_v_target_atom_id, __pyx_v_coef_component->ring_id, __pyx_v_force_terms);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2307")'> 2307: </pre>
<pre id='line2307' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2308")'> 2308:         self._cython_calc_target_atom_forces(target_atom_id, force_factor * coef_component.coefficient, force_terms, forces)</pre>
<pre id='line2308' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2308
 *         self._build_cython_force_terms(target_atom_id, coef_component.ring_id, force_terms)
 * 
 *         self._cython_calc_target_atom_forces(target_atom_id, force_factor * coef_component.coefficient, force_terms, forces)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #        #            #TODO: this is not how camshift does it, it uses the sum of the two ring normals
 */
  __pyx_f_17shift_calculators_26Fast_ring_force_calculator__cython_calc_target_atom_forces(__pyx_v_self, __pyx_v_target_atom_id, (__pyx_v_force_factor * __pyx_v_coef_component->coefficient), __pyx_v_force_terms, __pyx_v_forces);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2309")'> 2309: </pre>
<pre id='line2309' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2310")'> 2310: #        #            #TODO: this is not how camshift does it, it uses the sum of the two ring normals</pre>
<pre id='line2310' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF28' onclick='toggleDiv("line2311")'> 2311:         self._cython_calculate_ring_forces(atom_type_id, coef_component.ring_id, force_factor * coef_component.coefficient, force_terms, forces)</pre>
<pre id='line2311' class='code' style='background-color: #FFFF28'>
  /* "Cython_shift_calculator.pyx":2311
 * 
 * #        #            #TODO: this is not how camshift does it, it uses the sum of the two ring normals
 *         self._cython_calculate_ring_forces(atom_type_id, coef_component.ring_id, force_factor * coef_component.coefficient, force_terms, forces)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def _build_force_terms(self, int target_atom_id, int ring_id):
 */
  __pyx_f_17shift_calculators_26Fast_ring_force_calculator__cython_calculate_ring_forces(__pyx_v_self, __pyx_v_atom_type_id, __pyx_v_coef_component->ring_id, (__pyx_v_force_factor * __pyx_v_coef_component->coefficient), __pyx_v_force_terms, __pyx_v_forces);

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_15_build_force_terms(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_15_build_force_terms(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_target_atom_id;
  int __pyx_v_ring_id;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_build_force_terms (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__target_atom_id,&__pyx_n_s__ring_id,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__target_atom_id)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__ring_id)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_build_force_terms", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2313; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_build_force_terms") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2313; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_target_atom_id = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_target_atom_id == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2313; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_ring_id = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_ring_id == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2313; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_build_force_terms", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2313; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_force_calculator._build_force_terms", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_force_calculator_14_build_force_terms(((struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *)__pyx_v_self), __pyx_v_target_atom_id, __pyx_v_ring_id);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2312")'> 2312: </pre>
<pre id='line2312' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2313")'> 2313:     def _build_force_terms(self, int target_atom_id, int ring_id):</pre>
<pre id='line2313' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2313
 *         self._cython_calculate_ring_forces(atom_type_id, coef_component.ring_id, force_factor * coef_component.coefficient, force_terms, forces)
 * 
 *     def _build_force_terms(self, int target_atom_id, int ring_id):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Ring_force_sub_terms terms
 *         self._build_cython_force_terms(target_atom_id, ring_id, terms)
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_ring_force_calculator_14_build_force_terms(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, int __pyx_v_target_atom_id, int __pyx_v_ring_id) {
  struct __pyx_t_17shift_calculators_Ring_force_sub_terms __pyx_v_terms;
  struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms *__pyx_v_result = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_build_force_terms", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2314")'> 2314:         cdef Ring_force_sub_terms terms</pre>
<pre id='line2314' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2315")'> 2315:         self._build_cython_force_terms(target_atom_id, ring_id, terms)</pre>
<pre id='line2315' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2315
 *     def _build_force_terms(self, int target_atom_id, int ring_id):
 *         cdef Ring_force_sub_terms terms
 *         self._build_cython_force_terms(target_atom_id, ring_id, terms)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result  = Python_ring_force_sub_terms()
 *         result.setup(terms)
 */
  __pyx_f_17shift_calculators_26Fast_ring_force_calculator__build_cython_force_terms(__pyx_v_self, __pyx_v_target_atom_id, __pyx_v_ring_id, __pyx_v_terms);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line2316")'> 2316:         result  = Python_ring_force_sub_terms()</pre>
<pre id='line2316' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":2316
 *         cdef Ring_force_sub_terms terms
 *         self._build_cython_force_terms(target_atom_id, ring_id, terms)
 *         result  = Python_ring_force_sub_terms()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.setup(terms)
 *         return result
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Python_ring_force_sub_terms)), ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2316; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_result = ((struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line2317")'> 2317:         result.setup(terms)</pre>
<pre id='line2317' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":2317
 *         self._build_cython_force_terms(target_atom_id, ring_id, terms)
 *         result  = Python_ring_force_sub_terms()
 *         result.setup(terms)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return result
 * 
 */
  __pyx_t_1 = ((struct __pyx_vtabstruct_17shift_calculators_Python_ring_force_sub_terms *)__pyx_v_result->__pyx_vtab)->setup(__pyx_v_result, __pyx_v_terms);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line2318")'> 2318:         return result</pre>
<pre id='line2318' class='code' style='background-color: #FFFF8d'>
  /* "Cython_shift_calculator.pyx":2318
 *         result  = Python_ring_force_sub_terms()
 *         result.setup(terms)
 *         return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline void _build_cython_force_terms(self, int target_atom_id, int ring_id, Ring_force_sub_terms& result):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_result));
  __pyx_r = ((PyObject *)__pyx_v_result);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_force_calculator._build_force_terms", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_result);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2319")'> 2319: </pre>
<pre id='line2319' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2320")'> 2320:     cdef inline void _build_cython_force_terms(self, int target_atom_id, int ring_id, Ring_force_sub_terms&amp; result):</pre>
<pre id='line2320' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2320
 *         return result
 * 
 *     cdef inline void _build_cython_force_terms(self, int target_atom_id, int ring_id, Ring_force_sub_terms& result):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3 target_atom_pos  = self._simulation[0].atomPos(target_atom_id)
 * 
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_26Fast_ring_force_calculator__build_cython_force_terms(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, int __pyx_v_target_atom_id, int __pyx_v_ring_id, struct __pyx_t_17shift_calculators_Ring_force_sub_terms &__pyx_v_result) {
  Vec3 __pyx_v_target_atom_pos;
  Vec3 __pyx_v_ring_centre;
  Vec3 *__pyx_v_ring_normal;
  Vec3 __pyx_v_d;
  float __pyx_v_dL;
  float __pyx_v_dL2;
  float __pyx_v_dL4;
  float __pyx_v_dL3;
  float __pyx_v_dL6;
  float __pyx_v_nL;
  float __pyx_v_nL2;
  float __pyx_v_dLnL;
  float __pyx_v_dL3nL3;
  float __pyx_v_dn;
  float __pyx_v_dn2;
  float __pyx_v_u;
  float __pyx_v_gradUQ_factor;
  Vec3 __pyx_v_scaled_d;
  Vec3 __pyx_v_scaled_normal;
  Vec3 __pyx_v_gradUQ;
  float __pyx_v_gradVQ_factor;
  Vec3 __pyx_v_gradVQ;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_build_cython_force_terms", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2321")'> 2321:         cdef Vec3 target_atom_pos  = self._simulation[0].atomPos(target_atom_id)</pre>
<pre id='line2321' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2321
 * 
 *     cdef inline void _build_cython_force_terms(self, int target_atom_id, int ring_id, Ring_force_sub_terms& result):
 *         cdef Vec3 target_atom_pos  = self._simulation[0].atomPos(target_atom_id)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Vec3 ring_centre = self._get_ring_centre(ring_id)[0]
 */
  __pyx_v_target_atom_pos = (__pyx_v_self->__pyx_base._simulation[0]).atomPos(__pyx_v_target_atom_id);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2322")'> 2322: </pre>
<pre id='line2322' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2323")'> 2323:         cdef Vec3 ring_centre = self._get_ring_centre(ring_id)[0]</pre>
<pre id='line2323' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2323
 *         cdef Vec3 target_atom_pos  = self._simulation[0].atomPos(target_atom_id)
 * 
 *         cdef Vec3 ring_centre = self._get_ring_centre(ring_id)[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3* ring_normal = self._get_ring_normal(ring_id)
 * 
 */
  __pyx_v_ring_centre = (__pyx_f_17shift_calculators_26Fast_ring_force_calculator__get_ring_centre(__pyx_v_self, __pyx_v_ring_id)[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2324")'> 2324:         cdef Vec3* ring_normal = self._get_ring_normal(ring_id)</pre>
<pre id='line2324' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2324
 * 
 *         cdef Vec3 ring_centre = self._get_ring_centre(ring_id)[0]
 *         cdef Vec3* ring_normal = self._get_ring_normal(ring_id)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         # distance vector between atom of interest and ring center
 */
  __pyx_v_ring_normal = __pyx_f_17shift_calculators_26Fast_ring_force_calculator__get_ring_normal(__pyx_v_self, __pyx_v_ring_id);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2325")'> 2325: </pre>
<pre id='line2325' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2326")'> 2326:         # distance vector between atom of interest and ring center</pre>
<pre id='line2326' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2327")'> 2327:         cdef Vec3 d = target_atom_pos - ring_centre</pre>
<pre id='line2327' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2327
 * 
 *         # distance vector between atom of interest and ring center
 *         cdef Vec3 d = target_atom_pos - ring_centre             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef float dL = norm(d)
 * 
 */
  __pyx_v_d = (__pyx_v_target_atom_pos - __pyx_v_ring_centre);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2328")'> 2328:         cdef float dL = norm(d)</pre>
<pre id='line2328' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2328
 *         # distance vector between atom of interest and ring center
 *         cdef Vec3 d = target_atom_pos - ring_centre
 *         cdef float dL = norm(d)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         # squared distance of atom of interest from ring center
 */
  __pyx_v_dL = norm(__pyx_v_d);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2329")'> 2329: </pre>
<pre id='line2329' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2330")'> 2330:         # squared distance of atom of interest from ring center</pre>
<pre id='line2330' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2331")'> 2331:         cdef float dL2 = dot(d, d) #            if (dL2 &lt; 0.5) cout &lt;&lt; "CAMSHIFT WARNING: Distance between atom and center of ring alarmingly small at " &lt;&lt; sqrt(dL2) &lt;&lt; " Angstrom!" &lt;&lt; endl;</pre>
<pre id='line2331' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2331
 * 
 *         # squared distance of atom of interest from ring center
 *         cdef float dL2 = dot(d, d) #            if (dL2 <code><</code> 0.5) cout <code><</code><code><</code> "CAMSHIFT WARNING: Distance between atom and center of ring alarmingly small at " <code><</code><code><</code> sqrt(dL2) <code><</code><code><</code> " Angstrom!" <code><</code><code><</code> endl;             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         # calculate terms resulting from differentiating energy function with respect to query and ring atom coordinates
 */
  __pyx_v_dL2 = dot(__pyx_v_d, __pyx_v_d);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2332")'> 2332: </pre>
<pre id='line2332' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2333")'> 2333:         # calculate terms resulting from differentiating energy function with respect to query and ring atom coordinates</pre>
<pre id='line2333' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2334")'> 2334:         cdef float dL4 = dL ** 4</pre>
<pre id='line2334' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2334
 * 
 *         # calculate terms resulting from differentiating energy function with respect to query and ring atom coordinates
 *         cdef float dL4 = dL ** 4             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef float dL3 = dL ** 3
 *         cdef float dL6 = dL3 ** 2
 */
  __pyx_v_dL4 = powf(__pyx_v_dL, 4.0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2335")'> 2335:         cdef float dL3 = dL ** 3</pre>
<pre id='line2335' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2335
 *         # calculate terms resulting from differentiating energy function with respect to query and ring atom coordinates
 *         cdef float dL4 = dL ** 4
 *         cdef float dL3 = dL ** 3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef float dL6 = dL3 ** 2
 * 
 */
  __pyx_v_dL3 = powf(__pyx_v_dL, 3.0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2336")'> 2336:         cdef float dL6 = dL3 ** 2</pre>
<pre id='line2336' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2336
 *         cdef float dL4 = dL ** 4
 *         cdef float dL3 = dL ** 3
 *         cdef float dL6 = dL3 ** 2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef float nL = norm(ring_normal[0])
 */
  __pyx_v_dL6 = powf(__pyx_v_dL3, 2.0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2337")'> 2337: </pre>
<pre id='line2337' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2338")'> 2338:         cdef float nL = norm(ring_normal[0])</pre>
<pre id='line2338' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2338
 *         cdef float dL6 = dL3 ** 2
 * 
 *         cdef float nL = norm(ring_normal[0])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef float nL2 = nL ** 2
 *         cdef float dLnL = dL * nL
 */
  __pyx_v_nL = norm((__pyx_v_ring_normal[0]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2339")'> 2339:         cdef float nL2 = nL ** 2</pre>
<pre id='line2339' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2339
 * 
 *         cdef float nL = norm(ring_normal[0])
 *         cdef float nL2 = nL ** 2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef float dLnL = dL * nL
 *         cdef float dL3nL3 = dL3 * nL2 * nL
 */
  __pyx_v_nL2 = powf(__pyx_v_nL, 2.0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2340")'> 2340:         cdef float dLnL = dL * nL</pre>
<pre id='line2340' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2340
 *         cdef float nL = norm(ring_normal[0])
 *         cdef float nL2 = nL ** 2
 *         cdef float dLnL = dL * nL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef float dL3nL3 = dL3 * nL2 * nL
 * 
 */
  __pyx_v_dLnL = (__pyx_v_dL * __pyx_v_nL);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2341")'> 2341:         cdef float dL3nL3 = dL3 * nL2 * nL</pre>
<pre id='line2341' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2341
 *         cdef float nL2 = nL ** 2
 *         cdef float dLnL = dL * nL
 *         cdef float dL3nL3 = dL3 * nL2 * nL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef float dn = dot(d, ring_normal[0])
 */
  __pyx_v_dL3nL3 = ((__pyx_v_dL3 * __pyx_v_nL2) * __pyx_v_nL);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2342")'> 2342: </pre>
<pre id='line2342' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2343")'> 2343:         cdef float dn = dot(d, ring_normal[0])</pre>
<pre id='line2343' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2343
 *         cdef float dL3nL3 = dL3 * nL2 * nL
 * 
 *         cdef float dn = dot(d, ring_normal[0])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef float dn2 = dn ** 2
 * 
 */
  __pyx_v_dn = dot(__pyx_v_d, (__pyx_v_ring_normal[0]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2344")'> 2344:         cdef float dn2 = dn ** 2</pre>
<pre id='line2344' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2344
 * 
 *         cdef float dn = dot(d, ring_normal[0])
 *         cdef float dn2 = dn ** 2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef float u = 1.0 - 3.0 * dn2 / (dL2 * nL2)
 */
  __pyx_v_dn2 = powf(__pyx_v_dn, 2.0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2345")'> 2345: </pre>
<pre id='line2345' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2346")'> 2346:         cdef float u = 1.0 - 3.0 * dn2 / (dL2 * nL2)</pre>
<pre id='line2346' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2346
 *         cdef float dn2 = dn ** 2
 * 
 *         cdef float u = 1.0 - 3.0 * dn2 / (dL2 * nL2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef float gradUQ_factor = -6.0 * dn / (dL4 * nL2)
 */
  __pyx_v_u = (1.0 - ((3.0 * __pyx_v_dn2) / (__pyx_v_dL2 * __pyx_v_nL2)));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2347")'> 2347: </pre>
<pre id='line2347' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2348")'> 2348:         cdef float gradUQ_factor = -6.0 * dn / (dL4 * nL2)</pre>
<pre id='line2348' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2348
 *         cdef float u = 1.0 - 3.0 * dn2 / (dL2 * nL2)
 * 
 *         cdef float gradUQ_factor = -6.0 * dn / (dL4 * nL2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         #TODO: remove temporarys and operator_mu;t#
 */
  __pyx_v_gradUQ_factor = ((-6.0 * __pyx_v_dn) / (__pyx_v_dL4 * __pyx_v_nL2));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2349")'> 2349: </pre>
<pre id='line2349' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2350")'> 2350:         #TODO: remove temporarys and operator_mu;t#</pre>
<pre id='line2350' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2351")'> 2351:         cdef Vec3 scaled_d =  d</pre>
<pre id='line2351' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2351
 * 
 *         #TODO: remove temporarys and operator_mu;t#
 *         cdef Vec3 scaled_d =  d             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(scaled_d,dn)
 *         cdef Vec3 scaled_normal = ring_normal[0]
 */
  __pyx_v_scaled_d = __pyx_v_d;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2352")'> 2352:         operator_times(scaled_d,dn)</pre>
<pre id='line2352' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2352
 *         #TODO: remove temporarys and operator_mu;t#
 *         cdef Vec3 scaled_d =  d
 *         operator_times(scaled_d,dn)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3 scaled_normal = ring_normal[0]
 *         operator_times(scaled_normal,dL2)
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_scaled_d, __pyx_v_dn);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2353")'> 2353:         cdef Vec3 scaled_normal = ring_normal[0]</pre>
<pre id='line2353' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2353
 *         cdef Vec3 scaled_d =  d
 *         operator_times(scaled_d,dn)
 *         cdef Vec3 scaled_normal = ring_normal[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(scaled_normal,dL2)
 * 
 */
  __pyx_v_scaled_normal = (__pyx_v_ring_normal[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2354")'> 2354:         operator_times(scaled_normal,dL2)</pre>
<pre id='line2354' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2354
 *         operator_times(scaled_d,dn)
 *         cdef Vec3 scaled_normal = ring_normal[0]
 *         operator_times(scaled_normal,dL2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Vec3 gradUQ = scaled_normal - scaled_d
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_scaled_normal, __pyx_v_dL2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2355")'> 2355: </pre>
<pre id='line2355' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2356")'> 2356:         cdef Vec3 gradUQ = scaled_normal - scaled_d</pre>
<pre id='line2356' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2356
 *         operator_times(scaled_normal,dL2)
 * 
 *         cdef Vec3 gradUQ = scaled_normal - scaled_d             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(gradUQ,gradUQ_factor)
 * 
 */
  __pyx_v_gradUQ = (__pyx_v_scaled_normal - __pyx_v_scaled_d);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2357")'> 2357:         operator_times(gradUQ,gradUQ_factor)</pre>
<pre id='line2357' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2357
 * 
 *         cdef Vec3 gradUQ = scaled_normal - scaled_d
 *         operator_times(gradUQ,gradUQ_factor)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_gradUQ, __pyx_v_gradUQ_factor);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2358")'> 2358: </pre>
<pre id='line2358' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2359")'> 2359: </pre>
<pre id='line2359' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2360")'> 2360:         cdef float gradVQ_factor = 3.0 * dL</pre>
<pre id='line2360' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2360
 * 
 * 
 *         cdef float gradVQ_factor = 3.0 * dL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3 gradVQ = d
 *         operator_times(gradVQ,gradVQ_factor)
 */
  __pyx_v_gradVQ_factor = (3.0 * __pyx_v_dL);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2361")'> 2361:         cdef Vec3 gradVQ = d</pre>
<pre id='line2361' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2361
 * 
 *         cdef float gradVQ_factor = 3.0 * dL
 *         cdef Vec3 gradVQ = d             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(gradVQ,gradVQ_factor)
 * 
 */
  __pyx_v_gradVQ = __pyx_v_d;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2362")'> 2362:         operator_times(gradVQ,gradVQ_factor)</pre>
<pre id='line2362' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2362
 *         cdef float gradVQ_factor = 3.0 * dL
 *         cdef Vec3 gradVQ = d
 *         operator_times(gradVQ,gradVQ_factor)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         result.dL3nL3 = dL3nL3
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_gradVQ, __pyx_v_gradVQ_factor);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2363")'> 2363: </pre>
<pre id='line2363' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2364")'> 2364:         result.dL3nL3 = dL3nL3</pre>
<pre id='line2364' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2364
 *         operator_times(gradVQ,gradVQ_factor)
 * 
 *         result.dL3nL3 = dL3nL3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.dLnL =dLnL
 *         result.dn = dn
 */
  __pyx_v_result.dL3nL3 = __pyx_v_dL3nL3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2365")'> 2365:         result.dLnL =dLnL</pre>
<pre id='line2365' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2365
 * 
 *         result.dL3nL3 = dL3nL3
 *         result.dLnL =dLnL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.dn = dn
 *         result.dL = dL
 */
  __pyx_v_result.dLnL = __pyx_v_dLnL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2366")'> 2366:         result.dn = dn</pre>
<pre id='line2366' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2366
 *         result.dL3nL3 = dL3nL3
 *         result.dLnL =dLnL
 *         result.dn = dn             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.dL = dL
 *         result.nL = nL
 */
  __pyx_v_result.dn = __pyx_v_dn;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2367")'> 2367:         result.dL = dL</pre>
<pre id='line2367' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2367
 *         result.dLnL =dLnL
 *         result.dn = dn
 *         result.dL = dL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.nL = nL
 *         result.d = d
 */
  __pyx_v_result.dL = __pyx_v_dL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2368")'> 2368:         result.nL = nL</pre>
<pre id='line2368' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2368
 *         result.dn = dn
 *         result.dL = dL
 *         result.nL = nL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.d = d
 *         result.gradUQ = gradUQ
 */
  __pyx_v_result.nL = __pyx_v_nL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2369")'> 2369:         result.d = d</pre>
<pre id='line2369' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2369
 *         result.dL = dL
 *         result.nL = nL
 *         result.d = d             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.gradUQ = gradUQ
 *         result.dL3 =dL3
 */
  __pyx_v_result.d = __pyx_v_d;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2370")'> 2370:         result.gradUQ = gradUQ</pre>
<pre id='line2370' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2370
 *         result.nL = nL
 *         result.d = d
 *         result.gradUQ = gradUQ             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.dL3 =dL3
 *         result.u  = u
 */
  __pyx_v_result.gradUQ = __pyx_v_gradUQ;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2371")'> 2371:         result.dL3 =dL3</pre>
<pre id='line2371' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2371
 *         result.d = d
 *         result.gradUQ = gradUQ
 *         result.dL3 =dL3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.u  = u
 *         result.gradVQ = gradVQ
 */
  __pyx_v_result.dL3 = __pyx_v_dL3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2372")'> 2372:         result.u  = u</pre>
<pre id='line2372' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2372
 *         result.gradUQ = gradUQ
 *         result.dL3 =dL3
 *         result.u  = u             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.gradVQ = gradVQ
 *         result.dL6 = dL6
 */
  __pyx_v_result.u = __pyx_v_u;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2373")'> 2373:         result.gradVQ = gradVQ</pre>
<pre id='line2373' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2373
 *         result.dL3 =dL3
 *         result.u  = u
 *         result.gradVQ = gradVQ             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.dL6 = dL6
 *         result.ring_normal =  ring_normal[0]
 */
  __pyx_v_result.gradVQ = __pyx_v_gradVQ;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2374")'> 2374:         result.dL6 = dL6</pre>
<pre id='line2374' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2374
 *         result.u  = u
 *         result.gradVQ = gradVQ
 *         result.dL6 = dL6             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.ring_normal =  ring_normal[0]
 * 
 */
  __pyx_v_result.dL6 = __pyx_v_dL6;
</pre><pre class='line' style='background-color: #FFFF1e' onclick='toggleDiv("line2375")'> 2375:         result.ring_normal =  ring_normal[0]</pre>
<pre id='line2375' class='code' style='background-color: #FFFF1e'>
  /* "Cython_shift_calculator.pyx":2375
 *         result.gradVQ = gradVQ
 *         result.dL6 = dL6
 *         result.ring_normal =  ring_normal[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #        return  dL3, u, dL6, ring_normal,  atom_type_id, coefficient, d, factor, dn, dL3nL3, dL, nL, dLnL
 */
  __pyx_v_result.ring_normal = (__pyx_v_ring_normal[0]);

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_17_calc_target_atom_forces(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_17_calc_target_atom_forces(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_target_atom_id;
  float __pyx_v_force_factor;
  struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms *__pyx_v_python_sub_terms = 0;
  struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calc_target_atom_forces (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__target_atom_id,&__pyx_n_s__force_factor,&__pyx_n_s__python_sub_terms,&__pyx_n_s__forces,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__target_atom_id)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__force_factor)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calc_target_atom_forces", 1, 4, 4, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2380; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__python_sub_terms)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calc_target_atom_forces", 1, 4, 4, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2380; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__forces)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calc_target_atom_forces", 1, 4, 4, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2380; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_calc_target_atom_forces") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2380; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_target_atom_id = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_target_atom_id == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2380; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_force_factor = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_force_factor == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2380; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_python_sub_terms = ((struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms *)values[2]);
    __pyx_v_forces = ((struct __pyx_obj_17shift_calculators_Out_array *)values[3]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calc_target_atom_forces", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2380; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_force_calculator._calc_target_atom_forces", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_python_sub_terms), __pyx_ptype_17shift_calculators_Python_ring_force_sub_terms, 1, "python_sub_terms", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2380; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_forces), __pyx_ptype_17shift_calculators_Out_array, 1, "forces", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2380; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_force_calculator_16_calc_target_atom_forces(((struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *)__pyx_v_self), __pyx_v_target_atom_id, __pyx_v_force_factor, __pyx_v_python_sub_terms, __pyx_v_forces);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2376")'> 2376: </pre>
<pre id='line2376' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2377")'> 2377: #        return  dL3, u, dL6, ring_normal,  atom_type_id, coefficient, d, factor, dn, dL3nL3, dL, nL, dLnL</pre>
<pre id='line2377' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2378")'> 2378: ##    ---</pre>
<pre id='line2378' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2379")'> 2379: #</pre>
<pre id='line2379' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2380")'> 2380:     def _calc_target_atom_forces(self, int target_atom_id, float force_factor, Python_ring_force_sub_terms python_sub_terms, Out_array forces):</pre>
<pre id='line2380' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2380
 * ##    ---
 * #
 *     def _calc_target_atom_forces(self, int target_atom_id, float force_factor, Python_ring_force_sub_terms python_sub_terms, Out_array forces):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Ring_force_sub_terms  terms  =  python_sub_terms.get_terms()
 *         self._cython_calc_target_atom_forces(target_atom_id, force_factor, terms, forces)
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_ring_force_calculator_16_calc_target_atom_forces(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, int __pyx_v_target_atom_id, float __pyx_v_force_factor, struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms *__pyx_v_python_sub_terms, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces) {
  struct __pyx_t_17shift_calculators_Ring_force_sub_terms __pyx_v_terms;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calc_target_atom_forces", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2381")'> 2381:         cdef Ring_force_sub_terms  terms  =  python_sub_terms.get_terms()</pre>
<pre id='line2381' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2381
 * #
 *     def _calc_target_atom_forces(self, int target_atom_id, float force_factor, Python_ring_force_sub_terms python_sub_terms, Out_array forces):
 *         cdef Ring_force_sub_terms  terms  =  python_sub_terms.get_terms()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._cython_calc_target_atom_forces(target_atom_id, force_factor, terms, forces)
 * 
 */
  __pyx_v_terms = ((struct __pyx_vtabstruct_17shift_calculators_Python_ring_force_sub_terms *)__pyx_v_python_sub_terms->__pyx_vtab)->get_terms(__pyx_v_python_sub_terms);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2382")'> 2382:         self._cython_calc_target_atom_forces(target_atom_id, force_factor, terms, forces)</pre>
<pre id='line2382' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":2382
 *     def _calc_target_atom_forces(self, int target_atom_id, float force_factor, Python_ring_force_sub_terms python_sub_terms, Out_array forces):
 *         cdef Ring_force_sub_terms  terms  =  python_sub_terms.get_terms()
 *         self._cython_calc_target_atom_forces(target_atom_id, force_factor, terms, forces)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline void _cython_calc_target_atom_forces(self, int target_atom_id, float force_factor, Ring_force_sub_terms& sub_terms, Out_array forces):
 */
  __pyx_f_17shift_calculators_26Fast_ring_force_calculator__cython_calc_target_atom_forces(__pyx_v_self, __pyx_v_target_atom_id, __pyx_v_force_factor, __pyx_v_terms, __pyx_v_forces);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2383")'> 2383: </pre>
<pre id='line2383' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2384")'> 2384:     cdef inline void _cython_calc_target_atom_forces(self, int target_atom_id, float force_factor, Ring_force_sub_terms&amp; sub_terms, Out_array forces):</pre>
<pre id='line2384' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2384
 *         self._cython_calc_target_atom_forces(target_atom_id, force_factor, terms, forces)
 * 
 *     cdef inline void _cython_calc_target_atom_forces(self, int target_atom_id, float force_factor, Ring_force_sub_terms& sub_terms, Out_array forces):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef object target_force_triplet
 *         cdef int axis
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_26Fast_ring_force_calculator__cython_calc_target_atom_forces(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, int __pyx_v_target_atom_id, float __pyx_v_force_factor, struct __pyx_t_17shift_calculators_Ring_force_sub_terms &__pyx_v_sub_terms, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces) {
  int __pyx_v_axis;
  float __pyx_v_term1;
  Vec3 __pyx_v_result;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_cython_calc_target_atom_forces", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2385")'> 2385:         cdef object target_force_triplet</pre>
<pre id='line2385' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2386")'> 2386:         cdef int axis</pre>
<pre id='line2386' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2387")'> 2387: #        target_force_triplet = self._get_or_make_target_force_triplet(forces, target_atom_id)</pre>
<pre id='line2387' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2388")'> 2388: #</pre>
<pre id='line2388' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2389")'> 2389: #        # update forces on query atom</pre>
<pre id='line2389' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2390")'> 2390:         cdef float term1</pre>
<pre id='line2390' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2391")'> 2391:         cdef Vec3 result</pre>
<pre id='line2391' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2392")'> 2392:         for axis in range(3):</pre>
<pre id='line2392' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2392
 *         cdef float term1
 *         cdef Vec3 result
 *         for axis in range(3):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             #TODO: report this as a bug it produces an un initialized reference
 *             term1= (sub_terms.gradUQ[axis] * sub_terms.dL3 - sub_terms.u * sub_terms.gradVQ[axis])
 */
  for (__pyx_t_1 = 0; __pyx_t_1 <code><</code> 3; __pyx_t_1+=1) {
    __pyx_v_axis = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2393")'> 2393:             #TODO: report this as a bug it produces an un initialized reference</pre>
<pre id='line2393' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2394")'> 2394:             term1= (sub_terms.gradUQ[axis] * sub_terms.dL3 - sub_terms.u * sub_terms.gradVQ[axis])</pre>
<pre id='line2394' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2394
 *         for axis in range(3):
 *             #TODO: report this as a bug it produces an un initialized reference
 *             term1= (sub_terms.gradUQ[axis] * sub_terms.dL3 - sub_terms.u * sub_terms.gradVQ[axis])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             result[axis] = -force_factor * term1 / sub_terms.dL6
 * 
 */
    __pyx_v_term1 = (((__pyx_v_sub_terms.gradUQ[__pyx_v_axis]) * __pyx_v_sub_terms.dL3) - (__pyx_v_sub_terms.u * (__pyx_v_sub_terms.gradVQ[__pyx_v_axis])));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2395")'> 2395:             result[axis] = -force_factor * term1 / sub_terms.dL6</pre>
<pre id='line2395' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2395
 *             #TODO: report this as a bug it produces an un initialized reference
 *             term1= (sub_terms.gradUQ[axis] * sub_terms.dL3 - sub_terms.u * sub_terms.gradVQ[axis])
 *             result[axis] = -force_factor * term1 / sub_terms.dL6             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         forces.add(target_atom_id, result)
 */
    (__pyx_v_result[__pyx_v_axis]) = (((-__pyx_v_force_factor) * __pyx_v_term1) / __pyx_v_sub_terms.dL6);
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2396")'> 2396: </pre>
<pre id='line2396' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line2397")'> 2397:         forces.add(target_atom_id, result)</pre>
<pre id='line2397' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":2397
 *             result[axis] = -force_factor * term1 / sub_terms.dL6
 * 
 *         forces.add(target_atom_id, result)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #             *  / sub_terms.dL6
 * #
 */
  __pyx_f_17shift_calculators_9Out_array_add(__pyx_v_forces, __pyx_v_target_atom_id, __pyx_v_result);

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2398")'> 2398: #             *  / sub_terms.dL6</pre>
<pre id='line2398' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2399")'> 2399: #</pre>
<pre id='line2399' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2400")'> 2400: #    #TODO: calculation of GradU and gradV are not consistent with force_terms for target atom correct</pre>
<pre id='line2400' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2401")'> 2401: #    #TODO: reduce number of parameters to method</pre>
<pre id='line2401' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2402")'> 2402: </pre>
<pre id='line2402' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2403")'> 2403:     cdef inline void _cython_calculate_ring_forces(self, int atom_type_id, int ring_id, float force_factor, Ring_force_sub_terms force_terms, Out_array forces):</pre>
<pre id='line2403' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2403
 * #    #TODO: reduce number of parameters to method
 * 
 *     cdef inline void _cython_calculate_ring_forces(self, int atom_type_id, int ring_id, float force_factor, Ring_force_sub_terms force_terms, Out_array forces):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3 temp_normal =  Vec3(force_terms.ring_normal)
 *         cdef Vec3 nSum = temp_normal
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_26Fast_ring_force_calculator__cython_calculate_ring_forces(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, CYTHON_UNUSED int __pyx_v_atom_type_id, int __pyx_v_ring_id, float __pyx_v_force_factor, struct __pyx_t_17shift_calculators_Ring_force_sub_terms __pyx_v_force_terms, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces) {
  Vec3 __pyx_v_temp_normal;
  Vec3 __pyx_v_nSum;
  int __pyx_v_num_ring_atoms;
  int __pyx_v_limit;
  Vec3 __pyx_v_g;
  int __pyx_v_ring_atom_id;
  int __pyx_v_ring_atom_index;
  int __pyx_v_index_1;
  int __pyx_v_index_2;
  float __pyx_v_pos_1;
  float __pyx_v_pos_2;
  float __pyx_v_pos_3;
  float __pyx_v_pos_4;
  int __pyx_v_offset;
  int __pyx_v_indices_1[3];
  int __pyx_v_indices_2[3];
  float __pyx_v_ab[3];
  float __pyx_v_c[3];
  float __pyx_v_factor;
  float __pyx_v_factor2;
  float __pyx_v_one_over_num_ring_atoms;
  float __pyx_v_factor3;
  Vec3 __pyx_v_gradU;
  Vec3 __pyx_v_gradV;
  Vec3 __pyx_v_result;
  int __pyx_v_axis;
  float __pyx_v_sub_term;
  float __pyx_v_sub_force;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_cython_calculate_ring_forces", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2404")'> 2404:         cdef Vec3 temp_normal =  Vec3(force_terms.ring_normal)</pre>
<pre id='line2404' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2404
 * 
 *     cdef inline void _cython_calculate_ring_forces(self, int atom_type_id, int ring_id, float force_factor, Ring_force_sub_terms force_terms, Out_array forces):
 *         cdef Vec3 temp_normal =  Vec3(force_terms.ring_normal)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3 nSum = temp_normal
 *         operator_times(nSum,2.0)  #            float_type g [3], ab [3], c [3]
 */
  __pyx_v_temp_normal = Vec3(__pyx_v_force_terms.ring_normal);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2405")'> 2405:         cdef Vec3 nSum = temp_normal</pre>
<pre id='line2405' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2405
 *     cdef inline void _cython_calculate_ring_forces(self, int atom_type_id, int ring_id, float force_factor, Ring_force_sub_terms force_terms, Out_array forces):
 *         cdef Vec3 temp_normal =  Vec3(force_terms.ring_normal)
 *         cdef Vec3 nSum = temp_normal             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(nSum,2.0)  #            float_type g [3], ab [3], c [3]
 *     #// 2 for a 5-membered ring, 3 for a 6-membered ring
 */
  __pyx_v_nSum = __pyx_v_temp_normal;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2406")'> 2406:         operator_times(nSum,2.0)  #            float_type g [3], ab [3], c [3]</pre>
<pre id='line2406' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2406
 *         cdef Vec3 temp_normal =  Vec3(force_terms.ring_normal)
 *         cdef Vec3 nSum = temp_normal
 *         operator_times(nSum,2.0)  #            float_type g [3], ab [3], c [3]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     #// 2 for a 5-membered ring, 3 for a 6-membered ring
 *         cdef int num_ring_atoms = self._compiled_ring_components[ring_id].num_atoms
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_nSum, 2.0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2407")'> 2407:     #// 2 for a 5-membered ring, 3 for a 6-membered ring</pre>
<pre id='line2407' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2408")'> 2408:         cdef int num_ring_atoms = self._compiled_ring_components[ring_id].num_atoms</pre>
<pre id='line2408' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2408
 *         operator_times(nSum,2.0)  #            float_type g [3], ab [3], c [3]
 *     #// 2 for a 5-membered ring, 3 for a 6-membered ring
 *         cdef int num_ring_atoms = self._compiled_ring_components[ring_id].num_atoms             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int limit = num_ring_atoms - 3
 * 
 */
  __pyx_t_1 = (__pyx_v_self->_compiled_ring_components[__pyx_v_ring_id]).num_atoms;
  __pyx_v_num_ring_atoms = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2409")'> 2409:         cdef int limit = num_ring_atoms - 3</pre>
<pre id='line2409' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2409
 *     #// 2 for a 5-membered ring, 3 for a 6-membered ring
 *         cdef int num_ring_atoms = self._compiled_ring_components[ring_id].num_atoms
 *         cdef int limit = num_ring_atoms - 3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #        for atom_type_id, ring_id, coefficient in coef_components:
 */
  __pyx_v_limit = (__pyx_v_num_ring_atoms - 3);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2410")'> 2410: </pre>
<pre id='line2410' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2411")'> 2411: #        for atom_type_id, ring_id, coefficient in coef_components:</pre>
<pre id='line2411' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2412")'> 2412:         cdef Vec3 g = Vec3()</pre>
<pre id='line2412' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2412
 * 
 * #        for atom_type_id, ring_id, coefficient in coef_components:
 *         cdef Vec3 g = Vec3()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int ring_atom_id
 *         cdef int ring_atom_index
 */
  __pyx_v_g = Vec3();
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2413")'> 2413:         cdef int ring_atom_id</pre>
<pre id='line2413' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2414")'> 2414:         cdef int ring_atom_index</pre>
<pre id='line2414' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2415")'> 2415:         cdef int index_1</pre>
<pre id='line2415' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2416")'> 2416:         cdef int index_2</pre>
<pre id='line2416' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2417")'> 2417:         cdef float pos_1</pre>
<pre id='line2417' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2418")'> 2418:         cdef float pos_2</pre>
<pre id='line2418' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2419")'> 2419:         cdef float pos_3</pre>
<pre id='line2419' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2420")'> 2420:         cdef float pos_4</pre>
<pre id='line2420' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2421")'> 2421:         cdef int offset</pre>
<pre id='line2421' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2422")'> 2422: </pre>
<pre id='line2422' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2423")'> 2423:         cdef int[3] indices_1</pre>
<pre id='line2423' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2424")'> 2424:         cdef int[3] indices_2</pre>
<pre id='line2424' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2425")'> 2425: </pre>
<pre id='line2425' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2426")'> 2426:         cdef float[3] ab</pre>
<pre id='line2426' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2427")'> 2427:         cdef float[3] c</pre>
<pre id='line2427' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2428")'> 2428: </pre>
<pre id='line2428' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2429")'> 2429:         cdef float factor</pre>
<pre id='line2429' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2430")'> 2430:         cdef float factor2</pre>
<pre id='line2430' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2431")'> 2431:         cdef float one_over_num_ring_atoms</pre>
<pre id='line2431' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2432")'> 2432:         cdef float factor3</pre>
<pre id='line2432' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2433")'> 2433: </pre>
<pre id='line2433' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2434")'> 2434:         cdef Vec3 gradU</pre>
<pre id='line2434' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2435")'> 2435:         cdef Vec3 gradV</pre>
<pre id='line2435' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2436")'> 2436:         cdef Vec3 result</pre>
<pre id='line2436' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2437")'> 2437: </pre>
<pre id='line2437' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2438")'> 2438:         cdef int axis</pre>
<pre id='line2438' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2439")'> 2439:         cdef float sub_term</pre>
<pre id='line2439' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2440")'> 2440:         cdef float sub_force</pre>
<pre id='line2440' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2441")'> 2441: </pre>
<pre id='line2441' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2442")'> 2442:         for ring_atom_index in range(num_ring_atoms):</pre>
<pre id='line2442' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2442
 *         cdef float sub_force
 * 
 *         for ring_atom_index in range(num_ring_atoms):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             ring_atom_id = self._compiled_ring_components[ring_id].atom_ids[ring_atom_index]
 *             if ring_atom_index <code><</code> limit:
 */
  __pyx_t_1 = __pyx_v_num_ring_atoms;
  for (__pyx_t_2 = 0; __pyx_t_2 <code><</code> __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_ring_atom_index = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2443")'> 2443:             ring_atom_id = self._compiled_ring_components[ring_id].atom_ids[ring_atom_index]</pre>
<pre id='line2443' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2443
 * 
 *         for ring_atom_index in range(num_ring_atoms):
 *             ring_atom_id = self._compiled_ring_components[ring_id].atom_ids[ring_atom_index]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if ring_atom_index <code><</code> limit:
 *                 for axis in range(3):
 */
    __pyx_v_ring_atom_id = ((__pyx_v_self->_compiled_ring_components[__pyx_v_ring_id]).atom_ids[__pyx_v_ring_atom_index]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2444")'> 2444:             if ring_atom_index &lt; limit:</pre>
<pre id='line2444' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2444
 *         for ring_atom_index in range(num_ring_atoms):
 *             ring_atom_id = self._compiled_ring_components[ring_id].atom_ids[ring_atom_index]
 *             if ring_atom_index <code><</code> limit:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 for axis in range(3):
 *                     index_1 = (ring_atom_index + 1) % 3
 */
    __pyx_t_3 = (__pyx_v_ring_atom_index <code><</code> __pyx_v_limit);
    if (__pyx_t_3) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2445")'> 2445:                 for axis in range(3):</pre>
<pre id='line2445' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":2445
 *             ring_atom_id = self._compiled_ring_components[ring_id].atom_ids[ring_atom_index]
 *             if ring_atom_index <code><</code> limit:
 *                 for axis in range(3):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     index_1 = (ring_atom_index + 1) % 3
 *                     index_2 = (ring_atom_index + 2) % 3
 */
      for (__pyx_t_4 = 0; __pyx_t_4 <code><</code> 3; __pyx_t_4+=1) {
        __pyx_v_axis = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2446")'> 2446:                     index_1 = (ring_atom_index + 1) % 3</pre>
<pre id='line2446' class='code' style='background-color: #FFFFff'>
        /* "Cython_shift_calculator.pyx":2446
 *             if ring_atom_index <code><</code> limit:
 *                 for axis in range(3):
 *                     index_1 = (ring_atom_index + 1) % 3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     index_2 = (ring_atom_index + 2) % 3
 *                     pos_1 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[index_1])[axis]
 */
        __pyx_v_index_1 = ((__pyx_v_ring_atom_index + 1) % 3);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2447")'> 2447:                     index_2 = (ring_atom_index + 2) % 3</pre>
<pre id='line2447' class='code' style='background-color: #FFFFff'>
        /* "Cython_shift_calculator.pyx":2447
 *                 for axis in range(3):
 *                     index_1 = (ring_atom_index + 1) % 3
 *                     index_2 = (ring_atom_index + 2) % 3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     pos_1 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[index_1])[axis]
 *                     pos_2 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[index_2])[axis]
 */
        __pyx_v_index_2 = ((__pyx_v_ring_atom_index + 2) % 3);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2448")'> 2448:                     pos_1 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[index_1])[axis]</pre>
<pre id='line2448' class='code' style='background-color: #FFFFff'>
        /* "Cython_shift_calculator.pyx":2448
 *                     index_1 = (ring_atom_index + 1) % 3
 *                     index_2 = (ring_atom_index + 2) % 3
 *                     pos_1 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[index_1])[axis]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     pos_2 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[index_2])[axis]
 *                     g[axis] =  pos_1 - pos_2 # atoms 3,4 (5 member) or 3,4,5 (6 member)
 */
        __pyx_v_pos_1 = ((__pyx_v_self->__pyx_base._simulation[0]).atomPos(((__pyx_v_self->_compiled_ring_components[__pyx_v_ring_id]).atom_ids[__pyx_v_index_1]))[__pyx_v_axis]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2449")'> 2449:                     pos_2 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[index_2])[axis]</pre>
<pre id='line2449' class='code' style='background-color: #FFFFff'>
        /* "Cython_shift_calculator.pyx":2449
 *                     index_2 = (ring_atom_index + 2) % 3
 *                     pos_1 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[index_1])[axis]
 *                     pos_2 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[index_2])[axis]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     g[axis] =  pos_1 - pos_2 # atoms 3,4 (5 member) or 3,4,5 (6 member)
 * 
 */
        __pyx_v_pos_2 = ((__pyx_v_self->__pyx_base._simulation[0]).atomPos(((__pyx_v_self->_compiled_ring_components[__pyx_v_ring_id]).atom_ids[__pyx_v_index_2]))[__pyx_v_axis]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2450")'> 2450:                     g[axis] =  pos_1 - pos_2 # atoms 3,4 (5 member) or 3,4,5 (6 member)</pre>
<pre id='line2450' class='code' style='background-color: #FFFFff'>
        /* "Cython_shift_calculator.pyx":2450
 *                     pos_1 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[index_1])[axis]
 *                     pos_2 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[index_2])[axis]
 *                     g[axis] =  pos_1 - pos_2 # atoms 3,4 (5 member) or 3,4,5 (6 member)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             else:
 */
        (__pyx_v_g[__pyx_v_axis]) = (__pyx_v_pos_1 - __pyx_v_pos_2);
      }
      goto __pyx_L5;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2451")'> 2451: </pre>
<pre id='line2451' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2452")'> 2452:             else:</pre>
<pre id='line2452' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2453")'> 2453:                 if  ring_atom_index &gt;= num_ring_atoms - limit:</pre>
<pre id='line2453' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":2453
 * 
 *             else:
 *                 if  ring_atom_index >= num_ring_atoms - limit:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     offset = num_ring_atoms - 3 #2 for a 5-membered ring, 3 for a 6-membered ring
 *                     for axis in range(3):
 */
      __pyx_t_3 = (__pyx_v_ring_atom_index >= (__pyx_v_num_ring_atoms - __pyx_v_limit));
      if (__pyx_t_3) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2454")'> 2454:                     offset = num_ring_atoms - 3 #2 for a 5-membered ring, 3 for a 6-membered ring</pre>
<pre id='line2454' class='code' style='background-color: #FFFFff'>
        /* "Cython_shift_calculator.pyx":2454
 *             else:
 *                 if  ring_atom_index >= num_ring_atoms - limit:
 *                     offset = num_ring_atoms - 3 #2 for a 5-membered ring, 3 for a 6-membered ring             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for axis in range(3):
 *                         index_1 = (ring_atom_index + 1 - offset) % 3 + offset
 */
        __pyx_v_offset = (__pyx_v_num_ring_atoms - 3);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2455")'> 2455:                     for axis in range(3):</pre>
<pre id='line2455' class='code' style='background-color: #FFFFff'>
        /* "Cython_shift_calculator.pyx":2455
 *                 if  ring_atom_index >= num_ring_atoms - limit:
 *                     offset = num_ring_atoms - 3 #2 for a 5-membered ring, 3 for a 6-membered ring
 *                     for axis in range(3):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         index_1 = (ring_atom_index + 1 - offset) % 3 + offset
 *                         index_2 = (ring_atom_index + 2 - offset) % 3 + offset
 */
        for (__pyx_t_4 = 0; __pyx_t_4 <code><</code> 3; __pyx_t_4+=1) {
          __pyx_v_axis = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2456")'> 2456:                         index_1 = (ring_atom_index + 1 - offset) % 3 + offset</pre>
<pre id='line2456' class='code' style='background-color: #FFFFff'>
          /* "Cython_shift_calculator.pyx":2456
 *                     offset = num_ring_atoms - 3 #2 for a 5-membered ring, 3 for a 6-membered ring
 *                     for axis in range(3):
 *                         index_1 = (ring_atom_index + 1 - offset) % 3 + offset             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         index_2 = (ring_atom_index + 2 - offset) % 3 + offset
 *                         pos_1 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[index_1])[axis]
 */
          __pyx_v_index_1 = ((((__pyx_v_ring_atom_index + 1) - __pyx_v_offset) % 3) + __pyx_v_offset);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2457")'> 2457:                         index_2 = (ring_atom_index + 2 - offset) % 3 + offset</pre>
<pre id='line2457' class='code' style='background-color: #FFFFff'>
          /* "Cython_shift_calculator.pyx":2457
 *                     for axis in range(3):
 *                         index_1 = (ring_atom_index + 1 - offset) % 3 + offset
 *                         index_2 = (ring_atom_index + 2 - offset) % 3 + offset             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         pos_1 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[index_1])[axis]
 *                         pos_2 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[index_2])[axis]
 */
          __pyx_v_index_2 = ((((__pyx_v_ring_atom_index + 2) - __pyx_v_offset) % 3) + __pyx_v_offset);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2458")'> 2458:                         pos_1 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[index_1])[axis]</pre>
<pre id='line2458' class='code' style='background-color: #FFFFff'>
          /* "Cython_shift_calculator.pyx":2458
 *                         index_1 = (ring_atom_index + 1 - offset) % 3 + offset
 *                         index_2 = (ring_atom_index + 2 - offset) % 3 + offset
 *                         pos_1 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[index_1])[axis]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         pos_2 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[index_2])[axis]
 *                         g[axis] = pos_1 - pos_2
 */
          __pyx_v_pos_1 = ((__pyx_v_self->__pyx_base._simulation[0]).atomPos(((__pyx_v_self->_compiled_ring_components[__pyx_v_ring_id]).atom_ids[__pyx_v_index_1]))[__pyx_v_axis]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2459")'> 2459:                         pos_2 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[index_2])[axis]</pre>
<pre id='line2459' class='code' style='background-color: #FFFFff'>
          /* "Cython_shift_calculator.pyx":2459
 *                         index_2 = (ring_atom_index + 2 - offset) % 3 + offset
 *                         pos_1 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[index_1])[axis]
 *                         pos_2 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[index_2])[axis]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         g[axis] = pos_1 - pos_2
 *                 else:
 */
          __pyx_v_pos_2 = ((__pyx_v_self->__pyx_base._simulation[0]).atomPos(((__pyx_v_self->_compiled_ring_components[__pyx_v_ring_id]).atom_ids[__pyx_v_index_2]))[__pyx_v_axis]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2460")'> 2460:                         g[axis] = pos_1 - pos_2</pre>
<pre id='line2460' class='code' style='background-color: #FFFFff'>
          /* "Cython_shift_calculator.pyx":2460
 *                         pos_1 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[index_1])[axis]
 *                         pos_2 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[index_2])[axis]
 *                         g[axis] = pos_1 - pos_2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 else:
 * 
 */
          (__pyx_v_g[__pyx_v_axis]) = (__pyx_v_pos_1 - __pyx_v_pos_2);
        }
        goto __pyx_L8;
      }
      /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2461")'> 2461:                 else:</pre>
<pre id='line2461' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2462")'> 2462: </pre>
<pre id='line2462' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2463")'> 2463:                     for axis in range(3):</pre>
<pre id='line2463' class='code' style='background-color: #FFFFff'>
        /* "Cython_shift_calculator.pyx":2463
 *                 else:
 * 
 *                     for axis in range(3):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         pos_1 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[0])[axis]
 *                         pos_2 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[1])[axis]
 */
        for (__pyx_t_4 = 0; __pyx_t_4 <code><</code> 3; __pyx_t_4+=1) {
          __pyx_v_axis = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2464")'> 2464:                         pos_1 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[0])[axis]</pre>
<pre id='line2464' class='code' style='background-color: #FFFFff'>
          /* "Cython_shift_calculator.pyx":2464
 * 
 *                     for axis in range(3):
 *                         pos_1 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[0])[axis]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         pos_2 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[1])[axis]
 *                         pos_3 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[3])[axis]
 */
          __pyx_v_pos_1 = ((__pyx_v_self->__pyx_base._simulation[0]).atomPos(((__pyx_v_self->_compiled_ring_components[__pyx_v_ring_id]).atom_ids[0]))[__pyx_v_axis]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2465")'> 2465:                         pos_2 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[1])[axis]</pre>
<pre id='line2465' class='code' style='background-color: #FFFFff'>
          /* "Cython_shift_calculator.pyx":2465
 *                     for axis in range(3):
 *                         pos_1 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[0])[axis]
 *                         pos_2 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[1])[axis]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         pos_3 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[3])[axis]
 *                         pos_4 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[4])[axis]
 */
          __pyx_v_pos_2 = ((__pyx_v_self->__pyx_base._simulation[0]).atomPos(((__pyx_v_self->_compiled_ring_components[__pyx_v_ring_id]).atom_ids[1]))[__pyx_v_axis]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2466")'> 2466:                         pos_3 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[3])[axis]</pre>
<pre id='line2466' class='code' style='background-color: #FFFFff'>
          /* "Cython_shift_calculator.pyx":2466
 *                         pos_1 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[0])[axis]
 *                         pos_2 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[1])[axis]
 *                         pos_3 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[3])[axis]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         pos_4 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[4])[axis]
 *                         g[axis] = pos_1 - pos_2 + pos_3 - pos_4
 */
          __pyx_v_pos_3 = ((__pyx_v_self->__pyx_base._simulation[0]).atomPos(((__pyx_v_self->_compiled_ring_components[__pyx_v_ring_id]).atom_ids[3]))[__pyx_v_axis]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2467")'> 2467:                         pos_4 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[4])[axis]</pre>
<pre id='line2467' class='code' style='background-color: #FFFFff'>
          /* "Cython_shift_calculator.pyx":2467
 *                         pos_2 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[1])[axis]
 *                         pos_3 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[3])[axis]
 *                         pos_4 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[4])[axis]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         g[axis] = pos_1 - pos_2 + pos_3 - pos_4
 * 
 */
          __pyx_v_pos_4 = ((__pyx_v_self->__pyx_base._simulation[0]).atomPos(((__pyx_v_self->_compiled_ring_components[__pyx_v_ring_id]).atom_ids[4]))[__pyx_v_axis]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2468")'> 2468:                         g[axis] = pos_1 - pos_2 + pos_3 - pos_4</pre>
<pre id='line2468' class='code' style='background-color: #FFFFff'>
          /* "Cython_shift_calculator.pyx":2468
 *                         pos_3 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[3])[axis]
 *                         pos_4 = self._simulation[0].atomPos(self._compiled_ring_components[ring_id].atom_ids[4])[axis]
 *                         g[axis] = pos_1 - pos_2 + pos_3 - pos_4             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             # 0 1 2 2 1   (0+1) %3 (0+2) %3
 */
          (__pyx_v_g[__pyx_v_axis]) = (((__pyx_v_pos_1 - __pyx_v_pos_2) + __pyx_v_pos_3) - __pyx_v_pos_4);
        }
      }
      __pyx_L8:;
    }
    __pyx_L5:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2469")'> 2469: </pre>
<pre id='line2469' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2470")'> 2470:             # 0 1 2 2 1   (0+1) %3 (0+2) %3</pre>
<pre id='line2470' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2471")'> 2471:             # 1 2 0 0 2</pre>
<pre id='line2471' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2472")'> 2472:             # 2 0 1 10</pre>
<pre id='line2472' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2473")'> 2473:             #atom 2 (5-membered rings)</pre>
<pre id='line2473' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2474")'> 2474:             for axis in range(3):</pre>
<pre id='line2474' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2474
 *             # 2 0 1 10
 *             #atom 2 (5-membered rings)
 *             for axis in range(3):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 indices_1[axis] = (axis + 1) % 3
 *                 indices_2[axis] = (axis + 2) % 3
 */
    for (__pyx_t_4 = 0; __pyx_t_4 <code><</code> 3; __pyx_t_4+=1) {
      __pyx_v_axis = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2475")'> 2475:                 indices_1[axis] = (axis + 1) % 3</pre>
<pre id='line2475' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":2475
 *             #atom 2 (5-membered rings)
 *             for axis in range(3):
 *                 indices_1[axis] = (axis + 1) % 3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 indices_2[axis] = (axis + 2) % 3
 * 
 */
      (__pyx_v_indices_1[__pyx_v_axis]) = ((__pyx_v_axis + 1) % 3);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2476")'> 2476:                 indices_2[axis] = (axis + 2) % 3</pre>
<pre id='line2476' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":2476
 *             for axis in range(3):
 *                 indices_1[axis] = (axis + 1) % 3
 *                 indices_2[axis] = (axis + 2) % 3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             for axis in range(3):
 */
      (__pyx_v_indices_2[__pyx_v_axis]) = ((__pyx_v_axis + 2) % 3);
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2477")'> 2477: </pre>
<pre id='line2477' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2478")'> 2478:             for axis in range(3):</pre>
<pre id='line2478' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2478
 *                 indices_2[axis] = (axis + 2) % 3
 * 
 *             for axis in range(3):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 index_1 = indices_1[axis]
 *                 index_2 = indices_2[axis]
 */
    for (__pyx_t_4 = 0; __pyx_t_4 <code><</code> 3; __pyx_t_4+=1) {
      __pyx_v_axis = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2479")'> 2479:                 index_1 = indices_1[axis]</pre>
<pre id='line2479' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":2479
 * 
 *             for axis in range(3):
 *                 index_1 = indices_1[axis]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 index_2 = indices_2[axis]
 *                 ab[axis] = force_terms.d[index_1] * g[index_2] - force_terms.d[index_2] * g[index_1]
 */
      __pyx_v_index_1 = (__pyx_v_indices_1[__pyx_v_axis]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2480")'> 2480:                 index_2 = indices_2[axis]</pre>
<pre id='line2480' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":2480
 *             for axis in range(3):
 *                 index_1 = indices_1[axis]
 *                 index_2 = indices_2[axis]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 ab[axis] = force_terms.d[index_1] * g[index_2] - force_terms.d[index_2] * g[index_1]
 * 
 */
      __pyx_v_index_2 = (__pyx_v_indices_2[__pyx_v_axis]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2481")'> 2481:                 ab[axis] = force_terms.d[index_1] * g[index_2] - force_terms.d[index_2] * g[index_1]</pre>
<pre id='line2481' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":2481
 *                 index_1 = indices_1[axis]
 *                 index_2 = indices_2[axis]
 *                 ab[axis] = force_terms.d[index_1] * g[index_2] - force_terms.d[index_2] * g[index_1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             for axis in range(3):
 */
      (__pyx_v_ab[__pyx_v_axis]) = (((__pyx_v_force_terms.d[__pyx_v_index_1]) * (__pyx_v_g[__pyx_v_index_2])) - ((__pyx_v_force_terms.d[__pyx_v_index_2]) * (__pyx_v_g[__pyx_v_index_1])));
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2482")'> 2482: </pre>
<pre id='line2482' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2483")'> 2483:             for axis in range(3):</pre>
<pre id='line2483' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2483
 *                 ab[axis] = force_terms.d[index_1] * g[index_2] - force_terms.d[index_2] * g[index_1]
 * 
 *             for axis in range(3):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 index_1 = indices_1[axis]
 *                 index_2 = indices_2[axis]
 */
    for (__pyx_t_4 = 0; __pyx_t_4 <code><</code> 3; __pyx_t_4+=1) {
      __pyx_v_axis = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2484")'> 2484:                 index_1 = indices_1[axis]</pre>
<pre id='line2484' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":2484
 * 
 *             for axis in range(3):
 *                 index_1 = indices_1[axis]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 index_2 = indices_2[axis]
 *                 c[axis] = nSum[index_1] * g[index_2] - nSum[index_2] * g[index_1]
 */
      __pyx_v_index_1 = (__pyx_v_indices_1[__pyx_v_axis]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2485")'> 2485:                 index_2 = indices_2[axis]</pre>
<pre id='line2485' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":2485
 *             for axis in range(3):
 *                 index_1 = indices_1[axis]
 *                 index_2 = indices_2[axis]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 c[axis] = nSum[index_1] * g[index_2] - nSum[index_2] * g[index_1]
 * 
 */
      __pyx_v_index_2 = (__pyx_v_indices_2[__pyx_v_axis]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2486")'> 2486:                 c[axis] = nSum[index_1] * g[index_2] - nSum[index_2] * g[index_1]</pre>
<pre id='line2486' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":2486
 *                 index_1 = indices_1[axis]
 *                 index_2 = indices_2[axis]
 *                 c[axis] = nSum[index_1] * g[index_2] - nSum[index_2] * g[index_1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             factor = -6.0 * force_terms.dn / force_terms.dL3nL3
 */
      (__pyx_v_c[__pyx_v_axis]) = (((__pyx_v_nSum[__pyx_v_index_1]) * (__pyx_v_g[__pyx_v_index_2])) - ((__pyx_v_nSum[__pyx_v_index_2]) * (__pyx_v_g[__pyx_v_index_1])));
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2487")'> 2487: </pre>
<pre id='line2487' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2488")'> 2488:             factor = -6.0 * force_terms.dn / force_terms.dL3nL3</pre>
<pre id='line2488' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2488
 *                 c[axis] = nSum[index_1] * g[index_2] - nSum[index_2] * g[index_1]
 * 
 *             factor = -6.0 * force_terms.dn / force_terms.dL3nL3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             factor2 = 0.25 * force_terms.dL / force_terms.nL
 *             one_over_num_ring_atoms = 1.0 / float(num_ring_atoms)
 */
    __pyx_v_factor = ((-6.0 * __pyx_v_force_terms.dn) / __pyx_v_force_terms.dL3nL3);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2489")'> 2489:             factor2 = 0.25 * force_terms.dL / force_terms.nL</pre>
<pre id='line2489' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2489
 * 
 *             factor = -6.0 * force_terms.dn / force_terms.dL3nL3
 *             factor2 = 0.25 * force_terms.dL / force_terms.nL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             one_over_num_ring_atoms = 1.0 / float(num_ring_atoms)
 *             factor3 = force_terms.nL / force_terms.dL * one_over_num_ring_atoms
 */
    __pyx_v_factor2 = ((0.25 * __pyx_v_force_terms.dL) / __pyx_v_force_terms.nL);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2490")'> 2490:             one_over_num_ring_atoms = 1.0 / float(num_ring_atoms)</pre>
<pre id='line2490' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2490
 *             factor = -6.0 * force_terms.dn / force_terms.dL3nL3
 *             factor2 = 0.25 * force_terms.dL / force_terms.nL
 *             one_over_num_ring_atoms = 1.0 / float(num_ring_atoms)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             factor3 = force_terms.nL / force_terms.dL * one_over_num_ring_atoms
 * 
 */
    __pyx_v_one_over_num_ring_atoms = (1.0 / ((double)__pyx_v_num_ring_atoms));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2491")'> 2491:             factor3 = force_terms.nL / force_terms.dL * one_over_num_ring_atoms</pre>
<pre id='line2491' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2491
 *             factor2 = 0.25 * force_terms.dL / force_terms.nL
 *             one_over_num_ring_atoms = 1.0 / float(num_ring_atoms)
 *             factor3 = force_terms.nL / force_terms.dL * one_over_num_ring_atoms             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             gradU = Vec3()
 */
    __pyx_v_factor3 = ((__pyx_v_force_terms.nL / __pyx_v_force_terms.dL) * __pyx_v_one_over_num_ring_atoms);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2492")'> 2492: </pre>
<pre id='line2492' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2493")'> 2493:             gradU = Vec3()</pre>
<pre id='line2493' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2493
 *             factor3 = force_terms.nL / force_terms.dL * one_over_num_ring_atoms
 * 
 *             gradU = Vec3()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for axis in range(3):
 *                 gradU[axis] = factor * ((0.5 * ab[axis] - force_terms.ring_normal[axis] * one_over_num_ring_atoms) * force_terms.dLnL - force_terms.dn * (factor2 * c[axis] - factor3 * force_terms.d[axis]))
 */
    __pyx_v_gradU = Vec3();
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2494")'> 2494:             for axis in range(3):</pre>
<pre id='line2494' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2494
 * 
 *             gradU = Vec3()
 *             for axis in range(3):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 gradU[axis] = factor * ((0.5 * ab[axis] - force_terms.ring_normal[axis] * one_over_num_ring_atoms) * force_terms.dLnL - force_terms.dn * (factor2 * c[axis] - factor3 * force_terms.d[axis]))
 * 
 */
    for (__pyx_t_4 = 0; __pyx_t_4 <code><</code> 3; __pyx_t_4+=1) {
      __pyx_v_axis = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2495")'> 2495:                 gradU[axis] = factor * ((0.5 * ab[axis] - force_terms.ring_normal[axis] * one_over_num_ring_atoms) * force_terms.dLnL - force_terms.dn * (factor2 * c[axis] - factor3 * force_terms.d[axis]))</pre>
<pre id='line2495' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":2495
 *             gradU = Vec3()
 *             for axis in range(3):
 *                 gradU[axis] = factor * ((0.5 * ab[axis] - force_terms.ring_normal[axis] * one_over_num_ring_atoms) * force_terms.dLnL - force_terms.dn * (factor2 * c[axis] - factor3 * force_terms.d[axis]))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             gradV = Vec3()
 */
      (__pyx_v_gradU[__pyx_v_axis]) = (__pyx_v_factor * ((((0.5 * (__pyx_v_ab[__pyx_v_axis])) - ((__pyx_v_force_terms.ring_normal[__pyx_v_axis]) * __pyx_v_one_over_num_ring_atoms)) * __pyx_v_force_terms.dLnL) - (__pyx_v_force_terms.dn * ((__pyx_v_factor2 * (__pyx_v_c[__pyx_v_axis])) - (__pyx_v_factor3 * (__pyx_v_force_terms.d[__pyx_v_axis]))))));
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2496")'> 2496: </pre>
<pre id='line2496' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2497")'> 2497:             gradV = Vec3()</pre>
<pre id='line2497' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2497
 *                 gradU[axis] = factor * ((0.5 * ab[axis] - force_terms.ring_normal[axis] * one_over_num_ring_atoms) * force_terms.dLnL - force_terms.dn * (factor2 * c[axis] - factor3 * force_terms.d[axis]))
 * 
 *             gradV = Vec3()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             factor = -3 * force_terms.dL * one_over_num_ring_atoms
 *             for axis in range(3):
 */
    __pyx_v_gradV = Vec3();
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2498")'> 2498:             factor = -3 * force_terms.dL * one_over_num_ring_atoms</pre>
<pre id='line2498' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2498
 * 
 *             gradV = Vec3()
 *             factor = -3 * force_terms.dL * one_over_num_ring_atoms             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for axis in range(3):
 *                 gradV[axis] = factor * force_terms.d[axis]
 */
    __pyx_v_factor = ((-3.0 * __pyx_v_force_terms.dL) * __pyx_v_one_over_num_ring_atoms);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2499")'> 2499:             for axis in range(3):</pre>
<pre id='line2499' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2499
 *             gradV = Vec3()
 *             factor = -3 * force_terms.dL * one_over_num_ring_atoms
 *             for axis in range(3):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 gradV[axis] = factor * force_terms.d[axis]
 * 
 */
    for (__pyx_t_4 = 0; __pyx_t_4 <code><</code> 3; __pyx_t_4+=1) {
      __pyx_v_axis = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2500")'> 2500:                 gradV[axis] = factor * force_terms.d[axis]</pre>
<pre id='line2500' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":2500
 *             factor = -3 * force_terms.dL * one_over_num_ring_atoms
 *             for axis in range(3):
 *                 gradV[axis] = factor * force_terms.d[axis]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #TODO: rename force terms  sub_terms or vice versa
 */
      (__pyx_v_gradV[__pyx_v_axis]) = (__pyx_v_factor * (__pyx_v_force_terms.d[__pyx_v_axis]));
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2501")'> 2501: </pre>
<pre id='line2501' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2502")'> 2502: #TODO: rename force terms  sub_terms or vice versa</pre>
<pre id='line2502' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2503")'> 2503: </pre>
<pre id='line2503' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2504")'> 2504: #            ring_target_force_triplet = self._get_or_make_target_force_triplet(forces, ring_atom_id)</pre>
<pre id='line2504' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2505")'> 2505: </pre>
<pre id='line2505' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2506")'> 2506:             for axis in range(3):</pre>
<pre id='line2506' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2506
 * #            ring_target_force_triplet = self._get_or_make_target_force_triplet(forces, ring_atom_id)
 * 
 *             for axis in range(3):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 sub_term = (gradU[axis] * force_terms.dL3 - force_terms.u * gradV[axis])
 *                 sub_force = -force_factor * sub_term / force_terms.dL6
 */
    for (__pyx_t_4 = 0; __pyx_t_4 <code><</code> 3; __pyx_t_4+=1) {
      __pyx_v_axis = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2507")'> 2507:                 sub_term = (gradU[axis] * force_terms.dL3 - force_terms.u * gradV[axis])</pre>
<pre id='line2507' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":2507
 * 
 *             for axis in range(3):
 *                 sub_term = (gradU[axis] * force_terms.dL3 - force_terms.u * gradV[axis])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 sub_force = -force_factor * sub_term / force_terms.dL6
 *                 result[axis] = sub_force
 */
      __pyx_v_sub_term = (((__pyx_v_gradU[__pyx_v_axis]) * __pyx_v_force_terms.dL3) - (__pyx_v_force_terms.u * (__pyx_v_gradV[__pyx_v_axis])));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2508")'> 2508:                 sub_force = -force_factor * sub_term / force_terms.dL6</pre>
<pre id='line2508' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":2508
 *             for axis in range(3):
 *                 sub_term = (gradU[axis] * force_terms.dL3 - force_terms.u * gradV[axis])
 *                 sub_force = -force_factor * sub_term / force_terms.dL6             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 result[axis] = sub_force
 *             forces.add(ring_atom_id,result)
 */
      __pyx_v_sub_force = (((-__pyx_v_force_factor) * __pyx_v_sub_term) / __pyx_v_force_terms.dL6);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2509")'> 2509:                 result[axis] = sub_force</pre>
<pre id='line2509' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":2509
 *                 sub_term = (gradU[axis] * force_terms.dL3 - force_terms.u * gradV[axis])
 *                 sub_force = -force_factor * sub_term / force_terms.dL6
 *                 result[axis] = sub_force             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             forces.add(ring_atom_id,result)
 * 
 */
      (__pyx_v_result[__pyx_v_axis]) = __pyx_v_sub_force;
    }
</pre><pre class='line' style='background-color: #FFFF27' onclick='toggleDiv("line2510")'> 2510:             forces.add(ring_atom_id,result)</pre>
<pre id='line2510' class='code' style='background-color: #FFFF27'>
    /* "Cython_shift_calculator.pyx":2510
 *                 sub_force = -force_factor * sub_term / force_terms.dL6
 *                 result[axis] = sub_force
 *             forces.add(ring_atom_id,result)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_f_17shift_calculators_9Out_array_add(__pyx_v_forces, __pyx_v_ring_atom_id, __pyx_v_result);
  }

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_32Fast_non_bonded_shift_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_32Fast_non_bonded_shift_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED PyObject *__pyx_v_simulation = 0;
  CYTHON_UNUSED int __pyx_v_smoothed;
  CYTHON_UNUSED PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__simulation,&__pyx_n_s__smoothed,&__pyx_n_s__name,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__simulation)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__smoothed)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 3, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2540; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 3, 3, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2540; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2540; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_simulation = values[0];
    __pyx_v_smoothed = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_smoothed == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2540; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_name = ((PyObject*)values[2]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2540; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_non_bonded_shift_calculator.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&PyString_Type), 1, "name", 1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2540; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_32Fast_non_bonded_shift_calculator___cinit__(((struct __pyx_obj_17shift_calculators_Fast_non_bonded_shift_calculator *)__pyx_v_self), __pyx_v_simulation, __pyx_v_smoothed, __pyx_v_name);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2511")'> 2511: </pre>
<pre id='line2511' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2512")'> 2512: </pre>
<pre id='line2512' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2513")'> 2513: cdef class Fast_non_bonded_shift_calculator(Fast_distance_shift_calculator):</pre>
<pre id='line2513' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2513
 * 
 * 
 * cdef class Fast_non_bonded_shift_calculator(Fast_distance_shift_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef float _nb_cutoff
 */
struct __pyx_obj_17shift_calculators_Fast_non_bonded_shift_calculator {
  struct __pyx_obj_17shift_calculators_Fast_distance_shift_calculator __pyx_base;
  float _nb_cutoff;
  struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *_non_bonded_list;
  PyObject *_raw_target_data;
  struct __pyx_t_17shift_calculators_Non_bonded_target_component *_compiled_target_components;
  int _num_target_components;
  PyObject *_raw_remote_data;
  struct __pyx_t_17shift_calculators_Non_bonded_remote_atom_component *_compiled_remote_components;
  int _num_remote_components;
  PyObject *_raw_coefficient_data;
  struct __pyx_t_17shift_calculators_Nonbonded_coefficient_component *_compiled_coefficient_components;
  int _num_coefficient_components;
  int _component_offset;
};



/* "Cython_shift_calculator.pyx":2513
 * 
 * 
 * cdef class Fast_non_bonded_shift_calculator(Fast_distance_shift_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef float _nb_cutoff
 */

struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_shift_calculator {
  struct __pyx_vtabstruct_17shift_calculators_Fast_distance_shift_calculator __pyx_base;
  void (*_bytes_to_remote_components)(struct __pyx_obj_17shift_calculators_Fast_non_bonded_shift_calculator *, uintptr_t, uintptr_t);
  void (*_bytes_to_nonbonded_coefficient_components)(struct __pyx_obj_17shift_calculators_Fast_non_bonded_shift_calculator *, uintptr_t, uintptr_t);
  void (*_calc_single_component_shift)(struct __pyx_obj_17shift_calculators_Fast_non_bonded_shift_calculator *, int, int, CDSVector<code><</code>double> *, __Pyx_memviewslice);
};
static struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_shift_calculator *__pyx_vtabptr_17shift_calculators_Fast_non_bonded_shift_calculator;
static CYTHON_INLINE void __pyx_f_17shift_calculators_32Fast_non_bonded_shift_calculator__calc_single_component_shift(struct __pyx_obj_17shift_calculators_Fast_non_bonded_shift_calculator *, int, int, CDSVector<code><</code>double> *, __Pyx_memviewslice);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2514")'> 2514: </pre>
<pre id='line2514' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2515")'> 2515:     cdef float _nb_cutoff</pre>
<pre id='line2515' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2516")'> 2516: </pre>
<pre id='line2516' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2517")'> 2517:     cdef Non_bonded_interaction_list _non_bonded_list</pre>
<pre id='line2517' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2518")'> 2518: </pre>
<pre id='line2518' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2519")'> 2519: </pre>
<pre id='line2519' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2520")'> 2520:     #TODO: can we use memory views here...</pre>
<pre id='line2520' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2521")'> 2521:     cdef object _raw_target_data</pre>
<pre id='line2521' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2522")'> 2522:     cdef Non_bonded_target_component* _compiled_target_components</pre>
<pre id='line2522' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2523")'> 2523:     cdef int _num_target_components</pre>
<pre id='line2523' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2524")'> 2524: </pre>
<pre id='line2524' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2525")'> 2525: </pre>
<pre id='line2525' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2526")'> 2526:     #TODO: can we use memory views here...</pre>
<pre id='line2526' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2527")'> 2527:     cdef object _raw_remote_data</pre>
<pre id='line2527' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2528")'> 2528:     cdef Non_bonded_remote_atom_component* _compiled_remote_components</pre>
<pre id='line2528' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2529")'> 2529:     cdef int _num_remote_components</pre>
<pre id='line2529' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2530")'> 2530: </pre>
<pre id='line2530' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2531")'> 2531:     cdef object _raw_coefficient_data</pre>
<pre id='line2531' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2532")'> 2532:     cdef Nonbonded_coefficient_component* _compiled_coefficient_components</pre>
<pre id='line2532' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2533")'> 2533:     cdef int _num_coefficient_components</pre>
<pre id='line2533' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2534")'> 2534: </pre>
<pre id='line2534' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2535")'> 2535:     cdef int _component_offset</pre>
<pre id='line2535' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2536")'> 2536: </pre>
<pre id='line2536' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2537")'> 2537: </pre>
<pre id='line2537' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2538")'> 2538: </pre>
<pre id='line2538' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2539")'> 2539: </pre>
<pre id='line2539' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2540")'> 2540:     def __cinit__(self, simulation, bint smoothed, str name):</pre>
<pre id='line2540' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2540
 * 
 * 
 *     def __cinit__(self, simulation, bint smoothed, str name):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._non_bonded_list = None
 *         self._compiled_target_components =  NULL
 */

static int __pyx_pf_17shift_calculators_32Fast_non_bonded_shift_calculator___cinit__(struct __pyx_obj_17shift_calculators_Fast_non_bonded_shift_calculator *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_simulation, CYTHON_UNUSED int __pyx_v_smoothed, CYTHON_UNUSED PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2541")'> 2541:         self._non_bonded_list = None</pre>
<pre id='line2541' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":2541
 * 
 *     def __cinit__(self, simulation, bint smoothed, str name):
 *         self._non_bonded_list = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_target_components =  NULL
 *         self._compiled_remote_components = NULL
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_non_bonded_list);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_non_bonded_list));
  __pyx_v_self->_non_bonded_list = ((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)Py_None);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2542")'> 2542:         self._compiled_target_components =  NULL</pre>
<pre id='line2542' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2542
 *     def __cinit__(self, simulation, bint smoothed, str name):
 *         self._non_bonded_list = None
 *         self._compiled_target_components =  NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_remote_components = NULL
 *         self._compiled_coefficient_components = NULL
 */
  __pyx_v_self->_compiled_target_components = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2543")'> 2543:         self._compiled_remote_components = NULL</pre>
<pre id='line2543' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2543
 *         self._non_bonded_list = None
 *         self._compiled_target_components =  NULL
 *         self._compiled_remote_components = NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_coefficient_components = NULL
 *         self. _component_offset = 0
 */
  __pyx_v_self->_compiled_remote_components = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2544")'> 2544:         self._compiled_coefficient_components = NULL</pre>
<pre id='line2544' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2544
 *         self._compiled_target_components =  NULL
 *         self._compiled_remote_components = NULL
 *         self._compiled_coefficient_components = NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self. _component_offset = 0
 * 
 */
  __pyx_v_self->_compiled_coefficient_components = NULL;
</pre><pre class='line' style='background-color: #FFFF27' onclick='toggleDiv("line2545")'> 2545:         self. _component_offset = 0</pre>
<pre id='line2545' class='code' style='background-color: #FFFF27'>
  /* "Cython_shift_calculator.pyx":2545
 *         self._compiled_remote_components = NULL
 *         self._compiled_coefficient_components = NULL
 *         self. _component_offset = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __init__(self, simulation, bint smoothed, str name):
 */
  __pyx_v_self->_component_offset = 0;

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_32Fast_non_bonded_shift_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_32Fast_non_bonded_shift_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_simulation = 0;
  int __pyx_v_smoothed;
  PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__simulation,&__pyx_n_s__smoothed,&__pyx_n_s__name,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__simulation)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__smoothed)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 3, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2547; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 3, 3, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2547; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2547; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_simulation = values[0];
    __pyx_v_smoothed = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_smoothed == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2547; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_name = ((PyObject*)values[2]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2547; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_non_bonded_shift_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&PyString_Type), 1, "name", 1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2547; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_32Fast_non_bonded_shift_calculator_2__init__(((struct __pyx_obj_17shift_calculators_Fast_non_bonded_shift_calculator *)__pyx_v_self), __pyx_v_simulation, __pyx_v_smoothed, __pyx_v_name);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2546")'> 2546: </pre>
<pre id='line2546' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2547")'> 2547:     def __init__(self, simulation, bint smoothed, str name):</pre>
<pre id='line2547' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2547
 *         self. _component_offset = 0
 * 
 *     def __init__(self, simulation, bint smoothed, str name):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         super(Fast_non_bonded_shift_calculator, self).__init__(simulation, smoothed,name)
 *         self._simulation = simulationAsNative(simulation)
 */

static int __pyx_pf_17shift_calculators_32Fast_non_bonded_shift_calculator_2__init__(struct __pyx_obj_17shift_calculators_Fast_non_bonded_shift_calculator *__pyx_v_self, PyObject *__pyx_v_simulation, int __pyx_v_smoothed, PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFF2f' onclick='toggleDiv("line2548")'> 2548:         super(Fast_non_bonded_shift_calculator, self).__init__(simulation, smoothed,name)</pre>
<pre id='line2548' class='code' style='background-color: #FFFF2f'>
  /* "Cython_shift_calculator.pyx":2548
 * 
 *     def __init__(self, simulation, bint smoothed, str name):
 *         super(Fast_non_bonded_shift_calculator, self).__init__(simulation, smoothed,name)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._simulation = simulationAsNative(simulation)
 *         global DEFAULT_NB_CUTOFF
 */
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2548; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Fast_non_bonded_shift_calculator)));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Fast_non_bonded_shift_calculator)));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Fast_non_bonded_shift_calculator)));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_self));
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_super, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2548; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s____init__);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2548; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(__pyx_v_smoothed);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2548; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2548; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simulation);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_simulation);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_simulation);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_name));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, ((PyObject *)__pyx_v_name));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_name));
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2548; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2549")'> 2549:         self._simulation = simulationAsNative(simulation)</pre>
<pre id='line2549' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2549
 *     def __init__(self, simulation, bint smoothed, str name):
 *         super(Fast_non_bonded_shift_calculator, self).__init__(simulation, smoothed,name)
 *         self._simulation = simulationAsNative(simulation)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         global DEFAULT_NB_CUTOFF
 *         self._nb_cutoff = DEFAULT_NB_CUTOFF
 */
  __pyx_t_4 = __pyx_f_17shift_calculators_simulationAsNative(__pyx_v_simulation);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2549; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->__pyx_base.__pyx_base._simulation = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2550")'> 2550:         global DEFAULT_NB_CUTOFF</pre>
<pre id='line2550' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line2551")'> 2551:         self._nb_cutoff = DEFAULT_NB_CUTOFF</pre>
<pre id='line2551' class='code' style='background-color: #FFFF96'>
  /* "Cython_shift_calculator.pyx":2551
 *         self._simulation = simulationAsNative(simulation)
 *         global DEFAULT_NB_CUTOFF
 *         self._nb_cutoff = DEFAULT_NB_CUTOFF             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def set_verbose(self,on):
 */
  __pyx_v_self->_nb_cutoff = __pyx_v_17shift_calculators_DEFAULT_NB_CUTOFF;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_non_bonded_shift_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_32Fast_non_bonded_shift_calculator_5set_verbose(PyObject *__pyx_v_self, PyObject *__pyx_v_on); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_32Fast_non_bonded_shift_calculator_5set_verbose(PyObject *__pyx_v_self, PyObject *__pyx_v_on) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_verbose (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_32Fast_non_bonded_shift_calculator_4set_verbose(((struct __pyx_obj_17shift_calculators_Fast_non_bonded_shift_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_on));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2552")'> 2552: </pre>
<pre id='line2552' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2553")'> 2553:     def set_verbose(self,on):</pre>
<pre id='line2553' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2553
 *         self._nb_cutoff = DEFAULT_NB_CUTOFF
 * 
 *     def set_verbose(self,on):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._verbose = on
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_32Fast_non_bonded_shift_calculator_4set_verbose(struct __pyx_obj_17shift_calculators_Fast_non_bonded_shift_calculator *__pyx_v_self, PyObject *__pyx_v_on) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_verbose", 0);
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line2554")'> 2554:         self._verbose = on</pre>
<pre id='line2554' class='code' style='background-color: #FFFF6a'>
  /* "Cython_shift_calculator.pyx":2554
 * 
 *     def set_verbose(self,on):
 *         self._verbose = on             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     #TODO: use global version
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_v_on);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2554; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->__pyx_base.__pyx_base._verbose = __pyx_t_1;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_non_bonded_shift_calculator.set_verbose", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2555")'> 2555: </pre>
<pre id='line2555' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2556")'> 2556:     #TODO: use global version</pre>
<pre id='line2556' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2557")'> 2557:     cdef void _bytes_to_components(self,uintptr_t data, uintptr_t length) nogil:</pre>
<pre id='line2557' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2557
 * 
 *     #TODO: use global version
 *     cdef void _bytes_to_components(self,uintptr_t data, uintptr_t length) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_target_components =  <code><</code>Non_bonded_target_component*> <code><</code>size_t> data
 *         self._num_target_components =  length
 */

static void __pyx_f_17shift_calculators_32Fast_non_bonded_shift_calculator__bytes_to_components(struct __pyx_obj_17shift_calculators_Fast_non_bonded_shift_calculator *__pyx_v_self, uintptr_t __pyx_v_data, uintptr_t __pyx_v_length) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2558")'> 2558:         self._compiled_target_components =  &lt;Non_bonded_target_component*&gt; &lt;size_t&gt; data</pre>
<pre id='line2558' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2558
 *     #TODO: use global version
 *     cdef void _bytes_to_components(self,uintptr_t data, uintptr_t length) nogil:
 *         self._compiled_target_components =  <code><</code>Non_bonded_target_component*> <code><</code>size_t> data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_target_components =  length
 * 
 */
  __pyx_v_self->_compiled_target_components = ((struct __pyx_t_17shift_calculators_Non_bonded_target_component *)((size_t)__pyx_v_data));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2559")'> 2559:         self._num_target_components =  length</pre>
<pre id='line2559' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2559
 *     cdef void _bytes_to_components(self,uintptr_t data, uintptr_t length) nogil:
 *         self._compiled_target_components =  <code><</code>Non_bonded_target_component*> <code><</code>size_t> data
 *         self._num_target_components =  length             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     #TODO: use global version
 */
  __pyx_v_self->_num_target_components = __pyx_v_length;

}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2560")'> 2560: </pre>
<pre id='line2560' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2561")'> 2561:     #TODO: use global version</pre>
<pre id='line2561' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2562")'> 2562:     cdef void _bytes_to_remote_components(self, uintptr_t data, uintptr_t length) nogil:</pre>
<pre id='line2562' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2562
 * 
 *     #TODO: use global version
 *     cdef void _bytes_to_remote_components(self, uintptr_t data, uintptr_t length) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_remote_components =  <code><</code>Non_bonded_remote_atom_component*> <code><</code>size_t> data
 *         self._num_remote_components =  length
 */

static void __pyx_f_17shift_calculators_32Fast_non_bonded_shift_calculator__bytes_to_remote_components(struct __pyx_obj_17shift_calculators_Fast_non_bonded_shift_calculator *__pyx_v_self, uintptr_t __pyx_v_data, uintptr_t __pyx_v_length) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2563")'> 2563:         self._compiled_remote_components =  &lt;Non_bonded_remote_atom_component*&gt; &lt;size_t&gt; data</pre>
<pre id='line2563' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2563
 *     #TODO: use global version
 *     cdef void _bytes_to_remote_components(self, uintptr_t data, uintptr_t length) nogil:
 *         self._compiled_remote_components =  <code><</code>Non_bonded_remote_atom_component*> <code><</code>size_t> data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_remote_components =  length
 * 
 */
  __pyx_v_self->_compiled_remote_components = ((struct __pyx_t_17shift_calculators_Non_bonded_remote_atom_component *)((size_t)__pyx_v_data));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2564")'> 2564:         self._num_remote_components =  length</pre>
<pre id='line2564' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2564
 *     cdef void _bytes_to_remote_components(self, uintptr_t data, uintptr_t length) nogil:
 *         self._compiled_remote_components =  <code><</code>Non_bonded_remote_atom_component*> <code><</code>size_t> data
 *         self._num_remote_components =  length             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void _bytes_to_nonbonded_coefficient_components(self, uintptr_t data, uintptr_t length) nogil:
 */
  __pyx_v_self->_num_remote_components = __pyx_v_length;

}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2565")'> 2565: </pre>
<pre id='line2565' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2566")'> 2566:     cdef void _bytes_to_nonbonded_coefficient_components(self, uintptr_t data, uintptr_t length) nogil:</pre>
<pre id='line2566' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2566
 *         self._num_remote_components =  length
 * 
 *     cdef void _bytes_to_nonbonded_coefficient_components(self, uintptr_t data, uintptr_t length) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_coefficient_components =  <code><</code>Nonbonded_coefficient_component*> <code><</code>size_t> data
 *         self._num_coefficient_components =  length
 */

static void __pyx_f_17shift_calculators_32Fast_non_bonded_shift_calculator__bytes_to_nonbonded_coefficient_components(struct __pyx_obj_17shift_calculators_Fast_non_bonded_shift_calculator *__pyx_v_self, uintptr_t __pyx_v_data, uintptr_t __pyx_v_length) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2567")'> 2567:         self._compiled_coefficient_components =  &lt;Nonbonded_coefficient_component*&gt; &lt;size_t&gt; data</pre>
<pre id='line2567' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2567
 * 
 *     cdef void _bytes_to_nonbonded_coefficient_components(self, uintptr_t data, uintptr_t length) nogil:
 *         self._compiled_coefficient_components =  <code><</code>Nonbonded_coefficient_component*> <code><</code>size_t> data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_coefficient_components =  length
 * 
 */
  __pyx_v_self->_compiled_coefficient_components = ((struct __pyx_t_17shift_calculators_Nonbonded_coefficient_component *)((size_t)__pyx_v_data));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2568")'> 2568:         self._num_coefficient_components =  length</pre>
<pre id='line2568' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2568
 *     cdef void _bytes_to_nonbonded_coefficient_components(self, uintptr_t data, uintptr_t length) nogil:
 *         self._compiled_coefficient_components =  <code><</code>Nonbonded_coefficient_component*> <code><</code>size_t> data
 *         self._num_coefficient_components =  length             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void _set_components(self, cmap[int, uintptr_t] *components) nogil:
 */
  __pyx_v_self->_num_coefficient_components = __pyx_v_length;

}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2569")'> 2569: </pre>
<pre id='line2569' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2570")'> 2570:     cdef void _set_components(self, cmap[int, uintptr_t] *components) nogil:</pre>
<pre id='line2570' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2570
 *         self._num_coefficient_components =  length
 * 
 *     cdef void _set_components(self, cmap[int, uintptr_t] *components) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         Fast_distance_shift_calculator._set_components(self,components)
 *         with gil:
 */

static void __pyx_f_17shift_calculators_32Fast_non_bonded_shift_calculator__set_components(struct __pyx_obj_17shift_calculators_Fast_non_bonded_shift_calculator *__pyx_v_self, std::map<code><</code>int,uintptr_t> *__pyx_v_components) {
  #ifdef WITH_THREAD
  PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
  #endif
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_components", 0);
  #ifdef WITH_THREAD
  PyGILState_Release(__pyx_gilstate_save);
  #endif
  /*try:*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2571")'> 2571:         Fast_distance_shift_calculator._set_components(self,components)</pre>
<pre id='line2571' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2571
 * 
 *     cdef void _set_components(self, cmap[int, uintptr_t] *components) nogil:
 *         Fast_distance_shift_calculator._set_components(self,components)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         with gil:
 *             self._non_bonded_list =  <code><</code>Non_bonded_interaction_list>components[0][NBLT]
 */
    __pyx_vtabptr_17shift_calculators_Fast_distance_shift_calculator->__pyx_base._set_components(((struct __pyx_obj_17shift_calculators_Base_shift_calculator *)__pyx_v_self), __pyx_v_components);

  /* "Cython_shift_calculator.pyx":2571
 * 
 *     cdef void _set_components(self, cmap[int, uintptr_t] *components) nogil:
 *         Fast_distance_shift_calculator._set_components(self,components)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         with gil:
 *             self._non_bonded_list =  <code><</code>Non_bonded_interaction_list>components[0][NBLT]
 */
  /*finally:*/ {
    #ifdef WITH_THREAD
    __pyx_gilstate_save = PyGILState_Ensure();
    #endif
  }

  #ifdef WITH_THREAD
  PyGILState_Release(__pyx_gilstate_save);
  #endif
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2572")'> 2572:         with gil:</pre>
<pre id='line2572' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2572
 *     cdef void _set_components(self, cmap[int, uintptr_t] *components) nogil:
 *         Fast_distance_shift_calculator._set_components(self,components)
 *         with gil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._non_bonded_list =  <code><</code>Non_bonded_interaction_list>components[0][NBLT]
 * 
 */
    {
        #ifdef WITH_THREAD
        PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
        #endif
        /*try:*/ {

        /* "Cython_shift_calculator.pyx":2572
 *     cdef void _set_components(self, cmap[int, uintptr_t] *components) nogil:
 *         Fast_distance_shift_calculator._set_components(self,components)
 *         with gil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._non_bonded_list =  <code><</code>Non_bonded_interaction_list>components[0][NBLT]
 * 
 */
        /*finally:*/ {
          #ifdef WITH_THREAD
          PyGILState_Release(__pyx_gilstate_save);
          #endif
        }
    }
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2573")'> 2573:             self._non_bonded_list =  &lt;Non_bonded_interaction_list&gt;components[0][NBLT]</pre>
<pre id='line2573' class='code' style='background-color: #FFFFd4'>
          /* "Cython_shift_calculator.pyx":2573
 *         Fast_distance_shift_calculator._set_components(self,components)
 *         with gil:
 *             self._non_bonded_list =  <code><</code>Non_bonded_interaction_list>components[0][NBLT]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._bytes_to_remote_components(components[0][NBRM], components[0][NNBRM])
 */
          __pyx_t_1 = ((__pyx_v_components[0])[__pyx_v_17shift_calculators_NBLT]);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)__pyx_t_1)));
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_1));
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_non_bonded_list);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_non_bonded_list));
          __pyx_v_self->_non_bonded_list = ((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)__pyx_t_1);
        }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2574")'> 2574: </pre>
<pre id='line2574' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2575")'> 2575:         self._bytes_to_remote_components(components[0][NBRM], components[0][NNBRM])</pre>
<pre id='line2575' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2575
 *             self._non_bonded_list =  <code><</code>Non_bonded_interaction_list>components[0][NBLT]
 * 
 *         self._bytes_to_remote_components(components[0][NBRM], components[0][NNBRM])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._bytes_to_nonbonded_coefficient_components(components[0][COEF],components[0][NCOEF])
 * 
 */
    ((struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_shift_calculator *)__pyx_v_self->__pyx_base.__pyx_base.__pyx_vtab)->_bytes_to_remote_components(__pyx_v_self, ((__pyx_v_components[0])[__pyx_v_17shift_calculators_NBRM]), ((__pyx_v_components[0])[__pyx_v_17shift_calculators_NNBRM]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2576")'> 2576:         self._bytes_to_nonbonded_coefficient_components(components[0][COEF],components[0][NCOEF])</pre>
<pre id='line2576' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2576
 * 
 *         self._bytes_to_remote_components(components[0][NBRM], components[0][NNBRM])
 *         self._bytes_to_nonbonded_coefficient_components(components[0][COEF],components[0][NCOEF])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._component_offset = components[0][OFFS]
 */
    ((struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_shift_calculator *)__pyx_v_self->__pyx_base.__pyx_base.__pyx_vtab)->_bytes_to_nonbonded_coefficient_components(__pyx_v_self, ((__pyx_v_components[0])[__pyx_v_17shift_calculators_COEF]), ((__pyx_v_components[0])[__pyx_v_17shift_calculators_NCOEF]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2577")'> 2577: </pre>
<pre id='line2577' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2578")'> 2578:         self._component_offset = components[0][OFFS]</pre>
<pre id='line2578' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2578
 *         self._bytes_to_nonbonded_coefficient_components(components[0][COEF],components[0][NCOEF])
 * 
 *         self._component_offset = components[0][OFFS]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_v_self->_component_offset = ((__pyx_v_components[0])[__pyx_v_17shift_calculators_OFFS]);
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2579")'> 2579: </pre>
<pre id='line2579' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2580")'> 2580: </pre>
<pre id='line2580' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2581")'> 2581: </pre>
<pre id='line2581' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2582")'> 2582: </pre>
<pre id='line2582' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2583")'> 2583:     cdef void calc(self, cmap[int,uintptr_t] *components, CDSSharedVectorFloat shift_cache, int[:] component_to_target, int[:] active_components) nogil:</pre>
<pre id='line2583' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2583
 * 
 * 
 *     cdef void calc(self, cmap[int,uintptr_t] *components, CDSSharedVectorFloat shift_cache, int[:] component_to_target, int[:] active_components) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._set_components(components)
 */

static void __pyx_f_17shift_calculators_32Fast_non_bonded_shift_calculator_calc(struct __pyx_obj_17shift_calculators_Fast_non_bonded_shift_calculator *__pyx_v_self, std::map<code><</code>int,uintptr_t> *__pyx_v_components, struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_shift_cache, __Pyx_memviewslice __pyx_v_component_to_target, __Pyx_memviewslice __pyx_v_active_components) {
  CDSVector<code><</code>double> *__pyx_v_results;
  int __pyx_v_non_bonded_index;
  Py_ssize_t __pyx_v_factor_index;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2584")'> 2584: </pre>
<pre id='line2584' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2585")'> 2585:         self._set_components(components)</pre>
<pre id='line2585' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2585
 *     cdef void calc(self, cmap[int,uintptr_t] *components, CDSSharedVectorFloat shift_cache, int[:] component_to_target, int[:] active_components) nogil:
 * 
 *         self._set_components(components)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef CDSVector[double]  *results = shift_cache.get_data()
 */
  ((struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_shift_calculator *)__pyx_v_self->__pyx_base.__pyx_base.__pyx_vtab)->__pyx_base.__pyx_base._set_components(((struct __pyx_obj_17shift_calculators_Base_shift_calculator *)__pyx_v_self), __pyx_v_components);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2586")'> 2586: </pre>
<pre id='line2586' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2587")'> 2587:         cdef CDSVector[double]  *results = shift_cache.get_data()</pre>
<pre id='line2587' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2587
 *         self._set_components(components)
 * 
 *         cdef CDSVector[double]  *results = shift_cache.get_data()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int non_bonded_index
 * 
 */
  __pyx_v_results = ((struct __pyx_vtabstruct_17shift_calculators_CDSSharedVectorFloat *)__pyx_v_shift_cache->__pyx_vtab)->get_data(__pyx_v_shift_cache);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2588")'> 2588:         cdef int non_bonded_index</pre>
<pre id='line2588' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2589")'> 2589: </pre>
<pre id='line2589' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2590")'> 2590:         if active_components == None:</pre>
<pre id='line2590' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2590
 *         cdef int non_bonded_index
 * 
 *         if active_components == None:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for non_bonded_index in range(self._non_bonded_list.get_length()):
 * #                 print non_bonded_index
 */
  __pyx_t_1 = (((PyObject *) __pyx_v_active_components.memview) == Py_None);
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2591")'> 2591:             for non_bonded_index in range(self._non_bonded_list.get_length()):</pre>
<pre id='line2591' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2591
 * 
 *         if active_components == None:
 *             for non_bonded_index in range(self._non_bonded_list.get_length()):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #                 print non_bonded_index
 *                 self._calc_single_component_shift(non_bonded_index, non_bonded_index, results, component_to_target)
 */
    __pyx_t_2 = ((struct __pyx_vtabstruct_17shift_calculators_Non_bonded_interaction_list *)__pyx_v_self->_non_bonded_list->__pyx_vtab)->get_length(__pyx_v_self->_non_bonded_list);
    for (__pyx_t_3 = 0; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
      __pyx_v_non_bonded_index = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2592")'> 2592: #                 print non_bonded_index</pre>
<pre id='line2592' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2593")'> 2593:                 self._calc_single_component_shift(non_bonded_index, non_bonded_index, results, component_to_target)</pre>
<pre id='line2593' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":2593
 *             for non_bonded_index in range(self._non_bonded_list.get_length()):
 * #                 print non_bonded_index
 *                 self._calc_single_component_shift(non_bonded_index, non_bonded_index, results, component_to_target)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             for factor_index  in range(active_components.shape[0]):
 */
      __pyx_f_17shift_calculators_32Fast_non_bonded_shift_calculator__calc_single_component_shift(__pyx_v_self, __pyx_v_non_bonded_index, __pyx_v_non_bonded_index, __pyx_v_results, __pyx_v_component_to_target);
    }
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2594")'> 2594:         else:</pre>
<pre id='line2594' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2595")'> 2595:             for factor_index  in range(active_components.shape[0]):</pre>
<pre id='line2595' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2595
 *                 self._calc_single_component_shift(non_bonded_index, non_bonded_index, results, component_to_target)
 *         else:
 *             for factor_index  in range(active_components.shape[0]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 non_bonded_index = active_components[factor_index]
 * #                 print factor_index, non_bonded_index
 */
    __pyx_t_4 = (__pyx_v_active_components.shape[0]);
    for (__pyx_t_5 = 0; __pyx_t_5 <code><</code> __pyx_t_4; __pyx_t_5+=1) {
      __pyx_v_factor_index = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2596")'> 2596:                 non_bonded_index = active_components[factor_index]</pre>
<pre id='line2596' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":2596
 *         else:
 *             for factor_index  in range(active_components.shape[0]):
 *                 non_bonded_index = active_components[factor_index]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #                 print factor_index, non_bonded_index
 *                 self._calc_single_component_shift(factor_index, non_bonded_index, results, component_to_target)
 */
      __pyx_t_6 = __pyx_v_factor_index;
      __pyx_v_non_bonded_index = (*((int *) ( /* dim=0 */ (__pyx_v_active_components.data + __pyx_t_6 * __pyx_v_active_components.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2597")'> 2597: #                 print factor_index, non_bonded_index</pre>
<pre id='line2597' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2598")'> 2598:                 self._calc_single_component_shift(factor_index, non_bonded_index, results, component_to_target)</pre>
<pre id='line2598' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":2598
 *                 non_bonded_index = active_components[factor_index]
 * #                 print factor_index, non_bonded_index
 *                 self._calc_single_component_shift(factor_index, non_bonded_index, results, component_to_target)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
      __pyx_f_17shift_calculators_32Fast_non_bonded_shift_calculator__calc_single_component_shift(__pyx_v_self, __pyx_v_factor_index, __pyx_v_non_bonded_index, __pyx_v_results, __pyx_v_component_to_target);
    }
  }
  __pyx_L3:;

}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2599")'> 2599: </pre>
<pre id='line2599' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2600")'> 2600: </pre>
<pre id='line2600' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2601")'> 2601:     cdef inline void  _calc_single_component_shift(self,int factor_index, int non_bonded_index, CDSVector[double]*  results, int[:] component_to_target) nogil:</pre>
<pre id='line2601' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2601
 * 
 * 
 *     cdef inline void  _calc_single_component_shift(self,int factor_index, int non_bonded_index, CDSVector[double]*  results, int[:] component_to_target) nogil:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Component_index_pair* non_bonded_pair
 * 
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_32Fast_non_bonded_shift_calculator__calc_single_component_shift(struct __pyx_obj_17shift_calculators_Fast_non_bonded_shift_calculator *__pyx_v_self, CYTHON_UNUSED int __pyx_v_factor_index, int __pyx_v_non_bonded_index, CDSVector<code><</code>double> *__pyx_v_results, __Pyx_memviewslice __pyx_v_component_to_target) {
  struct __pyx_t_17shift_calculators_Component_index_pair *__pyx_v_non_bonded_pair;
  int __pyx_v_target_component_index;
  int __pyx_v_remote_component_index;
  int __pyx_v_target_index;
  int __pyx_v_remote_index;
  float __pyx_v_distance;
  int __pyx_v_chem_type_id;
  float __pyx_v_default_smoothing_factor;
  float __pyx_v_smoothing_factor;
  float __pyx_v_ratio;
  int __pyx_v_atom_1_coefficent_offset;
  float __pyx_v_coefficient;
  float __pyx_v_exponent;
  int __pyx_v_component_offset;
  int __pyx_v_offset;
  long __pyx_v_i;
  struct __pyx_t_17shift_calculators_Nonbonded_coefficient_component *__pyx_v_coefficient_component;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2602")'> 2602:         cdef Component_index_pair* non_bonded_pair</pre>
<pre id='line2602' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2603")'> 2603: </pre>
<pre id='line2603' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2604")'> 2604:         cdef int target_component_index</pre>
<pre id='line2604' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2605")'> 2605:         cdef int remote_component_index</pre>
<pre id='line2605' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2606")'> 2606: </pre>
<pre id='line2606' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2607")'> 2607:         cdef int target_index</pre>
<pre id='line2607' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2608")'> 2608:         cdef int remote_index</pre>
<pre id='line2608' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2609")'> 2609: </pre>
<pre id='line2609' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2610")'> 2610:         cdef float distance</pre>
<pre id='line2610' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2611")'> 2611: </pre>
<pre id='line2611' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2612")'> 2612:         cdef int chem_type_id</pre>
<pre id='line2612' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2613")'> 2613: </pre>
<pre id='line2613' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2614")'> 2614:         cdef float default_smoothing_factor = self._smoothing_factor</pre>
<pre id='line2614' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2614
 *         cdef int chem_type_id
 * 
 *         cdef float default_smoothing_factor = self._smoothing_factor             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef float smoothing_factor
 * 
 */
  __pyx_t_1 = __pyx_v_self->__pyx_base._smoothing_factor;
  __pyx_v_default_smoothing_factor = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2615")'> 2615:         cdef float smoothing_factor</pre>
<pre id='line2615' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2616")'> 2616: </pre>
<pre id='line2616' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2617")'> 2617:         cdef float ratio</pre>
<pre id='line2617' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2618")'> 2618: </pre>
<pre id='line2618' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2619")'> 2619:         cdef int atom_1_coefficent_offset</pre>
<pre id='line2619' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2620")'> 2620: </pre>
<pre id='line2620' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2621")'> 2621:         cdef float coefficient,exponent</pre>
<pre id='line2621' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2622")'> 2622: </pre>
<pre id='line2622' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2623")'> 2623:         cdef Nonbonded_coefficient_component* coefficent_component</pre>
<pre id='line2623' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2624")'> 2624:         cdef int component_offset</pre>
<pre id='line2624' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2625")'> 2625:         cdef int offset</pre>
<pre id='line2625' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2626")'> 2626: </pre>
<pre id='line2626' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2627")'> 2627: </pre>
<pre id='line2627' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2628")'> 2628:         non_bonded_pair  =  self._non_bonded_list.get(non_bonded_index)</pre>
<pre id='line2628' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2628
 * 
 * 
 *         non_bonded_pair  =  self._non_bonded_list.get(non_bonded_index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         target_component_index = non_bonded_pair[0].target_index
 */
  __pyx_v_non_bonded_pair = __pyx_f_17shift_calculators_27Non_bonded_interaction_list_get(__pyx_v_self->_non_bonded_list, __pyx_v_non_bonded_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2629")'> 2629: </pre>
<pre id='line2629' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2630")'> 2630:         target_component_index = non_bonded_pair[0].target_index</pre>
<pre id='line2630' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2630
 *         non_bonded_pair  =  self._non_bonded_list.get(non_bonded_index)
 * 
 *         target_component_index = non_bonded_pair[0].target_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         remote_component_index = non_bonded_pair[0].remote_index
 * 
 */
  __pyx_t_2 = (__pyx_v_non_bonded_pair[0]).target_index;
  __pyx_v_target_component_index = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2631")'> 2631:         remote_component_index = non_bonded_pair[0].remote_index</pre>
<pre id='line2631' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2631
 * 
 *         target_component_index = non_bonded_pair[0].target_index
 *         remote_component_index = non_bonded_pair[0].remote_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         target_index  = self._compiled_target_components[target_component_index].target_atom_id
 */
  __pyx_t_2 = (__pyx_v_non_bonded_pair[0]).remote_index;
  __pyx_v_remote_component_index = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2632")'> 2632: </pre>
<pre id='line2632' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2633")'> 2633:         target_index  = self._compiled_target_components[target_component_index].target_atom_id</pre>
<pre id='line2633' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2633
 *         remote_component_index = non_bonded_pair[0].remote_index
 * 
 *         target_index  = self._compiled_target_components[target_component_index].target_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         remote_index = self._compiled_remote_components[remote_component_index].remote_atom_id
 * 
 */
  __pyx_t_2 = (__pyx_v_self->_compiled_target_components[__pyx_v_target_component_index]).target_atom_id;
  __pyx_v_target_index = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2634")'> 2634:         remote_index = self._compiled_remote_components[remote_component_index].remote_atom_id</pre>
<pre id='line2634' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2634
 * 
 *         target_index  = self._compiled_target_components[target_component_index].target_atom_id
 *         remote_index = self._compiled_remote_components[remote_component_index].remote_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         distance = calc_distance_simulation(self._simulation, target_index, remote_index)
 */
  __pyx_t_2 = (__pyx_v_self->_compiled_remote_components[__pyx_v_remote_component_index]).remote_atom_id;
  __pyx_v_remote_index = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2635")'> 2635: </pre>
<pre id='line2635' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2636")'> 2636:         distance = calc_distance_simulation(self._simulation, target_index, remote_index)</pre>
<pre id='line2636' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2636
 *         remote_index = self._compiled_remote_components[remote_component_index].remote_atom_id
 * 
 *         distance = calc_distance_simulation(self._simulation, target_index, remote_index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         component_offset = self._component_offset + non_bonded_pair[0].component_index
 */
  __pyx_v_distance = __pyx_f_17shift_calculators_calc_distance_simulation(__pyx_v_self->__pyx_base.__pyx_base._simulation, __pyx_v_target_index, __pyx_v_remote_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2637")'> 2637: </pre>
<pre id='line2637' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2638")'> 2638:         component_offset = self._component_offset + non_bonded_pair[0].component_index</pre>
<pre id='line2638' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2638
 *         distance = calc_distance_simulation(self._simulation, target_index, remote_index)
 * 
 *         component_offset = self._component_offset + non_bonded_pair[0].component_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if distance <code><</code> self._nb_cutoff:
 */
  __pyx_v_component_offset = (__pyx_v_self->_component_offset + (__pyx_v_non_bonded_pair[0]).component_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2639")'> 2639: </pre>
<pre id='line2639' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2640")'> 2640:         if distance &lt; self._nb_cutoff:</pre>
<pre id='line2640' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2640
 *         component_offset = self._component_offset + non_bonded_pair[0].component_index
 * 
 *         if distance <code><</code> self._nb_cutoff:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             atom_1_coefficent_offset = self._compiled_target_components[target_component_index].atom_type_id
 */
  __pyx_t_3 = (__pyx_v_distance <code><</code> __pyx_v_self->_nb_cutoff);
  if (__pyx_t_3) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2641")'> 2641: </pre>
<pre id='line2641' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2642")'> 2642:             atom_1_coefficent_offset = self._compiled_target_components[target_component_index].atom_type_id</pre>
<pre id='line2642' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2642
 *         if distance <code><</code> self._nb_cutoff:
 * 
 *             atom_1_coefficent_offset = self._compiled_target_components[target_component_index].atom_type_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             for i in range(2):
 */
    __pyx_t_2 = (__pyx_v_self->_compiled_target_components[__pyx_v_target_component_index]).atom_type_id;
    __pyx_v_atom_1_coefficent_offset = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2643")'> 2643: </pre>
<pre id='line2643' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2644")'> 2644:             for i in range(2):</pre>
<pre id='line2644' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2644
 *             atom_1_coefficent_offset = self._compiled_target_components[target_component_index].atom_type_id
 * 
 *             for i in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 chem_type_id = self._compiled_remote_components[remote_component_index].chem_type[i]
 * 
 */
    for (__pyx_t_4 = 0; __pyx_t_4 <code><</code> 2; __pyx_t_4+=1) {
      __pyx_v_i = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2645")'> 2645:                 chem_type_id = self._compiled_remote_components[remote_component_index].chem_type[i]</pre>
<pre id='line2645' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":2645
 * 
 *             for i in range(2):
 *                 chem_type_id = self._compiled_remote_components[remote_component_index].chem_type[i]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 coefficient_component = &self._compiled_coefficient_components[chem_type_id]
 */
      __pyx_v_chem_type_id = ((__pyx_v_self->_compiled_remote_components[__pyx_v_remote_component_index]).chem_type[__pyx_v_i]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2646")'> 2646: </pre>
<pre id='line2646' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2647")'> 2647:                 coefficient_component = &amp;self._compiled_coefficient_components[chem_type_id]</pre>
<pre id='line2647' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":2647
 *                 chem_type_id = self._compiled_remote_components[remote_component_index].chem_type[i]
 * 
 *                 coefficient_component = &self._compiled_coefficient_components[chem_type_id]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 exponent = coefficient_component[0].exponent
 */
      __pyx_v_coefficient_component = (&(__pyx_v_self->_compiled_coefficient_components[__pyx_v_chem_type_id]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2648")'> 2648: </pre>
<pre id='line2648' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2649")'> 2649:                 exponent = coefficient_component[0].exponent</pre>
<pre id='line2649' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":2649
 *                 coefficient_component = &self._compiled_coefficient_components[chem_type_id]
 * 
 *                 exponent = coefficient_component[0].exponent             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 coefficient  = coefficient_component[0].coefficients[atom_1_coefficent_offset]
 */
      __pyx_t_1 = (__pyx_v_coefficient_component[0]).exponent;
      __pyx_v_exponent = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2650")'> 2650: </pre>
<pre id='line2650' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2651")'> 2651:                 coefficient  = coefficient_component[0].coefficients[atom_1_coefficent_offset]</pre>
<pre id='line2651' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":2651
 *                 exponent = coefficient_component[0].exponent
 * 
 *                 coefficient  = coefficient_component[0].coefficients[atom_1_coefficent_offset]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 smoothing_factor = default_smoothing_factor
 */
      __pyx_v_coefficient = ((__pyx_v_coefficient_component[0]).coefficients[__pyx_v_atom_1_coefficent_offset]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2652")'> 2652: </pre>
<pre id='line2652' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2653")'> 2653:                 smoothing_factor = default_smoothing_factor</pre>
<pre id='line2653' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":2653
 *                 coefficient  = coefficient_component[0].coefficients[atom_1_coefficent_offset]
 * 
 *                 smoothing_factor = default_smoothing_factor             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if self._smoothed:
 *                     ratio = distance / self._cutoff
 */
      __pyx_v_smoothing_factor = __pyx_v_default_smoothing_factor;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2654")'> 2654:                 if self._smoothed:</pre>
<pre id='line2654' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":2654
 * 
 *                 smoothing_factor = default_smoothing_factor
 *                 if self._smoothed:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     ratio = distance / self._cutoff
 *                     smoothing_factor = 1.0 - ratio ** 8
 */
      if (__pyx_v_self->__pyx_base._smoothed) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2655")'> 2655:                     ratio = distance / self._cutoff</pre>
<pre id='line2655' class='code' style='background-color: #FFFFff'>
        /* "Cython_shift_calculator.pyx":2655
 *                 smoothing_factor = default_smoothing_factor
 *                 if self._smoothed:
 *                     ratio = distance / self._cutoff             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     smoothing_factor = 1.0 - ratio ** 8
 * 
 */
        __pyx_v_ratio = (__pyx_v_distance / __pyx_v_self->__pyx_base._cutoff);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2656")'> 2656:                     smoothing_factor = 1.0 - ratio ** 8</pre>
<pre id='line2656' class='code' style='background-color: #FFFFff'>
        /* "Cython_shift_calculator.pyx":2656
 *                 if self._smoothed:
 *                     ratio = distance / self._cutoff
 *                     smoothing_factor = 1.0 - ratio ** 8             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 offset = self.ensemble_array_offset(component_to_target[component_offset])
 */
        __pyx_v_smoothing_factor = (1.0 - powf(__pyx_v_ratio, 8.0));
        goto __pyx_L6;
      }
      __pyx_L6:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2657")'> 2657: </pre>
<pre id='line2657' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2658")'> 2658:                 offset = self.ensemble_array_offset(component_to_target[component_offset])</pre>
<pre id='line2658' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":2658
 *                     smoothing_factor = 1.0 - ratio ** 8
 * 
 *                 offset = self.ensemble_array_offset(component_to_target[component_offset])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 results[0][offset]  +=  smoothing_factor * pow(distance,  exponent) * coefficient
 * 
 */
      __pyx_t_2 = __pyx_v_component_offset;
      __pyx_v_offset = __pyx_f_17shift_calculators_21Base_shift_calculator_ensemble_array_offset(((struct __pyx_obj_17shift_calculators_Base_shift_calculator *)__pyx_v_self), (*((int *) ( /* dim=0 */ (__pyx_v_component_to_target.data + __pyx_t_2 * __pyx_v_component_to_target.strides[0]) ))));
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line2659")'> 2659:                 results[0][offset]  +=  smoothing_factor * pow(distance,  exponent) * coefficient</pre>
<pre id='line2659' class='code' style='background-color: #FFFFe7'>
      /* "Cython_shift_calculator.pyx":2659
 * 
 *                 offset = self.ensemble_array_offset(component_to_target[component_offset])
 *                 results[0][offset]  +=  smoothing_factor * pow(distance,  exponent) * coefficient             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
      __pyx_t_5 = 0;
      __pyx_t_6 = __pyx_v_offset;
      ((__pyx_v_results[__pyx_t_5])[__pyx_t_6]) = (((__pyx_v_results[__pyx_t_5])[__pyx_t_6]) + ((__pyx_v_smoothing_factor * pow(__pyx_v_distance, __pyx_v_exponent)) * __pyx_v_coefficient));
    }
    goto __pyx_L3;
  }
  __pyx_L3:;

}

/* Python wrapper */
static CYTHON_UNUSED int __pyx_pw_7cpython_5array_5array_1__getbuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags); /*proto*/
static CYTHON_UNUSED int __pyx_pw_7cpython_5array_5array_1__getbuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__getbuffer__ (wrapper)", 0);
  __pyx_r = __pyx_pf_7cpython_5array_5array___getbuffer__(((arrayobject *)__pyx_v_self), ((Py_buffer *)__pyx_v_info), ((int)__pyx_v_flags));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2660")'> 2660: </pre>
<pre id='line2660' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2661")'> 2661: </pre>
<pre id='line2661' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2662")'> 2662: </pre>
<pre id='line2662' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2663")'> 2663: </pre>
<pre id='line2663' class='code' style='background-color: #FFFFff'></pre></body></html>
