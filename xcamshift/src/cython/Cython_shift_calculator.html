<!-- Generated by Cython 0.18 on Tue Dec 24 21:01:53 2013 -->
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style type="text/css">

body { font-family: courier; font-size: 12; }

.code  { font-size: 9; color: #444444; display: none; margin-left: 20px; }
.py_c_api  { color: red; }
.py_macro_api  { color: #FF7000; }
.pyx_c_api  { color: #FF3000; }
.pyx_macro_api  { color: #FF7000; }
.refnanny  { color: #FFA000; }

.error_goto  { color: #FFA000; }

.tag  {  }

.coerce  { color: #008000; border: 1px dotted #008000 }

.py_attr { color: #FF0000; font-weight: bold; }
.c_attr  { color: #0000FF; }

.py_call { color: #FF0000; font-weight: bold; }
.c_call  { color: #0000FF; }

.line { margin: 0em }

</style>
<script>
function toggleDiv(id) {
    theDiv = document.getElementById(id);
    if (theDiv.style.display == 'none') theDiv.style.display = 'block';
    else theDiv.style.display = 'none';
}
</script>
</head>
        <body>
<p>Generated by Cython 0.18 on Tue Dec 24 21:01:53 2013
<p>Raw output: <a href="Cython_shift_calculator.cpp">Cython_shift_calculator.cpp</a>
<pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line1")'> 1: #-------------------------------------------------------------------------------</pre>
<pre id='line1' class='code' style='background-color: #FFFF79'>
  /* "Cython_shift_calculator.pyx":1
 * #-------------------------------------------------------------------------------             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * # Copyright (c) 2013 Gary Thompson & The University of Leeds.
 * # All rights reserved. This program and the accompanying materials
 */
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s____test__, ((PyObject *)__pyx_t_2)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2")'> 2: # Copyright (c) 2013 Gary Thompson &amp; The University of Leeds.</pre>
<pre id='line2' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line3")'> 3: # All rights reserved. This program and the accompanying materials</pre>
<pre id='line3' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line4")'> 4: # are made available under the terms of the GNU Lesser Public License v3.0</pre>
<pre id='line4' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line5")'> 5: # which accompanies this distribution, and is available at</pre>
<pre id='line5' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line6")'> 6: # http://www.gnu.org/licenses/lgpl-3.0.html</pre>
<pre id='line6' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line7")'> 7: #</pre>
<pre id='line7' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line8")'> 8: # Contributors:</pre>
<pre id='line8' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line9")'> 9: #     gary thompson - initial API and implementation</pre>
<pre id='line9' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line10")'> 10: #-------------------------------------------------------------------------------</pre>
<pre id='line10' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line11")'> 11: # cython: profile=False</pre>
<pre id='line11' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line12")'> 12: # cython: boundscheck=False</pre>
<pre id='line12' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line13")'> 13: # cython: wraparound=False</pre>
<pre id='line13' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line14")'> 14: # cython: cdivision=True</pre>
<pre id='line14' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line15")'> 15: </pre>
<pre id='line15' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line16")'> 16: '''</pre>
<pre id='line16' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line17")'> 17: Created on 31 Jul 2012</pre>
<pre id='line17' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line18")'> 18: </pre>
<pre id='line18' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line19")'> 19: @author: garyt</pre>
<pre id='line19' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line20")'> 20: </pre>
<pre id='line20' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line21")'> 21: '''</pre>
<pre id='line21' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line22")'> 22: cdef extern from "instantiate.hh":</pre>
<pre id='line22' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line23")'> 23:     pass</pre>
<pre id='line23' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line24")'> 24: </pre>
<pre id='line24' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line25")'> 25: from derivList import DerivList as PyDerivList</pre>
<pre id='line25' class='code' style='background-color: #FFFF41'>
  /* "Cython_shift_calculator.pyx":25
 *     pass
 * 
 * from derivList import DerivList as PyDerivList             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * from math import ceil
 * cimport cython
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__DerivList));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_n_s__DerivList));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__DerivList));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__derivList), ((PyObject *)__pyx_t_1), -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__DerivList);
  if (__pyx_t_1 == NULL) {
    if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseImportError</span>(__pyx_n_s__DerivList);
    if (unlikely(!__pyx_t_1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__PyDerivList, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line26")'> 26: from math import ceil</pre>
<pre id='line26' class='code' style='background-color: #FFFF41'>
  /* "Cython_shift_calculator.pyx":26
 * 
 * from derivList import DerivList as PyDerivList
 * from math import ceil             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * cimport cython
 * from vec3 import Vec3 as python_vec3
 */
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__ceil));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_n_s__ceil));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__ceil));
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__math), ((PyObject *)__pyx_t_2), -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__ceil);
  if (__pyx_t_2 == NULL) {
    if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseImportError</span>(__pyx_n_s__ceil);
    if (unlikely(!__pyx_t_2))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__ceil, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 26; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line27")'> 27: cimport cython</pre>
<pre id='line27' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line28")'> 28: from vec3 import Vec3 as python_vec3</pre>
<pre id='line28' class='code' style='background-color: #FFFF41'>
  /* "Cython_shift_calculator.pyx":28
 * from math import ceil
 * cimport cython
 * from vec3 import Vec3 as python_vec3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * from common_constants import TARGET_ATOM_IDS_CHANGED, STRUCTURE_CHANGED
 * from xplor_access cimport norm,Vec3, Dihedral, Atom,  dot,  cross,  Simulation, CDSVector, DerivList,\
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__Vec3));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_n_s__Vec3));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__Vec3));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__vec3), ((PyObject *)__pyx_t_1), -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__Vec3);
  if (__pyx_t_1 == NULL) {
    if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseImportError</span>(__pyx_n_s__Vec3);
    if (unlikely(!__pyx_t_1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__python_vec3, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF2b' onclick='toggleDiv("line29")'> 29: from common_constants import TARGET_ATOM_IDS_CHANGED, STRUCTURE_CHANGED</pre>
<pre id='line29' class='code' style='background-color: #FFFF2b'>
  /* "Cython_shift_calculator.pyx":29
 * cimport cython
 * from vec3 import Vec3 as python_vec3
 * from common_constants import TARGET_ATOM_IDS_CHANGED, STRUCTURE_CHANGED             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * from xplor_access cimport norm,Vec3, Dihedral, Atom,  dot,  cross,  Simulation, CDSVector, DerivList,\
 *      clearSharedVector, EnsembleSimulation, createSharedVector, getSharedVectorValue, resizeSharedVector,\
 */
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s_99));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_n_s_99));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s_99));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__STRUCTURE_CHANGED));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, ((PyObject *)__pyx_n_s__STRUCTURE_CHANGED));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__STRUCTURE_CHANGED));
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__common_constants), ((PyObject *)__pyx_t_2), -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s_99);
  if (__pyx_t_2 == NULL) {
    if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseImportError</span>(__pyx_n_s_99);
    if (unlikely(!__pyx_t_2))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s_99, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__STRUCTURE_CHANGED);
  if (__pyx_t_2 == NULL) {
    if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseImportError</span>(__pyx_n_s__STRUCTURE_CHANGED);
    if (unlikely(!__pyx_t_2))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__STRUCTURE_CHANGED, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line30")'> 30: from xplor_access cimport norm,Vec3, Dihedral, Atom,  dot,  cross,  Simulation, CDSVector, DerivList,\</pre>
<pre id='line30' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line31")'> 31:      clearSharedVector, EnsembleSimulation, createSharedVector, getSharedVectorValue, resizeSharedVector,\</pre>
<pre id='line31' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line32")'> 32:      addToSharedVectorValue, getSharedVectorValue, deleteSharedVector, setSharedVectorValue, BondAngle</pre>
<pre id='line32' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line33")'> 33: from libc.math cimport cos,sin,  fabs, tanh, pow, cosh</pre>
<pre id='line33' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line34")'> 34: from libc.stdlib cimport malloc, free</pre>
<pre id='line34' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line35")'> 35: from libc.string cimport strcmp</pre>
<pre id='line35' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line36")'> 36: from time import time</pre>
<pre id='line36' class='code' style='background-color: #FFFF41'>
  /* "Cython_shift_calculator.pyx":36
 * from libc.stdlib cimport malloc, free
 * from libc.string cimport strcmp
 * from time import time             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * from utils import Atom_utils
 * from cpython cimport array
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__time));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_n_s__time));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__time));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__time), ((PyObject *)__pyx_t_1), -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__time);
  if (__pyx_t_1 == NULL) {
    if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseImportError</span>(__pyx_n_s__time);
    if (unlikely(!__pyx_t_1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__time, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line37")'> 37: from utils import Atom_utils</pre>
<pre id='line37' class='code' style='background-color: #FFFF41'>
  /* "Cython_shift_calculator.pyx":37
 * from libc.string cimport strcmp
 * from time import time
 * from utils import Atom_utils             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * from cpython cimport array
 * import ctypes
 */
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__Atom_utils));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_n_s__Atom_utils));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__Atom_utils));
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__utils), ((PyObject *)__pyx_t_2), -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__Atom_utils);
  if (__pyx_t_2 == NULL) {
    if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseImportError</span>(__pyx_n_s__Atom_utils);
    if (unlikely(!__pyx_t_2))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__Atom_utils, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line38")'> 38: from cpython cimport array</pre>
<pre id='line38' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line39")'> 39: import ctypes</pre>
<pre id='line39' class='code' style='background-color: #FFFF8d'>
  /* "Cython_shift_calculator.pyx":39
 * from utils import Atom_utils
 * from cpython cimport array
 * import ctypes             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * from component_list import  Component_list, Native_component_list
 * from ensembleSimulation import EnsembleSimulation as pyEnsembleSimulation
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__ctypes), 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__ctypes, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF2b' onclick='toggleDiv("line40")'> 40: from component_list import  Component_list, Native_component_list</pre>
<pre id='line40' class='code' style='background-color: #FFFF2b'>
  /* "Cython_shift_calculator.pyx":40
 * from cpython cimport array
 * import ctypes
 * from component_list import  Component_list, Native_component_list             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * from ensembleSimulation import EnsembleSimulation as pyEnsembleSimulation
 * import math
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__Component_list));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_n_s__Component_list));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__Component_list));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s_100));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_n_s_100));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s_100));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__component_list), ((PyObject *)__pyx_t_1), -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__Component_list);
  if (__pyx_t_1 == NULL) {
    if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseImportError</span>(__pyx_n_s__Component_list);
    if (unlikely(!__pyx_t_1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__Component_list, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s_100);
  if (__pyx_t_1 == NULL) {
    if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseImportError</span>(__pyx_n_s_100);
    if (unlikely(!__pyx_t_1))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s_100, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line41")'> 41: from ensembleSimulation import EnsembleSimulation as pyEnsembleSimulation</pre>
<pre id='line41' class='code' style='background-color: #FFFF41'>
  /* "Cython_shift_calculator.pyx":41
 * import ctypes
 * from component_list import  Component_list, Native_component_list
 * from ensembleSimulation import EnsembleSimulation as pyEnsembleSimulation             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * import math
 * cdef double PI = math.pi
 */
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__EnsembleSimulation));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_n_s__EnsembleSimulation));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__EnsembleSimulation));
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__ensembleSimulation), ((PyObject *)__pyx_t_2), -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__EnsembleSimulation);
  if (__pyx_t_2 == NULL) {
    if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseImportError</span>(__pyx_n_s__EnsembleSimulation);
    if (unlikely(!__pyx_t_2))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s_4, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line42")'> 42: import math</pre>
<pre id='line42' class='code' style='background-color: #FFFF8d'>
  /* "Cython_shift_calculator.pyx":42
 * from component_list import  Component_list, Native_component_list
 * from ensembleSimulation import EnsembleSimulation as pyEnsembleSimulation
 * import math             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * cdef double PI = math.pi
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__math), 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 42; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__math, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 42; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line43")'> 43: cdef double PI = math.pi</pre>
<pre id='line43' class='code' style='background-color: #FFFF57'>
  /* "Cython_shift_calculator.pyx":43
 * from ensembleSimulation import EnsembleSimulation as pyEnsembleSimulation
 * import math
 * cdef double PI = math.pi             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #TODO: should be ensembleSimulationAsNative
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__math);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 43; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__pi);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 43; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 43; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_17shift_calculators_PI = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line44")'> 44: </pre>
<pre id='line44' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line45")'> 45: #TODO: should be ensembleSimulationAsNative</pre>
<pre id='line45' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line46")'> 46: cdef inline EnsembleSimulation* simulationAsNative(object simulation) except NULL:</pre>
<pre id='line46' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":46
 * 
 * #TODO: should be ensembleSimulationAsNative
 * cdef inline EnsembleSimulation* simulationAsNative(object simulation) except NULL:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     #TODO tell charles his __eq__ method has problems
 *     if id(None) == id(simulation):
 */

static CYTHON_INLINE EnsembleSimulation *__pyx_f_17shift_calculators_simulationAsNative(PyObject *__pyx_v_simulation) {
  EnsembleSimulation *__pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("simulationAsNative", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line47")'> 47:     #TODO tell charles his __eq__ method has problems</pre>
<pre id='line47' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF37' onclick='toggleDiv("line48")'> 48:     if id(None) == id(simulation):</pre>
<pre id='line48' class='code' style='background-color: #FFFF37'>
  /* "Cython_shift_calculator.pyx":48
 * cdef inline EnsembleSimulation* simulationAsNative(object simulation) except NULL:
 *     #TODO tell charles his __eq__ method has problems
 *     if id(None) == id(simulation):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         raise Exception("_simulation cannot be None!")
 *     if not isinstance(simulation, pyEnsembleSimulation):
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_id, ((PyObject *)__pyx_k_tuple_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simulation);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_simulation);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_simulation);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_id, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_3, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_4) {

  /* "Cython_shift_calculator.pyx":48
 * cdef inline EnsembleSimulation* simulationAsNative(object simulation) except NULL:
 *     #TODO tell charles his __eq__ method has problems
 *     if id(None) == id(simulation):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         raise Exception("_simulation cannot be None!")
 *     if not isinstance(simulation, pyEnsembleSimulation):
 */
  __pyx_k_tuple_1 = <span class='py_c_api'>PyTuple_Pack</span>(1, Py_None);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 48; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_1));
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line49")'> 49:         raise Exception("_simulation cannot be None!")</pre>
<pre id='line49' class='code' style='background-color: #FFFF6e'>
    /* "Cython_shift_calculator.pyx":49
 *     #TODO tell charles his __eq__ method has problems
 *     if id(None) == id(simulation):
 *         raise Exception("_simulation cannot be None!")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     if not isinstance(simulation, pyEnsembleSimulation):
 *         raise Exception("a %s can't be converted to a EnsembleSimulation*" % simulation.__class__.__name__)
 */
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_Exception, ((PyObject *)__pyx_k_tuple_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "Cython_shift_calculator.pyx":49
 *     #TODO tell charles his __eq__ method has problems
 *     if id(None) == id(simulation):
 *         raise Exception("_simulation cannot be None!")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     if not isinstance(simulation, pyEnsembleSimulation):
 *         raise Exception("a %s can't be converted to a EnsembleSimulation*" % simulation.__class__.__name__)
 */
  __pyx_k_tuple_3 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_2));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_3));
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line50")'> 50:     if not isinstance(simulation, pyEnsembleSimulation):</pre>
<pre id='line50' class='code' style='background-color: #FFFF8d'>
  /* "Cython_shift_calculator.pyx":50
 *     if id(None) == id(simulation):
 *         raise Exception("_simulation cannot be None!")
 *     if not isinstance(simulation, pyEnsembleSimulation):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         raise Exception("a %s can't be converted to a EnsembleSimulation*" % simulation.__class__.__name__)
 *     return <code><</code>EnsembleSimulation*><code><</code>size_t>int(simulation.this)
 */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_simulation, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = (!__pyx_t_4);
  if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFF3c' onclick='toggleDiv("line51")'> 51:         raise Exception("a %s can't be converted to a EnsembleSimulation*" % simulation.__class__.__name__)</pre>
<pre id='line51' class='code' style='background-color: #FFFF3c'>
    /* "Cython_shift_calculator.pyx":51
 *         raise Exception("_simulation cannot be None!")
 *     if not isinstance(simulation, pyEnsembleSimulation):
 *         raise Exception("a %s can't be converted to a EnsembleSimulation*" % simulation.__class__.__name__)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return <code><</code>EnsembleSimulation*><code><</code>size_t>int(simulation.this)
 * 
 */
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_simulation, __pyx_n_s____class__);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s____name__);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_5), __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, ((PyObject *)__pyx_t_2));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_2));
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_Exception, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L4;
  }
  __pyx_L4:;
</pre><pre class='line' style='background-color: #FFFF39' onclick='toggleDiv("line52")'> 52:     return &lt;EnsembleSimulation*&gt;&lt;size_t&gt;int(simulation.this)</pre>
<pre id='line52' class='code' style='background-color: #FFFF39'>
  /* "Cython_shift_calculator.pyx":52
 *     if not isinstance(simulation, pyEnsembleSimulation):
 *         raise Exception("a %s can't be converted to a EnsembleSimulation*" % simulation.__class__.__name__)
 *     return <code><</code>EnsembleSimulation*><code><</code>size_t>int(simulation.this)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cpdef array.array allocate_array(int len, type='d'):
 */
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_simulation, __pyx_n_s__this);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_t_6 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_6 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = ((EnsembleSimulation *)((size_t)__pyx_t_6));
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.simulationAsNative", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line53")'> 53: </pre>
<pre id='line53' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line54")'> 54: cpdef array.array allocate_array(int len, type='d'):</pre>
<pre id='line54' class='code' style='background-color: #FFFF9f'>
/* "Cython_shift_calculator.pyx":54
 *     return <code><</code>EnsembleSimulation*><code><</code>size_t>int(simulation.this)
 * 
 * cpdef array.array allocate_array(int len, type='d'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     result = array.array(type,[0])
 *     array.resize(result, len)
 */

static PyObject *__pyx_pw_17shift_calculators_1allocate_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static arrayobject *__pyx_f_17shift_calculators_allocate_array(int __pyx_v_len, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_17shift_calculators_allocate_array *__pyx_optional_args) {
  PyObject *__pyx_v_type = ((PyObject *)__pyx_n_s__d);
  PyObject *__pyx_v_result = NULL;
  arrayobject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("allocate_array", 0);
  if (__pyx_optional_args) {
    if (__pyx_optional_args->__pyx_n > 0) {
      __pyx_v_type = __pyx_optional_args->type;
    }
  }

/* "Cython_shift_calculator.pyx":54
 *     return <code><</code>EnsembleSimulation*><code><</code>size_t>int(simulation.this)
 * 
 * cpdef array.array allocate_array(int len, type='d'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     result = array.array(type,[0])
 *     array.resize(result, len)
 */

static PyObject *__pyx_pf_17shift_calculators_allocate_array(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_len, PyObject *__pyx_v_type) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("allocate_array", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2.__pyx_n = 1;
  __pyx_t_2.type = __pyx_v_type;
  __pyx_t_1 = ((PyObject *)__pyx_f_17shift_calculators_allocate_array(__pyx_v_len, 0, &__pyx_t_2));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.allocate_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* "Cython_shift_calculator.pyx":54
 *     return <code><</code>EnsembleSimulation*><code><</code>size_t>int(simulation.this)
 * 
 * cpdef array.array allocate_array(int len, type='d'):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     result = array.array(type,[0])
 *     array.resize(result, len)
 */
struct __pyx_opt_args_17shift_calculators_allocate_array {
  int __pyx_n;
  PyObject *type;
};
</pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line55")'> 55:     result = array.array(type,[0])</pre>
<pre id='line55' class='code' style='background-color: #FFFF52'>
  /* "Cython_shift_calculator.pyx":55
 * 
 * cpdef array.array allocate_array(int len, type='d'):
 *     result = array.array(type,[0])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     array.resize(result, len)
 *     array.zero(result)
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_0);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_0);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_type);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_type);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_type);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, ((PyObject *)__pyx_t_1));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_1));
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)__pyx_ptype_7cpython_5array_array)), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 55; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_v_result = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line56")'> 56:     array.resize(result, len)</pre>
<pre id='line56' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":56
 * cpdef array.array allocate_array(int len, type='d'):
 *     result = array.array(type,[0])
 *     array.resize(result, len)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     array.zero(result)
 *     return result
 */
  if (!(likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_result, __pyx_ptype_7cpython_5array_array))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 56; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  resize(((arrayobject *)__pyx_v_result), __pyx_v_len);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line57")'> 57:     array.zero(result)</pre>
<pre id='line57' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":57
 *     result = array.array(type,[0])
 *     array.resize(result, len)
 *     array.zero(result)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return result
 * 
 */
  if (!(likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_result, __pyx_ptype_7cpython_5array_array))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_f_7cpython_5array_zero(((arrayobject *)__pyx_v_result));
</pre><pre class='line' style='background-color: #FFFF29' onclick='toggleDiv("line58")'> 58:     return result</pre>
<pre id='line58' class='code' style='background-color: #FFFF29'>
  /* "Cython_shift_calculator.pyx":58
 *     array.resize(result, len)
 *     array.zero(result)
 *     return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cpdef zero_array(array.array in_array):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  if (!(likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_result, __pyx_ptype_7cpython_5array_array))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_result);
  __pyx_r = ((arrayobject *)__pyx_v_result);
  goto __pyx_L0;

  __pyx_r = ((arrayobject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.allocate_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>((PyObject *)__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_1allocate_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_1allocate_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_len;
  PyObject *__pyx_v_type = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("allocate_array (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__len,&__pyx_n_s__type,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject *)__pyx_n_s__d);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__len)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__type);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "allocate_array") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_len = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_len == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_type = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("allocate_array", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.allocate_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_allocate_array(__pyx_self, __pyx_v_len, __pyx_v_type);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line59")'> 59: </pre>
<pre id='line59' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line60")'> 60: cpdef zero_array(array.array in_array):</pre>
<pre id='line60' class='code' style='background-color: #FFFF9f'>
/* "Cython_shift_calculator.pyx":60
 *     return result
 * 
 * cpdef zero_array(array.array in_array):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *      array.zero(in_array)
 * 
 */

static PyObject *__pyx_pw_17shift_calculators_3zero_array(PyObject *__pyx_self, PyObject *__pyx_v_in_array); /*proto*/
static PyObject *__pyx_f_17shift_calculators_zero_array(arrayobject *__pyx_v_in_array, CYTHON_UNUSED int __pyx_skip_dispatch) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("zero_array", 0);

/* "Cython_shift_calculator.pyx":60
 *     return result
 * 
 * cpdef zero_array(array.array in_array):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *      array.zero(in_array)
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_2zero_array(CYTHON_UNUSED PyObject *__pyx_self, arrayobject *__pyx_v_in_array) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("zero_array", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_17shift_calculators_zero_array(__pyx_v_in_array, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.zero_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line61")'> 61:      array.zero(in_array)</pre>
<pre id='line61' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":61
 * 
 * cpdef zero_array(array.array in_array):
 *      array.zero(in_array)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cpdef resize_array(array.array in_array, int len):
 */
  __pyx_f_7cpython_5array_zero(__pyx_v_in_array);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_3zero_array(PyObject *__pyx_self, PyObject *__pyx_v_in_array); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_3zero_array(PyObject *__pyx_self, PyObject *__pyx_v_in_array) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("zero_array (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_in_array), __pyx_ptype_7cpython_5array_array, 1, "in_array", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_2zero_array(__pyx_self, ((arrayobject *)__pyx_v_in_array));
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line62")'> 62: </pre>
<pre id='line62' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF29' onclick='toggleDiv("line63")'> 63: cpdef resize_array(array.array in_array, int len):</pre>
<pre id='line63' class='code' style='background-color: #FFFF29'>
/* "Cython_shift_calculator.pyx":63
 *      array.zero(in_array)
 * 
 * cpdef resize_array(array.array in_array, int len):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     array.resize(in_array, len)
 * 
 */

static PyObject *__pyx_pw_17shift_calculators_5resize_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_17shift_calculators_resize_array(arrayobject *__pyx_v_in_array, int __pyx_v_len, CYTHON_UNUSED int __pyx_skip_dispatch) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("resize_array", 0);

/* "Cython_shift_calculator.pyx":63
 *      array.zero(in_array)
 * 
 * cpdef resize_array(array.array in_array, int len):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     array.resize(in_array, len)
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_4resize_array(CYTHON_UNUSED PyObject *__pyx_self, arrayobject *__pyx_v_in_array, int __pyx_v_len) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("resize_array", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_17shift_calculators_resize_array(__pyx_v_in_array, __pyx_v_len, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.resize_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_7test_dump_component_index_pair(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_17shift_calculators_7test_dump_component_index_pair = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("test_dump_component_index_pair"), (PyCFunction)__pyx_pw_17shift_calculators_7test_dump_component_index_pair, METH_VARARGS|METH_KEYWORDS, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_17shift_calculators_7test_dump_component_index_pair(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_data = 0;
  int __pyx_v_index;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("test_dump_component_index_pair (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__data,&__pyx_n_s__index,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__data)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__index)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("test_dump_component_index_pair", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "test_dump_component_index_pair") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_data = ((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)values[0]);
    __pyx_v_index = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_index == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("test_dump_component_index_pair", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.test_dump_component_index_pair", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_data), __pyx_ptype_17shift_calculators_Non_bonded_interaction_list, 1, "data", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_6test_dump_component_index_pair(__pyx_self, __pyx_v_data, __pyx_v_index);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFF2d' onclick='toggleDiv("line64")'> 64:     array.resize(in_array, len)</pre>
<pre id='line64' class='code' style='background-color: #FFFF2d'>
  /* "Cython_shift_calculator.pyx":64
 * 
 * cpdef resize_array(array.array in_array, int len):
 *     array.resize(in_array, len)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef struct Random_coil_component:
 */
  resize(__pyx_v_in_array, __pyx_v_len);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_5resize_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_5resize_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  arrayobject *__pyx_v_in_array = 0;
  int __pyx_v_len;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("resize_array (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__in_array,&__pyx_n_s__len,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__in_array)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__len)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("resize_array", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "resize_array") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_in_array = ((arrayobject *)values[0]);
    __pyx_v_len = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_len == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("resize_array", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.resize_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_in_array), __pyx_ptype_7cpython_5array_array, 1, "in_array", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_4resize_array(__pyx_self, __pyx_v_in_array, __pyx_v_len);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line65")'> 65: </pre>
<pre id='line65' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line66")'> 66: cdef struct Random_coil_component:</pre>
<pre id='line66' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":66
 *     array.resize(in_array, len)
 * 
 * cdef struct Random_coil_component:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     int target_atom
 *     float shift
 */
struct __pyx_t_17shift_calculators_Random_coil_component {
  int target_atom;
  float shift;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line67")'> 67:     int target_atom</pre>
<pre id='line67' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line68")'> 68:     float shift</pre>
<pre id='line68' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line69")'> 69: </pre>
<pre id='line69' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line70")'> 70: cdef struct Nonbonded_coefficient_component:</pre>
<pre id='line70' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":70
 *     float shift
 * 
 * cdef struct Nonbonded_coefficient_component:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     int chem_type_id
 *     int sphere_id
 */
struct __pyx_t_17shift_calculators_Nonbonded_coefficient_component {
  int chem_type_id;
  int sphere_id;
  float exponent;
  float coefficients[(3 * 7)];
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line71")'> 71:     int chem_type_id</pre>
<pre id='line71' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line72")'> 72:     int sphere_id</pre>
<pre id='line72' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line73")'> 73:     float exponent</pre>
<pre id='line73' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line74")'> 74:     float[3*7] coefficients</pre>
<pre id='line74' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line75")'> 75: </pre>
<pre id='line75' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line76")'> 76: cdef struct Distance_component:</pre>
<pre id='line76' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":76
 *     float[3*7] coefficients
 * 
 * cdef struct Distance_component:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *       int target_atom
 *       int remote_atom_1
 */
struct __pyx_t_17shift_calculators_Distance_component {
  int target_atom;
  int remote_atom_1;
  int remote_atom_2;
  float coefficient;
  float exponent;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line77")'> 77:       int target_atom</pre>
<pre id='line77' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line78")'> 78:       int remote_atom_1</pre>
<pre id='line78' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line79")'> 79:       int remote_atom_2</pre>
<pre id='line79' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line80")'> 80:       float coefficient</pre>
<pre id='line80' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line81")'> 81:       float exponent</pre>
<pre id='line81' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line82")'> 82: </pre>
<pre id='line82' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line83")'> 83: cdef struct Dihedral_component:</pre>
<pre id='line83' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":83
 *       float exponent
 * 
 * cdef struct Dihedral_component:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *       int target_atom
 *       int[4] dihedral_atoms
 */
struct __pyx_t_17shift_calculators_Dihedral_component {
  int target_atom;
  int dihedral_atoms[4];
  float coefficient;
  float parameters[6];
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line84")'> 84:       int target_atom</pre>
<pre id='line84' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line85")'> 85:       int[4] dihedral_atoms</pre>
<pre id='line85' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line86")'> 86:       float coefficient</pre>
<pre id='line86' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line87")'> 87:       float[6] parameters</pre>
<pre id='line87' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line88")'> 88:       #TODO: there seems to be an extra float here...</pre>
<pre id='line88' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line89")'> 89: </pre>
<pre id='line89' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line90")'> 90: #TODO: same as sing target component unite and rename</pre>
<pre id='line90' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line91")'> 91: cdef struct Non_bonded_target_component:</pre>
<pre id='line91' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":91
 * 
 * #TODO: same as sing target component unite and rename
 * cdef struct Non_bonded_target_component:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *       int target_atom_id
 *       int atom_type_id
 */
struct __pyx_t_17shift_calculators_Non_bonded_target_component {
  int target_atom_id;
  int atom_type_id;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line92")'> 92:       int target_atom_id</pre>
<pre id='line92' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line93")'> 93:       int atom_type_id</pre>
<pre id='line93' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line94")'> 94: </pre>
<pre id='line94' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line95")'> 95: cdef struct Non_bonded_remote_atom_component:</pre>
<pre id='line95' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":95
 *       int atom_type_id
 * 
 * cdef struct Non_bonded_remote_atom_component:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *       int remote_atom_id
 *       int chem_type[2] # one for each sphere
 */
struct __pyx_t_17shift_calculators_Non_bonded_remote_atom_component {
  int remote_atom_id;
  int chem_type[2];
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line96")'> 96:       int remote_atom_id</pre>
<pre id='line96' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line97")'> 97:       int chem_type[2] # one for each sphere</pre>
<pre id='line97' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line98")'> 98: </pre>
<pre id='line98' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line99")'> 99: cdef struct Component_index_pair:</pre>
<pre id='line99' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":99
 *       int chem_type[2] # one for each sphere
 * 
 * cdef struct Component_index_pair:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     int target_atom_id
 *     int target_index
 */
struct __pyx_t_17shift_calculators_Component_index_pair {
  int target_atom_id;
  int target_index;
  int remote_index;
  int component_index;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line100")'> 100:     int target_atom_id</pre>
<pre id='line100' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line101")'> 101:     int target_index</pre>
<pre id='line101' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line102")'> 102:     int remote_index</pre>
<pre id='line102' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line103")'> 103:     int component_index</pre>
<pre id='line103' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line104")'> 104: </pre>
<pre id='line104' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line105")'> 105: cdef struct Constant_cache:</pre>
<pre id='line105' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":105
 *     int component_index
 * 
 * cdef struct Constant_cache:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     int     target_atom_id
 *     float   flat_bottom_shift_limit
 */
struct __pyx_t_17shift_calculators_Constant_cache {
  int target_atom_id;
  float flat_bottom_shift_limit;
  float end_harmonic;
  float scale_harmonic;
  float weight;
  float tanh_amplitude;
  float tanh_elongation;
  float tanh_y_offset;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line106")'> 106:     int     target_atom_id</pre>
<pre id='line106' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line107")'> 107:     float   flat_bottom_shift_limit</pre>
<pre id='line107' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line108")'> 108:     float   end_harmonic</pre>
<pre id='line108' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line109")'> 109:     float   scale_harmonic</pre>
<pre id='line109' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line110")'> 110:     float   weight</pre>
<pre id='line110' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line111")'> 111:     float   tanh_amplitude</pre>
<pre id='line111' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line112")'> 112:     float   tanh_elongation</pre>
<pre id='line112' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line113")'> 113:     float   tanh_y_offset</pre>
<pre id='line113' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line114")'> 114: </pre>
<pre id='line114' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line115")'> 115: cdef struct Hydrogen_bond_component:</pre>
<pre id='line115' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":115
 *     float   tanh_y_offset
 * 
 * cdef struct Hydrogen_bond_component:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     int index
 *     int direct_atom_id
 */
struct __pyx_t_17shift_calculators_Hydrogen_bond_component {
  int index;
  int direct_atom_id;
  int indirect_atom_id;
  int type;
  int atom_type_id;
  int backbone;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line116")'> 116:     int index</pre>
<pre id='line116' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line117")'> 117:     int direct_atom_id</pre>
<pre id='line117' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line118")'> 118:     int indirect_atom_id</pre>
<pre id='line118' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line119")'> 119:     int type</pre>
<pre id='line119' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line120")'> 120:     int atom_type_id</pre>
<pre id='line120' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line121")'> 121:     int backbone</pre>
<pre id='line121' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line122")'> 122: </pre>
<pre id='line122' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line123")'> 123: cdef struct Hydrogen_bond_parameter:</pre>
<pre id='line123' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":123
 *     int backbone
 * 
 * cdef struct Hydrogen_bond_parameter:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     int component_index
 *     int param_index
 */
struct __pyx_t_17shift_calculators_Hydrogen_bond_parameter {
  int component_index;
  int param_index;
  int donor_index;
  int acceptor_index;
  float p[6];
  float r;
  float s;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line124")'> 124:     int component_index</pre>
<pre id='line124' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line125")'> 125:     int param_index</pre>
<pre id='line125' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line126")'> 126:     int donor_index</pre>
<pre id='line126' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line127")'> 127:     int acceptor_index</pre>
<pre id='line127' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line128")'> 128:     float[6] p</pre>
<pre id='line128' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line129")'> 129:     float r</pre>
<pre id='line129' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line130")'> 130:     float s</pre>
<pre id='line130' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line131")'> 131: </pre>
<pre id='line131' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line132")'> 132: cdef struct Hydrogen_bond_donor_lookup:</pre>
<pre id='line132' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":132
 *     float s
 * 
 * cdef struct Hydrogen_bond_donor_lookup:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     int donor_id
 *     int number_acceptors
 */
struct __pyx_t_17shift_calculators_Hydrogen_bond_donor_lookup {
  int donor_id;
  int number_acceptors;
  int acceptor_offset[1];
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line133")'> 133:     int donor_id</pre>
<pre id='line133' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line134")'> 134:     int number_acceptors</pre>
<pre id='line134' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line135")'> 135:     int[1] acceptor_offset</pre>
<pre id='line135' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line136")'> 136: </pre>
<pre id='line136' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line137")'> 137: cdef struct Hydrogen_bond_acceptor_lookup:</pre>
<pre id='line137' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":137
 *     int[1] acceptor_offset
 * 
 * cdef struct Hydrogen_bond_acceptor_lookup:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     int index
 *     int donor_id
 */
struct __pyx_t_17shift_calculators_Hydrogen_bond_acceptor_lookup {
  int index;
  int donor_id;
  int acceptor_id;
  int parameter_indices[3];
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line138")'> 138:     int index</pre>
<pre id='line138' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line139")'> 139:     int donor_id</pre>
<pre id='line139' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line140")'> 140:     int acceptor_id</pre>
<pre id='line140' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line141")'> 141:     int[3] parameter_indices</pre>
<pre id='line141' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line142")'> 142: </pre>
<pre id='line142' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line143")'> 143: def test_dump_component_index_pair(Non_bonded_interaction_list data, int index):</pre>
<pre id='line143' class='code' style='background-color: #FFFF62'>
/* "Cython_shift_calculator.pyx":143
 *     int[3] parameter_indices
 * 
 * def test_dump_component_index_pair(Non_bonded_interaction_list data, int index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Component_index_pair* result =  data.get(index)
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_6test_dump_component_index_pair(CYTHON_UNUSED PyObject *__pyx_self, struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_data, int __pyx_v_index) {
  struct __pyx_t_17shift_calculators_Component_index_pair *__pyx_v_result;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("test_dump_component_index_pair", 0);

  /* "Cython_shift_calculator.pyx":143
 *     int[3] parameter_indices
 * 
 * def test_dump_component_index_pair(Non_bonded_interaction_list data, int index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Component_index_pair* result =  data.get(index)
 * 
 */
  __pyx_k_tuple_101 = <span class='py_c_api'>PyTuple_Pack</span>(3, ((PyObject *)__pyx_n_s__data), ((PyObject *)__pyx_n_s__index), ((PyObject *)__pyx_n_s__result));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_101)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_101);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_101));

  /* "Cython_shift_calculator.pyx":143
 *     int[3] parameter_indices
 * 
 * def test_dump_component_index_pair(Non_bonded_interaction_list data, int index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Component_index_pair* result =  data.get(index)
 * 
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_17shift_calculators_7test_dump_component_index_pair, NULL, __pyx_n_s__shift_calculators);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s_103, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_102 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(2, 0, 3, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_101, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_104, __pyx_n_s_103, 143, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_102)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line144")'> 144:     cdef Component_index_pair* result =  data.get(index)</pre>
<pre id='line144' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":144
 * 
 * def test_dump_component_index_pair(Non_bonded_interaction_list data, int index):
 *     cdef Component_index_pair* result =  data.get(index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     return result[0].target_atom_id, result[0].target_index, result[0].remote_index, result[0].component_index
 */
  __pyx_v_result = __pyx_f_17shift_calculators_27Non_bonded_interaction_list_get(__pyx_v_data, __pyx_v_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line145")'> 145: </pre>
<pre id='line145' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF31' onclick='toggleDiv("line146")'> 146:     return result[0].target_atom_id, result[0].target_index, result[0].remote_index, result[0].component_index</pre>
<pre id='line146' class='code' style='background-color: #FFFF31'>
  /* "Cython_shift_calculator.pyx":146
 *     cdef Component_index_pair* result =  data.get(index)
 * 
 *     return result[0].target_atom_id, result[0].target_index, result[0].remote_index, result[0].component_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * def test_dump_component_offsets(data):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_result[0]).target_atom_id);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_result[0]).target_index);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_result[0]).remote_index);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_result[0]).component_index);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_t_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 3, __pyx_t_4);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_r = ((PyObject *)__pyx_t_5);
  __pyx_t_5 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.test_dump_component_index_pair", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_9test_dump_component_offsets(PyObject *__pyx_self, PyObject *__pyx_v_data); /*proto*/
static PyMethodDef __pyx_mdef_17shift_calculators_9test_dump_component_offsets = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("test_dump_component_offsets"), (PyCFunction)__pyx_pw_17shift_calculators_9test_dump_component_offsets, METH_O, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_17shift_calculators_9test_dump_component_offsets(PyObject *__pyx_self, PyObject *__pyx_v_data) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("test_dump_component_offsets (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_8test_dump_component_offsets(__pyx_self, ((PyObject *)__pyx_v_data));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line147")'> 147: </pre>
<pre id='line147' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line148")'> 148: def test_dump_component_offsets(data):</pre>
<pre id='line148' class='code' style='background-color: #FFFF62'>
/* "Cython_shift_calculator.pyx":148
 *     return result[0].target_atom_id, result[0].target_index, result[0].remote_index, result[0].component_index
 * 
 * def test_dump_component_offsets(data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef size_t  test  = ctypes.addressof(data)
 *     cdef Component_Offsets* test2 = <code><</code>Component_Offsets*> test
 */

static PyObject *__pyx_pf_17shift_calculators_8test_dump_component_offsets(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data) {
  size_t __pyx_v_test;
  struct __pyx_t_17shift_calculators_Component_Offsets *__pyx_v_test2;
  __Pyx_memviewslice __pyx_v_dummy_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_result = NULL;
  PyObject *__pyx_v_result_data = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("test_dump_component_offsets", 0);

  /* "Cython_shift_calculator.pyx":148
 *     return result[0].target_atom_id, result[0].target_index, result[0].remote_index, result[0].component_index
 * 
 * def test_dump_component_offsets(data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef size_t  test  = ctypes.addressof(data)
 *     cdef Component_Offsets* test2 = <code><</code>Component_Offsets*> test
 */
  __pyx_k_tuple_105 = <span class='py_c_api'>PyTuple_Pack</span>(7, ((PyObject *)__pyx_n_s__data), ((PyObject *)__pyx_n_s__test), ((PyObject *)__pyx_n_s__test2), ((PyObject *)__pyx_n_s__dummy_view), ((PyObject *)__pyx_n_s__result), ((PyObject *)__pyx_n_s__result_data), ((PyObject *)__pyx_n_s__i));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_105)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_105);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_105));

  /* "Cython_shift_calculator.pyx":148
 *     return result[0].target_atom_id, result[0].target_index, result[0].remote_index, result[0].component_index
 * 
 * def test_dump_component_offsets(data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef size_t  test  = ctypes.addressof(data)
 *     cdef Component_Offsets* test2 = <code><</code>Component_Offsets*> test
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_17shift_calculators_9test_dump_component_offsets, NULL, __pyx_n_s__shift_calculators);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s_107, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_106 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(1, 0, 7, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_105, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_104, __pyx_n_s_107, 148, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_106)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line149")'> 149:     cdef size_t  test  = ctypes.addressof(data)</pre>
<pre id='line149' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":149
 * 
 * def test_dump_component_offsets(data):
 *     cdef size_t  test  = ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Component_Offsets* test2 = <code><</code>Component_Offsets*> test
 *     cdef Component_Offsets[:] dummy_view
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 149; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 149; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 149; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 149; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 149; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_test = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line150")'> 150:     cdef Component_Offsets* test2 = &lt;Component_Offsets*&gt; test</pre>
<pre id='line150' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":150
 * def test_dump_component_offsets(data):
 *     cdef size_t  test  = ctypes.addressof(data)
 *     cdef Component_Offsets* test2 = <code><</code>Component_Offsets*> test             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Component_Offsets[:] dummy_view
 *     if len(data) == 0:
 */
  __pyx_v_test2 = ((struct __pyx_t_17shift_calculators_Component_Offsets *)__pyx_v_test);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line151")'> 151:     cdef Component_Offsets[:] dummy_view</pre>
<pre id='line151' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line152")'> 152:     if len(data) == 0:</pre>
<pre id='line152' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":152
 *     cdef Component_Offsets* test2 = <code><</code>Component_Offsets*> test
 *     cdef Component_Offsets[:] dummy_view
 *     if len(data) == 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result = ()
 *     else:
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = (__pyx_t_5 == 0);
  if (__pyx_t_6) {
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line153")'> 153:         result = ()</pre>
<pre id='line153' class='code' style='background-color: #FFFFe7'>
    /* "Cython_shift_calculator.pyx":153
 *     cdef Component_Offsets[:] dummy_view
 *     if len(data) == 0:
 *         result = ()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     else:
 *         dummy_view = <code><</code>Component_Offsets[:len(data)/ sizeof(Component_Offsets)]> &test2[0]
 */
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_empty_tuple));
    __pyx_v_result = __pyx_empty_tuple;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line154")'> 154:     else:</pre>
<pre id='line154' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line155")'> 155:         dummy_view = &lt;Component_Offsets[:len(data)/ sizeof(Component_Offsets)]&gt; &amp;test2[0]</pre>
<pre id='line155' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":155
 *         result = ()
 *     else:
 *         dummy_view = <code><</code>Component_Offsets[:len(data)/ sizeof(Component_Offsets)]> &test2[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         result_data = []
 */
    __pyx_t_7 = (&(__pyx_v_test2[0]));
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    if (!__pyx_t_7) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_1 = __pyx_format_from_typeinfo(&__Pyx_TypeInfo_nn_struct___pyx_t_17shift_calculators_Component_Offsets);
    __pyx_t_3 = Py_BuildValue("("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)(__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Component_Offsets)))));
    if (unlikely(!__pyx_t_1 || !__pyx_t_3 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_8 = __pyx_array_new(__pyx_t_3, sizeof(struct __pyx_t_17shift_calculators_Component_Offsets), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_1), (char *) "c", (char *) __pyx_t_7);
    if (unlikely(!__pyx_t_8))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn_struct___pyx_t_17shift_calculators_Component_Offsets(((PyObject *)__pyx_t_8));
    if (unlikely(!__pyx_t_9.memview))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
    __pyx_v_dummy_view = __pyx_t_9;
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line156")'> 156: </pre>
<pre id='line156' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line157")'> 157:         result_data = []</pre>
<pre id='line157' class='code' style='background-color: #FFFFaa'>
    /* "Cython_shift_calculator.pyx":157
 *         dummy_view = <code><</code>Component_Offsets[:len(data)/ sizeof(Component_Offsets)]> &test2[0]
 * 
 *         result_data = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for i in range(len(data)/ sizeof(Component_Offsets)):
 *             result_data.append((dummy_view[i].id,  dummy_view[i].offset,  dummy_view[i].length))
 */
    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_v_result_data = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF1e' onclick='toggleDiv("line158")'> 158:         for i in range(len(data)/ sizeof(Component_Offsets)):</pre>
<pre id='line158' class='code' style='background-color: #FFFF1e'>
    /* "Cython_shift_calculator.pyx":158
 * 
 *         result_data = []
 *         for i in range(len(data)/ sizeof(Component_Offsets)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             result_data.append((dummy_view[i].id,  dummy_view[i].offset,  dummy_view[i].length))
 *         result = tuple(result_data)
 */
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = __Pyx_<span class='py_c_api'>PyInt_FromSize_t</span>((__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Component_Offsets))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      __pyx_t_3 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5 = 0;
      __pyx_t_10 = NULL;
    } else {
      __pyx_t_5 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_10 = Py_TYPE(__pyx_t_3)->tp_iternext;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (!__pyx_t_10 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) {
        if (__pyx_t_5 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else if (!__pyx_t_10 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
        if (__pyx_t_5 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else {
        __pyx_t_1 = __pyx_t_10(__pyx_t_3);
        if (unlikely(!__pyx_t_1)) {
          if (<span class='py_c_api'>PyErr_Occurred</span>()) {
            if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
      __pyx_v_i = __pyx_t_1;
      __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF24' onclick='toggleDiv("line159")'> 159:             result_data.append((dummy_view[i].id,  dummy_view[i].offset,  dummy_view[i].length))</pre>
<pre id='line159' class='code' style='background-color: #FFFF24'>
      /* "Cython_shift_calculator.pyx":159
 *         result_data = []
 *         for i in range(len(data)/ sizeof(Component_Offsets)):
 *             result_data.append((dummy_view[i].id,  dummy_view[i].offset,  dummy_view[i].length))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result = tuple(result_data)
 *     return result
 */
      __pyx_t_11 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_12 = __pyx_t_11;
      __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>((*((struct __pyx_t_17shift_calculators_Component_Offsets *) ( /* dim=0 */ (__pyx_v_dummy_view.data + __pyx_t_12 * __pyx_v_dummy_view.strides[0]) ))).id);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_11 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_13 = __pyx_t_11;
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>((*((struct __pyx_t_17shift_calculators_Component_Offsets *) ( /* dim=0 */ (__pyx_v_dummy_view.data + __pyx_t_13 * __pyx_v_dummy_view.strides[0]) ))).offset);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_11 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_14 = __pyx_t_11;
      __pyx_t_15 = <span class='py_c_api'>PyInt_FromLong</span>((*((struct __pyx_t_17shift_calculators_Component_Offsets *) ( /* dim=0 */ (__pyx_v_dummy_view.data + __pyx_t_14 * __pyx_v_dummy_view.strides[0]) ))).length);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
      __pyx_t_16 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_16);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 0, __pyx_t_1);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 1, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 2, __pyx_t_15);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_15);
      __pyx_t_1 = 0;
      __pyx_t_2 = 0;
      __pyx_t_15 = 0;
      __pyx_t_17 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_result_data, ((PyObject *)__pyx_t_16));<span class='error_goto'> if (unlikely(__pyx_t_17 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_16)); __pyx_t_16 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line160")'> 160:         result = tuple(result_data)</pre>
<pre id='line160' class='code' style='background-color: #FFFFaa'>
    /* "Cython_shift_calculator.pyx":160
 *         for i in range(len(data)/ sizeof(Component_Offsets)):
 *             result_data.append((dummy_view[i].id,  dummy_view[i].offset,  dummy_view[i].length))
 *         result = tuple(result_data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return result
 * 
 */
    __pyx_t_3 = ((PyObject *)<span class='py_c_api'>PyList_AsTuple</span>(__pyx_v_result_data));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
    __pyx_v_result = ((PyObject*)__pyx_t_3);
    __pyx_t_3 = 0;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line161")'> 161:     return result</pre>
<pre id='line161' class='code' style='background-color: #FFFF5b'>
  /* "Cython_shift_calculator.pyx":161
 *             result_data.append((dummy_view[i].id,  dummy_view[i].offset,  dummy_view[i].length))
 *         result = tuple(result_data)
 *     return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_result));
  __pyx_r = ((PyObject *)__pyx_v_result);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_t_8));
  __PYX_XDEC_MEMVIEW(&__pyx_t_9, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.test_dump_component_offsets", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&__pyx_v_dummy_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result_data);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_11test_dump_dist_comp(PyObject *__pyx_self, PyObject *__pyx_v_data); /*proto*/
static PyMethodDef __pyx_mdef_17shift_calculators_11test_dump_dist_comp = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("test_dump_dist_comp"), (PyCFunction)__pyx_pw_17shift_calculators_11test_dump_dist_comp, METH_O, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_17shift_calculators_11test_dump_dist_comp(PyObject *__pyx_self, PyObject *__pyx_v_data) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("test_dump_dist_comp (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_10test_dump_dist_comp(__pyx_self, ((PyObject *)__pyx_v_data));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line162")'> 162: </pre>
<pre id='line162' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line163")'> 163: </pre>
<pre id='line163' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line164")'> 164: def test_dump_dist_comp(data):</pre>
<pre id='line164' class='code' style='background-color: #FFFF62'>
/* "Cython_shift_calculator.pyx":164
 * 
 * 
 * def test_dump_dist_comp(data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef size_t  test  = ctypes.addressof(data)
 *     cdef Distance_component* test2 = <code><</code>Distance_component*> test
 */

static PyObject *__pyx_pf_17shift_calculators_10test_dump_dist_comp(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data) {
  size_t __pyx_v_test;
  struct __pyx_t_17shift_calculators_Distance_component *__pyx_v_test2;
  __Pyx_memviewslice __pyx_v_dummy_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_result = NULL;
  PyObject *__pyx_v_result_data = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("test_dump_dist_comp", 0);

  /* "Cython_shift_calculator.pyx":164
 * 
 * 
 * def test_dump_dist_comp(data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef size_t  test  = ctypes.addressof(data)
 *     cdef Distance_component* test2 = <code><</code>Distance_component*> test
 */
  __pyx_k_tuple_108 = <span class='py_c_api'>PyTuple_Pack</span>(7, ((PyObject *)__pyx_n_s__data), ((PyObject *)__pyx_n_s__test), ((PyObject *)__pyx_n_s__test2), ((PyObject *)__pyx_n_s__dummy_view), ((PyObject *)__pyx_n_s__result), ((PyObject *)__pyx_n_s__result_data), ((PyObject *)__pyx_n_s__i));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_108)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_108);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_108));

  /* "Cython_shift_calculator.pyx":164
 * 
 * 
 * def test_dump_dist_comp(data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef size_t  test  = ctypes.addressof(data)
 *     cdef Distance_component* test2 = <code><</code>Distance_component*> test
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_17shift_calculators_11test_dump_dist_comp, NULL, __pyx_n_s__shift_calculators);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__test_dump_dist_comp, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_109 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(1, 0, 7, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_108, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_104, __pyx_n_s__test_dump_dist_comp, 164, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_109)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line165")'> 165:     cdef size_t  test  = ctypes.addressof(data)</pre>
<pre id='line165' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":165
 * 
 * def test_dump_dist_comp(data):
 *     cdef size_t  test  = ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Distance_component* test2 = <code><</code>Distance_component*> test
 *     cdef Distance_component[:] dummy_view
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_test = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line166")'> 166:     cdef Distance_component* test2 = &lt;Distance_component*&gt; test</pre>
<pre id='line166' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":166
 * def test_dump_dist_comp(data):
 *     cdef size_t  test  = ctypes.addressof(data)
 *     cdef Distance_component* test2 = <code><</code>Distance_component*> test             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Distance_component[:] dummy_view
 *     if len(data) == 0:
 */
  __pyx_v_test2 = ((struct __pyx_t_17shift_calculators_Distance_component *)__pyx_v_test);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line167")'> 167:     cdef Distance_component[:] dummy_view</pre>
<pre id='line167' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line168")'> 168:     if len(data) == 0:</pre>
<pre id='line168' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":168
 *     cdef Distance_component* test2 = <code><</code>Distance_component*> test
 *     cdef Distance_component[:] dummy_view
 *     if len(data) == 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result = ()
 *     else:
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 168; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = (__pyx_t_5 == 0);
  if (__pyx_t_6) {
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line169")'> 169:         result = ()</pre>
<pre id='line169' class='code' style='background-color: #FFFFe7'>
    /* "Cython_shift_calculator.pyx":169
 *     cdef Distance_component[:] dummy_view
 *     if len(data) == 0:
 *         result = ()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     else:
 *         dummy_view = <code><</code>Distance_component[:len(data)/ sizeof(Distance_component)]> &test2[0]
 */
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_empty_tuple));
    __pyx_v_result = __pyx_empty_tuple;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line170")'> 170:     else:</pre>
<pre id='line170' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line171")'> 171:         dummy_view = &lt;Distance_component[:len(data)/ sizeof(Distance_component)]&gt; &amp;test2[0]</pre>
<pre id='line171' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":171
 *         result = ()
 *     else:
 *         dummy_view = <code><</code>Distance_component[:len(data)/ sizeof(Distance_component)]> &test2[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         result_data = []
 */
    __pyx_t_7 = (&(__pyx_v_test2[0]));
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    if (!__pyx_t_7) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
     <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_1 = __pyx_format_from_typeinfo(&__Pyx_TypeInfo_nn_struct___pyx_t_17shift_calculators_Distance_component);
    __pyx_t_3 = Py_BuildValue("("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)(__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Distance_component)))));
    if (unlikely(!__pyx_t_1 || !__pyx_t_3 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_8 = __pyx_array_new(__pyx_t_3, sizeof(struct __pyx_t_17shift_calculators_Distance_component), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_1), (char *) "c", (char *) __pyx_t_7);
    if (unlikely(!__pyx_t_8))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn_struct___pyx_t_17shift_calculators_Distance_component(((PyObject *)__pyx_t_8));
    if (unlikely(!__pyx_t_9.memview))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
    __pyx_v_dummy_view = __pyx_t_9;
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line172")'> 172: </pre>
<pre id='line172' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line173")'> 173:         result_data = []</pre>
<pre id='line173' class='code' style='background-color: #FFFFaa'>
    /* "Cython_shift_calculator.pyx":173
 *         dummy_view = <code><</code>Distance_component[:len(data)/ sizeof(Distance_component)]> &test2[0]
 * 
 *         result_data = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for i in range(len(data)/ sizeof(Distance_component)):
 *             result_data.append((dummy_view[i].target_atom,  dummy_view[i].remote_atom_1,  dummy_view[i].remote_atom_2,   dummy_view[i].coefficient, dummy_view[i].exponent))
 */
    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_v_result_data = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF1e' onclick='toggleDiv("line174")'> 174:         for i in range(len(data)/ sizeof(Distance_component)):</pre>
<pre id='line174' class='code' style='background-color: #FFFF1e'>
    /* "Cython_shift_calculator.pyx":174
 * 
 *         result_data = []
 *         for i in range(len(data)/ sizeof(Distance_component)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             result_data.append((dummy_view[i].target_atom,  dummy_view[i].remote_atom_1,  dummy_view[i].remote_atom_2,   dummy_view[i].coefficient, dummy_view[i].exponent))
 *         result = tuple(result_data)
 */
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = __Pyx_<span class='py_c_api'>PyInt_FromSize_t</span>((__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Distance_component))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      __pyx_t_3 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5 = 0;
      __pyx_t_10 = NULL;
    } else {
      __pyx_t_5 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_10 = Py_TYPE(__pyx_t_3)->tp_iternext;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (!__pyx_t_10 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) {
        if (__pyx_t_5 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else if (!__pyx_t_10 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
        if (__pyx_t_5 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else {
        __pyx_t_1 = __pyx_t_10(__pyx_t_3);
        if (unlikely(!__pyx_t_1)) {
          if (<span class='py_c_api'>PyErr_Occurred</span>()) {
            if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
      __pyx_v_i = __pyx_t_1;
      __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF19' onclick='toggleDiv("line175")'> 175:             result_data.append((dummy_view[i].target_atom,  dummy_view[i].remote_atom_1,  dummy_view[i].remote_atom_2,   dummy_view[i].coefficient, dummy_view[i].exponent))</pre>
<pre id='line175' class='code' style='background-color: #FFFF19'>
      /* "Cython_shift_calculator.pyx":175
 *         result_data = []
 *         for i in range(len(data)/ sizeof(Distance_component)):
 *             result_data.append((dummy_view[i].target_atom,  dummy_view[i].remote_atom_1,  dummy_view[i].remote_atom_2,   dummy_view[i].coefficient, dummy_view[i].exponent))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result = tuple(result_data)
 *     return result
 */
      __pyx_t_11 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_12 = __pyx_t_11;
      __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>((*((struct __pyx_t_17shift_calculators_Distance_component *) ( /* dim=0 */ (__pyx_v_dummy_view.data + __pyx_t_12 * __pyx_v_dummy_view.strides[0]) ))).target_atom);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_11 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_13 = __pyx_t_11;
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>((*((struct __pyx_t_17shift_calculators_Distance_component *) ( /* dim=0 */ (__pyx_v_dummy_view.data + __pyx_t_13 * __pyx_v_dummy_view.strides[0]) ))).remote_atom_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_11 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_14 = __pyx_t_11;
      __pyx_t_15 = <span class='py_c_api'>PyInt_FromLong</span>((*((struct __pyx_t_17shift_calculators_Distance_component *) ( /* dim=0 */ (__pyx_v_dummy_view.data + __pyx_t_14 * __pyx_v_dummy_view.strides[0]) ))).remote_atom_2);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_15);
      __pyx_t_11 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_16 = __pyx_t_11;
      __pyx_t_17 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((struct __pyx_t_17shift_calculators_Distance_component *) ( /* dim=0 */ (__pyx_v_dummy_view.data + __pyx_t_16 * __pyx_v_dummy_view.strides[0]) ))).coefficient);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
      __pyx_t_11 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_18 = __pyx_t_11;
      __pyx_t_19 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((struct __pyx_t_17shift_calculators_Distance_component *) ( /* dim=0 */ (__pyx_v_dummy_view.data + __pyx_t_18 * __pyx_v_dummy_view.strides[0]) ))).exponent);<span class='error_goto'> if (unlikely(!__pyx_t_19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_19);
      __pyx_t_20 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_20)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_20);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 0, __pyx_t_1);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 1, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 2, __pyx_t_15);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_15);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 3, __pyx_t_17);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_17);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 4, __pyx_t_19);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_19);
      __pyx_t_1 = 0;
      __pyx_t_2 = 0;
      __pyx_t_15 = 0;
      __pyx_t_17 = 0;
      __pyx_t_19 = 0;
      __pyx_t_21 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_result_data, ((PyObject *)__pyx_t_20));<span class='error_goto'> if (unlikely(__pyx_t_21 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_20)); __pyx_t_20 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line176")'> 176:         result = tuple(result_data)</pre>
<pre id='line176' class='code' style='background-color: #FFFFaa'>
    /* "Cython_shift_calculator.pyx":176
 *         for i in range(len(data)/ sizeof(Distance_component)):
 *             result_data.append((dummy_view[i].target_atom,  dummy_view[i].remote_atom_1,  dummy_view[i].remote_atom_2,   dummy_view[i].coefficient, dummy_view[i].exponent))
 *         result = tuple(result_data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return result
 * 
 */
    __pyx_t_3 = ((PyObject *)<span class='py_c_api'>PyList_AsTuple</span>(__pyx_v_result_data));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
    __pyx_v_result = ((PyObject*)__pyx_t_3);
    __pyx_t_3 = 0;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line177")'> 177:     return result</pre>
<pre id='line177' class='code' style='background-color: #FFFF55'>
  /* "Cython_shift_calculator.pyx":177
 *             result_data.append((dummy_view[i].target_atom,  dummy_view[i].remote_atom_1,  dummy_view[i].remote_atom_2,   dummy_view[i].coefficient, dummy_view[i].exponent))
 *         result = tuple(result_data)
 *     return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * def test_dump_dihedral_comp(data):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_result));
  __pyx_r = ((PyObject *)__pyx_v_result);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_t_8));
  __PYX_XDEC_MEMVIEW(&__pyx_t_9, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_19);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.test_dump_dist_comp", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&__pyx_v_dummy_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result_data);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_13test_dump_dihedral_comp(PyObject *__pyx_self, PyObject *__pyx_v_data); /*proto*/
static PyMethodDef __pyx_mdef_17shift_calculators_13test_dump_dihedral_comp = {<span class='pyx_macro_api'>__Pyx_NAMESTR</span>("test_dump_dihedral_comp"), (PyCFunction)__pyx_pw_17shift_calculators_13test_dump_dihedral_comp, METH_O, <span class='pyx_macro_api'>__Pyx_DOCSTR</span>(0)};
static PyObject *__pyx_pw_17shift_calculators_13test_dump_dihedral_comp(PyObject *__pyx_self, PyObject *__pyx_v_data) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("test_dump_dihedral_comp (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_12test_dump_dihedral_comp(__pyx_self, ((PyObject *)__pyx_v_data));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line178")'> 178: </pre>
<pre id='line178' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line179")'> 179: def test_dump_dihedral_comp(data):</pre>
<pre id='line179' class='code' style='background-color: #FFFF62'>
/* "Cython_shift_calculator.pyx":179
 *     return result
 * 
 * def test_dump_dihedral_comp(data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef size_t  test  = ctypes.addressof(data)
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_12test_dump_dihedral_comp(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data) {
  size_t __pyx_v_test;
  struct __pyx_t_17shift_calculators_Dihedral_component *__pyx_v_compiled_components;
  PyObject *__pyx_v_num_components = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("test_dump_dihedral_comp", 0);

  /* "Cython_shift_calculator.pyx":179
 *     return result
 * 
 * def test_dump_dihedral_comp(data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef size_t  test  = ctypes.addressof(data)
 * 
 */
  __pyx_k_tuple_110 = <span class='py_c_api'>PyTuple_Pack</span>(5, ((PyObject *)__pyx_n_s__data), ((PyObject *)__pyx_n_s__test), ((PyObject *)__pyx_n_s__compiled_components), ((PyObject *)__pyx_n_s__num_components), ((PyObject *)__pyx_n_s__i));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_110)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_110);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_110));

  /* "Cython_shift_calculator.pyx":179
 *     return result
 * 
 * def test_dump_dihedral_comp(data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef size_t  test  = ctypes.addressof(data)
 * 
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_17shift_calculators_13test_dump_dihedral_comp, NULL, __pyx_n_s__shift_calculators);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s_112, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k_codeobj_111 = (PyObject*)__Pyx_<span class='py_c_api'>PyCode_New</span>(1, 0, 5, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_110, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_104, __pyx_n_s_112, 179, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_k_codeobj_111)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line180")'> 180:     cdef size_t  test  = ctypes.addressof(data)</pre>
<pre id='line180' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":180
 * 
 * def test_dump_dihedral_comp(data):
 *     cdef size_t  test  = ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     compiled_components =  <code><</code>Dihedral_component*> <code><</code>size_t> ctypes.addressof(data)
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_test = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line181")'> 181: </pre>
<pre id='line181' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line182")'> 182:     compiled_components =  &lt;Dihedral_component*&gt; &lt;size_t&gt; ctypes.addressof(data)</pre>
<pre id='line182' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":182
 *     cdef size_t  test  = ctypes.addressof(data)
 * 
 *     compiled_components =  <code><</code>Dihedral_component*> <code><</code>size_t> ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     num_components =  len(data)/ sizeof(Dihedral_component)
 *     print 'dump num comp',num_components, test
 */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_3, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_compiled_components = ((struct __pyx_t_17shift_calculators_Dihedral_component *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line183")'> 183:     num_components =  len(data)/ sizeof(Dihedral_component)</pre>
<pre id='line183' class='code' style='background-color: #FFFF7f'>
  /* "Cython_shift_calculator.pyx":183
 * 
 *     compiled_components =  <code><</code>Dihedral_component*> <code><</code>size_t> ctypes.addressof(data)
 *     num_components =  len(data)/ sizeof(Dihedral_component)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     print 'dump num comp',num_components, test
 * 
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyInt_FromSize_t</span>((__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Dihedral_component))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_v_num_components = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line184")'> 184:     print 'dump num comp',num_components, test</pre>
<pre id='line184' class='code' style='background-color: #FFFF5b'>
  /* "Cython_shift_calculator.pyx":184
 *     compiled_components =  <code><</code>Dihedral_component*> <code><</code>size_t> ctypes.addressof(data)
 *     num_components =  len(data)/ sizeof(Dihedral_component)
 *     print 'dump num comp',num_components, test             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     for i in range(num_components):
 */
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyInt_FromSize_t</span>(__pyx_v_test);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_6));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, ((PyObject *)__pyx_kp_s_6));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_6));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_components);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_num_components);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_num_components);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;
  if (<span class='pyx_c_api'>__Pyx_Print</span>(0, ((PyObject *)__pyx_t_3), 1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line185")'> 185: </pre>
<pre id='line185' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF22' onclick='toggleDiv("line186")'> 186:     for i in range(num_components):</pre>
<pre id='line186' class='code' style='background-color: #FFFF22'>
  /* "Cython_shift_calculator.pyx":186
 *     print 'dump num comp',num_components, test
 * 
 *     for i in range(num_components):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         print 'target_atom',i, compiled_components[0].target_atom
 */
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_components);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_num_components);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_num_components);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
    __pyx_t_3 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_6 = Py_TYPE(__pyx_t_3)->tp_iternext;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (!__pyx_t_6 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) {
      if (__pyx_t_5 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_6 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
      if (__pyx_t_5 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_2 = __pyx_t_6(__pyx_t_3);
      if (unlikely(!__pyx_t_2)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
    __pyx_v_i = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line187")'> 187: </pre>
<pre id='line187' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line188")'> 188:         print 'target_atom',i, compiled_components[0].target_atom</pre>
<pre id='line188' class='code' style='background-color: #FFFF5b'>
    /* "Cython_shift_calculator.pyx":188
 *     for i in range(num_components):
 * 
 *         print 'target_atom',i, compiled_components[0].target_atom             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         print 'dihedral_atoms',i, compiled_components[i].dihedral_atoms[0],compiled_components[i].dihedral_atoms[1],\
 */
    __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_compiled_components[0]).target_atom);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 188; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 188; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__target_atom));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_n_s__target_atom));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__target_atom));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_i);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_t_2);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
    __pyx_t_2 = 0;
    if (<span class='pyx_c_api'>__Pyx_Print</span>(0, ((PyObject *)__pyx_t_1), 1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 188; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line189")'> 189: </pre>
<pre id='line189' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line190")'> 190:         print 'dihedral_atoms',i, compiled_components[i].dihedral_atoms[0],compiled_components[i].dihedral_atoms[1],\</pre>
<pre id='line190' class='code' style='background-color: #FFFF3f'>
    /* "Cython_shift_calculator.pyx":190
 *         print 'target_atom',i, compiled_components[0].target_atom
 * 
 *         print 'dihedral_atoms',i, compiled_components[i].dihedral_atoms[0],compiled_components[i].dihedral_atoms[1],\             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                compiled_components[i].dihedral_atoms[2], compiled_components[i].dihedral_atoms[4]
 *         print 'coeff',i, compiled_components[i].coefficient
 */
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(((__pyx_v_compiled_components[__pyx_t_7]).dihedral_atoms[0]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(((__pyx_v_compiled_components[__pyx_t_7]).dihedral_atoms[1]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
</pre><pre class='line' style='background-color: #FFFF2d' onclick='toggleDiv("line191")'> 191:                                compiled_components[i].dihedral_atoms[2], compiled_components[i].dihedral_atoms[4]</pre>
<pre id='line191' class='code' style='background-color: #FFFF2d'>
    /* "Cython_shift_calculator.pyx":191
 * 
 *         print 'dihedral_atoms',i, compiled_components[i].dihedral_atoms[0],compiled_components[i].dihedral_atoms[1],\
 *                                compiled_components[i].dihedral_atoms[2], compiled_components[i].dihedral_atoms[4]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         print 'coeff',i, compiled_components[i].coefficient
 *         print 'param',i, compiled_components[i].parameters[0], compiled_components[i].parameters[1],\
 */
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_8 = <span class='py_c_api'>PyInt_FromLong</span>(((__pyx_v_compiled_components[__pyx_t_7]).dihedral_atoms[2]));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_9 = <span class='py_c_api'>PyInt_FromLong</span>(((__pyx_v_compiled_components[__pyx_t_7]).dihedral_atoms[4]));<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
    __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__dihedral_atoms));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, ((PyObject *)__pyx_n_s__dihedral_atoms));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__dihedral_atoms));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_v_i);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 2, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 3, __pyx_t_2);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 4, __pyx_t_8);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 5, __pyx_t_9);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_9);
    __pyx_t_1 = 0;
    __pyx_t_2 = 0;
    __pyx_t_8 = 0;
    __pyx_t_9 = 0;
    if (<span class='pyx_c_api'>__Pyx_Print</span>(0, ((PyObject *)__pyx_t_10), 1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_10)); __pyx_t_10 = 0;
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line192")'> 192:         print 'coeff',i, compiled_components[i].coefficient</pre>
<pre id='line192' class='code' style='background-color: #FFFF43'>
    /* "Cython_shift_calculator.pyx":192
 *         print 'dihedral_atoms',i, compiled_components[i].dihedral_atoms[0],compiled_components[i].dihedral_atoms[1],\
 *                                compiled_components[i].dihedral_atoms[2], compiled_components[i].dihedral_atoms[4]
 *         print 'coeff',i, compiled_components[i].coefficient             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         print 'param',i, compiled_components[i].parameters[0], compiled_components[i].parameters[1],\
 *                       compiled_components[i].parameters[2], compiled_components[i].parameters[3],\
 */
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_10 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_compiled_components[__pyx_t_7]).coefficient);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__coeff));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, ((PyObject *)__pyx_n_s__coeff));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__coeff));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_v_i);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2, __pyx_t_10);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_10);
    __pyx_t_10 = 0;
    if (<span class='pyx_c_api'>__Pyx_Print</span>(0, ((PyObject *)__pyx_t_9), 1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_9)); __pyx_t_9 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line193")'> 193:         print 'param',i, compiled_components[i].parameters[0], compiled_components[i].parameters[1],\</pre>
<pre id='line193' class='code' style='background-color: #FFFF3f'>
    /* "Cython_shift_calculator.pyx":193
 *                                compiled_components[i].dihedral_atoms[2], compiled_components[i].dihedral_atoms[4]
 *         print 'coeff',i, compiled_components[i].coefficient
 *         print 'param',i, compiled_components[i].parameters[0], compiled_components[i].parameters[1],\             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                       compiled_components[i].parameters[2], compiled_components[i].parameters[3],\
 *                       compiled_components[i].parameters[4], compiled_components[i].parameters[5],\
 */
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_compiled_components[__pyx_t_7]).parameters[0]));<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_10 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_compiled_components[__pyx_t_7]).parameters[1]));<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line194")'> 194:                       compiled_components[i].parameters[2], compiled_components[i].parameters[3],\</pre>
<pre id='line194' class='code' style='background-color: #FFFF3f'>
    /* "Cython_shift_calculator.pyx":194
 *         print 'coeff',i, compiled_components[i].coefficient
 *         print 'param',i, compiled_components[i].parameters[0], compiled_components[i].parameters[1],\
 *                       compiled_components[i].parameters[2], compiled_components[i].parameters[3],\             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                       compiled_components[i].parameters[4], compiled_components[i].parameters[5],\
 *                       compiled_components[i].parameters[6]
 */
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_compiled_components[__pyx_t_7]).parameters[2]));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_compiled_components[__pyx_t_7]).parameters[3]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line195")'> 195:                       compiled_components[i].parameters[4], compiled_components[i].parameters[5],\</pre>
<pre id='line195' class='code' style='background-color: #FFFF3f'>
    /* "Cython_shift_calculator.pyx":195
 *         print 'param',i, compiled_components[i].parameters[0], compiled_components[i].parameters[1],\
 *                       compiled_components[i].parameters[2], compiled_components[i].parameters[3],\
 *                       compiled_components[i].parameters[4], compiled_components[i].parameters[5],\             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                       compiled_components[i].parameters[6]
 * 
 */
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_compiled_components[__pyx_t_7]).parameters[4]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_compiled_components[__pyx_t_7]).parameters[5]));<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
</pre><pre class='line' style='background-color: #FFFF19' onclick='toggleDiv("line196")'> 196:                       compiled_components[i].parameters[6]</pre>
<pre id='line196' class='code' style='background-color: #FFFF19'>
    /* "Cython_shift_calculator.pyx":196
 *                       compiled_components[i].parameters[2], compiled_components[i].parameters[3],\
 *                       compiled_components[i].parameters[4], compiled_components[i].parameters[5],\
 *                       compiled_components[i].parameters[6]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef class CDSSharedVectorFloat:
 */
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_12 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_compiled_components[__pyx_t_7]).parameters[6]));<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
    __pyx_t_13 = <span class='py_c_api'>PyTuple_New</span>(9);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__param));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0, ((PyObject *)__pyx_n_s__param));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__param));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 1, __pyx_v_i);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 2, __pyx_t_9);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 3, __pyx_t_10);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_10);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 4, __pyx_t_8);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 5, __pyx_t_2);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 6, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 7, __pyx_t_11);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_11);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 8, __pyx_t_12);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_12);
    __pyx_t_9 = 0;
    __pyx_t_10 = 0;
    __pyx_t_8 = 0;
    __pyx_t_2 = 0;
    __pyx_t_1 = 0;
    __pyx_t_11 = 0;
    __pyx_t_12 = 0;
    if (<span class='pyx_c_api'>__Pyx_Print</span>(0, ((PyObject *)__pyx_t_13), 1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_13)); __pyx_t_13 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.test_dump_dihedral_comp", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_components);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_20CDSSharedVectorFloat_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_20CDSSharedVectorFloat_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_size;
  PyObject *__pyx_v_ensembleSimulation = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__size,&__pyx_n_s__ensembleSimulation,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__size)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__ensembleSimulation)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_size = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_size == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_ensembleSimulation = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.CDSSharedVectorFloat.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_20CDSSharedVectorFloat___init__(((struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *)__pyx_v_self), __pyx_v_size, __pyx_v_ensembleSimulation);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line197")'> 197: </pre>
<pre id='line197' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line198")'> 198: cdef class CDSSharedVectorFloat:</pre>
<pre id='line198' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":198
 *                       compiled_components[i].parameters[6]
 * 
 * cdef class CDSSharedVectorFloat:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef void *  data
 *     cdef int size
 */
struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat {
  PyObject_HEAD
  struct __pyx_vtabstruct_17shift_calculators_CDSSharedVectorFloat *__pyx_vtab;
  void *data;
  int size;
  PyObject *_simulation;
  int _ensemble_size;
};


/* "Cython_shift_calculator.pyx":198
 *                       compiled_components[i].parameters[6]
 * 
 * cdef class CDSSharedVectorFloat:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef void *  data
 *     cdef int size
 */

struct __pyx_vtabstruct_17shift_calculators_CDSSharedVectorFloat {
  PyObject *(*resize)(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *, int, int __pyx_skip_dispatch);
  PyObject *(*clear)(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *, int __pyx_skip_dispatch);
  int (*array_offset)(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *, int, int);
  int (*ensemble_array_offset)(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *, int);
  void (*addToResult)(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *, int, double);
};
static struct __pyx_vtabstruct_17shift_calculators_CDSSharedVectorFloat *__pyx_vtabptr_17shift_calculators_CDSSharedVectorFloat;
static CYTHON_INLINE int __pyx_f_17shift_calculators_20CDSSharedVectorFloat_array_offset(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *, int, int);
static CYTHON_INLINE int __pyx_f_17shift_calculators_20CDSSharedVectorFloat_ensemble_array_offset(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *, int);
static CYTHON_INLINE void __pyx_f_17shift_calculators_20CDSSharedVectorFloat_addToResult(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *, int, double);


</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line199")'> 199:     cdef void *  data</pre>
<pre id='line199' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line200")'> 200:     cdef int size</pre>
<pre id='line200' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line201")'> 201:     cdef object _simulation</pre>
<pre id='line201' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line202")'> 202:     cdef int _ensemble_size</pre>
<pre id='line202' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line203")'> 203: </pre>
<pre id='line203' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line204")'> 204:     def __init__(self, int size, object ensembleSimulation):</pre>
<pre id='line204' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":204
 *     cdef int _ensemble_size
 * 
 *     def __init__(self, int size, object ensembleSimulation):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._simulation = ensembleSimulation
 *         self._ensemble_size = ensembleSimulation.size()
 */

static int __pyx_pf_17shift_calculators_20CDSSharedVectorFloat___init__(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_self, int __pyx_v_size, PyObject *__pyx_v_ensembleSimulation) {
  EnsembleSimulation *__pyx_v_cEnsembleSimulation;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line205")'> 205:         self._simulation = ensembleSimulation</pre>
<pre id='line205' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":205
 * 
 *     def __init__(self, int size, object ensembleSimulation):
 *         self._simulation = ensembleSimulation             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._ensemble_size = ensembleSimulation.size()
 * 
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ensembleSimulation);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_ensembleSimulation);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_simulation);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_simulation);
  __pyx_v_self->_simulation = __pyx_v_ensembleSimulation;
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line206")'> 206:         self._ensemble_size = ensembleSimulation.size()</pre>
<pre id='line206' class='code' style='background-color: #FFFF4f'>
  /* "Cython_shift_calculator.pyx":206
 *     def __init__(self, int size, object ensembleSimulation):
 *         self._simulation = ensembleSimulation
 *         self._ensemble_size = ensembleSimulation.size()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef EnsembleSimulation* cEnsembleSimulation = simulationAsNative(ensembleSimulation)
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_ensembleSimulation, __pyx_n_s__size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_self->_ensemble_size = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line207")'> 207: </pre>
<pre id='line207' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line208")'> 208:         cdef EnsembleSimulation* cEnsembleSimulation = simulationAsNative(ensembleSimulation)</pre>
<pre id='line208' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":208
 *         self._ensemble_size = ensembleSimulation.size()
 * 
 *         cdef EnsembleSimulation* cEnsembleSimulation = simulationAsNative(ensembleSimulation)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.data = <code><</code>CDSVector[double]*>createSharedVector(size*self._ensemble_size, 0.0,  cEnsembleSimulation)
 *         self.size = size
 */
  __pyx_t_4 = __pyx_f_17shift_calculators_simulationAsNative(__pyx_v_ensembleSimulation);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 208; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_cEnsembleSimulation = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line209")'> 209:         self.data = &lt;CDSVector[double]*&gt;createSharedVector(size*self._ensemble_size, 0.0,  cEnsembleSimulation)</pre>
<pre id='line209' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":209
 * 
 *         cdef EnsembleSimulation* cEnsembleSimulation = simulationAsNative(ensembleSimulation)
 *         self.data = <code><</code>CDSVector[double]*>createSharedVector(size*self._ensemble_size, 0.0,  cEnsembleSimulation)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.size = size
 * 
 */
  __pyx_v_self->data = ((CDSVector<code><</code>double> *)SharedCDSVectorFactory::createSharedVector((__pyx_v_size * __pyx_v_self->_ensemble_size), 0.0, __pyx_v_cEnsembleSimulation));
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line210")'> 210:         self.size = size</pre>
<pre id='line210' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":210
 *         cdef EnsembleSimulation* cEnsembleSimulation = simulationAsNative(ensembleSimulation)
 *         self.data = <code><</code>CDSVector[double]*>createSharedVector(size*self._ensemble_size, 0.0,  cEnsembleSimulation)
 *         self.size = size             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef resize(self,int size):
 */
  __pyx_v_self->size = __pyx_v_size;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.CDSSharedVectorFloat.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line211")'> 211: </pre>
<pre id='line211' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line212")'> 212:     cpdef resize(self,int size):</pre>
<pre id='line212' class='code' style='background-color: #FFFF3e'>
/* "Cython_shift_calculator.pyx":212
 *         self.size = size
 * 
 *     cpdef resize(self,int size):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.size = size * self._ensemble_size
 *         resizeSharedVector(self.data,self.size)
 */

static PyObject *__pyx_pw_17shift_calculators_20CDSSharedVectorFloat_3resize(PyObject *__pyx_v_self, PyObject *__pyx_arg_size); /*proto*/
static PyObject *__pyx_f_17shift_calculators_20CDSSharedVectorFloat_resize(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_self, int __pyx_v_size, int __pyx_skip_dispatch) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("resize", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s__resize);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_17shift_calculators_20CDSSharedVectorFloat_3resize)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_size);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "Cython_shift_calculator.pyx":212
 *         self.size = size
 * 
 *     cpdef resize(self,int size):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.size = size * self._ensemble_size
 *         resizeSharedVector(self.data,self.size)
 */

static PyObject *__pyx_pf_17shift_calculators_20CDSSharedVectorFloat_2resize(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_self, int __pyx_v_size) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("resize", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_17shift_calculators_CDSSharedVectorFloat *)__pyx_v_self->__pyx_vtab)->resize(__pyx_v_self, __pyx_v_size, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.CDSSharedVectorFloat.resize", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line213")'> 213:         self.size = size * self._ensemble_size</pre>
<pre id='line213' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":213
 * 
 *     cpdef resize(self,int size):
 *         self.size = size * self._ensemble_size             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         resizeSharedVector(self.data,self.size)
 *         return self
 */
  __pyx_v_self->size = (__pyx_v_size * __pyx_v_self->_ensemble_size);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line214")'> 214:         resizeSharedVector(self.data,self.size)</pre>
<pre id='line214' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":214
 *     cpdef resize(self,int size):
 *         self.size = size * self._ensemble_size
 *         resizeSharedVector(self.data,self.size)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self
 * 
 */
  SharedCDSVectorFactory::resizeSharedVector(__pyx_v_self->data, __pyx_v_self->size);
</pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line215")'> 215:         return self</pre>
<pre id='line215' class='code' style='background-color: #FFFF4d'>
  /* "Cython_shift_calculator.pyx":215
 *         self.size = size * self._ensemble_size
 *         resizeSharedVector(self.data,self.size)
 *         return self             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef clear(self):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  __pyx_r = ((PyObject *)__pyx_v_self);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.CDSSharedVectorFloat.resize", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_20CDSSharedVectorFloat_3resize(PyObject *__pyx_v_self, PyObject *__pyx_arg_size); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_20CDSSharedVectorFloat_3resize(PyObject *__pyx_v_self, PyObject *__pyx_arg_size) {
  int __pyx_v_size;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("resize (wrapper)", 0);
  assert(__pyx_arg_size); {
    __pyx_v_size = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_arg_size);<span class='error_goto'> if (unlikely((__pyx_v_size == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.CDSSharedVectorFloat.resize", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_20CDSSharedVectorFloat_2resize(((struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *)__pyx_v_self), ((int)__pyx_v_size));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line216")'> 216: </pre>
<pre id='line216' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line217")'> 217:     cpdef clear(self):</pre>
<pre id='line217' class='code' style='background-color: #FFFF55'>
/* "Cython_shift_calculator.pyx":217
 *         return self
 * 
 *     cpdef clear(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         clearSharedVector(self.data)
 *         return self
 */

static PyObject *__pyx_pw_17shift_calculators_20CDSSharedVectorFloat_5clear(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_f_17shift_calculators_20CDSSharedVectorFloat_clear(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_self, int __pyx_skip_dispatch) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("clear", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s__clear);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_17shift_calculators_20CDSSharedVectorFloat_5clear)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "Cython_shift_calculator.pyx":217
 *         return self
 * 
 *     cpdef clear(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         clearSharedVector(self.data)
 *         return self
 */

static PyObject *__pyx_pf_17shift_calculators_20CDSSharedVectorFloat_4clear(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("clear", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_17shift_calculators_CDSSharedVectorFloat *)__pyx_v_self->__pyx_vtab)->clear(__pyx_v_self, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.CDSSharedVectorFloat.clear", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static Py_ssize_t __pyx_pw_17shift_calculators_20CDSSharedVectorFloat_7__len__(PyObject *__pyx_v_self); /*proto*/
static Py_ssize_t __pyx_pw_17shift_calculators_20CDSSharedVectorFloat_7__len__(PyObject *__pyx_v_self) {
  Py_ssize_t __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__len__ (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_20CDSSharedVectorFloat_6__len__(((struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line218")'> 218:         clearSharedVector(self.data)</pre>
<pre id='line218' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":218
 * 
 *     cpdef clear(self):
 *         clearSharedVector(self.data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self
 * 
 */
  SharedCDSVectorFactory::clearSharedVector(__pyx_v_self->data);
</pre><pre class='line' style='background-color: #FFFF86' onclick='toggleDiv("line219")'> 219:         return self</pre>
<pre id='line219' class='code' style='background-color: #FFFF86'>
  /* "Cython_shift_calculator.pyx":219
 *     cpdef clear(self):
 *         clearSharedVector(self.data)
 *         return self             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __len__(self):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  __pyx_r = ((PyObject *)__pyx_v_self);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.CDSSharedVectorFloat.clear", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_20CDSSharedVectorFloat_5clear(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_20CDSSharedVectorFloat_5clear(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("clear (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_20CDSSharedVectorFloat_4clear(((struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line220")'> 220: </pre>
<pre id='line220' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line221")'> 221:     def __len__(self):</pre>
<pre id='line221' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":221
 *         return self
 * 
 *     def __len__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self.size* self._ensemble_size
 * 
 */

static Py_ssize_t __pyx_pf_17shift_calculators_20CDSSharedVectorFloat_6__len__(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_self) {
  Py_ssize_t __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__len__", 0);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line222")'> 222:         return self.size* self._ensemble_size</pre>
<pre id='line222' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":222
 * 
 *     def __len__(self):
 *         return self.size* self._ensemble_size             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_r = (__pyx_v_self->size * __pyx_v_self->_ensemble_size);
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line223")'> 223: </pre>
<pre id='line223' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line224")'> 224: </pre>
<pre id='line224' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line225")'> 225:     cdef inline int array_offset(self,int index, int ensemble_index):</pre>
<pre id='line225' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":225
 * 
 * 
 *     cdef inline int array_offset(self,int index, int ensemble_index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return (self._ensemble_size * index) + ensemble_index
 * 
 */

static CYTHON_INLINE int __pyx_f_17shift_calculators_20CDSSharedVectorFloat_array_offset(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_self, int __pyx_v_index, int __pyx_v_ensemble_index) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("array_offset", 0);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line226")'> 226:         return (self._ensemble_size * index) + ensemble_index</pre>
<pre id='line226' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":226
 * 
 *     cdef inline int array_offset(self,int index, int ensemble_index):
 *         return (self._ensemble_size * index) + ensemble_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline int ensemble_array_offset(self,int index):
 */
  __pyx_r = ((__pyx_v_self->_ensemble_size * __pyx_v_index) + __pyx_v_ensemble_index);
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line227")'> 227: </pre>
<pre id='line227' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line228")'> 228:     cdef inline int ensemble_array_offset(self,int index):</pre>
<pre id='line228' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":228
 *         return (self._ensemble_size * index) + ensemble_index
 * 
 *     cdef inline int ensemble_array_offset(self,int index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self.array_offset(index, self.ensemble_member_index())
 * 
 */

static CYTHON_INLINE int __pyx_f_17shift_calculators_20CDSSharedVectorFloat_ensemble_array_offset(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_self, int __pyx_v_index) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("ensemble_array_offset", 0);
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line229")'> 229:         return self.array_offset(index, self.ensemble_member_index())</pre>
<pre id='line229' class='code' style='background-color: #FFFF43'>
  /* "Cython_shift_calculator.pyx":229
 * 
 *     cdef inline int ensemble_array_offset(self,int index):
 *         return self.array_offset(index, self.ensemble_member_index())             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __str__(self):
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_f_17shift_calculators_20CDSSharedVectorFloat_array_offset(__pyx_v_self, __pyx_v_index, __pyx_t_3);
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.CDSSharedVectorFloat.ensemble_array_offset", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_20CDSSharedVectorFloat_9__str__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_20CDSSharedVectorFloat_9__str__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__str__ (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_20CDSSharedVectorFloat_8__str__(((struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line230")'> 230: </pre>
<pre id='line230' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line231")'> 231:     def __str__(self):</pre>
<pre id='line231' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":231
 *         return self.array_offset(index, self.ensemble_member_index())
 * 
 *     def __str__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         data = []
 *         for i in range(len(self)):
 */

static PyObject *__pyx_pf_17shift_calculators_20CDSSharedVectorFloat_8__str__(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_self) {
  PyObject *__pyx_v_data = NULL;
  PyObject *__pyx_v_i = NULL;
  double __pyx_v_value;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__str__", 0);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line232")'> 232:         data = []</pre>
<pre id='line232' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":232
 * 
 *     def __str__(self):
 *         data = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for i in range(len(self)):
 *             value  = getSharedVectorValue(self.data,i)
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_data = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF1e' onclick='toggleDiv("line233")'> 233:         for i in range(len(self)):</pre>
<pre id='line233' class='code' style='background-color: #FFFF1e'>
  /* "Cython_shift_calculator.pyx":233
 *     def __str__(self):
 *         data = []
 *         for i in range(len(self)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             value  = getSharedVectorValue(self.data,i)
 *             data.append('%7.3f' % value)
 */
  __pyx_t_2 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_v_self));<span class='error_goto'> if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_3 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_2 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_4 = Py_TYPE(__pyx_t_3)->tp_iternext;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (!__pyx_t_4 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_4 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_3);
      if (unlikely(!__pyx_t_1)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
    __pyx_v_i = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line234")'> 234:             value  = getSharedVectorValue(self.data,i)</pre>
<pre id='line234' class='code' style='background-color: #FFFF7f'>
    /* "Cython_shift_calculator.pyx":234
 *         data = []
 *         for i in range(len(self)):
 *             value  = getSharedVectorValue(self.data,i)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             data.append('%7.3f' % value)
 *         return 'esim size: ' +`self._ensemble_size` + ', [' + ', '.join(data) + ']'
 */
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_value = SharedCDSVectorFactory::getSharedVectorValue(__pyx_v_self->data, __pyx_t_5);
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line235")'> 235:             data.append('%7.3f' % value)</pre>
<pre id='line235' class='code' style='background-color: #FFFF5b'>
    /* "Cython_shift_calculator.pyx":235
 *         for i in range(len(self)):
 *             value  = getSharedVectorValue(self.data,i)
 *             data.append('%7.3f' % value)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return 'esim size: ' +`self._ensemble_size` + ', [' + ', '.join(data) + ']'
 * 
 */
    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_value);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_8), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_6));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_data, ((PyObject *)__pyx_t_6));<span class='error_goto'> if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line236")'> 236:         return 'esim size: ' +`self._ensemble_size` + ', [' + ', '.join(data) + ']'</pre>
<pre id='line236' class='code' style='background-color: #FFFF20'>
  /* "Cython_shift_calculator.pyx":236
 *             value  = getSharedVectorValue(self.data,i)
 *             data.append('%7.3f' % value)
 *         return 'esim size: ' +`self._ensemble_size` + ', [' + ', '.join(data) + ']'             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_ensemble_size);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_6 = <span class='py_c_api'>PyObject_Repr</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_kp_s_9), __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, ((PyObject *)__pyx_kp_s_10));<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_kp_s_11), __pyx_n_s__join);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_data));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_data));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_data));
  __pyx_t_8 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_6, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, ((PyObject *)__pyx_kp_s_12));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_8;
  __pyx_t_8 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.CDSSharedVectorFloat.__str__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_20CDSSharedVectorFloat_11average_into(PyObject *__pyx_v_self, PyObject *__pyx_v_in_data); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_20CDSSharedVectorFloat_11average_into(PyObject *__pyx_v_self, PyObject *__pyx_v_in_data) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("average_into (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_in_data), __pyx_ptype_17shift_calculators_CDSVectorFloat, 1, "in_data", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_20CDSSharedVectorFloat_10average_into(((struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *)__pyx_v_self), ((struct __pyx_obj_17shift_calculators_CDSVectorFloat *)__pyx_v_in_data));
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line237")'> 237: </pre>
<pre id='line237' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line238")'> 238: </pre>
<pre id='line238' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line239")'> 239:     def average_into(self, CDSVectorFloat in_data):</pre>
<pre id='line239' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":239
 * 
 * 
 *     def average_into(self, CDSVectorFloat in_data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         in_data.clear()
 *         cdef CDSVector[double] *target =  in_data.data
 */

static PyObject *__pyx_pf_17shift_calculators_20CDSSharedVectorFloat_10average_into(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_self, struct __pyx_obj_17shift_calculators_CDSVectorFloat *__pyx_v_in_data) {
  CDSVector<code><</code>double> *__pyx_v_target;
  int __pyx_v_i;
  int __pyx_v_j;
  double __pyx_v_divisor;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("average_into", 0);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line240")'> 240:         in_data.clear()</pre>
<pre id='line240' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":240
 * 
 *     def average_into(self, CDSVectorFloat in_data):
 *         in_data.clear()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef CDSVector[double] *target =  in_data.data
 *         in_data.resize(self.size)
 */
  __pyx_t_1 = ((struct __pyx_vtabstruct_17shift_calculators_CDSVectorFloat *)__pyx_v_in_data->__pyx_vtab)->clear(__pyx_v_in_data, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line241")'> 241:         cdef CDSVector[double] *target =  in_data.data</pre>
<pre id='line241' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":241
 *     def average_into(self, CDSVectorFloat in_data):
 *         in_data.clear()
 *         cdef CDSVector[double] *target =  in_data.data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         in_data.resize(self.size)
 *         cdef int i,j
 */
  __pyx_t_2 = __pyx_v_in_data->data;
  __pyx_v_target = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line242")'> 242:         in_data.resize(self.size)</pre>
<pre id='line242' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":242
 *         in_data.clear()
 *         cdef CDSVector[double] *target =  in_data.data
 *         in_data.resize(self.size)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int i,j
 *         cdef double divisor = 1.0/self._ensemble_size
 */
  __pyx_t_1 = ((struct __pyx_vtabstruct_17shift_calculators_CDSVectorFloat *)__pyx_v_in_data->__pyx_vtab)->resize(__pyx_v_in_data, __pyx_v_self->size, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line243")'> 243:         cdef int i,j</pre>
<pre id='line243' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line244")'> 244:         cdef double divisor = 1.0/self._ensemble_size</pre>
<pre id='line244' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":244
 *         in_data.resize(self.size)
 *         cdef int i,j
 *         cdef double divisor = 1.0/self._ensemble_size             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for i in range(self.size):
 *             target[0][i]=0.0
 */
  __pyx_v_divisor = (1.0 / __pyx_v_self->_ensemble_size);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line245")'> 245:         for i in range(self.size):</pre>
<pre id='line245' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":245
 *         cdef int i,j
 *         cdef double divisor = 1.0/self._ensemble_size
 *         for i in range(self.size):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             target[0][i]=0.0
 *             for j in range(self._ensemble_size):
 */
  __pyx_t_3 = __pyx_v_self->size;
  for (__pyx_t_4 = 0; __pyx_t_4 <code><</code> __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_i = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line246")'> 246:             target[0][i]=0.0</pre>
<pre id='line246' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":246
 *         cdef double divisor = 1.0/self._ensemble_size
 *         for i in range(self.size):
 *             target[0][i]=0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for j in range(self._ensemble_size):
 *                 target[0][i] += getSharedVectorValue(self.data,self.array_offset(i,j)) * divisor
 */
    ((__pyx_v_target[0])[__pyx_v_i]) = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line247")'> 247:             for j in range(self._ensemble_size):</pre>
<pre id='line247' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":247
 *         for i in range(self.size):
 *             target[0][i]=0.0
 *             for j in range(self._ensemble_size):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 target[0][i] += getSharedVectorValue(self.data,self.array_offset(i,j)) * divisor
 * 
 */
    __pyx_t_5 = __pyx_v_self->_ensemble_size;
    for (__pyx_t_6 = 0; __pyx_t_6 <code><</code> __pyx_t_5; __pyx_t_6+=1) {
      __pyx_v_j = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line248")'> 248:                 target[0][i] += getSharedVectorValue(self.data,self.array_offset(i,j)) * divisor</pre>
<pre id='line248' class='code' style='background-color: #FFFFaa'>
      /* "Cython_shift_calculator.pyx":248
 *             target[0][i]=0.0
 *             for j in range(self._ensemble_size):
 *                 target[0][i] += getSharedVectorValue(self.data,self.array_offset(i,j)) * divisor             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline void addToResult(self, int offset, double value):
 */
      __pyx_t_7 = 0;
      __pyx_t_8 = __pyx_v_i;
      ((__pyx_v_target[__pyx_t_7])[__pyx_t_8]) = (((__pyx_v_target[__pyx_t_7])[__pyx_t_8]) + (SharedCDSVectorFactory::getSharedVectorValue(__pyx_v_self->data, __pyx_f_17shift_calculators_20CDSSharedVectorFloat_array_offset(__pyx_v_self, __pyx_v_i, __pyx_v_j)) * __pyx_v_divisor));
    }
  }

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.CDSSharedVectorFloat.average_into", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line249")'> 249: </pre>
<pre id='line249' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line250")'> 250:     cdef inline void addToResult(self, int offset, double value):</pre>
<pre id='line250' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":250
 *                 target[0][i] += getSharedVectorValue(self.data,self.array_offset(i,j)) * divisor
 * 
 *     cdef inline void addToResult(self, int offset, double value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         addToSharedVectorValue(self.data,offset,value)
 * 
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_20CDSSharedVectorFloat_addToResult(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_self, int __pyx_v_offset, double __pyx_v_value) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("addToResult", 0);
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line251")'> 251:         addToSharedVectorValue(self.data,offset,value)</pre>
<pre id='line251' class='code' style='background-color: #FFFF66'>
  /* "Cython_shift_calculator.pyx":251
 * 
 *     cdef inline void addToResult(self, int offset, double value):
 *         addToSharedVectorValue(self.data,offset,value)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __getitem__(self, int key):
 */
  SharedCDSVectorFactory::addToSharedVectorValue(__pyx_v_self->data, __pyx_v_offset, __pyx_v_value);

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_20CDSSharedVectorFloat_13__getitem__(PyObject *__pyx_v_self, PyObject *__pyx_arg_key); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_20CDSSharedVectorFloat_13__getitem__(PyObject *__pyx_v_self, PyObject *__pyx_arg_key) {
  int __pyx_v_key;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__getitem__ (wrapper)", 0);
  assert(__pyx_arg_key); {
    __pyx_v_key = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_arg_key);<span class='error_goto'> if (unlikely((__pyx_v_key == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.CDSSharedVectorFloat.__getitem__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_20CDSSharedVectorFloat_12__getitem__(((struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *)__pyx_v_self), ((int)__pyx_v_key));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line252")'> 252: </pre>
<pre id='line252' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line253")'> 253:     def __getitem__(self, int key):</pre>
<pre id='line253' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":253
 *         addToSharedVectorValue(self.data,offset,value)
 * 
 *     def __getitem__(self, int key):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if key >= len(self):
 *             raise IndexError("index (%i) out of range (%i)" % (key, len(self)))
 */

static PyObject *__pyx_pf_17shift_calculators_20CDSSharedVectorFloat_12__getitem__(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_self, int __pyx_v_key) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__getitem__", 0);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line254")'> 254:         if key &gt;= len(self):</pre>
<pre id='line254' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":254
 * 
 *     def __getitem__(self, int key):
 *         if key >= len(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             raise IndexError("index (%i) out of range (%i)" % (key, len(self)))
 *         return getSharedVectorValue(self.data,key)
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_v_self));<span class='error_goto'> if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = (__pyx_v_key >= __pyx_t_1);
  if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line255")'> 255:             raise IndexError("index (%i) out of range (%i)" % (key, len(self)))</pre>
<pre id='line255' class='code' style='background-color: #FFFF30'>
    /* "Cython_shift_calculator.pyx":255
 *     def __getitem__(self, int key):
 *         if key >= len(self):
 *             raise IndexError("index (%i) out of range (%i)" % (key, len(self)))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return getSharedVectorValue(self.data,key)
 * 
 */
    __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_v_self));<span class='error_goto'> if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
    __pyx_t_3 = 0;
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_13), ((PyObject *)__pyx_t_5));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_4));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, ((PyObject *)__pyx_t_4));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_4));
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_IndexError, ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_4, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFF44' onclick='toggleDiv("line256")'> 256:         return getSharedVectorValue(self.data,key)</pre>
<pre id='line256' class='code' style='background-color: #FFFF44'>
  /* "Cython_shift_calculator.pyx":256
 *         if key >= len(self):
 *             raise IndexError("index (%i) out of range (%i)" % (key, len(self)))
 *         return getSharedVectorValue(self.data,key)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __setitem__(self, int key,value):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(SharedCDSVectorFactory::getSharedVectorValue(__pyx_v_self->data, __pyx_v_key));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.CDSSharedVectorFloat.__getitem__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_20CDSSharedVectorFloat_15__setitem__(PyObject *__pyx_v_self, PyObject *__pyx_arg_key, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_17shift_calculators_20CDSSharedVectorFloat_15__setitem__(PyObject *__pyx_v_self, PyObject *__pyx_arg_key, PyObject *__pyx_v_value) {
  int __pyx_v_key;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__setitem__ (wrapper)", 0);
  assert(__pyx_arg_key); {
    __pyx_v_key = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_arg_key);<span class='error_goto'> if (unlikely((__pyx_v_key == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 258; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.CDSSharedVectorFloat.__setitem__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_20CDSSharedVectorFloat_14__setitem__(((struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *)__pyx_v_self), ((int)__pyx_v_key), ((PyObject *)__pyx_v_value));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line257")'> 257: </pre>
<pre id='line257' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line258")'> 258:     def __setitem__(self, int key,value):</pre>
<pre id='line258' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":258
 *         return getSharedVectorValue(self.data,key)
 * 
 *     def __setitem__(self, int key,value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if key >= self.size:
 *             raise IndexError("index (%i) out of range (%i)" % (key, len(self)))
 */

static int __pyx_pf_17shift_calculators_20CDSSharedVectorFloat_14__setitem__(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_self, int __pyx_v_key, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__setitem__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line259")'> 259:         if key &gt;= self.size:</pre>
<pre id='line259' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":259
 * 
 *     def __setitem__(self, int key,value):
 *         if key >= self.size:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             raise IndexError("index (%i) out of range (%i)" % (key, len(self)))
 *         setSharedVectorValue(self.data,key,value)
 */
  __pyx_t_1 = (__pyx_v_key >= __pyx_v_self->size);
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line260")'> 260:             raise IndexError("index (%i) out of range (%i)" % (key, len(self)))</pre>
<pre id='line260' class='code' style='background-color: #FFFF30'>
    /* "Cython_shift_calculator.pyx":260
 *     def __setitem__(self, int key,value):
 *         if key >= self.size:
 *             raise IndexError("index (%i) out of range (%i)" % (key, len(self)))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         setSharedVectorValue(self.data,key,value)
 * 
 */
    __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_v_self));<span class='error_goto'> if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
    __pyx_t_2 = 0;
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_13), ((PyObject *)__pyx_t_5));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_4));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, ((PyObject *)__pyx_t_4));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_4));
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_IndexError, ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_4, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line261")'> 261:         setSharedVectorValue(self.data,key,value)</pre>
<pre id='line261' class='code' style='background-color: #FFFF5e'>
  /* "Cython_shift_calculator.pyx":261
 *         if key >= self.size:
 *             raise IndexError("index (%i) out of range (%i)" % (key, len(self)))
 *         setSharedVectorValue(self.data,key,value)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __del__(self):
 */
  __pyx_t_6 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_value);<span class='error_goto'> if (unlikely((__pyx_t_6 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  SharedCDSVectorFactory::setSharedVectorValue(__pyx_v_self->data, __pyx_v_key, __pyx_t_6);

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.CDSSharedVectorFloat.__setitem__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_20CDSSharedVectorFloat_17__del__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_20CDSSharedVectorFloat_17__del__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__del__ (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_20CDSSharedVectorFloat_16__del__(((struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line262")'> 262: </pre>
<pre id='line262' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line263")'> 263:     def __del__(self):</pre>
<pre id='line263' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":263
 *         setSharedVectorValue(self.data,key,value)
 * 
 *     def __del__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         deleteSharedVector(self.data)
 *         self.data = NULL
 */

static PyObject *__pyx_pf_17shift_calculators_20CDSSharedVectorFloat_16__del__(struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__del__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line264")'> 264:         deleteSharedVector(self.data)</pre>
<pre id='line264' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":264
 * 
 *     def __del__(self):
 *         deleteSharedVector(self.data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.data = NULL
 * 
 */
  SharedCDSVectorFactory::deleteSharedVector(__pyx_v_self->data);
</pre><pre class='line' style='background-color: #FFFF38' onclick='toggleDiv("line265")'> 265:         self.data = NULL</pre>
<pre id='line265' class='code' style='background-color: #FFFF38'>
  /* "Cython_shift_calculator.pyx":265
 *     def __del__(self):
 *         deleteSharedVector(self.data)
 *         self.data = NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef class CDSVectorFloat:
 */
  __pyx_v_self->data = NULL;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_14CDSVectorFloat_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_14CDSVectorFloat_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_size;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__size,0};
    PyObject* values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__size)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 1) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
    }
    __pyx_v_size = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_size == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 1, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.CDSVectorFloat.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_14CDSVectorFloat___init__(((struct __pyx_obj_17shift_calculators_CDSVectorFloat *)__pyx_v_self), __pyx_v_size);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line266")'> 266: </pre>
<pre id='line266' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line267")'> 267: cdef class CDSVectorFloat:</pre>
<pre id='line267' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":267
 *         self.data = NULL
 * 
 * cdef class CDSVectorFloat:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef CDSVector[double] *data
 * 
 */
struct __pyx_obj_17shift_calculators_CDSVectorFloat {
  PyObject_HEAD
  struct __pyx_vtabstruct_17shift_calculators_CDSVectorFloat *__pyx_vtab;
  CDSVector<code><</code>double> *data;
};


/* "Cython_shift_calculator.pyx":267
 *         self.data = NULL
 * 
 * cdef class CDSVectorFloat:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef CDSVector[double] *data
 * 
 */

struct __pyx_vtabstruct_17shift_calculators_CDSVectorFloat {
  PyObject *(*resize)(struct __pyx_obj_17shift_calculators_CDSVectorFloat *, int, int __pyx_skip_dispatch);
  PyObject *(*clear)(struct __pyx_obj_17shift_calculators_CDSVectorFloat *, int __pyx_skip_dispatch);
  CDSVector<code><</code>double> *(*get_data)(struct __pyx_obj_17shift_calculators_CDSVectorFloat *);
};
static struct __pyx_vtabstruct_17shift_calculators_CDSVectorFloat *__pyx_vtabptr_17shift_calculators_CDSVectorFloat;

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line268")'> 268:     cdef CDSVector[double] *data</pre>
<pre id='line268' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line269")'> 269: </pre>
<pre id='line269' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line270")'> 270: </pre>
<pre id='line270' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line271")'> 271:     def __init__(self, int size):</pre>
<pre id='line271' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":271
 * 
 * 
 *     def __init__(self, int size):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.data = new CDSVector[double]()
 *         self.data[0].resize(size)
 */

static int __pyx_pf_17shift_calculators_14CDSVectorFloat___init__(struct __pyx_obj_17shift_calculators_CDSVectorFloat *__pyx_v_self, int __pyx_v_size) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line272")'> 272:         self.data = new CDSVector[double]()</pre>
<pre id='line272' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":272
 * 
 *     def __init__(self, int size):
 *         self.data = new CDSVector[double]()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.data[0].resize(size)
 * 
 */
  try {
    __pyx_t_1 = new CDSVector<code><</code>double>();
  } catch(...) {
    __Pyx_CppExn2PyErr();
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_v_self->data = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line273")'> 273:         self.data[0].resize(size)</pre>
<pre id='line273' class='code' style='background-color: #FFFFc4'>
  /* "Cython_shift_calculator.pyx":273
 *     def __init__(self, int size):
 *         self.data = new CDSVector[double]()
 *         self.data[0].resize(size)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef resize(self,int size):
 */
  (__pyx_v_self->data[0]).resize(__pyx_v_size);

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.CDSVectorFloat.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line274")'> 274: </pre>
<pre id='line274' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line275")'> 275:     cpdef resize(self,int size):</pre>
<pre id='line275' class='code' style='background-color: #FFFF3e'>
/* "Cython_shift_calculator.pyx":275
 *         self.data[0].resize(size)
 * 
 *     cpdef resize(self,int size):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.data[0].resize(size)
 * 
 */

static PyObject *__pyx_pw_17shift_calculators_14CDSVectorFloat_3resize(PyObject *__pyx_v_self, PyObject *__pyx_arg_size); /*proto*/
static PyObject *__pyx_f_17shift_calculators_14CDSVectorFloat_resize(struct __pyx_obj_17shift_calculators_CDSVectorFloat *__pyx_v_self, int __pyx_v_size, int __pyx_skip_dispatch) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("resize", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s__resize);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_17shift_calculators_14CDSVectorFloat_3resize)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_size);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "Cython_shift_calculator.pyx":275
 *         self.data[0].resize(size)
 * 
 *     cpdef resize(self,int size):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.data[0].resize(size)
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_14CDSVectorFloat_2resize(struct __pyx_obj_17shift_calculators_CDSVectorFloat *__pyx_v_self, int __pyx_v_size) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("resize", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_17shift_calculators_CDSVectorFloat *)__pyx_v_self->__pyx_vtab)->resize(__pyx_v_self, __pyx_v_size, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.CDSVectorFloat.resize", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line276")'> 276:         self.data[0].resize(size)</pre>
<pre id='line276' class='code' style='background-color: #FFFF52'>
  /* "Cython_shift_calculator.pyx":276
 * 
 *     cpdef resize(self,int size):
 *         self.data[0].resize(size)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef clear(self):
 */
  (__pyx_v_self->data[0]).resize(__pyx_v_size);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.CDSVectorFloat.resize", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_14CDSVectorFloat_3resize(PyObject *__pyx_v_self, PyObject *__pyx_arg_size); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_14CDSVectorFloat_3resize(PyObject *__pyx_v_self, PyObject *__pyx_arg_size) {
  int __pyx_v_size;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("resize (wrapper)", 0);
  assert(__pyx_arg_size); {
    __pyx_v_size = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_arg_size);<span class='error_goto'> if (unlikely((__pyx_v_size == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.CDSVectorFloat.resize", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_14CDSVectorFloat_2resize(((struct __pyx_obj_17shift_calculators_CDSVectorFloat *)__pyx_v_self), ((int)__pyx_v_size));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line277")'> 277: </pre>
<pre id='line277' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line278")'> 278:     cpdef clear(self):</pre>
<pre id='line278' class='code' style='background-color: #FFFF55'>
/* "Cython_shift_calculator.pyx":278
 *         self.data[0].resize(size)
 * 
 *     cpdef clear(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.data[0].set(0.0)
 * 
 */

static PyObject *__pyx_pw_17shift_calculators_14CDSVectorFloat_5clear(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_f_17shift_calculators_14CDSVectorFloat_clear(struct __pyx_obj_17shift_calculators_CDSVectorFloat *__pyx_v_self, int __pyx_skip_dispatch) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("clear", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s__clear);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 278; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_17shift_calculators_14CDSVectorFloat_5clear)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 278; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "Cython_shift_calculator.pyx":278
 *         self.data[0].resize(size)
 * 
 *     cpdef clear(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.data[0].set(0.0)
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_14CDSVectorFloat_4clear(struct __pyx_obj_17shift_calculators_CDSVectorFloat *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("clear", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_17shift_calculators_CDSVectorFloat *)__pyx_v_self->__pyx_vtab)->clear(__pyx_v_self, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 278; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.CDSVectorFloat.clear", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static Py_ssize_t __pyx_pw_17shift_calculators_14CDSVectorFloat_7__len__(PyObject *__pyx_v_self); /*proto*/
static Py_ssize_t __pyx_pw_17shift_calculators_14CDSVectorFloat_7__len__(PyObject *__pyx_v_self) {
  Py_ssize_t __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__len__ (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_14CDSVectorFloat_6__len__(((struct __pyx_obj_17shift_calculators_CDSVectorFloat *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line279")'> 279:         self.data[0].set(0.0)</pre>
<pre id='line279' class='code' style='background-color: #FFFF96'>
  /* "Cython_shift_calculator.pyx":279
 * 
 *     cpdef clear(self):
 *         self.data[0].set(0.0)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __len__(self):
 */
  (__pyx_v_self->data[0]).set(0.0);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.CDSVectorFloat.clear", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_14CDSVectorFloat_5clear(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_14CDSVectorFloat_5clear(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("clear (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_14CDSVectorFloat_4clear(((struct __pyx_obj_17shift_calculators_CDSVectorFloat *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line280")'> 280: </pre>
<pre id='line280' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line281")'> 281:     def __len__(self):</pre>
<pre id='line281' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":281
 *         self.data[0].set(0.0)
 * 
 *     def __len__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self.data[0].size()
 * 
 */

static Py_ssize_t __pyx_pf_17shift_calculators_14CDSVectorFloat_6__len__(struct __pyx_obj_17shift_calculators_CDSVectorFloat *__pyx_v_self) {
  Py_ssize_t __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__len__", 0);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line282")'> 282:         return self.data[0].size()</pre>
<pre id='line282' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":282
 * 
 *     def __len__(self):
 *         return self.data[0].size()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef CDSVector[double]* get_data(self):
 */
  __pyx_r = (__pyx_v_self->data[0]).size();
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line283")'> 283: </pre>
<pre id='line283' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line284")'> 284:     cdef CDSVector[double]* get_data(self):</pre>
<pre id='line284' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":284
 *         return self.data[0].size()
 * 
 *     cdef CDSVector[double]* get_data(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self.data
 * 
 */

static CDSVector<code><</code>double> *__pyx_f_17shift_calculators_14CDSVectorFloat_get_data(struct __pyx_obj_17shift_calculators_CDSVectorFloat *__pyx_v_self) {
  CDSVector<code><</code>double> *__pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_data", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line285")'> 285:         return self.data</pre>
<pre id='line285' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":285
 * 
 *     cdef CDSVector[double]* get_data(self):
 *         return self.data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __str__(self):
 */
  __pyx_r = __pyx_v_self->data;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_14CDSVectorFloat_9__str__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_14CDSVectorFloat_9__str__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__str__ (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_14CDSVectorFloat_8__str__(((struct __pyx_obj_17shift_calculators_CDSVectorFloat *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line286")'> 286: </pre>
<pre id='line286' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line287")'> 287:     def __str__(self):</pre>
<pre id='line287' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":287
 *         return self.data
 * 
 *     def __str__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result = []
 *         for i in range(self.data[0].size()):
 */

static PyObject *__pyx_pf_17shift_calculators_14CDSVectorFloat_8__str__(struct __pyx_obj_17shift_calculators_CDSVectorFloat *__pyx_v_self) {
  PyObject *__pyx_v_result = NULL;
  int __pyx_v_i;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__str__", 0);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line288")'> 288:         result = []</pre>
<pre id='line288' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":288
 * 
 *     def __str__(self):
 *         result = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for i in range(self.data[0].size()):
 *             result.append('%7.3f' % self.data[0][i])
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_result = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line289")'> 289:         for i in range(self.data[0].size()):</pre>
<pre id='line289' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":289
 *     def __str__(self):
 *         result = []
 *         for i in range(self.data[0].size()):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             result.append('%7.3f' % self.data[0][i])
 *         return '[' + ', '.join(result) + ']'
 */
  __pyx_t_2 = (__pyx_v_self->data[0]).size();
  for (__pyx_t_3 = 0; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line290")'> 290:             result.append('%7.3f' % self.data[0][i])</pre>
<pre id='line290' class='code' style='background-color: #FFFF5e'>
    /* "Cython_shift_calculator.pyx":290
 *         result = []
 *         for i in range(self.data[0].size()):
 *             result.append('%7.3f' % self.data[0][i])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return '[' + ', '.join(result) + ']'
 * 
 */
    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_self->data[0])[__pyx_v_i]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_8), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_4));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_result, ((PyObject *)__pyx_t_4));<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  }
</pre><pre class='line' style='background-color: #FFFF27' onclick='toggleDiv("line291")'> 291:         return '[' + ', '.join(result) + ']'</pre>
<pre id='line291' class='code' style='background-color: #FFFF27'>
  /* "Cython_shift_calculator.pyx":291
 *         for i in range(self.data[0].size()):
 *             result.append('%7.3f' % self.data[0][i])
 *         return '[' + ', '.join(result) + ']'             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __getitem__(self, int key):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_4 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_kp_s_11), __pyx_n_s__join);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 291; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 291; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_result));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_result));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_result));
  __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_4, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 291; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_kp_s_14), __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 291; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, ((PyObject *)__pyx_kp_s_12));<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 291; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_6;
  __pyx_t_6 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.CDSVectorFloat.__str__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_14CDSVectorFloat_11__getitem__(PyObject *__pyx_v_self, PyObject *__pyx_arg_key); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_14CDSVectorFloat_11__getitem__(PyObject *__pyx_v_self, PyObject *__pyx_arg_key) {
  int __pyx_v_key;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__getitem__ (wrapper)", 0);
  assert(__pyx_arg_key); {
    __pyx_v_key = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_arg_key);<span class='error_goto'> if (unlikely((__pyx_v_key == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 293; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.CDSVectorFloat.__getitem__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_14CDSVectorFloat_10__getitem__(((struct __pyx_obj_17shift_calculators_CDSVectorFloat *)__pyx_v_self), ((int)__pyx_v_key));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line292")'> 292: </pre>
<pre id='line292' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line293")'> 293:     def __getitem__(self, int key):</pre>
<pre id='line293' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":293
 *         return '[' + ', '.join(result) + ']'
 * 
 *     def __getitem__(self, int key):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if key >= self.data[0].size():
 *             raise IndexError("index (%i) out of range (%i)" % (key, self.data.size()))
 */

static PyObject *__pyx_pf_17shift_calculators_14CDSVectorFloat_10__getitem__(struct __pyx_obj_17shift_calculators_CDSVectorFloat *__pyx_v_self, int __pyx_v_key) {
  double __pyx_v_result;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__getitem__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line294")'> 294:         if key &gt;= self.data[0].size():</pre>
<pre id='line294' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":294
 * 
 *     def __getitem__(self, int key):
 *         if key >= self.data[0].size():             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             raise IndexError("index (%i) out of range (%i)" % (key, self.data.size()))
 *         result = self.data[0][key]
 */
  __pyx_t_1 = (__pyx_v_key >= (__pyx_v_self->data[0]).size());
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFF35' onclick='toggleDiv("line295")'> 295:             raise IndexError("index (%i) out of range (%i)" % (key, self.data.size()))</pre>
<pre id='line295' class='code' style='background-color: #FFFF35'>
    /* "Cython_shift_calculator.pyx":295
 *     def __getitem__(self, int key):
 *         if key >= self.data[0].size():
 *             raise IndexError("index (%i) out of range (%i)" % (key, self.data.size()))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result = self.data[0][key]
 *         return result
 */
    __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->data->size());<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    __pyx_t_2 = 0;
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_13), ((PyObject *)__pyx_t_4));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, ((PyObject *)__pyx_t_3));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_3));
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_IndexError, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line296")'> 296:         result = self.data[0][key]</pre>
<pre id='line296' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":296
 *         if key >= self.data[0].size():
 *             raise IndexError("index (%i) out of range (%i)" % (key, self.data.size()))
 *         result = self.data[0][key]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return result
 * 
 */
  __pyx_v_result = ((__pyx_v_self->data[0])[__pyx_v_key]);
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line297")'> 297:         return result</pre>
<pre id='line297' class='code' style='background-color: #FFFF6a'>
  /* "Cython_shift_calculator.pyx":297
 *             raise IndexError("index (%i) out of range (%i)" % (key, self.data.size()))
 *         result = self.data[0][key]
 *         return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __del__(self):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_result);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 297; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.CDSVectorFloat.__getitem__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_14CDSVectorFloat_13__del__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_14CDSVectorFloat_13__del__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__del__ (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_14CDSVectorFloat_12__del__(((struct __pyx_obj_17shift_calculators_CDSVectorFloat *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line298")'> 298: </pre>
<pre id='line298' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line299")'> 299:     def __del__(self):</pre>
<pre id='line299' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":299
 *         return result
 * 
 *     def __del__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         del self.data
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_14CDSVectorFloat_12__del__(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_CDSVectorFloat *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__del__", 0);
</pre><pre class='line' style='background-color: #FFFF2e' onclick='toggleDiv("line300")'> 300:         del self.data</pre>
<pre id='line300' class='code' style='background-color: #FFFF2e'>
  /* "Cython_shift_calculator.pyx":300
 * 
 *     def __del__(self):
 *         del self.data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  delete __pyx_v_self->data;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_27Non_bonded_interaction_list_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_27Non_bonded_interaction_list_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_length;
  double __pyx_v_fill_factor;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__length,&__pyx_n_s__fill_factor,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__length);
          if (value) { values[0] = value; kw_args--; }
        }
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__fill_factor);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 312; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    if (values[0]) {
      __pyx_v_length = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_length == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 312; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_length = ((int)0);
    }
    if (values[1]) {
      __pyx_v_fill_factor = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_fill_factor == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 312; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line301")'> 301: </pre>
<pre id='line301' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line302")'> 302: </pre>
<pre id='line302' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line303")'> 303: </pre>
<pre id='line303' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line304")'> 304: </pre>
<pre id='line304' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line305")'> 305: </pre>
<pre id='line305' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line306")'> 306: cdef  class Non_bonded_interaction_list:</pre>
<pre id='line306' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":306
 * 
 * 
 * cdef  class Non_bonded_interaction_list:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef CDSVector[int]  *data
 *     cdef int length
 */
struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list {
  PyObject_HEAD
  struct __pyx_vtabstruct_17shift_calculators_Non_bonded_interaction_list *__pyx_vtab;
  CDSVector<code><</code>int> *data;
  int length;
  int size_increment;
  int RECORD_LENGTH;
};


/* "Cython_shift_calculator.pyx":306
 * 
 * 
 * cdef  class Non_bonded_interaction_list:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef CDSVector[int]  *data
 *     cdef int length
 */

struct __pyx_vtabstruct_17shift_calculators_Non_bonded_interaction_list {
  void (*append)(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *, int, int, int, int);
  void (*resize)(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *);
  struct __pyx_t_17shift_calculators_Component_index_pair *(*get)(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *, int);
};
static struct __pyx_vtabstruct_17shift_calculators_Non_bonded_interaction_list *__pyx_vtabptr_17shift_calculators_Non_bonded_interaction_list;
static CYTHON_INLINE void __pyx_f_17shift_calculators_27Non_bonded_interaction_list_append(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *, int, int, int, int);
static CYTHON_INLINE void __pyx_f_17shift_calculators_27Non_bonded_interaction_list_resize(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *);
static CYTHON_INLINE struct __pyx_t_17shift_calculators_Component_index_pair *__pyx_f_17shift_calculators_27Non_bonded_interaction_list_get(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *, int);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line307")'> 307:     cdef CDSVector[int]  *data</pre>
<pre id='line307' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line308")'> 308:     cdef int length</pre>
<pre id='line308' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line309")'> 309:     cdef int size_increment</pre>
<pre id='line309' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line310")'> 310:     cdef int RECORD_LENGTH</pre>
<pre id='line310' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line311")'> 311: </pre>
<pre id='line311' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line312")'> 312:     def __cinit__(self, int length=0, double fill_factor=1.0):</pre>
<pre id='line312' class='code' style='background-color: #FFFF96'>
      /* "Cython_shift_calculator.pyx":312
 *     cdef int RECORD_LENGTH
 * 
 *     def __cinit__(self, int length=0, double fill_factor=1.0):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.data = new CDSVector[int]()
 *         self.data[0].resize(<code><</code>int>ceil(length*fill_factor*2))
 */
      __pyx_v_fill_factor = ((double)1.0);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 0, 0, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 312; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Non_bonded_interaction_list.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_27Non_bonded_interaction_list___cinit__(((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)__pyx_v_self), __pyx_v_length, __pyx_v_fill_factor);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

static int __pyx_pf_17shift_calculators_27Non_bonded_interaction_list___cinit__(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_self, int __pyx_v_length, double __pyx_v_fill_factor) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line313")'> 313:         self.data = new CDSVector[int]()</pre>
<pre id='line313' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":313
 * 
 *     def __cinit__(self, int length=0, double fill_factor=1.0):
 *         self.data = new CDSVector[int]()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.data[0].resize(<code><</code>int>ceil(length*fill_factor*2))
 *         self.length =  0
 */
  try {
    __pyx_t_1 = new CDSVector<code><</code>int>();
  } catch(...) {
    __Pyx_CppExn2PyErr();
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 313; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_v_self->data = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line314")'> 314:         self.data[0].resize(&lt;int&gt;ceil(length*fill_factor*2))</pre>
<pre id='line314' class='code' style='background-color: #FFFF3e'>
  /* "Cython_shift_calculator.pyx":314
 *     def __cinit__(self, int length=0, double fill_factor=1.0):
 *         self.data = new CDSVector[int]()
 *         self.data[0].resize(<code><</code>int>ceil(length*fill_factor*2))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.length =  0
 *         self.size_increment =  20
 */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ceil);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_length * __pyx_v_fill_factor) * 2.0));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  __pyx_t_5 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  (__pyx_v_self->data[0]).resize(((int)__pyx_t_5));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line315")'> 315:         self.length =  0</pre>
<pre id='line315' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":315
 *         self.data = new CDSVector[int]()
 *         self.data[0].resize(<code><</code>int>ceil(length*fill_factor*2))
 *         self.length =  0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.size_increment =  20
 *         self.RECORD_LENGTH = 4
 */
  __pyx_v_self->length = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line316")'> 316:         self.size_increment =  20</pre>
<pre id='line316' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":316
 *         self.data[0].resize(<code><</code>int>ceil(length*fill_factor*2))
 *         self.length =  0
 *         self.size_increment =  20             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.RECORD_LENGTH = 4
 * 
 */
  __pyx_v_self->size_increment = 20;
</pre><pre class='line' style='background-color: #FFFF1a' onclick='toggleDiv("line317")'> 317:         self.RECORD_LENGTH = 4</pre>
<pre id='line317' class='code' style='background-color: #FFFF1a'>
  /* "Cython_shift_calculator.pyx":317
 *         self.length =  0
 *         self.size_increment =  20
 *         self.RECORD_LENGTH = 4             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def test_append(self,int target_atom_id, int target_id, int remote_id, component_index):
 */
  __pyx_v_self->RECORD_LENGTH = 4;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Non_bonded_interaction_list.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_27Non_bonded_interaction_list_3test_append(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_27Non_bonded_interaction_list_3test_append(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_target_atom_id;
  int __pyx_v_target_id;
  int __pyx_v_remote_id;
  PyObject *__pyx_v_component_index = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("test_append (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__target_atom_id,&__pyx_n_s__target_id,&__pyx_n_s__remote_id,&__pyx_n_s__component_index,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__target_atom_id)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__target_id)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("test_append", 1, 4, 4, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 319; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__remote_id)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("test_append", 1, 4, 4, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 319; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__component_index)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("test_append", 1, 4, 4, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 319; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "test_append") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 319; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_target_atom_id = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_target_atom_id == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 319; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_target_id = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_target_id == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 319; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_remote_id = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_remote_id == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 319; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_component_index = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("test_append", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 319; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Non_bonded_interaction_list.test_append", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_27Non_bonded_interaction_list_2test_append(((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)__pyx_v_self), __pyx_v_target_atom_id, __pyx_v_target_id, __pyx_v_remote_id, __pyx_v_component_index);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line318")'> 318: </pre>
<pre id='line318' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line319")'> 319:     def test_append(self,int target_atom_id, int target_id, int remote_id, component_index):</pre>
<pre id='line319' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":319
 *         self.RECORD_LENGTH = 4
 * 
 *     def test_append(self,int target_atom_id, int target_id, int remote_id, component_index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.append(target_atom_id,  target_id,  remote_id, component_index)
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_27Non_bonded_interaction_list_2test_append(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_self, int __pyx_v_target_atom_id, int __pyx_v_target_id, int __pyx_v_remote_id, PyObject *__pyx_v_component_index) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("test_append", 0);
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line320")'> 320:         self.append(target_atom_id,  target_id,  remote_id, component_index)</pre>
<pre id='line320' class='code' style='background-color: #FFFF66'>
  /* "Cython_shift_calculator.pyx":320
 * 
 *     def test_append(self,int target_atom_id, int target_id, int remote_id, component_index):
 *         self.append(target_atom_id,  target_id,  remote_id, component_index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def clear(self):
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_component_index);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 320; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_f_17shift_calculators_27Non_bonded_interaction_list_append(__pyx_v_self, __pyx_v_target_atom_id, __pyx_v_target_id, __pyx_v_remote_id, __pyx_t_1);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Non_bonded_interaction_list.test_append", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_27Non_bonded_interaction_list_5clear(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_27Non_bonded_interaction_list_5clear(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("clear (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_27Non_bonded_interaction_list_4clear(((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line321")'> 321: </pre>
<pre id='line321' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line322")'> 322:     def clear(self):</pre>
<pre id='line322' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":322
 *         self.append(target_atom_id,  target_id,  remote_id, component_index)
 * 
 *     def clear(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.length = 0
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_27Non_bonded_interaction_list_4clear(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("clear", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line323")'> 323:         self.length = 0</pre>
<pre id='line323' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":323
 * 
 *     def clear(self):
 *         self.length = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline void append(self, int target_atom_id, int target_id, int remote_id, int component_index):
 */
  __pyx_v_self->length = 0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line324")'> 324: </pre>
<pre id='line324' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line325")'> 325:     cdef inline void append(self, int target_atom_id, int target_id, int remote_id, int component_index):</pre>
<pre id='line325' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":325
 *         self.length = 0
 * 
 *     cdef inline void append(self, int target_atom_id, int target_id, int remote_id, int component_index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if  self.data[0].size()*self.RECORD_LENGTH <code><</code>= self.length*self.RECORD_LENGTH:
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_27Non_bonded_interaction_list_append(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_self, int __pyx_v_target_atom_id, int __pyx_v_target_id, int __pyx_v_remote_id, int __pyx_v_component_index) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("append", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line326")'> 326: </pre>
<pre id='line326' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line327")'> 327:         if  self.data[0].size()*self.RECORD_LENGTH &lt;= self.length*self.RECORD_LENGTH:</pre>
<pre id='line327' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":327
 *     cdef inline void append(self, int target_atom_id, int target_id, int remote_id, int component_index):
 * 
 *         if  self.data[0].size()*self.RECORD_LENGTH <code><</code>= self.length*self.RECORD_LENGTH:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self.resize()
 *         self.data[0][self.length] = target_atom_id
 */
  __pyx_t_1 = (((__pyx_v_self->data[0]).size() * __pyx_v_self->RECORD_LENGTH) <code><</code>= (__pyx_v_self->length * __pyx_v_self->RECORD_LENGTH));
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line328")'> 328:             self.resize()</pre>
<pre id='line328' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":328
 * 
 *         if  self.data[0].size()*self.RECORD_LENGTH <code><</code>= self.length*self.RECORD_LENGTH:
 *             self.resize()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.data[0][self.length] = target_atom_id
 *         self.data[0][self.length+1] = target_id
 */
    __pyx_f_17shift_calculators_27Non_bonded_interaction_list_resize(__pyx_v_self);
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line329")'> 329:         self.data[0][self.length] = target_atom_id</pre>
<pre id='line329' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":329
 *         if  self.data[0].size()*self.RECORD_LENGTH <code><</code>= self.length*self.RECORD_LENGTH:
 *             self.resize()
 *         self.data[0][self.length] = target_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.data[0][self.length+1] = target_id
 *         self.data[0][self.length+2] = remote_id
 */
  ((__pyx_v_self->data[0])[__pyx_v_self->length]) = __pyx_v_target_atom_id;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line330")'> 330:         self.data[0][self.length+1] = target_id</pre>
<pre id='line330' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":330
 *             self.resize()
 *         self.data[0][self.length] = target_atom_id
 *         self.data[0][self.length+1] = target_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.data[0][self.length+2] = remote_id
 *         self.data[0][self.length+3] = component_index
 */
  ((__pyx_v_self->data[0])[(__pyx_v_self->length + 1)]) = __pyx_v_target_id;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line331")'> 331:         self.data[0][self.length+2] = remote_id</pre>
<pre id='line331' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":331
 *         self.data[0][self.length] = target_atom_id
 *         self.data[0][self.length+1] = target_id
 *         self.data[0][self.length+2] = remote_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.data[0][self.length+3] = component_index
 * 
 */
  ((__pyx_v_self->data[0])[(__pyx_v_self->length + 2)]) = __pyx_v_remote_id;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line332")'> 332:         self.data[0][self.length+3] = component_index</pre>
<pre id='line332' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":332
 *         self.data[0][self.length+1] = target_id
 *         self.data[0][self.length+2] = remote_id
 *         self.data[0][self.length+3] = component_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self.length += self.RECORD_LENGTH
 */
  ((__pyx_v_self->data[0])[(__pyx_v_self->length + 3)]) = __pyx_v_component_index;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line333")'> 333: </pre>
<pre id='line333' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line334")'> 334:         self.length += self.RECORD_LENGTH</pre>
<pre id='line334' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":334
 *         self.data[0][self.length+3] = component_index
 * 
 *         self.length += self.RECORD_LENGTH             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_self->length = (__pyx_v_self->length + __pyx_v_self->RECORD_LENGTH);

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line335")'> 335: </pre>
<pre id='line335' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line336")'> 336: </pre>
<pre id='line336' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line337")'> 337:     cdef inline void resize(self):</pre>
<pre id='line337' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":337
 * 
 * 
 *     cdef inline void resize(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.data[0].resize(self.data[0].size()+self.size_increment*self.RECORD_LENGTH)
 * 
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_27Non_bonded_interaction_list_resize(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("resize", 0);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line338")'> 338:         self.data[0].resize(self.data[0].size()+self.size_increment*self.RECORD_LENGTH)</pre>
<pre id='line338' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":338
 * 
 *     cdef inline void resize(self):
 *         self.data[0].resize(self.data[0].size()+self.size_increment*self.RECORD_LENGTH)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline Component_index_pair* get(self,int offset):
 */
  (__pyx_v_self->data[0]).resize(((__pyx_v_self->data[0]).size() + (__pyx_v_self->size_increment * __pyx_v_self->RECORD_LENGTH)));

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line339")'> 339: </pre>
<pre id='line339' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line340")'> 340:     cdef inline Component_index_pair* get(self,int offset):</pre>
<pre id='line340' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":340
 *         self.data[0].resize(self.data[0].size()+self.size_increment*self.RECORD_LENGTH)
 * 
 *     cdef inline Component_index_pair* get(self,int offset):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return <code><</code>Component_index_pair *> &self.data[0][offset*self.RECORD_LENGTH]
 * 
 */

static CYTHON_INLINE struct __pyx_t_17shift_calculators_Component_index_pair *__pyx_f_17shift_calculators_27Non_bonded_interaction_list_get(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_self, int __pyx_v_offset) {
  struct __pyx_t_17shift_calculators_Component_index_pair *__pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line341")'> 341:         return &lt;Component_index_pair *&gt; &amp;self.data[0][offset*self.RECORD_LENGTH]</pre>
<pre id='line341' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":341
 * 
 *     cdef inline Component_index_pair* get(self,int offset):
 *         return <code><</code>Component_index_pair *> &self.data[0][offset*self.RECORD_LENGTH]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def get_allocation(self):
 */
  __pyx_r = ((struct __pyx_t_17shift_calculators_Component_index_pair *)(&((__pyx_v_self->data[0])[(__pyx_v_offset * __pyx_v_self->RECORD_LENGTH)])));
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_27Non_bonded_interaction_list_7get_allocation(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_27Non_bonded_interaction_list_7get_allocation(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_allocation (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_27Non_bonded_interaction_list_6get_allocation(((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line342")'> 342: </pre>
<pre id='line342' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line343")'> 343:     def get_allocation(self):</pre>
<pre id='line343' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":343
 *         return <code><</code>Component_index_pair *> &self.data[0][offset*self.RECORD_LENGTH]
 * 
 *     def get_allocation(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self.data[0].size()
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_27Non_bonded_interaction_list_6get_allocation(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_allocation", 0);
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line344")'> 344:         return self.data[0].size()</pre>
<pre id='line344' class='code' style='background-color: #FFFF73'>
  /* "Cython_shift_calculator.pyx":344
 * 
 *     def get_allocation(self):
 *         return self.data[0].size()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def get_size_increment(self):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_self->data[0]).size());<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Non_bonded_interaction_list.get_allocation", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_27Non_bonded_interaction_list_9get_size_increment(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_27Non_bonded_interaction_list_9get_size_increment(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_size_increment (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_27Non_bonded_interaction_list_8get_size_increment(((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line345")'> 345: </pre>
<pre id='line345' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line346")'> 346:     def get_size_increment(self):</pre>
<pre id='line346' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":346
 *         return self.data[0].size()
 * 
 *     def get_size_increment(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self.size_increment
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_27Non_bonded_interaction_list_8get_size_increment(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_size_increment", 0);
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line347")'> 347:         return self.size_increment</pre>
<pre id='line347' class='code' style='background-color: #FFFF73'>
  /* "Cython_shift_calculator.pyx":347
 * 
 *     def get_size_increment(self):
 *         return self.size_increment             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __len__(self):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->size_increment);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Non_bonded_interaction_list.get_size_increment", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static Py_ssize_t __pyx_pw_17shift_calculators_27Non_bonded_interaction_list_11__len__(PyObject *__pyx_v_self); /*proto*/
static Py_ssize_t __pyx_pw_17shift_calculators_27Non_bonded_interaction_list_11__len__(PyObject *__pyx_v_self) {
  Py_ssize_t __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__len__ (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_27Non_bonded_interaction_list_10__len__(((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line348")'> 348: </pre>
<pre id='line348' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line349")'> 349:     def __len__(self):</pre>
<pre id='line349' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":349
 *         return self.size_increment
 * 
 *     def __len__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self.length/self.RECORD_LENGTH
 * 
 */

static Py_ssize_t __pyx_pf_17shift_calculators_27Non_bonded_interaction_list_10__len__(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_self) {
  Py_ssize_t __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__len__", 0);
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line350")'> 350:         return self.length/self.RECORD_LENGTH</pre>
<pre id='line350' class='code' style='background-color: #FFFF66'>
  /* "Cython_shift_calculator.pyx":350
 * 
 *     def __len__(self):
 *         return self.length/self.RECORD_LENGTH             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __getitem__(self, int key):
 */
  __pyx_r = (__pyx_v_self->length / __pyx_v_self->RECORD_LENGTH);
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_27Non_bonded_interaction_list_13__getitem__(PyObject *__pyx_v_self, PyObject *__pyx_arg_key); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_27Non_bonded_interaction_list_13__getitem__(PyObject *__pyx_v_self, PyObject *__pyx_arg_key) {
  int __pyx_v_key;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__getitem__ (wrapper)", 0);
  assert(__pyx_arg_key); {
    __pyx_v_key = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_arg_key);<span class='error_goto'> if (unlikely((__pyx_v_key == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Non_bonded_interaction_list.__getitem__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_27Non_bonded_interaction_list_12__getitem__(((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)__pyx_v_self), ((int)__pyx_v_key));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line351")'> 351: </pre>
<pre id='line351' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line352")'> 352:     def __getitem__(self, int key):</pre>
<pre id='line352' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":352
 *         return self.length/self.RECORD_LENGTH
 * 
 *     def __getitem__(self, int key):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if key >= self.length/self.RECORD_LENGTH:
 *             raise IndexError("index (%i) out of range (%i)" % (key, self.length/self.RECORD_LENGTH))
 */

static PyObject *__pyx_pf_17shift_calculators_27Non_bonded_interaction_list_12__getitem__(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_self, int __pyx_v_key) {
  PyObject *__pyx_v_result = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__getitem__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line353")'> 353:         if key &gt;= self.length/self.RECORD_LENGTH:</pre>
<pre id='line353' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":353
 * 
 *     def __getitem__(self, int key):
 *         if key >= self.length/self.RECORD_LENGTH:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             raise IndexError("index (%i) out of range (%i)" % (key, self.length/self.RECORD_LENGTH))
 *         result  = []
 */
  __pyx_t_1 = (__pyx_v_key >= (__pyx_v_self->length / __pyx_v_self->RECORD_LENGTH));
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFF35' onclick='toggleDiv("line354")'> 354:             raise IndexError("index (%i) out of range (%i)" % (key, self.length/self.RECORD_LENGTH))</pre>
<pre id='line354' class='code' style='background-color: #FFFF35'>
    /* "Cython_shift_calculator.pyx":354
 *     def __getitem__(self, int key):
 *         if key >= self.length/self.RECORD_LENGTH:
 *             raise IndexError("index (%i) out of range (%i)" % (key, self.length/self.RECORD_LENGTH))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result  = []
 *         for i in range(self.RECORD_LENGTH):
 */
    __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_self->length / __pyx_v_self->RECORD_LENGTH));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    __pyx_t_2 = 0;
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_13), ((PyObject *)__pyx_t_4));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, ((PyObject *)__pyx_t_3));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_3));
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_IndexError, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line355")'> 355:         result  = []</pre>
<pre id='line355' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":355
 *         if key >= self.length/self.RECORD_LENGTH:
 *             raise IndexError("index (%i) out of range (%i)" % (key, self.length/self.RECORD_LENGTH))
 *         result  = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for i in range(self.RECORD_LENGTH):
 *             result.append(self.data[0][key*self.RECORD_LENGTH+i])
 */
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 355; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_v_result = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line356")'> 356:         for i in range(self.RECORD_LENGTH):</pre>
<pre id='line356' class='code' style='background-color: #FFFF20'>
  /* "Cython_shift_calculator.pyx":356
 *             raise IndexError("index (%i) out of range (%i)" % (key, self.length/self.RECORD_LENGTH))
 *         result  = []
 *         for i in range(self.RECORD_LENGTH):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             result.append(self.data[0][key*self.RECORD_LENGTH+i])
 *         return tuple(result)
 */
  __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->RECORD_LENGTH);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
    __pyx_t_4 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (!__pyx_t_6 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4)) {
      if (__pyx_t_5 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_6 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {
      if (__pyx_t_5 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_3 = __pyx_t_6(__pyx_t_4);
      if (unlikely(!__pyx_t_3)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
    __pyx_v_i = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF39' onclick='toggleDiv("line357")'> 357:             result.append(self.data[0][key*self.RECORD_LENGTH+i])</pre>
<pre id='line357' class='code' style='background-color: #FFFF39'>
    /* "Cython_shift_calculator.pyx":357
 *         result  = []
 *         for i in range(self.RECORD_LENGTH):
 *             result.append(self.data[0][key*self.RECORD_LENGTH+i])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return tuple(result)
 * 
 */
    __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_key * __pyx_v_self->RECORD_LENGTH));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 357; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 357; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_7 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 357; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(((__pyx_v_self->data[0])[__pyx_t_7]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 357; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_8 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_result, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 357; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF35' onclick='toggleDiv("line358")'> 358:         return tuple(result)</pre>
<pre id='line358' class='code' style='background-color: #FFFF35'>
  /* "Cython_shift_calculator.pyx":358
 *         for i in range(self.RECORD_LENGTH):
 *             result.append(self.data[0][key*self.RECORD_LENGTH+i])
 *         return tuple(result)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def build_selection_list(self, accept = lambda x: True):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_4 = ((PyObject *)<span class='py_c_api'>PyList_AsTuple</span>(__pyx_v_result));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_4));
  __pyx_r = ((PyObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Non_bonded_interaction_list.__getitem__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_27Non_bonded_interaction_list_15build_selection_list(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_27Non_bonded_interaction_list_15build_selection_list(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_accept = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("build_selection_list (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__accept,0};
    PyObject* values[1] = {0};
    values[0] = __pyx_k_15;
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__accept);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "build_selection_list") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 360; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_accept = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("build_selection_list", 0, 0, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 360; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Non_bonded_interaction_list.build_selection_list", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_27Non_bonded_interaction_list_14build_selection_list(((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)__pyx_v_self), __pyx_v_accept);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line359")'> 359: </pre>
<pre id='line359' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line360")'> 360:     def build_selection_list(self, accept = lambda x: True):</pre>
<pre id='line360' class='code' style='background-color: #FFFF6e'>
/* "Cython_shift_calculator.pyx":360
 *         return tuple(result)
 * 
 *     def build_selection_list(self, accept = lambda x: True):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result = []
 *         for i,elem in enumerate(self):
 */

static PyObject *__pyx_lambda_funcdef_17shift_calculators_lambda1(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("lambda1", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.lambda1", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* "Cython_shift_calculator.pyx":360
 *         return tuple(result)
 * 
 *     def build_selection_list(self, accept = lambda x: True):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result = []
 *         for i,elem in enumerate(self):
 */

static PyObject *__pyx_pf_17shift_calculators_27Non_bonded_interaction_list_14build_selection_list(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_self, PyObject *__pyx_v_accept) {
  PyObject *__pyx_v_result = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_elem = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("build_selection_list", 0);

  /* "Cython_shift_calculator.pyx":360
 *         return tuple(result)
 * 
 *     def build_selection_list(self, accept = lambda x: True):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result = []
 *         for i,elem in enumerate(self):
 */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&__pyx_mdef_17shift_calculators_14lambda1, 0, __pyx_n_s_113, NULL, __pyx_n_s__shift_calculators, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_k_15 = __pyx_t_2;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line361")'> 361:         result = []</pre>
<pre id='line361' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":361
 * 
 *     def build_selection_list(self, accept = lambda x: True):
 *         result = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for i,elem in enumerate(self):
 *             if accept(elem):
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_result = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF24' onclick='toggleDiv("line362")'> 362:         for i,elem in enumerate(self):</pre>
<pre id='line362' class='code' style='background-color: #FFFF24'>
  /* "Cython_shift_calculator.pyx":362
 *     def build_selection_list(self, accept = lambda x: True):
 *         result = []
 *         for i,elem in enumerate(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if accept(elem):
 *                 result.append(i)
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_t_1 = __pyx_int_0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(((PyObject *)__pyx_v_self)) || <span class='py_c_api'>PyTuple_CheckExact</span>(((PyObject *)__pyx_v_self))) {
    __pyx_t_2 = ((PyObject *)__pyx_v_self); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(((PyObject *)__pyx_v_self));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext;
  }
  for (;;) {
    if (!__pyx_t_4 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) {
      if (__pyx_t_3 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_4 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
      if (__pyx_t_3 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_5 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_5)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_elem);
    __pyx_v_elem = __pyx_t_5;
    __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
    __pyx_v_i = __pyx_t_1;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1);
    __pyx_t_1 = __pyx_t_5;
    __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line363")'> 363:             if accept(elem):</pre>
<pre id='line363' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":363
 *         result = []
 *         for i,elem in enumerate(self):
 *             if accept(elem):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 result.append(i)
 *         return array.array('i',result)
 */
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_elem);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_elem);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_elem);
    __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_v_accept, ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(__pyx_t_7 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (__pyx_t_7) {
</pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line364")'> 364:                 result.append(i)</pre>
<pre id='line364' class='code' style='background-color: #FFFF96'>
      /* "Cython_shift_calculator.pyx":364
 *         for i,elem in enumerate(self):
 *             if accept(elem):
 *                 result.append(i)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return array.array('i',result)
 * 
 */
      __pyx_t_8 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_result, __pyx_v_i);<span class='error_goto'> if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      goto __pyx_L5;
    }
    __pyx_L5:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line365")'> 365:         return array.array('i',result)</pre>
<pre id='line365' class='code' style='background-color: #FFFF43'>
  /* "Cython_shift_calculator.pyx":365
 *             if accept(elem):
 *                 result.append(i)
 *         return array.array('i',result)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__i));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_n_s__i));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__i));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_result));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_result));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_result));
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)__pyx_ptype_7cpython_5array_array)), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Non_bonded_interaction_list.build_selection_list", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_elem);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_27Non_bonded_interaction_list_17get_all_components(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_27Non_bonded_interaction_list_17get_all_components(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_all_components (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_27Non_bonded_interaction_list_16get_all_components(((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line366")'> 366: </pre>
<pre id='line366' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line367")'> 367: </pre>
<pre id='line367' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line368")'> 368:     def get_all_components(self):</pre>
<pre id='line368' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":368
 * 
 * 
 *     def get_all_components(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result = []
 *         for i in range(self.length/self.RECORD_LENGTH):
 */

static PyObject *__pyx_pf_17shift_calculators_27Non_bonded_interaction_list_16get_all_components(struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_self) {
  PyObject *__pyx_v_result = NULL;
  int __pyx_v_i;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_all_components", 0);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line369")'> 369:         result = []</pre>
<pre id='line369' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":369
 * 
 *     def get_all_components(self):
 *         result = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for i in range(self.length/self.RECORD_LENGTH):
 *             result.append(self[i])
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_result = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line370")'> 370:         for i in range(self.length/self.RECORD_LENGTH):</pre>
<pre id='line370' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":370
 *     def get_all_components(self):
 *         result = []
 *         for i in range(self.length/self.RECORD_LENGTH):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             result.append(self[i])
 *         return result
 */
  __pyx_t_2 = (__pyx_v_self->length / __pyx_v_self->RECORD_LENGTH);
  for (__pyx_t_3 = 0; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line371")'> 371:             result.append(self[i])</pre>
<pre id='line371' class='code' style='background-color: #FFFF8d'>
    /* "Cython_shift_calculator.pyx":371
 *         result = []
 *         for i in range(self.length/self.RECORD_LENGTH):
 *             result.append(self[i])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return result
 * 
 */
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_self), __pyx_v_i, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_4 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_result, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line372")'> 372:         return result</pre>
<pre id='line372' class='code' style='background-color: #FFFF55'>
  /* "Cython_shift_calculator.pyx":372
 *         for i in range(self.length/self.RECORD_LENGTH):
 *             result.append(self[i])
 *         return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef class Vec3_list:
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_result));
  __pyx_r = ((PyObject *)__pyx_v_result);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Non_bonded_interaction_list.get_all_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_9Vec3_list_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_9Vec3_list_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) > 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) > 0) && unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__cinit__", 0))) return -1;
  __pyx_r = __pyx_pf_17shift_calculators_9Vec3_list___cinit__(((struct __pyx_obj_17shift_calculators_Vec3_list *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line373")'> 373: </pre>
<pre id='line373' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line374")'> 374: cdef class Vec3_list:</pre>
<pre id='line374' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":374
 *         return result
 * 
 * cdef class Vec3_list:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef CDSVector[Vec3] *data
 * 
 */
struct __pyx_obj_17shift_calculators_Vec3_list {
  PyObject_HEAD
  struct __pyx_vtabstruct_17shift_calculators_Vec3_list *__pyx_vtab;
  CDSVector<code><</code>Vec3> *data;
};


/* "Cython_shift_calculator.pyx":374
 *         return result
 * 
 * cdef class Vec3_list:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef CDSVector[Vec3] *data
 * 
 */

struct __pyx_vtabstruct_17shift_calculators_Vec3_list {
  PyObject *(*set_length)(struct __pyx_obj_17shift_calculators_Vec3_list *, int);
  Vec3 *(*get)(struct __pyx_obj_17shift_calculators_Vec3_list *, int);
  PyObject *(*set)(struct __pyx_obj_17shift_calculators_Vec3_list *, int, Vec3 &);
};
static struct __pyx_vtabstruct_17shift_calculators_Vec3_list *__pyx_vtabptr_17shift_calculators_Vec3_list;
static CYTHON_INLINE Vec3 *__pyx_f_17shift_calculators_9Vec3_list_get(struct __pyx_obj_17shift_calculators_Vec3_list *, int);
static CYTHON_INLINE PyObject *__pyx_f_17shift_calculators_9Vec3_list_set(struct __pyx_obj_17shift_calculators_Vec3_list *, int, Vec3 &);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line375")'> 375:     cdef CDSVector[Vec3] *data</pre>
<pre id='line375' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line376")'> 376: </pre>
<pre id='line376' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line377")'> 377:     def __cinit__(self):</pre>
<pre id='line377' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":377
 *     cdef CDSVector[Vec3] *data
 * 
 *     def __cinit__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *          self.data = new CDSVector[Vec3]()
 * 
 */

static int __pyx_pf_17shift_calculators_9Vec3_list___cinit__(struct __pyx_obj_17shift_calculators_Vec3_list *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__", 0);
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line378")'> 378:          self.data = new CDSVector[Vec3]()</pre>
<pre id='line378' class='code' style='background-color: #FFFFc4'>
  /* "Cython_shift_calculator.pyx":378
 * 
 *     def __cinit__(self):
 *          self.data = new CDSVector[Vec3]()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  try {
    __pyx_t_1 = new CDSVector<code><</code>Vec3>();
  } catch(...) {
    __Pyx_CppExn2PyErr();
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_v_self->data = __pyx_t_1;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Vec3_list.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line379")'> 379: </pre>
<pre id='line379' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line380")'> 380: </pre>
<pre id='line380' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line381")'> 381:     cdef set_length(self,int length):</pre>
<pre id='line381' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":381
 * 
 * 
 *     cdef set_length(self,int length):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.data.resize(length)
 * 
 */

static PyObject *__pyx_f_17shift_calculators_9Vec3_list_set_length(struct __pyx_obj_17shift_calculators_Vec3_list *__pyx_v_self, int __pyx_v_length) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_length", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line382")'> 382:         self.data.resize(length)</pre>
<pre id='line382' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":382
 * 
 *     cdef set_length(self,int length):
 *         self.data.resize(length)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     @cython.profile(False)
 */
  __pyx_v_self->data->resize(__pyx_v_length);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line383")'> 383: </pre>
<pre id='line383' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line384")'> 384:     @cython.profile(False)</pre>
<pre id='line384' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line385")'> 385:     cdef inline Vec3*  get(self, int offset):</pre>
<pre id='line385' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":385
 * 
 *     @cython.profile(False)
 *     cdef inline Vec3*  get(self, int offset):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return &self.data[0][offset]
 * 
 */

static CYTHON_INLINE Vec3 *__pyx_f_17shift_calculators_9Vec3_list_get(struct __pyx_obj_17shift_calculators_Vec3_list *__pyx_v_self, int __pyx_v_offset) {
  Vec3 *__pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get", 0);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line386")'> 386:         return &amp;self.data[0][offset]</pre>
<pre id='line386' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":386
 *     @cython.profile(False)
 *     cdef inline Vec3*  get(self, int offset):
 *         return &self.data[0][offset]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     @cython.profile(False)
 */
  __pyx_r = (&((__pyx_v_self->data[0])[__pyx_v_offset]));
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line387")'> 387: </pre>
<pre id='line387' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line388")'> 388:     @cython.profile(False)</pre>
<pre id='line388' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line389")'> 389:     cdef inline set(self, int x, Vec3&amp; y):</pre>
<pre id='line389' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":389
 * 
 *     @cython.profile(False)
 *     cdef inline set(self, int x, Vec3& y):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.data[0][x] =  y
 * 
 */

static CYTHON_INLINE PyObject *__pyx_f_17shift_calculators_9Vec3_list_set(struct __pyx_obj_17shift_calculators_Vec3_list *__pyx_v_self, int __pyx_v_x, Vec3 &__pyx_v_y) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set", 0);
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line390")'> 390:         self.data[0][x] =  y</pre>
<pre id='line390' class='code' style='background-color: #FFFFc4'>
  /* "Cython_shift_calculator.pyx":390
 *     @cython.profile(False)
 *     cdef inline set(self, int x, Vec3& y):
 *         self.data[0][x] =  y             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __len__(self):
 */
  ((__pyx_v_self->data[0])[__pyx_v_x]) = __pyx_v_y;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static Py_ssize_t __pyx_pw_17shift_calculators_9Vec3_list_3__len__(PyObject *__pyx_v_self); /*proto*/
static Py_ssize_t __pyx_pw_17shift_calculators_9Vec3_list_3__len__(PyObject *__pyx_v_self) {
  Py_ssize_t __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__len__ (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_9Vec3_list_2__len__(((struct __pyx_obj_17shift_calculators_Vec3_list *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line391")'> 391: </pre>
<pre id='line391' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line392")'> 392:     def __len__(self):</pre>
<pre id='line392' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":392
 *         self.data[0][x] =  y
 * 
 *     def __len__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self.data[0].size()
 * 
 */

static Py_ssize_t __pyx_pf_17shift_calculators_9Vec3_list_2__len__(struct __pyx_obj_17shift_calculators_Vec3_list *__pyx_v_self) {
  Py_ssize_t __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__len__", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line393")'> 393:         return self.data[0].size()</pre>
<pre id='line393' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":393
 * 
 *     def __len__(self):
 *         return self.data[0].size()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __dealloc__(self):
 */
  __pyx_r = (__pyx_v_self->data[0]).size();
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static void __pyx_pw_17shift_calculators_9Vec3_list_5__dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pw_17shift_calculators_9Vec3_list_5__dealloc__(PyObject *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__dealloc__ (wrapper)", 0);
  __pyx_pf_17shift_calculators_9Vec3_list_4__dealloc__(((struct __pyx_obj_17shift_calculators_Vec3_list *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line394")'> 394: </pre>
<pre id='line394' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line395")'> 395:     def __dealloc__(self):</pre>
<pre id='line395' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":395
 *         return self.data[0].size()
 * 
 *     def __dealloc__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if self.data != NULL:
 */

static void __pyx_pf_17shift_calculators_9Vec3_list_4__dealloc__(struct __pyx_obj_17shift_calculators_Vec3_list *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__dealloc__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line396")'> 396: </pre>
<pre id='line396' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line397")'> 397:         if self.data != NULL:</pre>
<pre id='line397' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":397
 *     def __dealloc__(self):
 * 
 *         if self.data != NULL:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             del self.data
 * 
 */
  __pyx_t_1 = (__pyx_v_self->data != NULL);
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line398")'> 398:             del self.data</pre>
<pre id='line398' class='code' style='background-color: #FFFFd4'>
    /* "Cython_shift_calculator.pyx":398
 * 
 *         if self.data != NULL:
 *             del self.data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    delete __pyx_v_self->data;
    goto __pyx_L3;
  }
  __pyx_L3:;

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
static PyObject *__pyx_gb_17shift_calculators_9Vec3_list_8generator(__pyx_GeneratorObject *__pyx_generator, PyObject *__pyx_sent_value); /* proto */

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_9Vec3_list_7__iter__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_9Vec3_list_7__iter__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__iter__ (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_9Vec3_list_6__iter__(((struct __pyx_obj_17shift_calculators_Vec3_list *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line399")'> 399: </pre>
<pre id='line399' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line400")'> 400: </pre>
<pre id='line400' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line401")'> 401:     def __iter__(self):</pre>
<pre id='line401' class='code' style='background-color: #FFFF79'>
/* "Cython_shift_calculator.pyx":401
 * 
 * 
 *     def __iter__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3 vec3
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_9Vec3_list_6__iter__(struct __pyx_obj_17shift_calculators_Vec3_list *__pyx_v_self) {
  struct __pyx_obj_17shift_calculators___pyx_scope_struct____iter__ *__pyx_cur_scope;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__iter__", 0);
  __pyx_cur_scope = (struct __pyx_obj_17shift_calculators___pyx_scope_struct____iter__ *)__pyx_ptype_17shift_calculators___pyx_scope_struct____iter__->tp_new(__pyx_ptype_17shift_calculators___pyx_scope_struct____iter__, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
    return NULL;
  }
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_cur_scope);
  __pyx_cur_scope->__pyx_v_self = __pyx_v_self;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_cur_scope->__pyx_v_self);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>((PyObject *)__pyx_cur_scope->__pyx_v_self);
  {
    __pyx_GeneratorObject *gen = <span class='pyx_c_api'>__Pyx_Generator_New</span>((__pyx_generator_body_t) __pyx_gb_17shift_calculators_9Vec3_list_8generator, (PyObject *) __pyx_cur_scope);<span class='error_goto'> if (unlikely(!gen)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope);
    <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
    return (PyObject *) gen;
  }

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Vec3_list.__iter__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

static PyObject *__pyx_gb_17shift_calculators_9Vec3_list_8generator(__pyx_GeneratorObject *__pyx_generator, PyObject *__pyx_sent_value) /* generator body */
{
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("None", 0);
  __pyx_L3_first_run:;
  if (unlikely(!__pyx_sent_value))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>

/* "Cython_shift_calculator.pyx":401
 * 
 * 
 *     def __iter__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3 vec3
 * 
 */
struct __pyx_obj_17shift_calculators___pyx_scope_struct____iter__ {
  PyObject_HEAD
  int __pyx_v_i;
  struct __pyx_obj_17shift_calculators_Vec3_list *__pyx_v_self;
  Vec3 __pyx_v_vec3;
  int __pyx_t_0;
  int __pyx_t_1;
};

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line402")'> 402:         cdef Vec3 vec3</pre>
<pre id='line402' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line403")'> 403: </pre>
<pre id='line403' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line404")'> 404: </pre>
<pre id='line404' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line405")'> 405: </pre>
<pre id='line405' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line406")'> 406:         for i in range(self.data.size()):</pre>
<pre id='line406' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":406
 * 
 * 
 *         for i in range(self.data.size()):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             vec3 = self.get(i)[0]
 *             yield (i,python_vec3(vec3[0],vec3[1],vec3[2]))
 */
  __pyx_t_1 = __pyx_cur_scope->__pyx_v_self->data->size();
  for (__pyx_t_2 = 0; __pyx_t_2 <code><</code> __pyx_t_1; __pyx_t_2+=1) {
    __pyx_cur_scope->__pyx_v_i = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line407")'> 407:             vec3 = self.get(i)[0]</pre>
<pre id='line407' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":407
 * 
 *         for i in range(self.data.size()):
 *             vec3 = self.get(i)[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             yield (i,python_vec3(vec3[0],vec3[1],vec3[2]))
 * 
 */
    __pyx_cur_scope->__pyx_v_vec3 = (__pyx_f_17shift_calculators_9Vec3_list_get(__pyx_cur_scope->__pyx_v_self, __pyx_cur_scope->__pyx_v_i)[0]);
</pre><pre class='line' style='background-color: #FFFF18' onclick='toggleDiv("line408")'> 408:             yield (i,python_vec3(vec3[0],vec3[1],vec3[2]))</pre>
<pre id='line408' class='code' style='background-color: #FFFF18'>
    /* "Cython_shift_calculator.pyx":408
 *         for i in range(self.data.size()):
 *             vec3 = self.get(i)[0]
 *             yield (i,python_vec3(vec3[0],vec3[1],vec3[2]))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_cur_scope->__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__python_vec3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_cur_scope->__pyx_v_vec3[0]));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_cur_scope->__pyx_v_vec3[1]));<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_cur_scope->__pyx_v_vec3[2]));<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_5);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_6);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2, __pyx_t_7);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_7);
    __pyx_t_5 = 0;
    __pyx_t_6 = 0;
    __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_4, ((PyObject *)__pyx_t_8), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_7);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_7);
    __pyx_t_3 = 0;
    __pyx_t_7 = 0;
    __pyx_r = ((PyObject *)__pyx_t_8);
    __pyx_t_8 = 0;
    __pyx_cur_scope->__pyx_t_0 = __pyx_t_1;
    __pyx_cur_scope->__pyx_t_1 = __pyx_t_2;
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
    <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
    /* return from generator, yielding value */
    __pyx_generator->resume_label = 1;
    return __pyx_r;
    __pyx_L6_resume_from_yield:;
    __pyx_t_1 = __pyx_cur_scope->__pyx_t_0;
    __pyx_t_2 = __pyx_cur_scope->__pyx_t_1;
    if (unlikely(!__pyx_sent_value))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='py_c_api'>PyErr_SetNone</span>(PyExc_StopIteration);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("__iter__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_generator->resume_label = -1;
  <span class='pyx_c_api'>__Pyx_Generator_clear</span>((PyObject*)__pyx_generator);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_9Out_array_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_9Out_array_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_length = 0;
  PyObject *__pyx_v_simulation = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__length,&__pyx_n_s__simulation,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__length)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__simulation)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 417; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 417; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_length = values[0];
    __pyx_v_simulation = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 417; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_9Out_array___init__(((struct __pyx_obj_17shift_calculators_Out_array *)__pyx_v_self), __pyx_v_length, __pyx_v_simulation);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line409")'> 409: </pre>
<pre id='line409' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line410")'> 410: </pre>
<pre id='line410' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line411")'> 411: cdef class Out_array:</pre>
<pre id='line411' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":411
 * 
 * 
 * cdef class Out_array:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef long _length
 *     cdef double[60000] _data
 */
struct __pyx_obj_17shift_calculators_Out_array {
  PyObject_HEAD
  struct __pyx_vtabstruct_17shift_calculators_Out_array *__pyx_vtab;
  long _length;
  double _data[60000];
  int _mask[60000];
  EnsembleSimulation *_simulation;
};


/* "Cython_shift_calculator.pyx":411
 * 
 * 
 * cdef class Out_array:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef long _length
 *     cdef double[60000] _data
 */

struct __pyx_vtabstruct_17shift_calculators_Out_array {
  PyObject *(*get_length)(struct __pyx_obj_17shift_calculators_Out_array *, int __pyx_skip_dispatch);
  PyObject *(*add_all)(struct __pyx_obj_17shift_calculators_Out_array *, struct __pyx_obj_17shift_calculators_Out_array *, int __pyx_skip_dispatch);
  int (*_check_clear_length)(struct __pyx_obj_17shift_calculators_Out_array *, long);
  int (*_check_offset)(struct __pyx_obj_17shift_calculators_Out_array *, long);
  int (*realloc)(struct __pyx_obj_17shift_calculators_Out_array *, long, int __pyx_skip_dispatch);
  int (*_check_state)(struct __pyx_obj_17shift_calculators_Out_array *);
  PyObject *(*_clear)(struct __pyx_obj_17shift_calculators_Out_array *, PyObject *);
  void (*add)(struct __pyx_obj_17shift_calculators_Out_array *, long, Vec3 &);
};
static struct __pyx_vtabstruct_17shift_calculators_Out_array *__pyx_vtabptr_17shift_calculators_Out_array;
static CYTHON_INLINE int __pyx_f_17shift_calculators_9Out_array__check_clear_length(struct __pyx_obj_17shift_calculators_Out_array *, long);
static CYTHON_INLINE int __pyx_f_17shift_calculators_9Out_array__check_offset(struct __pyx_obj_17shift_calculators_Out_array *, long);
static CYTHON_INLINE int __pyx_f_17shift_calculators_9Out_array__check_state(struct __pyx_obj_17shift_calculators_Out_array *);
static CYTHON_INLINE void __pyx_f_17shift_calculators_9Out_array_add(struct __pyx_obj_17shift_calculators_Out_array *, long, Vec3 &);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line412")'> 412:     cdef long _length</pre>
<pre id='line412' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line413")'> 413:     cdef double[60000] _data</pre>
<pre id='line413' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line414")'> 414:     cdef int[60000] _mask</pre>
<pre id='line414' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line415")'> 415:     cdef EnsembleSimulation* _simulation</pre>
<pre id='line415' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line416")'> 416: </pre>
<pre id='line416' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line417")'> 417:     def __init__ (self, length, simulation):</pre>
<pre id='line417' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":417
 *     cdef EnsembleSimulation* _simulation
 * 
 *     def __init__ (self, length, simulation):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._length = length
 *         self._simulation = simulationAsNative(simulation)
 */

static int __pyx_pf_17shift_calculators_9Out_array___init__(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self, PyObject *__pyx_v_length, PyObject *__pyx_v_simulation) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line418")'> 418:         self._length = length</pre>
<pre id='line418' class='code' style='background-color: #FFFF7f'>
  /* "Cython_shift_calculator.pyx":418
 * 
 *     def __init__ (self, length, simulation):
 *         self._length = length             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._simulation = simulationAsNative(simulation)
 * 
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyInt_AsLong</span>(__pyx_v_length);<span class='error_goto'> if (unlikely((__pyx_t_1 == (long)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 418; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_length = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFF38' onclick='toggleDiv("line419")'> 419:         self._simulation = simulationAsNative(simulation)</pre>
<pre id='line419' class='code' style='background-color: #FFFF38'>
  /* "Cython_shift_calculator.pyx":419
 *     def __init__ (self, length, simulation):
 *         self._length = length
 *         self._simulation = simulationAsNative(simulation)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_2 = __pyx_f_17shift_calculators_simulationAsNative(__pyx_v_simulation);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_simulation = __pyx_t_2;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_9Out_array_3__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_9Out_array_3__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_length = 0;
  CYTHON_UNUSED PyObject *__pyx_v_simulation = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__length,&__pyx_n_s__simulation,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__length)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__simulation)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 422; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 422; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_length = values[0];
    __pyx_v_simulation = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 422; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_9Out_array_2__cinit__(((struct __pyx_obj_17shift_calculators_Out_array *)__pyx_v_self), __pyx_v_length, __pyx_v_simulation);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line420")'> 420: </pre>
<pre id='line420' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line421")'> 421: </pre>
<pre id='line421' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line422")'> 422:     def __cinit__(self,  length, simulation):</pre>
<pre id='line422' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":422
 * 
 * 
 *     def __cinit__(self,  length, simulation):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._length =  60000
 * 
 */

static int __pyx_pf_17shift_calculators_9Out_array_2__cinit__(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self, PyObject *__pyx_v_length, CYTHON_UNUSED PyObject *__pyx_v_simulation) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line423")'> 423:         self._length =  60000</pre>
<pre id='line423' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":423
 * 
 *     def __cinit__(self,  length, simulation):
 *         self._length =  60000             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if length > 60000:
 */
  __pyx_v_self->_length = 60000;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line424")'> 424: </pre>
<pre id='line424' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line425")'> 425:         if length &gt; 60000:</pre>
<pre id='line425' class='code' style='background-color: #FFFF79'>
  /* "Cython_shift_calculator.pyx":425
 *         self._length =  60000
 * 
 *         if length > 60000:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             raise MemoryError("couldn't allocate array beyond length %i" % 60000)
 * #        self._data = <code><</code>double *>malloc(length * sizeof(double))
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_length, __pyx_int_60000, Py_GT); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFF48' onclick='toggleDiv("line426")'> 426:             raise MemoryError("couldn't allocate array beyond length %i" % 60000)</pre>
<pre id='line426' class='code' style='background-color: #FFFF48'>
    /* "Cython_shift_calculator.pyx":426
 * 
 *         if length > 60000:
 *             raise MemoryError("couldn't allocate array beyond length %i" % 60000)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #        self._data = <code><</code>double *>malloc(length * sizeof(double))
 * #        if not self._data:
 */
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_16), __pyx_int_60000);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, ((PyObject *)__pyx_t_1));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_1));
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_MemoryError, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L3;
  }
  __pyx_L3:;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line427")'> 427: #        self._data = &lt;double *&gt;malloc(length * sizeof(double))</pre>
<pre id='line427' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line428")'> 428: #        if not self._data:</pre>
<pre id='line428' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line429")'> 429: #            raise MemoryError("couldn't allocate array of length %i" % length)</pre>
<pre id='line429' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line430")'> 430: #</pre>
<pre id='line430' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line431")'> 431: #        self._mask = &lt;long *&gt;malloc(length * sizeof(long))</pre>
<pre id='line431' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line432")'> 432: #        if not self._mask:</pre>
<pre id='line432' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line433")'> 433: #            raise MemoryError("couldn't allocate array of length %i" % length)</pre>
<pre id='line433' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line434")'> 434: #</pre>
<pre id='line434' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line435")'> 435: #        if  self._data  and self._mask:</pre>
<pre id='line435' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line436")'> 436: #            self._clear(length)</pre>
<pre id='line436' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line437")'> 437: #        print 'allocated'</pre>
<pre id='line437' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line438")'> 438: </pre>
<pre id='line438' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line439")'> 439:     cpdef get_length(self):</pre>
<pre id='line439' class='code' style='background-color: #FFFF57'>
/* "Cython_shift_calculator.pyx":439
 * #        print 'allocated'
 * 
 *     cpdef get_length(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._length
 * 
 */

static PyObject *__pyx_pw_17shift_calculators_9Out_array_5get_length(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_f_17shift_calculators_9Out_array_get_length(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self, int __pyx_skip_dispatch) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_length", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s__get_length);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_17shift_calculators_9Out_array_5get_length)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "Cython_shift_calculator.pyx":439
 * #        print 'allocated'
 * 
 *     cpdef get_length(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._length
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_9Out_array_4get_length(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_length", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_17shift_calculators_Out_array *)__pyx_v_self->__pyx_vtab)->get_length(__pyx_v_self, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.get_length", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line440")'> 440:         return self._length</pre>
<pre id='line440' class='code' style='background-color: #FFFF6e'>
  /* "Cython_shift_calculator.pyx":440
 * 
 *     cpdef get_length(self):
 *         return self._length             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef add_all(self, Out_array target_array):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_length);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 440; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.get_length", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_9Out_array_5get_length(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_9Out_array_5get_length(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_length (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_9Out_array_4get_length(((struct __pyx_obj_17shift_calculators_Out_array *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line441")'> 441: </pre>
<pre id='line441' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line442")'> 442:     cpdef add_all(self, Out_array target_array):</pre>
<pre id='line442' class='code' style='background-color: #FFFF43'>
/* "Cython_shift_calculator.pyx":442
 *         return self._length
 * 
 *     cpdef add_all(self, Out_array target_array):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3 value
 *         for i in range(target_array._length):
 */

static PyObject *__pyx_pw_17shift_calculators_9Out_array_7add_all(PyObject *__pyx_v_self, PyObject *__pyx_v_target_array); /*proto*/
static PyObject *__pyx_f_17shift_calculators_9Out_array_add_all(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_target_array, int __pyx_skip_dispatch) {
  Vec3 __pyx_v_value;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("add_all", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s__add_all);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 442; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_17shift_calculators_9Out_array_7add_all)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 442; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_target_array));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_v_target_array));
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_target_array));
      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 442; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "Cython_shift_calculator.pyx":442
 *         return self._length
 * 
 *     cpdef add_all(self, Out_array target_array):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3 value
 *         for i in range(target_array._length):
 */

static PyObject *__pyx_pf_17shift_calculators_9Out_array_6add_all(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_target_array) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("add_all", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_17shift_calculators_Out_array *)__pyx_v_self->__pyx_vtab)->add_all(__pyx_v_self, __pyx_v_target_array, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 442; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.add_all", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static void __pyx_pw_17shift_calculators_9Out_array_9__dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pw_17shift_calculators_9Out_array_9__dealloc__(PyObject *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__dealloc__ (wrapper)", 0);
  __pyx_pf_17shift_calculators_9Out_array_8__dealloc__(((struct __pyx_obj_17shift_calculators_Out_array *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line443")'> 443:         cdef Vec3 value</pre>
<pre id='line443' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line444")'> 444:         for i in range(target_array._length):</pre>
<pre id='line444' class='code' style='background-color: #FFFF20'>
  /* "Cython_shift_calculator.pyx":444
 *     cpdef add_all(self, Out_array target_array):
 *         cdef Vec3 value
 *         for i in range(target_array._length):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if i <code><</code> self._length and target_array._mask[i]:
 *                 value = Vec3(target_array._data[i*3+0],target_array._data[i*3+1],target_array._data[i*3+2])
 */
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_target_array->_length);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_3 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (!__pyx_t_5 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) {
      if (__pyx_t_4 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_5 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
      if (__pyx_t_4 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_1 = __pyx_t_5(__pyx_t_3);
      if (unlikely(!__pyx_t_1)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
    __pyx_v_i = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF44' onclick='toggleDiv("line445")'> 445:             if i &lt; self._length and target_array._mask[i]:</pre>
<pre id='line445' class='code' style='background-color: #FFFF44'>
    /* "Cython_shift_calculator.pyx":445
 *         cdef Vec3 value
 *         for i in range(target_array._length):
 *             if i <code><</code> self._length and target_array._mask[i]:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 value = Vec3(target_array._data[i*3+0],target_array._data[i*3+1],target_array._data[i*3+2])
 *                 self.add(i, value)
 */
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_length);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 445; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_i, __pyx_t_1, Py_LT); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 445; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_6 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 445; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (__pyx_t_6) {
      __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 445; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_8 = (__pyx_v_target_array->_mask[__pyx_t_7]);
    } else {
      __pyx_t_8 = __pyx_t_6;
    }
    if (__pyx_t_8) {
</pre><pre class='line' style='background-color: #FFFF21' onclick='toggleDiv("line446")'> 446:                 value = Vec3(target_array._data[i*3+0],target_array._data[i*3+1],target_array._data[i*3+2])</pre>
<pre id='line446' class='code' style='background-color: #FFFF21'>
      /* "Cython_shift_calculator.pyx":446
 *         for i in range(target_array._length):
 *             if i <code><</code> self._length and target_array._mask[i]:
 *                 value = Vec3(target_array._data[i*3+0],target_array._data[i*3+1],target_array._data[i*3+2])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self.add(i, value)
 * 
 */
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_i, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 446; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 446; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 446; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_i, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 446; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 446; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_9 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 446; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_i, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 446; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 446; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_10 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 446; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_v_value = Vec3((__pyx_v_target_array->_data[__pyx_t_7]), (__pyx_v_target_array->_data[__pyx_t_9]), (__pyx_v_target_array->_data[__pyx_t_10]));
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line447")'> 447:                 self.add(i, value)</pre>
<pre id='line447' class='code' style='background-color: #FFFF4f'>
      /* "Cython_shift_calculator.pyx":447
 *             if i <code><</code> self._length and target_array._mask[i]:
 *                 value = Vec3(target_array._data[i*3+0],target_array._data[i*3+1],target_array._data[i*3+2])
 *                 self.add(i, value)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __dealloc__(self):
 */
      __pyx_t_11 = __Pyx_<span class='py_c_api'>PyInt_AsLong</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_11 == (long)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 447; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_f_17shift_calculators_9Out_array_add(__pyx_v_self, __pyx_t_11, __pyx_v_value);
      goto __pyx_L5;
    }
    __pyx_L5:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.add_all", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_9Out_array_7add_all(PyObject *__pyx_v_self, PyObject *__pyx_v_target_array); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_9Out_array_7add_all(PyObject *__pyx_v_self, PyObject *__pyx_v_target_array) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("add_all (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_target_array), __pyx_ptype_17shift_calculators_Out_array, 1, "target_array", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 442; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_9Out_array_6add_all(((struct __pyx_obj_17shift_calculators_Out_array *)__pyx_v_self), ((struct __pyx_obj_17shift_calculators_Out_array *)__pyx_v_target_array));
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line448")'> 448: </pre>
<pre id='line448' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line449")'> 449:     def __dealloc__(self):</pre>
<pre id='line449' class='code' style='background-color: #FFFFe7'>
/* "Cython_shift_calculator.pyx":449
 *                 self.add(i, value)
 * 
 *     def __dealloc__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         pass
 * #        free(self._data)
 */

static void __pyx_pf_17shift_calculators_9Out_array_8__dealloc__(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__dealloc__", 0);

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line450")'> 450:         pass</pre>
<pre id='line450' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line451")'> 451: #        free(self._data)</pre>
<pre id='line451' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line452")'> 452: #        self._data = NULL</pre>
<pre id='line452' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line453")'> 453: #        free(self._mask)</pre>
<pre id='line453' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line454")'> 454: #        self._mask = NULL</pre>
<pre id='line454' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line455")'> 455: </pre>
<pre id='line455' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line456")'> 456:     cdef inline bint _check_clear_length(self, long length) except -1:</pre>
<pre id='line456' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":456
 * #        self._mask = NULL
 * 
 *     cdef inline bint _check_clear_length(self, long length) except -1:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if not length <code><</code>= self._length:
 *             raise IndexError("tried to clear to %i length is %i" % (length,self._length))
 */

static CYTHON_INLINE int __pyx_f_17shift_calculators_9Out_array__check_clear_length(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self, long __pyx_v_length) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_check_clear_length", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line457")'> 457:         if not length &lt;= self._length:</pre>
<pre id='line457' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":457
 * 
 *     cdef inline bint _check_clear_length(self, long length) except -1:
 *         if not length <code><</code>= self._length:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             raise IndexError("tried to clear to %i length is %i" % (length,self._length))
 *         if self._data is NULL:
 */
  __pyx_t_1 = (!(__pyx_v_length <code><</code>= __pyx_v_self->_length));
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFF35' onclick='toggleDiv("line458")'> 458:             raise IndexError("tried to clear to %i length is %i" % (length,self._length))</pre>
<pre id='line458' class='code' style='background-color: #FFFF35'>
    /* "Cython_shift_calculator.pyx":458
 *     cdef inline bint _check_clear_length(self, long length) except -1:
 *         if not length <code><</code>= self._length:
 *             raise IndexError("tried to clear to %i length is %i" % (length,self._length))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if self._data is NULL:
 *             raise AttributeError("trying to access deallocated memory!")
 */
    __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_length);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 458; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_length);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 458; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 458; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    __pyx_t_2 = 0;
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_17), ((PyObject *)__pyx_t_4));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 458; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 458; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, ((PyObject *)__pyx_t_3));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_3));
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_IndexError, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 458; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 458; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line459")'> 459:         if self._data is NULL:</pre>
<pre id='line459' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":459
 *         if not length <code><</code>= self._length:
 *             raise IndexError("tried to clear to %i length is %i" % (length,self._length))
 *         if self._data is NULL:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             raise AttributeError("trying to access deallocated memory!")
 * 
 */
  __pyx_t_1 = (__pyx_v_self->_data == NULL);
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line460")'> 460:             raise AttributeError("trying to access deallocated memory!")</pre>
<pre id='line460' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":460
 *             raise IndexError("tried to clear to %i length is %i" % (length,self._length))
 *         if self._data is NULL:
 *             raise AttributeError("trying to access deallocated memory!")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline bint _check_offset(self, long offset) except -1:
 */
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_AttributeError, ((PyObject *)__pyx_k_tuple_19), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 460; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 460; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L4;
  }
  __pyx_L4:;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array._check_clear_length", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

  /* "Cython_shift_calculator.pyx":460
 *             raise IndexError("tried to clear to %i length is %i" % (length,self._length))
 *         if self._data is NULL:
 *             raise AttributeError("trying to access deallocated memory!")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline bint _check_offset(self, long offset) except -1:
 */
  __pyx_k_tuple_19 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_18));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 460; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_19);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_19));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line461")'> 461: </pre>
<pre id='line461' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line462")'> 462:     cdef inline bint _check_offset(self, long offset) except -1:</pre>
<pre id='line462' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":462
 *             raise AttributeError("trying to access deallocated memory!")
 * 
 *     cdef inline bint _check_offset(self, long offset) except -1:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if not offset <code><</code> self._length:
 *             raise IndexError("tried to access object at %i length is %i" % (offset,self._length))
 */

static CYTHON_INLINE int __pyx_f_17shift_calculators_9Out_array__check_offset(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self, long __pyx_v_offset) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_check_offset", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line463")'> 463:         if not offset &lt; self._length:</pre>
<pre id='line463' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":463
 * 
 *     cdef inline bint _check_offset(self, long offset) except -1:
 *         if not offset <code><</code> self._length:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             raise IndexError("tried to access object at %i length is %i" % (offset,self._length))
 *         if self._data is NULL:
 */
  __pyx_t_1 = (!(__pyx_v_offset <code><</code> __pyx_v_self->_length));
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFF35' onclick='toggleDiv("line464")'> 464:             raise IndexError("tried to access object at %i length is %i" % (offset,self._length))</pre>
<pre id='line464' class='code' style='background-color: #FFFF35'>
    /* "Cython_shift_calculator.pyx":464
 *     cdef inline bint _check_offset(self, long offset) except -1:
 *         if not offset <code><</code> self._length:
 *             raise IndexError("tried to access object at %i length is %i" % (offset,self._length))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if self._data is NULL:
 *             raise AttributeError("trying to access deallocated memory!")
 */
    __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_offset);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_length);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    __pyx_t_2 = 0;
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_20), ((PyObject *)__pyx_t_4));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, ((PyObject *)__pyx_t_3));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_3));
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_IndexError, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line465")'> 465:         if self._data is NULL:</pre>
<pre id='line465' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":465
 *         if not offset <code><</code> self._length:
 *             raise IndexError("tried to access object at %i length is %i" % (offset,self._length))
 *         if self._data is NULL:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             raise AttributeError("trying to access deallocated memory!")
 * 
 */
  __pyx_t_1 = (__pyx_v_self->_data == NULL);
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line466")'> 466:             raise AttributeError("trying to access deallocated memory!")</pre>
<pre id='line466' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":466
 *             raise IndexError("tried to access object at %i length is %i" % (offset,self._length))
 *         if self._data is NULL:
 *             raise AttributeError("trying to access deallocated memory!")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef bint realloc(self,long length) except -1:
 */
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_AttributeError, ((PyObject *)__pyx_k_tuple_21), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 466; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 466; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L4;
  }
  __pyx_L4:;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array._check_offset", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

  /* "Cython_shift_calculator.pyx":466
 *             raise IndexError("tried to access object at %i length is %i" % (offset,self._length))
 *         if self._data is NULL:
 *             raise AttributeError("trying to access deallocated memory!")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef bint realloc(self,long length) except -1:
 */
  __pyx_k_tuple_21 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_18));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 466; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_21);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_21));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line467")'> 467: </pre>
<pre id='line467' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2d' onclick='toggleDiv("line468")'> 468:     cpdef bint realloc(self,long length) except -1:</pre>
<pre id='line468' class='code' style='background-color: #FFFF2d'>
/* "Cython_shift_calculator.pyx":468
 *             raise AttributeError("trying to access deallocated memory!")
 * 
 *     cpdef bint realloc(self,long length) except -1:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if length <code><</code>60000:
 * #            free(self._data)
 */

static PyObject *__pyx_pw_17shift_calculators_9Out_array_11realloc(PyObject *__pyx_v_self, PyObject *__pyx_arg_length); /*proto*/
static int __pyx_f_17shift_calculators_9Out_array_realloc(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self, long __pyx_v_length, int __pyx_skip_dispatch) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("realloc", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s__realloc);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 468; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_17shift_calculators_9Out_array_11realloc)) {
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_length);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 468; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 468; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 468; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_4 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 468; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_r = __pyx_t_4;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "Cython_shift_calculator.pyx":468
 *             raise AttributeError("trying to access deallocated memory!")
 * 
 *     cpdef bint realloc(self,long length) except -1:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if length <code><</code>60000:
 * #            free(self._data)
 */

static PyObject *__pyx_pf_17shift_calculators_9Out_array_10realloc(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self, long __pyx_v_length) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("realloc", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_17shift_calculators_Out_array *)__pyx_v_self->__pyx_vtab)->realloc(__pyx_v_self, __pyx_v_length, 1);<span class='error_goto'> if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 468; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 468; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.realloc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line469")'> 469:         if length &lt;60000:</pre>
<pre id='line469' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":469
 * 
 *     cpdef bint realloc(self,long length) except -1:
 *         if length <code><</code>60000:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #            free(self._data)
 * #            self._data = NULL
 */
  __pyx_t_4 = (__pyx_v_length <code><</code> 60000);
  if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line470")'> 470: #            free(self._data)</pre>
<pre id='line470' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line471")'> 471: #            self._data = NULL</pre>
<pre id='line471' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line472")'> 472: #            self._data = &lt;double *&gt;malloc(3 *(length+1) * sizeof(double))</pre>
<pre id='line472' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line473")'> 473: #            if not self._data:</pre>
<pre id='line473' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line474")'> 474: #                raise MemoryError("couldn't allocate array of length %i" % length)</pre>
<pre id='line474' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line475")'> 475: #            if  self._data:</pre>
<pre id='line475' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line476")'> 476: #                self._length =length</pre>
<pre id='line476' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line477")'> 477:             self._clear(length)</pre>
<pre id='line477' class='code' style='background-color: #FFFF96'>
    /* "Cython_shift_calculator.pyx":477
 * #            if  self._data:
 * #                self._length =length
 *             self._clear(length)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             raise MemoryError("couldn't beyond of length %i" % 60000)
 */
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_length);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 477; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = ((struct __pyx_vtabstruct_17shift_calculators_Out_array *)__pyx_v_self->__pyx_vtab)->_clear(__pyx_v_self, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 477; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line478")'> 478:         else:</pre>
<pre id='line478' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF33' onclick='toggleDiv("line479")'> 479:             raise MemoryError("couldn't beyond of length %i" % 60000)</pre>
<pre id='line479' class='code' style='background-color: #FFFF33'>
    /* "Cython_shift_calculator.pyx":479
 *             self._clear(length)
 *         else:
 *             raise MemoryError("couldn't beyond of length %i" % 60000)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #
 * #            free(self._mask)
 */
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_22), __pyx_int_60000);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_t_2));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_2));
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_MemoryError, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_L3:;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.realloc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_9Out_array_11realloc(PyObject *__pyx_v_self, PyObject *__pyx_arg_length); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_9Out_array_11realloc(PyObject *__pyx_v_self, PyObject *__pyx_arg_length) {
  long __pyx_v_length;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("realloc (wrapper)", 0);
  assert(__pyx_arg_length); {
    __pyx_v_length = __Pyx_<span class='py_c_api'>PyInt_AsLong</span>(__pyx_arg_length);<span class='error_goto'> if (unlikely((__pyx_v_length == (long)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 468; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.realloc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_9Out_array_10realloc(((struct __pyx_obj_17shift_calculators_Out_array *)__pyx_v_self), ((long)__pyx_v_length));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line480")'> 480: #</pre>
<pre id='line480' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line481")'> 481: #            free(self._mask)</pre>
<pre id='line481' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line482")'> 482: #            self._mask = NULL</pre>
<pre id='line482' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line483")'> 483: #            self._mask = &lt;int *&gt;malloc((length+1) * sizeof(int))</pre>
<pre id='line483' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line484")'> 484: #            if not self._mask:</pre>
<pre id='line484' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line485")'> 485: #                raise MemoryError("couldn't allocate array of length %i" % length)</pre>
<pre id='line485' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line486")'> 486: #            if  self._mask:</pre>
<pre id='line486' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line487")'> 487: #                self._clear_mask(length)</pre>
<pre id='line487' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line488")'> 488: </pre>
<pre id='line488' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line489")'> 489:     cdef inline bint _check_state(self) except -1:</pre>
<pre id='line489' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":489
 * #                self._clear_mask(length)
 * 
 *     cdef inline bint _check_state(self) except -1:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if self._data is NULL:
 *             raise MemoryError("couldn't reallocate array of length %i" % self._length)
 */

static CYTHON_INLINE int __pyx_f_17shift_calculators_9Out_array__check_state(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_check_state", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line490")'> 490:         if self._data is NULL:</pre>
<pre id='line490' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":490
 * 
 *     cdef inline bint _check_state(self) except -1:
 *         if self._data is NULL:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             raise MemoryError("couldn't reallocate array of length %i" % self._length)
 * 
 */
  __pyx_t_1 = (__pyx_v_self->_data == NULL);
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line491")'> 491:             raise MemoryError("couldn't reallocate array of length %i" % self._length)</pre>
<pre id='line491' class='code' style='background-color: #FFFF3e'>
    /* "Cython_shift_calculator.pyx":491
 *     cdef inline bint _check_state(self) except -1:
 *         if self._data is NULL:
 *             raise MemoryError("couldn't reallocate array of length %i" % self._length)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef _clear(self, length):
 */
    __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_length);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_23), __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_t_3));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_3));
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_MemoryError, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L3;
  }
  __pyx_L3:;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array._check_state", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line492")'> 492: </pre>
<pre id='line492' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line493")'> 493:     cdef _clear(self, length):</pre>
<pre id='line493' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":493
 *             raise MemoryError("couldn't reallocate array of length %i" % self._length)
 * 
 *     cdef _clear(self, length):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._check_clear_length(length)
 *         for i in range(length*3):
 */

static PyObject *__pyx_f_17shift_calculators_9Out_array__clear(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self, PyObject *__pyx_v_length) {
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_clear", 0);
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line494")'> 494:         self._check_clear_length(length)</pre>
<pre id='line494' class='code' style='background-color: #FFFF7f'>
  /* "Cython_shift_calculator.pyx":494
 * 
 *     cdef _clear(self, length):
 *         self._check_clear_length(length)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for i in range(length*3):
 *             self._data[i] = 0.0
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyInt_AsLong</span>(__pyx_v_length);<span class='error_goto'> if (unlikely((__pyx_t_1 == (long)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 494; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = __pyx_f_17shift_calculators_9Out_array__check_clear_length(__pyx_v_self, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 494; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line495")'> 495:         for i in range(length*3):</pre>
<pre id='line495' class='code' style='background-color: #FFFF20'>
  /* "Cython_shift_calculator.pyx":495
 *     cdef _clear(self, length):
 *         self._check_clear_length(length)
 *         for i in range(length*3):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._data[i] = 0.0
 *         for i in range(length):
 */
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_length, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 495; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 495; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 495; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
    __pyx_t_4 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 495; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (!__pyx_t_6 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4)) {
      if (__pyx_t_5 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 495; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 495; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_6 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {
      if (__pyx_t_5 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 495; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 495; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_3 = __pyx_t_6(__pyx_t_4);
      if (unlikely(!__pyx_t_3)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 495; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
    __pyx_v_i = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line496")'> 496:             self._data[i] = 0.0</pre>
<pre id='line496' class='code' style='background-color: #FFFF79'>
    /* "Cython_shift_calculator.pyx":496
 *         self._check_clear_length(length)
 *         for i in range(length*3):
 *             self._data[i] = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for i in range(length):
 *             self._mask[i]=0
 */
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 496; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    (__pyx_v_self->_data[__pyx_t_7]) = 0.0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF22' onclick='toggleDiv("line497")'> 497:         for i in range(length):</pre>
<pre id='line497' class='code' style='background-color: #FFFF22'>
  /* "Cython_shift_calculator.pyx":497
 *         for i in range(length*3):
 *             self._data[i] = 0.0
 *         for i in range(length):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._mask[i]=0
 * 
 */
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 497; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_length);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_length);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_length);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 497; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
    __pyx_t_4 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 497; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (!__pyx_t_6 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4)) {
      if (__pyx_t_5 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 497; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 497; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_6 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {
      if (__pyx_t_5 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 497; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 497; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_3 = __pyx_t_6(__pyx_t_4);
      if (unlikely(!__pyx_t_3)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 497; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
    __pyx_v_i = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line498")'> 498:             self._mask[i]=0</pre>
<pre id='line498' class='code' style='background-color: #FFFF2a'>
    /* "Cython_shift_calculator.pyx":498
 *             self._data[i] = 0.0
 *         for i in range(length):
 *             self._mask[i]=0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def padd(self,offset,value):
 */
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    (__pyx_v_self->_mask[__pyx_t_7]) = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array._clear", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_9Out_array_13padd(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_9Out_array_13padd(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_offset = 0;
  PyObject *__pyx_v_value = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("padd (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__offset,&__pyx_n_s__value,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__offset)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__value)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("padd", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 500; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "padd") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 500; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_offset = values[0];
    __pyx_v_value = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("padd", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 500; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.padd", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_9Out_array_12padd(((struct __pyx_obj_17shift_calculators_Out_array *)__pyx_v_self), __pyx_v_offset, __pyx_v_value);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line499")'> 499: </pre>
<pre id='line499' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line500")'> 500:     def padd(self,offset,value):</pre>
<pre id='line500' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":500
 *             self._mask[i]=0
 * 
 *     def padd(self,offset,value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3 cvalue  = Vec3(value[0],value[1],value[2])
 *         self.add(offset, cvalue)
 */

static PyObject *__pyx_pf_17shift_calculators_9Out_array_12padd(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self, PyObject *__pyx_v_offset, PyObject *__pyx_v_value) {
  Vec3 __pyx_v_cvalue;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("padd", 0);
</pre><pre class='line' style='background-color: #FFFF34' onclick='toggleDiv("line501")'> 501:         cdef Vec3 cvalue  = Vec3(value[0],value[1],value[2])</pre>
<pre id='line501' class='code' style='background-color: #FFFF34'>
  /* "Cython_shift_calculator.pyx":501
 * 
 *     def padd(self,offset,value):
 *         cdef Vec3 cvalue  = Vec3(value[0],value[1],value[2])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.add(offset, cvalue)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_value, 0, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 501; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 501; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_value, 1, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 501; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_3 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 501; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_value, 2, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 501; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_4 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_4 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 501; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_cvalue = Vec3(__pyx_t_2, __pyx_t_3, __pyx_t_4);
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line502")'> 502:         self.add(offset, cvalue)</pre>
<pre id='line502' class='code' style='background-color: #FFFF66'>
  /* "Cython_shift_calculator.pyx":502
 *     def padd(self,offset,value):
 *         cdef Vec3 cvalue  = Vec3(value[0],value[1],value[2])
 *         self.add(offset, cvalue)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     @cython.profile(False)
 */
  __pyx_t_5 = __Pyx_<span class='py_c_api'>PyInt_AsLong</span>(__pyx_v_offset);<span class='error_goto'> if (unlikely((__pyx_t_5 == (long)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 502; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_f_17shift_calculators_9Out_array_add(__pyx_v_self, __pyx_t_5, __pyx_v_cvalue);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.padd", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line503")'> 503: </pre>
<pre id='line503' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line504")'> 504:     @cython.profile(False)</pre>
<pre id='line504' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line505")'> 505:     cdef inline void  add(self,long offset, Vec3&amp; value):</pre>
<pre id='line505' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":505
 * 
 *     @cython.profile(False)
 *     cdef inline void  add(self,long offset, Vec3& value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #        self._check_offset(offset)
 *         cdef long id3 = offset *3
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_9Out_array_add(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self, long __pyx_v_offset, Vec3 &__pyx_v_value) {
  long __pyx_v_id3;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("add", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line506")'> 506: #        self._check_offset(offset)</pre>
<pre id='line506' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line507")'> 507:         cdef long id3 = offset *3</pre>
<pre id='line507' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":507
 *     cdef inline void  add(self,long offset, Vec3& value):
 * #        self._check_offset(offset)
 *         cdef long id3 = offset *3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._data[id3]   += value[0]
 */
  __pyx_v_id3 = (__pyx_v_offset * 3);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line508")'> 508: </pre>
<pre id='line508' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line509")'> 509:         self._data[id3]   += value[0]</pre>
<pre id='line509' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":509
 *         cdef long id3 = offset *3
 * 
 *         self._data[id3]   += value[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._data[id3+1] += value[1]
 *         self._data[id3+2] += value[2]
 */
  __pyx_t_1 = __pyx_v_id3;
  (__pyx_v_self->_data[__pyx_t_1]) = ((__pyx_v_self->_data[__pyx_t_1]) + (__pyx_v_value[0]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line510")'> 510:         self._data[id3+1] += value[1]</pre>
<pre id='line510' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":510
 * 
 *         self._data[id3]   += value[0]
 *         self._data[id3+1] += value[1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._data[id3+2] += value[2]
 * 
 */
  __pyx_t_1 = (__pyx_v_id3 + 1);
  (__pyx_v_self->_data[__pyx_t_1]) = ((__pyx_v_self->_data[__pyx_t_1]) + (__pyx_v_value[1]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line511")'> 511:         self._data[id3+2] += value[2]</pre>
<pre id='line511' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":511
 *         self._data[id3]   += value[0]
 *         self._data[id3+1] += value[1]
 *         self._data[id3+2] += value[2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._mask[offset] = 1
 */
  __pyx_t_1 = (__pyx_v_id3 + 2);
  (__pyx_v_self->_data[__pyx_t_1]) = ((__pyx_v_self->_data[__pyx_t_1]) + (__pyx_v_value[2]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line512")'> 512: </pre>
<pre id='line512' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line513")'> 513:         self._mask[offset] = 1</pre>
<pre id='line513' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":513
 *         self._data[id3+2] += value[2]
 * 
 *         self._mask[offset] = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def clear_by_id(self,target_ids):
 */
  (__pyx_v_self->_mask[__pyx_v_offset]) = 1;

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_9Out_array_15clear_by_id(PyObject *__pyx_v_self, PyObject *__pyx_v_target_ids); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_9Out_array_15clear_by_id(PyObject *__pyx_v_self, PyObject *__pyx_v_target_ids) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("clear_by_id (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_9Out_array_14clear_by_id(((struct __pyx_obj_17shift_calculators_Out_array *)__pyx_v_self), ((PyObject *)__pyx_v_target_ids));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line514")'> 514: </pre>
<pre id='line514' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line515")'> 515:     def clear_by_id(self,target_ids):</pre>
<pre id='line515' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":515
 *         self._mask[offset] = 1
 * 
 *     def clear_by_id(self,target_ids):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef long id3 = 0
 *         for target_id in target_ids:
 */

static PyObject *__pyx_pf_17shift_calculators_9Out_array_14clear_by_id(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self, PyObject *__pyx_v_target_ids) {
  long __pyx_v_id3;
  PyObject *__pyx_v_target_id = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("clear_by_id", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line516")'> 516:         cdef long id3 = 0</pre>
<pre id='line516' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":516
 * 
 *     def clear_by_id(self,target_ids):
 *         cdef long id3 = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for target_id in target_ids:
 *             self._check_offset(target_id)
 */
  __pyx_v_id3 = 0;
</pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line517")'> 517:         for target_id in target_ids:</pre>
<pre id='line517' class='code' style='background-color: #FFFF2a'>
  /* "Cython_shift_calculator.pyx":517
 *     def clear_by_id(self,target_ids):
 *         cdef long id3 = 0
 *         for target_id in target_ids:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._check_offset(target_id)
 *             id3 = target_id *3
 */
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_target_ids) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_target_ids)) {
    __pyx_t_1 = __pyx_v_target_ids; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_target_ids);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext;
  }
  for (;;) {
    if (!__pyx_t_3 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_3 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_target_id);
    __pyx_v_target_id = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line518")'> 518:             self._check_offset(target_id)</pre>
<pre id='line518' class='code' style='background-color: #FFFF7f'>
    /* "Cython_shift_calculator.pyx":518
 *         cdef long id3 = 0
 *         for target_id in target_ids:
 *             self._check_offset(target_id)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             id3 = target_id *3
 * 
 */
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyInt_AsLong</span>(__pyx_v_target_id);<span class='error_goto'> if (unlikely((__pyx_t_5 == (long)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_6 = __pyx_f_17shift_calculators_9Out_array__check_offset(__pyx_v_self, __pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line519")'> 519:             id3 = target_id *3</pre>
<pre id='line519' class='code' style='background-color: #FFFF62'>
    /* "Cython_shift_calculator.pyx":519
 *         for target_id in target_ids:
 *             self._check_offset(target_id)
 *             id3 = target_id *3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             self._data[id3]   = 0.0
 */
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_target_id, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyInt_AsLong</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_5 == (long)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_id3 = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line520")'> 520: </pre>
<pre id='line520' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line521")'> 521:             self._data[id3]   = 0.0</pre>
<pre id='line521' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":521
 *             id3 = target_id *3
 * 
 *             self._data[id3]   = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._data[id3+1] = 0.0
 *             self._data[id3+2] = 0.0
 */
    (__pyx_v_self->_data[__pyx_v_id3]) = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line522")'> 522:             self._data[id3+1] = 0.0</pre>
<pre id='line522' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":522
 * 
 *             self._data[id3]   = 0.0
 *             self._data[id3+1] = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._data[id3+2] = 0.0
 * 
 */
    (__pyx_v_self->_data[(__pyx_v_id3 + 1)]) = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line523")'> 523:             self._data[id3+2] = 0.0</pre>
<pre id='line523' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":523
 *             self._data[id3]   = 0.0
 *             self._data[id3+1] = 0.0
 *             self._data[id3+2] = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             self._mask[target_id] = 0
 */
    (__pyx_v_self->_data[(__pyx_v_id3 + 2)]) = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line524")'> 524: </pre>
<pre id='line524' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line525")'> 525:             self._mask[target_id] = 0</pre>
<pre id='line525' class='code' style='background-color: #FFFF5b'>
    /* "Cython_shift_calculator.pyx":525
 *             self._data[id3+2] = 0.0
 * 
 *             self._mask[target_id] = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def add_forces_to_result(self, result=None, weight=1.0):
 */
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_target_id);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    (__pyx_v_self->_mask[__pyx_t_7]) = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.clear_by_id", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_target_id);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_9Out_array_17add_forces_to_result(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_9Out_array_17add_forces_to_result(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_result = 0;
  PyObject *__pyx_v_weight = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("add_forces_to_result (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__result,&__pyx_n_s__weight,0};
    PyObject* values[2] = {0,0};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line526")'> 526: </pre>
<pre id='line526' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF37' onclick='toggleDiv("line527")'> 527:     def add_forces_to_result(self, result=None, weight=1.0):</pre>
<pre id='line527' class='code' style='background-color: #FFFF37'>
    /* "Cython_shift_calculator.pyx":527
 *             self._mask[target_id] = 0
 * 
 *     def add_forces_to_result(self, result=None, weight=1.0):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef long id3
 *         cdef DerivList *derivList
 */
    values[0] = ((PyObject *)Py_None);
    values[1] = __pyx_k_24;
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__result);
          if (value) { values[0] = value; kw_args--; }
        }
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__weight);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "add_forces_to_result") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_result = values[0];
    __pyx_v_weight = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("add_forces_to_result", 0, 0, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.add_forces_to_result", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_9Out_array_16add_forces_to_result(((struct __pyx_obj_17shift_calculators_Out_array *)__pyx_v_self), __pyx_v_result, __pyx_v_weight);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_17shift_calculators_9Out_array_16add_forces_to_result(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self, PyObject *__pyx_v_result, PyObject *__pyx_v_weight) {
  long __pyx_v_id3;
  DerivList *__pyx_v_derivList;
  CDSVector<code><</code>Vec3> *__pyx_v_derivs;
  PyObject *__pyx_v_pointer = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("add_forces_to_result", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_result);

  /* "Cython_shift_calculator.pyx":527
 *             self._mask[target_id] = 0
 * 
 *     def add_forces_to_result(self, result=None, weight=1.0):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef long id3
 *         cdef DerivList *derivList
 */
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(1.0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_k_24 = __pyx_t_2;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line528")'> 528:         cdef long id3</pre>
<pre id='line528' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line529")'> 529:         cdef DerivList *derivList</pre>
<pre id='line529' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line530")'> 530:         cdef CDSVector[Vec3]* derivs</pre>
<pre id='line530' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line531")'> 531:         cdef Vec3* test</pre>
<pre id='line531' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line532")'> 532: </pre>
<pre id='line532' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line533")'> 533:         if isinstance(result,PyDerivList):</pre>
<pre id='line533' class='code' style='background-color: #FFFF8d'>
  /* "Cython_shift_calculator.pyx":533
 *         cdef Vec3* test
 * 
 *         if isinstance(result,PyDerivList):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             pointer = int(result.this)
 *             derivList = (<code><</code>DerivList*><code><</code>size_t>pointer)
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__PyDerivList);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 533; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_result, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 533; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line534")'> 534:             pointer = int(result.this)</pre>
<pre id='line534' class='code' style='background-color: #FFFF5e'>
    /* "Cython_shift_calculator.pyx":534
 * 
 *         if isinstance(result,PyDerivList):
 *             pointer = int(result.this)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             derivList = (<code><</code>DerivList*><code><</code>size_t>pointer)
 *             #TODO: references don't work here lots of problems -> cython mailing list
 */
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_result, __pyx_n_s__this);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 534; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 534; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 534; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_v_pointer = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line535")'> 535:             derivList = (&lt;DerivList*&gt;&lt;size_t&gt;pointer)</pre>
<pre id='line535' class='code' style='background-color: #FFFF7f'>
    /* "Cython_shift_calculator.pyx":535
 *         if isinstance(result,PyDerivList):
 *             pointer = int(result.this)
 *             derivList = (<code><</code>DerivList*><code><</code>size_t>pointer)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             #TODO: references don't work here lots of problems -> cython mailing list
 *             derivs  = &derivList[0][self._simulation]
 */
    __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_v_pointer);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 535; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_derivList = ((DerivList *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line536")'> 536:             #TODO: references don't work here lots of problems -&gt; cython mailing list</pre>
<pre id='line536' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line537")'> 537:             derivs  = &amp;derivList[0][self._simulation]</pre>
<pre id='line537' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":537
 *             derivList = (<code><</code>DerivList*><code><</code>size_t>pointer)
 *             #TODO: references don't work here lots of problems -> cython mailing list
 *             derivs  = &derivList[0][self._simulation]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for i in range(self._length):
 *                 if self._mask[i] != 0:
 */
    __pyx_v_derivs = (&((__pyx_v_derivList[0])[__pyx_v_self->_simulation]));
</pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line538")'> 538:             for i in range(self._length):</pre>
<pre id='line538' class='code' style='background-color: #FFFF20'>
    /* "Cython_shift_calculator.pyx":538
 *             #TODO: references don't work here lots of problems -> cython mailing list
 *             derivs  = &derivList[0][self._simulation]
 *             for i in range(self._length):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if self._mask[i] != 0:
 *                     id3 = i * 3
 */
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_length);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 538; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 538; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 538; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      __pyx_t_3 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5 = 0;
      __pyx_t_6 = NULL;
    } else {
      __pyx_t_5 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 538; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_6 = Py_TYPE(__pyx_t_3)->tp_iternext;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (!__pyx_t_6 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) {
        if (__pyx_t_5 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 538; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 538; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else if (!__pyx_t_6 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
        if (__pyx_t_5 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 538; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 538; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else {
        __pyx_t_1 = __pyx_t_6(__pyx_t_3);
        if (unlikely(!__pyx_t_1)) {
          if (<span class='py_c_api'>PyErr_Occurred</span>()) {
            if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 538; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
      __pyx_v_i = __pyx_t_1;
      __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line539")'> 539:                 if self._mask[i] != 0:</pre>
<pre id='line539' class='code' style='background-color: #FFFF7f'>
      /* "Cython_shift_calculator.pyx":539
 *             derivs  = &derivList[0][self._simulation]
 *             for i in range(self._length):
 *                 if self._mask[i] != 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     id3 = i * 3
 * 
 */
      __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 539; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_2 = ((__pyx_v_self->_mask[__pyx_t_7]) != 0);
      if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line540")'> 540:                     id3 = i * 3</pre>
<pre id='line540' class='code' style='background-color: #FFFF62'>
        /* "Cython_shift_calculator.pyx":540
 *             for i in range(self._length):
 *                 if self._mask[i] != 0:
 *                     id3 = i * 3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                     derivs[0][i][0]  +=  self._data[id3] * weight
 */
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_i, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 540; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_8 = __Pyx_<span class='py_c_api'>PyInt_AsLong</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_8 == (long)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 540; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_v_id3 = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line541")'> 541: </pre>
<pre id='line541' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2f' onclick='toggleDiv("line542")'> 542:                     derivs[0][i][0]  +=  self._data[id3] * weight</pre>
<pre id='line542' class='code' style='background-color: #FFFF2f'>
        /* "Cython_shift_calculator.pyx":542
 *                     id3 = i * 3
 * 
 *                     derivs[0][i][0]  +=  self._data[id3] * weight             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     derivs[0][i][1]  +=  self._data[id3+1] *weight
 *                     derivs[0][i][2]  +=  self._data[id3+2] * weight
 */
        __pyx_t_8 = 0;
        __pyx_t_9 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_9 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_10 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((((__pyx_v_derivs[__pyx_t_8])[__pyx_t_9])[__pyx_t_10]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self->_data[__pyx_v_id3]));<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
        __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_11, __pyx_v_weight);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        __pyx_t_11 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_1, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        __pyx_t_13 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_11);<span class='error_goto'> if (unlikely((__pyx_t_13 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        (((__pyx_v_derivs[__pyx_t_8])[__pyx_t_9])[__pyx_t_10]) = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFF2f' onclick='toggleDiv("line543")'> 543:                     derivs[0][i][1]  +=  self._data[id3+1] *weight</pre>
<pre id='line543' class='code' style='background-color: #FFFF2f'>
        /* "Cython_shift_calculator.pyx":543
 * 
 *                     derivs[0][i][0]  +=  self._data[id3] * weight
 *                     derivs[0][i][1]  +=  self._data[id3+1] *weight             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     derivs[0][i][2]  +=  self._data[id3+2] * weight
 * 
 */
        __pyx_t_8 = 0;
        __pyx_t_9 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_9 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 543; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_10 = 1;
        __pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>((((__pyx_v_derivs[__pyx_t_8])[__pyx_t_9])[__pyx_t_10]));<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 543; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
        __pyx_t_12 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self->_data[(__pyx_v_id3 + 1)]));<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 543; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_12, __pyx_v_weight);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 543; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        __pyx_t_12 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_11, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 543; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_13 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_12);<span class='error_goto'> if (unlikely((__pyx_t_13 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 543; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        (((__pyx_v_derivs[__pyx_t_8])[__pyx_t_9])[__pyx_t_10]) = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFF2e' onclick='toggleDiv("line544")'> 544:                     derivs[0][i][2]  +=  self._data[id3+2] * weight</pre>
<pre id='line544' class='code' style='background-color: #FFFF2e'>
        /* "Cython_shift_calculator.pyx":544
 *                     derivs[0][i][0]  +=  self._data[id3] * weight
 *                     derivs[0][i][1]  +=  self._data[id3+1] *weight
 *                     derivs[0][i][2]  +=  self._data[id3+2] * weight             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
        __pyx_t_8 = 0;
        __pyx_t_9 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_9 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 544; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_10 = 2;
        __pyx_t_12 = <span class='py_c_api'>PyFloat_FromDouble</span>((((__pyx_v_derivs[__pyx_t_8])[__pyx_t_9])[__pyx_t_10]));<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 544; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
        __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self->_data[(__pyx_v_id3 + 2)]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 544; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_11 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_v_weight);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 544; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_12, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 544; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        __pyx_t_13 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_13 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 544; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        (((__pyx_v_derivs[__pyx_t_8])[__pyx_t_9])[__pyx_t_10]) = __pyx_t_13;
        goto __pyx_L6;
      }
      __pyx_L6:;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    goto __pyx_L3;
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line545")'> 545: </pre>
<pre id='line545' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line546")'> 546: </pre>
<pre id='line546' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line547")'> 547:         elif result == None:</pre>
<pre id='line547' class='code' style='background-color: #FFFF79'>
  /* "Cython_shift_calculator.pyx":547
 * 
 * 
 *         elif result == None:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if result ==  None:
 *                 result = [None] * self._length
 */
  __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_result, Py_None, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 547; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_2 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 547; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line548")'> 548:             if result ==  None:</pre>
<pre id='line548' class='code' style='background-color: #FFFF79'>
    /* "Cython_shift_calculator.pyx":548
 * 
 *         elif result == None:
 *             if result ==  None:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 result = [None] * self._length
 *             for i in range(self._length):
 */
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_result, Py_None, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_2 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line549")'> 549:                 result = [None] * self._length</pre>
<pre id='line549' class='code' style='background-color: #FFFF8d'>
      /* "Cython_shift_calculator.pyx":549
 *         elif result == None:
 *             if result ==  None:
 *                 result = [None] * self._length             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for i in range(self._length):
 *                 if self._mask[i] != 0:
 */
      __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1 * ((__pyx_v_self->_length<code><</code>0) ? 0:__pyx_v_self->_length));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 549; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      { Py_ssize_t __pyx_temp;
        for (__pyx_temp=0; __pyx_temp <code><</code> __pyx_v_self->_length; __pyx_temp++) {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
          <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, __pyx_temp, Py_None);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
        }
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_result);
      __pyx_v_result = ((PyObject *)__pyx_t_3);
      __pyx_t_3 = 0;
      goto __pyx_L7;
    }
    __pyx_L7:;
</pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line550")'> 550:             for i in range(self._length):</pre>
<pre id='line550' class='code' style='background-color: #FFFF20'>
    /* "Cython_shift_calculator.pyx":550
 *             if result ==  None:
 *                 result = [None] * self._length
 *             for i in range(self._length):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if self._mask[i] != 0:
 *                     if result[i] ==  None:
 */
    __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_length);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 550; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 550; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 550; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
      __pyx_t_1 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5 = 0;
      __pyx_t_6 = NULL;
    } else {
      __pyx_t_5 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 550; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_6 = Py_TYPE(__pyx_t_1)->tp_iternext;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    for (;;) {
      if (!__pyx_t_6 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) {
        if (__pyx_t_5 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 550; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 550; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else if (!__pyx_t_6 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
        if (__pyx_t_5 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 550; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 550; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else {
        __pyx_t_3 = __pyx_t_6(__pyx_t_1);
        if (unlikely(!__pyx_t_3)) {
          if (<span class='py_c_api'>PyErr_Occurred</span>()) {
            if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 550; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
      __pyx_v_i = __pyx_t_3;
      __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line551")'> 551:                 if self._mask[i] != 0:</pre>
<pre id='line551' class='code' style='background-color: #FFFF7f'>
      /* "Cython_shift_calculator.pyx":551
 *                 result = [None] * self._length
 *             for i in range(self._length):
 *                 if self._mask[i] != 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     if result[i] ==  None:
 *                         result[i] = [0.0]*3
 */
      __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 551; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_2 = ((__pyx_v_self->_mask[__pyx_t_7]) != 0);
      if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line552")'> 552:                     if result[i] ==  None:</pre>
<pre id='line552' class='code' style='background-color: #FFFF5e'>
        /* "Cython_shift_calculator.pyx":552
 *             for i in range(self._length):
 *                 if self._mask[i] != 0:
 *                     if result[i] ==  None:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         result[i] = [0.0]*3
 *                     id3 = i * 3
 */
        __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_result, __pyx_v_i);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
        __pyx_t_11 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, Py_None, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_11);<span class='error_goto'> if (unlikely(__pyx_t_2 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line553")'> 553:                         result[i] = [0.0]*3</pre>
<pre id='line553' class='code' style='background-color: #FFFF57'>
          /* "Cython_shift_calculator.pyx":553
 *                 if self._mask[i] != 0:
 *                     if result[i] ==  None:
 *                         result[i] = [0.0]*3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     id3 = i * 3
 *                     result[i][0] += self._data[id3] * weight
 */
          __pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>(0.0);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
          __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1 * 3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
          { Py_ssize_t __pyx_temp;
            for (__pyx_temp=0; __pyx_temp <code><</code> 3; __pyx_temp++) {
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
              <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, __pyx_temp, __pyx_t_11);
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_11);
            }
          }
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
          if (<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_result, __pyx_v_i, ((PyObject *)__pyx_t_3)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
          goto __pyx_L11;
        }
        __pyx_L11:;
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line554")'> 554:                     id3 = i * 3</pre>
<pre id='line554' class='code' style='background-color: #FFFF62'>
        /* "Cython_shift_calculator.pyx":554
 *                     if result[i] ==  None:
 *                         result[i] = [0.0]*3
 *                     id3 = i * 3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     result[i][0] += self._data[id3] * weight
 *                     result[i][1] += self._data[id3+1] *weight
 */
        __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_i, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 554; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
        __pyx_t_8 = __Pyx_<span class='py_c_api'>PyInt_AsLong</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_8 == (long)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 554; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_v_id3 = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line555")'> 555:                     result[i][0] += self._data[id3] * weight</pre>
<pre id='line555' class='code' style='background-color: #FFFF41'>
        /* "Cython_shift_calculator.pyx":555
 *                         result[i] = [0.0]*3
 *                     id3 = i * 3
 *                     result[i][0] += self._data[id3] * weight             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     result[i][1] += self._data[id3+1] *weight
 *                     result[i][2] += self._data[id3+2] * weight
 */
        __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_result, __pyx_v_i);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 555; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
        __pyx_t_7 = 0;
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, __pyx_t_7, sizeof(Py_ssize_t), PyInt_FromSsize_t);<span class='error_goto'> if (!__pyx_t_11) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 555; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
        __pyx_t_12 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self->_data[__pyx_v_id3]));<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 555; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
        __pyx_t_14 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_12, __pyx_v_weight);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 555; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        __pyx_t_12 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_11, __pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 555; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
        if (<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_t_3, __pyx_t_7, __pyx_t_12, sizeof(Py_ssize_t), PyInt_FromSsize_t) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 555; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line556")'> 556:                     result[i][1] += self._data[id3+1] *weight</pre>
<pre id='line556' class='code' style='background-color: #FFFF41'>
        /* "Cython_shift_calculator.pyx":556
 *                     id3 = i * 3
 *                     result[i][0] += self._data[id3] * weight
 *                     result[i][1] += self._data[id3+1] *weight             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     result[i][2] += self._data[id3+2] * weight
 *         else:
 */
        __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_result, __pyx_v_i);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
        __pyx_t_7 = 1;
        __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, __pyx_t_7, sizeof(Py_ssize_t), PyInt_FromSsize_t);<span class='error_goto'> if (!__pyx_t_12) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
        __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self->_data[(__pyx_v_id3 + 1)]));<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
        __pyx_t_11 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_14, __pyx_v_weight);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
        __pyx_t_14 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_12, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        if (<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_t_3, __pyx_t_7, __pyx_t_14, sizeof(Py_ssize_t), PyInt_FromSsize_t) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line557")'> 557:                     result[i][2] += self._data[id3+2] * weight</pre>
<pre id='line557' class='code' style='background-color: #FFFF3f'>
        /* "Cython_shift_calculator.pyx":557
 *                     result[i][0] += self._data[id3] * weight
 *                     result[i][1] += self._data[id3+1] *weight
 *                     result[i][2] += self._data[id3+2] * weight             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             # raw pointer
 */
        __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_result, __pyx_v_i);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
        __pyx_t_7 = 2;
        __pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, __pyx_t_7, sizeof(Py_ssize_t), PyInt_FromSsize_t);<span class='error_goto'> if (!__pyx_t_14) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
        __pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self->_data[(__pyx_v_id3 + 2)]));<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
        __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_11, __pyx_v_weight);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        __pyx_t_11 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_14, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        if (<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_t_3, __pyx_t_7, __pyx_t_11, sizeof(Py_ssize_t), PyInt_FromSsize_t) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        goto __pyx_L10;
      }
      __pyx_L10:;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line558")'> 558:         else:</pre>
<pre id='line558' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line559")'> 559:             # raw pointer</pre>
<pre id='line559' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line560")'> 560:             pointer = int(result)</pre>
<pre id='line560' class='code' style='background-color: #FFFF6e'>
    /* "Cython_shift_calculator.pyx":560
 *         else:
 *             # raw pointer
 *             pointer = int(result)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             derivList = (<code><</code>DerivList*><code><</code>size_t>pointer)
 *             #TODO: references don't work here lots of problems -> cython mailing list
 */
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 560; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_result);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_result);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_result);
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 560; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_v_pointer = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line561")'> 561:             derivList = (&lt;DerivList*&gt;&lt;size_t&gt;pointer)</pre>
<pre id='line561' class='code' style='background-color: #FFFF7f'>
    /* "Cython_shift_calculator.pyx":561
 *             # raw pointer
 *             pointer = int(result)
 *             derivList = (<code><</code>DerivList*><code><</code>size_t>pointer)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             #TODO: references don't work here lots of problems -> cython mailing list
 *             derivs  = &derivList[0][self._simulation]
 */
    __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_v_pointer);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 561; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_derivList = ((DerivList *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line562")'> 562:             #TODO: references don't work here lots of problems -&gt; cython mailing list</pre>
<pre id='line562' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line563")'> 563:             derivs  = &amp;derivList[0][self._simulation]</pre>
<pre id='line563' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":563
 *             derivList = (<code><</code>DerivList*><code><</code>size_t>pointer)
 *             #TODO: references don't work here lots of problems -> cython mailing list
 *             derivs  = &derivList[0][self._simulation]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for i in range(self._length):
 *                 if self._mask[i] != 0:
 */
    __pyx_v_derivs = (&((__pyx_v_derivList[0])[__pyx_v_self->_simulation]));
</pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line564")'> 564:             for i in range(self._length):</pre>
<pre id='line564' class='code' style='background-color: #FFFF20'>
    /* "Cython_shift_calculator.pyx":564
 *             #TODO: references don't work here lots of problems -> cython mailing list
 *             derivs  = &derivList[0][self._simulation]
 *             for i in range(self._length):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if self._mask[i] != 0:
 *                     id3 = i * 3
 */
    __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_length);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 564; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 564; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 564; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
      __pyx_t_1 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5 = 0;
      __pyx_t_6 = NULL;
    } else {
      __pyx_t_5 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 564; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_6 = Py_TYPE(__pyx_t_1)->tp_iternext;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    for (;;) {
      if (!__pyx_t_6 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) {
        if (__pyx_t_5 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 564; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 564; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else if (!__pyx_t_6 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
        if (__pyx_t_5 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 564; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 564; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else {
        __pyx_t_3 = __pyx_t_6(__pyx_t_1);
        if (unlikely(!__pyx_t_3)) {
          if (<span class='py_c_api'>PyErr_Occurred</span>()) {
            if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 564; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
      __pyx_v_i = __pyx_t_3;
      __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line565")'> 565:                 if self._mask[i] != 0:</pre>
<pre id='line565' class='code' style='background-color: #FFFF7f'>
      /* "Cython_shift_calculator.pyx":565
 *             derivs  = &derivList[0][self._simulation]
 *             for i in range(self._length):
 *                 if self._mask[i] != 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     id3 = i * 3
 * 
 */
      __pyx_t_7 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 565; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_2 = ((__pyx_v_self->_mask[__pyx_t_7]) != 0);
      if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line566")'> 566:                     id3 = i * 3</pre>
<pre id='line566' class='code' style='background-color: #FFFF62'>
        /* "Cython_shift_calculator.pyx":566
 *             for i in range(self._length):
 *                 if self._mask[i] != 0:
 *                     id3 = i * 3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                     derivs[0][i][0]  +=  self._data[id3] * weight
 */
        __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_i, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 566; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
        __pyx_t_8 = __Pyx_<span class='py_c_api'>PyInt_AsLong</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_8 == (long)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 566; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_v_id3 = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line567")'> 567: </pre>
<pre id='line567' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2f' onclick='toggleDiv("line568")'> 568:                     derivs[0][i][0]  +=  self._data[id3] * weight</pre>
<pre id='line568' class='code' style='background-color: #FFFF2f'>
        /* "Cython_shift_calculator.pyx":568
 *                     id3 = i * 3
 * 
 *                     derivs[0][i][0]  +=  self._data[id3] * weight             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     derivs[0][i][1]  +=  self._data[id3+1] *weight
 *                     derivs[0][i][2]  +=  self._data[id3+2] * weight
 */
        __pyx_t_8 = 0;
        __pyx_t_9 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_9 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 568; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_10 = 0;
        __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((((__pyx_v_derivs[__pyx_t_8])[__pyx_t_9])[__pyx_t_10]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 568; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
        __pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self->_data[__pyx_v_id3]));<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 568; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
        __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_11, __pyx_v_weight);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 568; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        __pyx_t_11 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_3, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 568; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        __pyx_t_13 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_11);<span class='error_goto'> if (unlikely((__pyx_t_13 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 568; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        (((__pyx_v_derivs[__pyx_t_8])[__pyx_t_9])[__pyx_t_10]) = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFF2f' onclick='toggleDiv("line569")'> 569:                     derivs[0][i][1]  +=  self._data[id3+1] *weight</pre>
<pre id='line569' class='code' style='background-color: #FFFF2f'>
        /* "Cython_shift_calculator.pyx":569
 * 
 *                     derivs[0][i][0]  +=  self._data[id3] * weight
 *                     derivs[0][i][1]  +=  self._data[id3+1] *weight             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     derivs[0][i][2]  +=  self._data[id3+2] * weight
 * 
 */
        __pyx_t_8 = 0;
        __pyx_t_9 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_9 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_10 = 1;
        __pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>((((__pyx_v_derivs[__pyx_t_8])[__pyx_t_9])[__pyx_t_10]));<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
        __pyx_t_12 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self->_data[(__pyx_v_id3 + 1)]));<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
        __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_12, __pyx_v_weight);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        __pyx_t_12 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_11, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_13 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_12);<span class='error_goto'> if (unlikely((__pyx_t_13 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        (((__pyx_v_derivs[__pyx_t_8])[__pyx_t_9])[__pyx_t_10]) = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFF2e' onclick='toggleDiv("line570")'> 570:                     derivs[0][i][2]  +=  self._data[id3+2] * weight</pre>
<pre id='line570' class='code' style='background-color: #FFFF2e'>
        /* "Cython_shift_calculator.pyx":570
 *                     derivs[0][i][0]  +=  self._data[id3] * weight
 *                     derivs[0][i][1]  +=  self._data[id3+1] *weight
 *                     derivs[0][i][2]  +=  self._data[id3+2] * weight             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         return result
 */
        __pyx_t_8 = 0;
        __pyx_t_9 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_9 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_10 = 2;
        __pyx_t_12 = <span class='py_c_api'>PyFloat_FromDouble</span>((((__pyx_v_derivs[__pyx_t_8])[__pyx_t_9])[__pyx_t_10]));<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
        __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self->_data[(__pyx_v_id3 + 2)]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
        __pyx_t_11 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_v_weight);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_12, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        __pyx_t_13 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_13 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        (((__pyx_v_derivs[__pyx_t_8])[__pyx_t_9])[__pyx_t_10]) = __pyx_t_13;
        goto __pyx_L14;
      }
      __pyx_L14:;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line571")'> 571: </pre>
<pre id='line571' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line572")'> 572:         return result</pre>
<pre id='line572' class='code' style='background-color: #FFFF6a'>
  /* "Cython_shift_calculator.pyx":572
 *                     derivs[0][i][2]  +=  self._data[id3+2] * weight
 * 
 *         return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def add_forces_to_result_by_id(self, list target_atom_ids, list result=None):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_result);
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.add_forces_to_result", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_pointer);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_9Out_array_19add_forces_to_result_by_id(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_9Out_array_19add_forces_to_result_by_id(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_target_atom_ids = 0;
  PyObject *__pyx_v_result = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("add_forces_to_result_by_id (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__target_atom_ids,&__pyx_n_s__result,0};
    PyObject* values[2] = {0,0};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line573")'> 573: </pre>
<pre id='line573' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF38' onclick='toggleDiv("line574")'> 574:     def add_forces_to_result_by_id(self, list target_atom_ids, list result=None):</pre>
<pre id='line574' class='code' style='background-color: #FFFF38'>
    /* "Cython_shift_calculator.pyx":574
 *         return result
 * 
 *     def add_forces_to_result_by_id(self, list target_atom_ids, list result=None):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if result ==  None:
 *             result = [None] * self._length
 */
    values[1] = ((PyObject*)Py_None);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__target_atom_ids)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__result);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "add_forces_to_result_by_id") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 574; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_target_atom_ids = ((PyObject*)values[0]);
    __pyx_v_result = ((PyObject*)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("add_forces_to_result_by_id", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 574; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.add_forces_to_result_by_id", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_target_atom_ids), (&PyList_Type), 1, "target_atom_ids", 1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 574; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_result), (&PyList_Type), 1, "result", 1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 574; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_9Out_array_18add_forces_to_result_by_id(((struct __pyx_obj_17shift_calculators_Out_array *)__pyx_v_self), __pyx_v_target_atom_ids, __pyx_v_result);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_17shift_calculators_9Out_array_18add_forces_to_result_by_id(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self, PyObject *__pyx_v_target_atom_ids, PyObject *__pyx_v_result) {
  double __pyx_v_x;
  double __pyx_v_y;
  double __pyx_v_z;
  long __pyx_v_id3;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("add_forces_to_result_by_id", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_result);
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line575")'> 575:         if result ==  None:</pre>
<pre id='line575' class='code' style='background-color: #FFFF79'>
  /* "Cython_shift_calculator.pyx":575
 * 
 *     def add_forces_to_result_by_id(self, list target_atom_ids, list result=None):
 *         if result ==  None:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             result = [None] * self._length
 * 
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(((PyObject *)__pyx_v_result), Py_None, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 575; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 575; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line576")'> 576:             result = [None] * self._length</pre>
<pre id='line576' class='code' style='background-color: #FFFF8d'>
    /* "Cython_shift_calculator.pyx":576
 *     def add_forces_to_result_by_id(self, list target_atom_ids, list result=None):
 *         if result ==  None:
 *             result = [None] * self._length             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef double x = 0.0
 */
    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1 * ((__pyx_v_self->_length<code><</code>0) ? 0:__pyx_v_self->_length));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 576; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    { Py_ssize_t __pyx_temp;
      for (__pyx_temp=0; __pyx_temp <code><</code> __pyx_v_self->_length; __pyx_temp++) {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
        <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, __pyx_temp, Py_None);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_result));
    __pyx_v_result = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line577")'> 577: </pre>
<pre id='line577' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line578")'> 578:         cdef double x = 0.0</pre>
<pre id='line578' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":578
 *             result = [None] * self._length
 * 
 *         cdef double x = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef double y = 0.0
 *         cdef double z = 0.0
 */
  __pyx_v_x = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line579")'> 579:         cdef double y = 0.0</pre>
<pre id='line579' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":579
 * 
 *         cdef double x = 0.0
 *         cdef double y = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef double z = 0.0
 *         cdef long id3
 */
  __pyx_v_y = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line580")'> 580:         cdef double z = 0.0</pre>
<pre id='line580' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":580
 *         cdef double x = 0.0
 *         cdef double y = 0.0
 *         cdef double z = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef long id3
 *         for i in target_atom_ids:
 */
  __pyx_v_z = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line581")'> 581:         cdef long id3</pre>
<pre id='line581' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line582")'> 582:         for i in target_atom_ids:</pre>
<pre id='line582' class='code' style='background-color: #FFFF79'>
  /* "Cython_shift_calculator.pyx":582
 *         cdef double z = 0.0
 *         cdef long id3
 *         for i in target_atom_ids:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if self._mask[i] != 0:
 *                 if result[i] ==  None:
 */
  if (unlikely(((PyObject *)__pyx_v_target_atom_ids) == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 582; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_1 = ((PyObject *)__pyx_v_target_atom_ids); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3 = 0;
  for (;;) {
    if (__pyx_t_3 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_3++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 582; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    #else
    __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 582; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    #endif
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
    __pyx_v_i = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line583")'> 583:             if self._mask[i] != 0:</pre>
<pre id='line583' class='code' style='background-color: #FFFF7f'>
    /* "Cython_shift_calculator.pyx":583
 *         cdef long id3
 *         for i in target_atom_ids:
 *             if self._mask[i] != 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if result[i] ==  None:
 *                     result[i] = [0.0]*3
 */
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 583; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_2 = ((__pyx_v_self->_mask[__pyx_t_5]) != 0);
    if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line584")'> 584:                 if result[i] ==  None:</pre>
<pre id='line584' class='code' style='background-color: #FFFF4f'>
      /* "Cython_shift_calculator.pyx":584
 *         for i in target_atom_ids:
 *             if self._mask[i] != 0:
 *                 if result[i] ==  None:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     result[i] = [0.0]*3
 *                 id3 = i * 3
 */
      if (unlikely(((PyObject *)__pyx_v_result) == Py_None)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
       <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 584; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_result), __pyx_v_i);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 584; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_6 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_4, Py_None, Py_EQ); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 584; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_2 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(__pyx_t_2 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 584; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line585")'> 585:                     result[i] = [0.0]*3</pre>
<pre id='line585' class='code' style='background-color: #FFFF4b'>
        /* "Cython_shift_calculator.pyx":585
 *             if self._mask[i] != 0:
 *                 if result[i] ==  None:
 *                     result[i] = [0.0]*3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 id3 = i * 3
 *                 x  = self._data[id3]
 */
        __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(0.0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
        __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(1 * 3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
        { Py_ssize_t __pyx_temp;
          for (__pyx_temp=0; __pyx_temp <code><</code> 3; __pyx_temp++) {
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
            <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, __pyx_temp, __pyx_t_6);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_6);
          }
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(((PyObject *)__pyx_v_result) == Py_None)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
         <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        if (<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_result), __pyx_v_i, ((PyObject *)__pyx_t_4)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
        goto __pyx_L7;
      }
      __pyx_L7:;
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line586")'> 586:                 id3 = i * 3</pre>
<pre id='line586' class='code' style='background-color: #FFFF62'>
      /* "Cython_shift_calculator.pyx":586
 *                 if result[i] ==  None:
 *                     result[i] = [0.0]*3
 *                 id3 = i * 3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 x  = self._data[id3]
 *                 y  = self._data[id3+1]
 */
      __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_i, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 586; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_7 = __Pyx_<span class='py_c_api'>PyInt_AsLong</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_7 == (long)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 586; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_v_id3 = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line587")'> 587:                 x  = self._data[id3]</pre>
<pre id='line587' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":587
 *                     result[i] = [0.0]*3
 *                 id3 = i * 3
 *                 x  = self._data[id3]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 y  = self._data[id3+1]
 *                 z  = self._data[id3+2]
 */
      __pyx_v_x = (__pyx_v_self->_data[__pyx_v_id3]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line588")'> 588:                 y  = self._data[id3+1]</pre>
<pre id='line588' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":588
 *                 id3 = i * 3
 *                 x  = self._data[id3]
 *                 y  = self._data[id3+1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 z  = self._data[id3+2]
 *                 result[i][0] += x
 */
      __pyx_v_y = (__pyx_v_self->_data[(__pyx_v_id3 + 1)]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line589")'> 589:                 z  = self._data[id3+2]</pre>
<pre id='line589' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":589
 *                 x  = self._data[id3]
 *                 y  = self._data[id3+1]
 *                 z  = self._data[id3+2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 result[i][0] += x
 *                 result[i][1] += y
 */
      __pyx_v_z = (__pyx_v_self->_data[(__pyx_v_id3 + 2)]);
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line590")'> 590:                 result[i][0] += x</pre>
<pre id='line590' class='code' style='background-color: #FFFF43'>
      /* "Cython_shift_calculator.pyx":590
 *                 y  = self._data[id3+1]
 *                 z  = self._data[id3+2]
 *                 result[i][0] += x             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 result[i][1] += y
 *                 result[i][2] += z
 */
      if (unlikely(((PyObject *)__pyx_v_result) == Py_None)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
       <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 590; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_result), __pyx_v_i);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 590; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_5 = 0;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, __pyx_t_5, sizeof(Py_ssize_t), PyInt_FromSsize_t);<span class='error_goto'> if (!__pyx_t_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 590; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_x);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 590; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      __pyx_t_9 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_6, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 590; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      if (<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_t_4, __pyx_t_5, __pyx_t_9, sizeof(Py_ssize_t), PyInt_FromSsize_t) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 590; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line591")'> 591:                 result[i][1] += y</pre>
<pre id='line591' class='code' style='background-color: #FFFF43'>
      /* "Cython_shift_calculator.pyx":591
 *                 z  = self._data[id3+2]
 *                 result[i][0] += x
 *                 result[i][1] += y             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 result[i][2] += z
 * 
 */
      if (unlikely(((PyObject *)__pyx_v_result) == Py_None)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
       <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 591; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_result), __pyx_v_i);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 591; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_5 = 1;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, __pyx_t_5, sizeof(Py_ssize_t), PyInt_FromSsize_t);<span class='error_goto'> if (!__pyx_t_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 591; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_y);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 591; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      __pyx_t_6 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_9, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 591; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      if (<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_t_4, __pyx_t_5, __pyx_t_6, sizeof(Py_ssize_t), PyInt_FromSsize_t) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 591; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line592")'> 592:                 result[i][2] += z</pre>
<pre id='line592' class='code' style='background-color: #FFFF41'>
      /* "Cython_shift_calculator.pyx":592
 *                 result[i][0] += x
 *                 result[i][1] += y
 *                 result[i][2] += z             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
      if (unlikely(((PyObject *)__pyx_v_result) == Py_None)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
       <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 592; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(((PyObject *)__pyx_v_result), __pyx_v_i);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 592; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_5 = 2;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, __pyx_t_5, sizeof(Py_ssize_t), PyInt_FromSsize_t);<span class='error_goto'> if (!__pyx_t_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 592; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
      __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_z);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 592; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      __pyx_t_9 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_6, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 592; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      if (<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_t_4, __pyx_t_5, __pyx_t_9, sizeof(Py_ssize_t), PyInt_FromSsize_t) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 592; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      goto __pyx_L6;
    }
    __pyx_L6:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line593")'> 593: </pre>
<pre id='line593' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line594")'> 594: </pre>
<pre id='line594' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line595")'> 595:         return result</pre>
<pre id='line595' class='code' style='background-color: #FFFF6a'>
  /* "Cython_shift_calculator.pyx":595
 * 
 * 
 *         return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __str__(self):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_result));
  __pyx_r = ((PyObject *)__pyx_v_result);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.add_forces_to_result_by_id", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_9Out_array_21__str__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_9Out_array_21__str__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__str__ (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_9Out_array_20__str__(((struct __pyx_obj_17shift_calculators_Out_array *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line596")'> 596: </pre>
<pre id='line596' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line597")'> 597:     def __str__(self):</pre>
<pre id='line597' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":597
 *         return result
 * 
 *     def __str__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef long id3 =0
 */

static PyObject *__pyx_pf_17shift_calculators_9Out_array_20__str__(struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_self) {
  long __pyx_v_id3;
  PyObject *__pyx_v_result = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__str__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line598")'> 598: </pre>
<pre id='line598' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line599")'> 599:         cdef long id3 =0</pre>
<pre id='line599' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":599
 *     def __str__(self):
 * 
 *         cdef long id3 =0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result =  []
 *         result.append('length = %i' % self._length)
 */
  __pyx_v_id3 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line600")'> 600:         result =  []</pre>
<pre id='line600' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":600
 * 
 *         cdef long id3 =0
 *         result =  []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.append('length = %i' % self._length)
 *         for i in range(self._length):
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 600; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_result = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line601")'> 601:         result.append('length = %i' % self._length)</pre>
<pre id='line601' class='code' style='background-color: #FFFF5e'>
  /* "Cython_shift_calculator.pyx":601
 *         cdef long id3 =0
 *         result =  []
 *         result.append('length = %i' % self._length)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for i in range(self._length):
 *             if self._mask[i] ==0:
 */
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_length);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_25), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_result, ((PyObject *)__pyx_t_2));<span class='error_goto'> if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line602")'> 602:         for i in range(self._length):</pre>
<pre id='line602' class='code' style='background-color: #FFFF20'>
  /* "Cython_shift_calculator.pyx":602
 *         result =  []
 *         result.append('length = %i' % self._length)
 *         for i in range(self._length):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if self._mask[i] ==0:
 *                 result.append("%5i ." % i)
 */
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_self->_length);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
    __pyx_t_1 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_5 = Py_TYPE(__pyx_t_1)->tp_iternext;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (!__pyx_t_5 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) {
      if (__pyx_t_4 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_5 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      if (__pyx_t_4 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_2 = __pyx_t_5(__pyx_t_1);
      if (unlikely(!__pyx_t_2)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
    __pyx_v_i = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line603")'> 603:             if self._mask[i] ==0:</pre>
<pre id='line603' class='code' style='background-color: #FFFF7f'>
    /* "Cython_shift_calculator.pyx":603
 *         result.append('length = %i' % self._length)
 *         for i in range(self._length):
 *             if self._mask[i] ==0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 result.append("%5i ." % i)
 *             else:
 */
    __pyx_t_6 = __Pyx_<span class='py_c_api'>PyIndex_AsSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_6 == (Py_ssize_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_7 = ((__pyx_v_self->_mask[__pyx_t_6]) == 0);
    if (__pyx_t_7) {
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line604")'> 604:                 result.append("%5i ." % i)</pre>
<pre id='line604' class='code' style='background-color: #FFFF79'>
      /* "Cython_shift_calculator.pyx":604
 *         for i in range(self._length):
 *             if self._mask[i] ==0:
 *                 result.append("%5i ." % i)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 id3 = i * 3
 */
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_26), __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 604; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
      __pyx_t_3 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_result, ((PyObject *)__pyx_t_2));<span class='error_goto'> if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 604; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
      goto __pyx_L5;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line605")'> 605:             else:</pre>
<pre id='line605' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line606")'> 606:                 id3 = i * 3</pre>
<pre id='line606' class='code' style='background-color: #FFFF62'>
      /* "Cython_shift_calculator.pyx":606
 *                 result.append("%5i ." % i)
 *             else:
 *                 id3 = i * 3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 result.append('%5i %4.7f,%4.7f,%4.7f' % (i,self._data[id3],self._data[id3+1],self._data[id3+2]))
 *         return '\n'.join(result)
 */
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_i, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_8 = __Pyx_<span class='py_c_api'>PyInt_AsLong</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_8 == (long)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_v_id3 = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFF35' onclick='toggleDiv("line607")'> 607:                 result.append('%5i %4.7f,%4.7f,%4.7f' % (i,self._data[id3],self._data[id3+1],self._data[id3+2]))</pre>
<pre id='line607' class='code' style='background-color: #FFFF35'>
      /* "Cython_shift_calculator.pyx":607
 *             else:
 *                 id3 = i * 3
 *                 result.append('%5i %4.7f,%4.7f,%4.7f' % (i,self._data[id3],self._data[id3+1],self._data[id3+2]))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return '\n'.join(result)
 * 
 */
      __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self->_data[__pyx_v_id3]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self->_data[(__pyx_v_id3 + 1)]));<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_10 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self->_data[(__pyx_v_id3 + 2)]));<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
      __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_v_i);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_i);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 2, __pyx_t_9);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_9);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 3, __pyx_t_10);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_10);
      __pyx_t_2 = 0;
      __pyx_t_9 = 0;
      __pyx_t_10 = 0;
      __pyx_t_10 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_27), ((PyObject *)__pyx_t_11));<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_10));
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_11)); __pyx_t_11 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_result, ((PyObject *)__pyx_t_10));<span class='error_goto'> if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_10)); __pyx_t_10 = 0;
    }
    __pyx_L5:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line608")'> 608:         return '\n'.join(result)</pre>
<pre id='line608' class='code' style='background-color: #FFFF3e'>
  /* "Cython_shift_calculator.pyx":608
 *                 id3 = i * 3
 *                 result.append('%5i %4.7f,%4.7f,%4.7f' % (i,self._data[id3],self._data[id3+1],self._data[id3+2]))
 *         return '\n'.join(result)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_kp_s_28), __pyx_n_s__join);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_result));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, ((PyObject *)__pyx_v_result));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_result));
  __pyx_t_11 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_10), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_10)); __pyx_t_10 = 0;
  __pyx_r = __pyx_t_11;
  __pyx_t_11 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Out_array.__str__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line609")'> 609: </pre>
<pre id='line609' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line610")'> 610: </pre>
<pre id='line610' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line611")'> 611: #cdef float* out_array = null</pre>
<pre id='line611' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line612")'> 612: #cdef long out_array_length = -1</pre>
<pre id='line612' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line613")'> 613: #cdef bint allocate_out_array_for_forces(long length) except -1:</pre>
<pre id='line613' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line614")'> 614: #    global out_array</pre>
<pre id='line614' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line615")'> 615: #    global out_array_length</pre>
<pre id='line615' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line616")'> 616: #    cdef long required_length = length*3</pre>
<pre id='line616' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line617")'> 617: #    cdef bint allocate =  False</pre>
<pre id='line617' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line618")'> 618: #    if out_array ==  null:</pre>
<pre id='line618' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line619")'> 619: #        out_array = &lt;float*&gt; malloc*(required_length *sizeof(float))</pre>
<pre id='line619' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line620")'> 620: #        if out_array  == null:</pre>
<pre id='line620' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line621")'> 621: #            Raise</pre>
<pre id='line621' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line622")'> 622: #        allocate=True</pre>
<pre id='line622' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line623")'> 623: #        out_array_length =</pre>
<pre id='line623' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line624")'> 624: #        elif  len(out_array) &lt; required_length</pre>
<pre id='line624' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line625")'> 625: #    return allocate</pre>
<pre id='line625' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line626")'> 626: #</pre>
<pre id='line626' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line627")'> 627: #def _clear_out_array_for_forces(self, length):</pre>
<pre id='line627' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line628")'> 628: #</pre>
<pre id='line628' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line629")'> 629: #</pre>
<pre id='line629' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line630")'> 630: #    is_new  = self.allocate_out_array_for_forces(length)</pre>
<pre id='line630' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line631")'> 631: #</pre>
<pre id='line631' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line632")'> 632: #    if not is_new:</pre>
<pre id='line632' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line633")'> 633: #        length = length*3</pre>
<pre id='line633' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line634")'> 634: #        for i in range(length):</pre>
<pre id='line634' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line635")'> 635: #            self._out_array[i] =0.0</pre>
<pre id='line635' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line636")'> 636: #    return self._out_array</pre>
<pre id='line636' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line637")'> 637: #</pre>
<pre id='line637' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line638")'> 638: #def _copy_back_forces(self, data_dict, data_array, target_atom_ids):</pre>
<pre id='line638' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line639")'> 639: #    for id in target_atom_ids:</pre>
<pre id='line639' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line640")'> 640: #        result =  dict.setdefault(id,[0.0,0.0,0.0])</pre>
<pre id='line640' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line641")'> 641: #        id3 = id*3</pre>
<pre id='line641' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line642")'> 642: #        result[0] = data_array[id3]</pre>
<pre id='line642' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line643")'> 643: #        result[1] = data_array[id3+1]</pre>
<pre id='line643' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line644")'> 644: #        result[2] = data_array[id3+2]</pre>
<pre id='line644' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line645")'> 645: </pre>
<pre id='line645' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line646")'> 646: </pre>
<pre id='line646' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line647")'> 647: </pre>
<pre id='line647' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line648")'> 648: cdef object vec3_as_tuple(Vec3&amp; vec_3):</pre>
<pre id='line648' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":648
 * 
 * 
 * cdef object vec3_as_tuple(Vec3& vec_3):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return vec_3.x(), vec_3.y(), vec_3.z()
 * 
 */

static PyObject *__pyx_f_17shift_calculators_vec3_as_tuple(Vec3 &__pyx_v_vec_3) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("vec3_as_tuple", 0);
</pre><pre class='line' style='background-color: #FFFF2f' onclick='toggleDiv("line649")'> 649:     return vec_3.x(), vec_3.y(), vec_3.z()</pre>
<pre id='line649' class='code' style='background-color: #FFFF2f'>
  /* "Cython_shift_calculator.pyx":649
 * 
 * cdef object vec3_as_tuple(Vec3& vec_3):
 *     return vec_3.x(), vec_3.y(), vec_3.z()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_vec_3.x());<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 649; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_vec_3.y());<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 649; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_vec_3.z());<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 649; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 649; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_t_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_r = ((PyObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.vec3_as_tuple", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_27Python_ring_force_sub_terms_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_27Python_ring_force_sub_terms_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) > 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) > 0) && unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__init__", 0))) return -1;
  __pyx_r = __pyx_pf_17shift_calculators_27Python_ring_force_sub_terms___init__(((struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line650")'> 650: </pre>
<pre id='line650' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line651")'> 651: </pre>
<pre id='line651' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line652")'> 652: </pre>
<pre id='line652' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line653")'> 653: </pre>
<pre id='line653' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line654")'> 654: cdef struct target_distant_atom:</pre>
<pre id='line654' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":654
 * 
 * 
 * cdef struct target_distant_atom:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     int target_atom_id
 *     int distant_atom_id
 */
struct __pyx_t_17shift_calculators_target_distant_atom {
  int target_atom_id;
  int distant_atom_id;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line655")'> 655:     int target_atom_id</pre>
<pre id='line655' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line656")'> 656:     int distant_atom_id</pre>
<pre id='line656' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line657")'> 657: </pre>
<pre id='line657' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line658")'> 658: cdef struct target_type:</pre>
<pre id='line658' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":658
 *     int distant_atom_id
 * 
 * cdef struct target_type:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     int  target_atom_id
 *     int  atom_type_id
 */
struct __pyx_t_17shift_calculators_target_type {
  int target_atom_id;
  int atom_type_id;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line659")'> 659:     int  target_atom_id</pre>
<pre id='line659' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line660")'> 660:     int  atom_type_id</pre>
<pre id='line660' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line661")'> 661: </pre>
<pre id='line661' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line662")'> 662: cdef struct coefficient_exponent:</pre>
<pre id='line662' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":662
 *     int  atom_type_id
 * 
 * cdef struct coefficient_exponent:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     float coefficient
 *     float exponent
 */
struct __pyx_t_17shift_calculators_coefficient_exponent {
  float coefficient;
  float exponent;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line663")'> 663:     float coefficient</pre>
<pre id='line663' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line664")'> 664:     float exponent</pre>
<pre id='line664' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line665")'> 665: </pre>
<pre id='line665' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line666")'> 666: cdef struct dihedral_ids:</pre>
<pre id='line666' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":666
 *     float exponent
 * 
 * cdef struct dihedral_ids:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     int atom_id_1
 *     int atom_id_2
 */
struct __pyx_t_17shift_calculators_dihedral_ids {
  int atom_id_1;
  int atom_id_2;
  int atom_id_3;
  int atom_id_4;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line667")'> 667:     int atom_id_1</pre>
<pre id='line667' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line668")'> 668:     int atom_id_2</pre>
<pre id='line668' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line669")'> 669:     int atom_id_3</pre>
<pre id='line669' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line670")'> 670:     int atom_id_4</pre>
<pre id='line670' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line671")'> 671: </pre>
<pre id='line671' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line672")'> 672: cdef struct bond_angle_ids:</pre>
<pre id='line672' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":672
 *     int atom_id_4
 * 
 * cdef struct bond_angle_ids:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     int atom_id_1
 *     int atom_id_2
 */
struct __pyx_t_17shift_calculators_bond_angle_ids {
  int atom_id_1;
  int atom_id_2;
  int atom_id_3;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line673")'> 673:     int atom_id_1</pre>
<pre id='line673' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line674")'> 674:     int atom_id_2</pre>
<pre id='line674' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line675")'> 675:     int atom_id_3</pre>
<pre id='line675' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line676")'> 676: </pre>
<pre id='line676' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line677")'> 677: </pre>
<pre id='line677' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line678")'> 678: cdef struct Coef_component:</pre>
<pre id='line678' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":678
 * 
 * 
 * cdef struct Coef_component:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     int atom_type_id
 *     int ring_id
 */
struct __pyx_t_17shift_calculators_Coef_component {
  int atom_type_id;
  int ring_id;
  float coefficient;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line679")'> 679:     int atom_type_id</pre>
<pre id='line679' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line680")'> 680:     int ring_id</pre>
<pre id='line680' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line681")'> 681:     float coefficient</pre>
<pre id='line681' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line682")'> 682: </pre>
<pre id='line682' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line683")'> 683: cdef struct Ring_force_sub_terms:</pre>
<pre id='line683' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":683
 *     float coefficient
 * 
 * cdef struct Ring_force_sub_terms:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     Vec3 d
 *     float dLnL
 */
struct __pyx_t_17shift_calculators_Ring_force_sub_terms {
  Vec3 d;
  float dLnL;
  float dL3nL3;
  float dn;
  float dL;
  float nL;
  Vec3 gradUQ;
  float dL3;
  float u;
  Vec3 gradVQ;
  float dL6;
  Vec3 ring_normal;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line684")'> 684:     Vec3 d</pre>
<pre id='line684' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line685")'> 685:     float dLnL</pre>
<pre id='line685' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line686")'> 686:     float dL3nL3</pre>
<pre id='line686' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line687")'> 687:     float dn</pre>
<pre id='line687' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line688")'> 688:     float dL</pre>
<pre id='line688' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line689")'> 689:     float nL</pre>
<pre id='line689' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line690")'> 690:     Vec3 gradUQ</pre>
<pre id='line690' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line691")'> 691:     float dL3</pre>
<pre id='line691' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line692")'> 692:     float u</pre>
<pre id='line692' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line693")'> 693:     Vec3 gradVQ</pre>
<pre id='line693' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line694")'> 694:     float dL6</pre>
<pre id='line694' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line695")'> 695:     Vec3 ring_normal</pre>
<pre id='line695' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line696")'> 696: </pre>
<pre id='line696' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line697")'> 697: cdef class Python_ring_force_sub_terms:</pre>
<pre id='line697' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":697
 *     Vec3 ring_normal
 * 
 * cdef class Python_ring_force_sub_terms:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Ring_force_sub_terms _terms
 * 
 */
struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms {
  PyObject_HEAD
  struct __pyx_vtabstruct_17shift_calculators_Python_ring_force_sub_terms *__pyx_vtab;
  struct __pyx_t_17shift_calculators_Ring_force_sub_terms _terms;
};


/* "Cython_shift_calculator.pyx":697
 *     Vec3 ring_normal
 * 
 * cdef class Python_ring_force_sub_terms:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Ring_force_sub_terms _terms
 * 
 */

struct __pyx_vtabstruct_17shift_calculators_Python_ring_force_sub_terms {
  PyObject *(*setup)(struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms *, struct __pyx_t_17shift_calculators_Ring_force_sub_terms &);
  struct __pyx_t_17shift_calculators_Ring_force_sub_terms (*get_terms)(struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms *);
};
static struct __pyx_vtabstruct_17shift_calculators_Python_ring_force_sub_terms *__pyx_vtabptr_17shift_calculators_Python_ring_force_sub_terms;

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line698")'> 698:     cdef Ring_force_sub_terms _terms</pre>
<pre id='line698' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line699")'> 699: </pre>
<pre id='line699' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line700")'> 700: #    def __cinit__(self):</pre>
<pre id='line700' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line701")'> 701: #        self._terms = NULL</pre>
<pre id='line701' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line702")'> 702: </pre>
<pre id='line702' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line703")'> 703:     def __init__(self):</pre>
<pre id='line703' class='code' style='background-color: #FFFFe7'>
/* "Cython_shift_calculator.pyx":703
 * #        self._terms = NULL
 * 
 *     def __init__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         pass
 * 
 */

static int __pyx_pf_17shift_calculators_27Python_ring_force_sub_terms___init__(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line704")'> 704:         pass</pre>
<pre id='line704' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line705")'> 705: </pre>
<pre id='line705' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line706")'> 706:     cdef setup(self, Ring_force_sub_terms&amp; terms):</pre>
<pre id='line706' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":706
 *         pass
 * 
 *     cdef setup(self, Ring_force_sub_terms& terms):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._terms=terms
 * 
 */

static PyObject *__pyx_f_17shift_calculators_27Python_ring_force_sub_terms_setup(struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms *__pyx_v_self, struct __pyx_t_17shift_calculators_Ring_force_sub_terms &__pyx_v_terms) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("setup", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line707")'> 707:         self._terms=terms</pre>
<pre id='line707' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":707
 * 
 *     cdef setup(self, Ring_force_sub_terms& terms):
 *         self._terms=terms             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef Ring_force_sub_terms get_terms(self):
 */
  __pyx_v_self->_terms = __pyx_v_terms;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line708")'> 708: </pre>
<pre id='line708' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line709")'> 709:     cdef Ring_force_sub_terms get_terms(self):</pre>
<pre id='line709' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":709
 *         self._terms=terms
 * 
 *     cdef Ring_force_sub_terms get_terms(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._terms
 * 
 */

static struct __pyx_t_17shift_calculators_Ring_force_sub_terms __pyx_f_17shift_calculators_27Python_ring_force_sub_terms_get_terms(struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms *__pyx_v_self) {
  struct __pyx_t_17shift_calculators_Ring_force_sub_terms __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_terms", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line710")'> 710:         return self._terms</pre>
<pre id='line710' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":710
 * 
 *     cdef Ring_force_sub_terms get_terms(self):
 *         return self._terms             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_r = __pyx_v_self->_terms;
  goto __pyx_L0;

  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_15Coef_components_1_bytes_to_components(PyObject *__pyx_v_self, PyObject *__pyx_v_data); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_15Coef_components_1_bytes_to_components(PyObject *__pyx_v_self, PyObject *__pyx_v_data) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_components (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_15Coef_components__bytes_to_components(((struct __pyx_obj_17shift_calculators_Coef_components *)__pyx_v_self), ((PyObject *)__pyx_v_data));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line711")'> 711: </pre>
<pre id='line711' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line712")'> 712: </pre>
<pre id='line712' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line713")'> 713: cdef struct Component_Offsets:</pre>
<pre id='line713' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":713
 * 
 * 
 * cdef struct Component_Offsets:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     int id
 *     int offset
 */
struct __pyx_t_17shift_calculators_Component_Offsets {
  int id;
  int offset;
  int length;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line714")'> 714:     int id</pre>
<pre id='line714' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line715")'> 715:     int offset</pre>
<pre id='line715' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line716")'> 716:     int length</pre>
<pre id='line716' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line717")'> 717: </pre>
<pre id='line717' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line718")'> 718: </pre>
<pre id='line718' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line719")'> 719: cdef class Coef_components:</pre>
<pre id='line719' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":719
 * 
 * 
 * cdef class Coef_components:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef object _raw_data
 *     cdef Coef_component* _components
 */
struct __pyx_obj_17shift_calculators_Coef_components {
  PyObject_HEAD
  struct __pyx_vtabstruct_17shift_calculators_Coef_components *__pyx_vtab;
  PyObject *_raw_data;
  struct __pyx_t_17shift_calculators_Coef_component *_components;
  int _num_components;
  PyObject *_raw_component_offsets_data;
  struct __pyx_t_17shift_calculators_Component_Offsets *_component_offsets;
  int num_ids;
};


/* "Cython_shift_calculator.pyx":719
 * 
 * 
 * cdef class Coef_components:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef object _raw_data
 *     cdef Coef_component* _components
 */

struct __pyx_vtabstruct_17shift_calculators_Coef_components {
  void (*_bytes_to_component_offsets)(struct __pyx_obj_17shift_calculators_Coef_components *, PyObject *);
  struct __pyx_t_17shift_calculators_Component_Offsets *(*get_id_offsets)(struct __pyx_obj_17shift_calculators_Coef_components *, int);
  struct __pyx_t_17shift_calculators_Coef_component *(*get_component)(struct __pyx_obj_17shift_calculators_Coef_components *, int);
};
static struct __pyx_vtabstruct_17shift_calculators_Coef_components *__pyx_vtabptr_17shift_calculators_Coef_components;
static CYTHON_INLINE struct __pyx_t_17shift_calculators_Component_Offsets *__pyx_f_17shift_calculators_15Coef_components_get_id_offsets(struct __pyx_obj_17shift_calculators_Coef_components *, int);
static CYTHON_INLINE struct __pyx_t_17shift_calculators_Coef_component *__pyx_f_17shift_calculators_15Coef_components_get_component(struct __pyx_obj_17shift_calculators_Coef_components *, int);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line720")'> 720:     cdef object _raw_data</pre>
<pre id='line720' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line721")'> 721:     cdef Coef_component* _components</pre>
<pre id='line721' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line722")'> 722:     cdef int _num_components</pre>
<pre id='line722' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line723")'> 723: </pre>
<pre id='line723' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line724")'> 724:     cdef object _raw_component_offsets_data</pre>
<pre id='line724' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line725")'> 725:     cdef Component_Offsets* _component_offsets</pre>
<pre id='line725' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line726")'> 726:     cdef int num_ids</pre>
<pre id='line726' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line727")'> 727: </pre>
<pre id='line727' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line728")'> 728:     def _bytes_to_components(self, data):</pre>
<pre id='line728' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":728
 *     cdef int num_ids
 * 
 *     def _bytes_to_components(self, data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._raw_data =  data
 */

static PyObject *__pyx_pf_17shift_calculators_15Coef_components__bytes_to_components(struct __pyx_obj_17shift_calculators_Coef_components *__pyx_v_self, PyObject *__pyx_v_data) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_components", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line729")'> 729: </pre>
<pre id='line729' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line730")'> 730:         self._raw_data =  data</pre>
<pre id='line730' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":730
 *     def _bytes_to_components(self, data):
 * 
 *         self._raw_data =  data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._components =  <code><</code>Coef_component*> <code><</code>size_t> ctypes.addressof(data)
 *         self._num_components =  len(data)/ sizeof(Coef_component)
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_raw_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_raw_data);
  __pyx_v_self->_raw_data = __pyx_v_data;
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line731")'> 731:         self._components =  &lt;Coef_component*&gt; &lt;size_t&gt; ctypes.addressof(data)</pre>
<pre id='line731' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":731
 * 
 *         self._raw_data =  data
 *         self._components =  <code><</code>Coef_component*> <code><</code>size_t> ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components =  len(data)/ sizeof(Coef_component)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_self->_components = ((struct __pyx_t_17shift_calculators_Coef_component *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line732")'> 732:         self._num_components =  len(data)/ sizeof(Coef_component)</pre>
<pre id='line732' class='code' style='background-color: #FFFF73'>
  /* "Cython_shift_calculator.pyx":732
 *         self._raw_data =  data
 *         self._components =  <code><</code>Coef_component*> <code><</code>size_t> ctypes.addressof(data)
 *         self._num_components =  len(data)/ sizeof(Coef_component)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void _bytes_to_component_offsets(self, data):
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 732; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_num_components = (__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Coef_component)));

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Coef_components._bytes_to_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line733")'> 733: </pre>
<pre id='line733' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line734")'> 734:     cdef void _bytes_to_component_offsets(self, data):</pre>
<pre id='line734' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":734
 *         self._num_components =  len(data)/ sizeof(Coef_component)
 * 
 *     cdef void _bytes_to_component_offsets(self, data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._raw_component_offsets_data =  data
 */

static void __pyx_f_17shift_calculators_15Coef_components__bytes_to_component_offsets(struct __pyx_obj_17shift_calculators_Coef_components *__pyx_v_self, PyObject *__pyx_v_data) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_component_offsets", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line735")'> 735: </pre>
<pre id='line735' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line736")'> 736:         self._raw_component_offsets_data =  data</pre>
<pre id='line736' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":736
 *     cdef void _bytes_to_component_offsets(self, data):
 * 
 *         self._raw_component_offsets_data =  data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._component_offsets =  <code><</code>Component_Offsets*> <code><</code>size_t> ctypes.addressof(data)
 *         self.num_ids =  len(data)/ sizeof(Component_Offsets)
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_raw_component_offsets_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_raw_component_offsets_data);
  __pyx_v_self->_raw_component_offsets_data = __pyx_v_data;
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line737")'> 737:         self._component_offsets =  &lt;Component_Offsets*&gt; &lt;size_t&gt; ctypes.addressof(data)</pre>
<pre id='line737' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":737
 * 
 *         self._raw_component_offsets_data =  data
 *         self._component_offsets =  <code><</code>Component_Offsets*> <code><</code>size_t> ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.num_ids =  len(data)/ sizeof(Component_Offsets)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 737; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 737; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 737; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 737; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 737; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_self->_component_offsets = ((struct __pyx_t_17shift_calculators_Component_Offsets *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line738")'> 738:         self.num_ids =  len(data)/ sizeof(Component_Offsets)</pre>
<pre id='line738' class='code' style='background-color: #FFFF30'>
  /* "Cython_shift_calculator.pyx":738
 *         self._raw_component_offsets_data =  data
 *         self._component_offsets =  <code><</code>Component_Offsets*> <code><</code>size_t> ctypes.addressof(data)
 *         self.num_ids =  len(data)/ sizeof(Component_Offsets)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __cinit__(self, object coef_components, component_offsets):
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->num_ids = (__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Component_Offsets)));

  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Coef_components._bytes_to_component_offsets", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_15Coef_components_3__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_15Coef_components_3__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_coef_components = 0;
  PyObject *__pyx_v_component_offsets = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__coef_components,&__pyx_n_s__component_offsets,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__coef_components)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__component_offsets)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_coef_components = values[0];
    __pyx_v_component_offsets = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Coef_components.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_15Coef_components_2__cinit__(((struct __pyx_obj_17shift_calculators_Coef_components *)__pyx_v_self), __pyx_v_coef_components, __pyx_v_component_offsets);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line739")'> 739: </pre>
<pre id='line739' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line740")'> 740:     def __cinit__(self, object coef_components, component_offsets):</pre>
<pre id='line740' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":740
 *         self.num_ids =  len(data)/ sizeof(Component_Offsets)
 * 
 *     def __cinit__(self, object coef_components, component_offsets):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */

static int __pyx_pf_17shift_calculators_15Coef_components_2__cinit__(struct __pyx_obj_17shift_calculators_Coef_components *__pyx_v_self, PyObject *__pyx_v_coef_components, PyObject *__pyx_v_component_offsets) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line741")'> 741: </pre>
<pre id='line741' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line742")'> 742: </pre>
<pre id='line742' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line743")'> 743:         self._bytes_to_components(coef_components)</pre>
<pre id='line743' class='code' style='background-color: #FFFF55'>
  /* "Cython_shift_calculator.pyx":743
 * 
 * 
 *         self._bytes_to_components(coef_components)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._bytes_to_component_offsets(component_offsets)
 * 
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_29);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 743; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 743; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_coef_components);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_coef_components);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_coef_components);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 743; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF35' onclick='toggleDiv("line744")'> 744:         self._bytes_to_component_offsets(component_offsets)</pre>
<pre id='line744' class='code' style='background-color: #FFFF35'>
  /* "Cython_shift_calculator.pyx":744
 * 
 *         self._bytes_to_components(coef_components)
 *         self._bytes_to_component_offsets(component_offsets)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #         self. num_ids = len(components.get_component_atom_ids())
 */
  ((struct __pyx_vtabstruct_17shift_calculators_Coef_components *)__pyx_v_self->__pyx_vtab)->_bytes_to_component_offsets(__pyx_v_self, __pyx_v_component_offsets);

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Coef_components.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_15Coef_components_5__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_15Coef_components_5__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED PyObject *__pyx_v_coef_components = 0;
  CYTHON_UNUSED PyObject *__pyx_v_components = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__coef_components,&__pyx_n_s__components,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__coef_components)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__components)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 760; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 760; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_coef_components = values[0];
    __pyx_v_components = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 760; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Coef_components.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_15Coef_components_4__init__(((struct __pyx_obj_17shift_calculators_Coef_components *)__pyx_v_self), __pyx_v_coef_components, __pyx_v_components);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line745")'> 745: </pre>
<pre id='line745' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line746")'> 746: #         self. num_ids = len(components.get_component_atom_ids())</pre>
<pre id='line746' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line747")'> 747: #         self._component_offsets =  &lt;Component_Offsets*&gt;malloc(self.num_ids * sizeof(Component_Offsets))</pre>
<pre id='line747' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line748")'> 748: #         if not self._component_offsets:</pre>
<pre id='line748' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line749")'> 749: #             raise MemoryError()</pre>
<pre id='line749' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line750")'> 750: #</pre>
<pre id='line750' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line751")'> 751: #</pre>
<pre id='line751' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line752")'> 752: #         ids =  components.get_component_atom_ids()</pre>
<pre id='line752' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line753")'> 753: #         for i,id in enumerate(ids):</pre>
<pre id='line753' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line754")'> 754: #             start,end = components.get_component_range(id)</pre>
<pre id='line754' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line755")'> 755: #             self._component_offsets[i].id = id</pre>
<pre id='line755' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line756")'> 756: #             self._component_offsets[i].offset = start</pre>
<pre id='line756' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line757")'> 757: #             self._component_offsets[i].length = end-start</pre>
<pre id='line757' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line758")'> 758: </pre>
<pre id='line758' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line759")'> 759: </pre>
<pre id='line759' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line760")'> 760:     def __init__ (self, object coef_components, object components):</pre>
<pre id='line760' class='code' style='background-color: #FFFFe7'>
/* "Cython_shift_calculator.pyx":760
 * 
 * 
 *     def __init__ (self, object coef_components, object components):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         pass
 * 
 */

static int __pyx_pf_17shift_calculators_15Coef_components_4__init__(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Coef_components *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_coef_components, CYTHON_UNUSED PyObject *__pyx_v_components) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line761")'> 761:         pass</pre>
<pre id='line761' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line762")'> 762: </pre>
<pre id='line762' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line763")'> 763: </pre>
<pre id='line763' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line764")'> 764:     cdef inline Component_Offsets* get_id_offsets(self,int id):</pre>
<pre id='line764' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":764
 * 
 * 
 *     cdef inline Component_Offsets* get_id_offsets(self,int id):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return &self._component_offsets[id]
 * 
 */

static CYTHON_INLINE struct __pyx_t_17shift_calculators_Component_Offsets *__pyx_f_17shift_calculators_15Coef_components_get_id_offsets(struct __pyx_obj_17shift_calculators_Coef_components *__pyx_v_self, int __pyx_v_id) {
  struct __pyx_t_17shift_calculators_Component_Offsets *__pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_id_offsets", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line765")'> 765:         return &amp;self._component_offsets[id]</pre>
<pre id='line765' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":765
 * 
 *     cdef inline Component_Offsets* get_id_offsets(self,int id):
 *         return &self._component_offsets[id]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __dealloc__(self):
 */
  __pyx_r = (&(__pyx_v_self->_component_offsets[__pyx_v_id]));
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static void __pyx_pw_17shift_calculators_15Coef_components_7__dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pw_17shift_calculators_15Coef_components_7__dealloc__(PyObject *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__dealloc__ (wrapper)", 0);
  __pyx_pf_17shift_calculators_15Coef_components_6__dealloc__(((struct __pyx_obj_17shift_calculators_Coef_components *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line766")'> 766: </pre>
<pre id='line766' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line767")'> 767:     def __dealloc__(self):</pre>
<pre id='line767' class='code' style='background-color: #FFFFe7'>
/* "Cython_shift_calculator.pyx":767
 *         return &self._component_offsets[id]
 * 
 *     def __dealloc__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         pass
 * 
 */

static void __pyx_pf_17shift_calculators_15Coef_components_6__dealloc__(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Coef_components *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__dealloc__", 0);

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line768")'> 768:         pass</pre>
<pre id='line768' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line769")'> 769: </pre>
<pre id='line769' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line770")'> 770: </pre>
<pre id='line770' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line771")'> 771: </pre>
<pre id='line771' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line772")'> 772: </pre>
<pre id='line772' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line773")'> 773: #         if self._component_offsets != NULL:</pre>
<pre id='line773' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line774")'> 774: #             free(self._component_offsets)</pre>
<pre id='line774' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line775")'> 775: #             self._component_offsets =  NULL</pre>
<pre id='line775' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line776")'> 776: #             self.num_ids = 0</pre>
<pre id='line776' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line777")'> 777: </pre>
<pre id='line777' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line778")'> 778: </pre>
<pre id='line778' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line779")'> 779: #    cdef int _check_offset(self, int offset) except -1:</pre>
<pre id='line779' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line780")'> 780: #</pre>
<pre id='line780' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line781")'> 781: #        if not offset &lt; self.num_components:</pre>
<pre id='line781' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line782")'> 782: #            raise IndexError("tried to access object at %i length is %i" % (offset,self._num_components))</pre>
<pre id='line782' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line783")'> 783: #        if self._components is NULL:</pre>
<pre id='line783' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line784")'> 784: #            raise AttributeError("trying to access deallocated memory!")</pre>
<pre id='line784' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line785")'> 785: #        return 0</pre>
<pre id='line785' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line786")'> 786: </pre>
<pre id='line786' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line787")'> 787: </pre>
<pre id='line787' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line788")'> 788: </pre>
<pre id='line788' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line789")'> 789:     @cython.profile(False)</pre>
<pre id='line789' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line790")'> 790:     cdef inline Coef_component* get_component(self,int offset):</pre>
<pre id='line790' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":790
 * 
 *     @cython.profile(False)
 *     cdef inline Coef_component* get_component(self,int offset):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #        self._check_offset(offset)
 *         return &self._components[offset]
 */

static CYTHON_INLINE struct __pyx_t_17shift_calculators_Coef_component *__pyx_f_17shift_calculators_15Coef_components_get_component(struct __pyx_obj_17shift_calculators_Coef_components *__pyx_v_self, int __pyx_v_offset) {
  struct __pyx_t_17shift_calculators_Coef_component *__pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("get_component", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line791")'> 791: #        self._check_offset(offset)</pre>
<pre id='line791' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line792")'> 792:         return &amp;self._components[offset]</pre>
<pre id='line792' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":792
 *     cdef inline Coef_component* get_component(self,int offset):
 * #        self._check_offset(offset)
 *         return &self._components[offset]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef struct ring_atom_ids:
 */
  __pyx_r = (&(__pyx_v_self->_components[__pyx_v_offset]));
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line793")'> 793: </pre>
<pre id='line793' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line794")'> 794: cdef struct ring_atom_ids:</pre>
<pre id='line794' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":794
 *         return &self._components[offset]
 * 
 * cdef struct ring_atom_ids:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     int num_atoms
 *     int[6] atom_ids
 */
struct __pyx_t_17shift_calculators_ring_atom_ids {
  int num_atoms;
  int atom_ids[6];
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line795")'> 795:     int num_atoms</pre>
<pre id='line795' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line796")'> 796:     int[6] atom_ids</pre>
<pre id='line796' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line797")'> 797: </pre>
<pre id='line797' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line798")'> 798: </pre>
<pre id='line798' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line799")'> 799: </pre>
<pre id='line799' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line800")'> 800: </pre>
<pre id='line800' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line801")'> 801: </pre>
<pre id='line801' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line802")'> 802: </pre>
<pre id='line802' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line803")'> 803: cdef struct dihedral_parameters:</pre>
<pre id='line803' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":803
 * 
 * 
 * cdef struct dihedral_parameters:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     float param_0
 *     float param_1
 */
struct __pyx_t_17shift_calculators_dihedral_parameters {
  float param_0;
  float param_1;
  float param_2;
  float param_3;
  float param_4;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line804")'> 804:     float param_0</pre>
<pre id='line804' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line805")'> 805:     float param_1</pre>
<pre id='line805' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line806")'> 806:     float param_2</pre>
<pre id='line806' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line807")'> 807:     float param_3</pre>
<pre id='line807' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line808")'> 808:     float param_4</pre>
<pre id='line808' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line809")'> 809: </pre>
<pre id='line809' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line810")'> 810: </pre>
<pre id='line810' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line811")'> 811: #cdef float sum(Vec3 vec3):</pre>
<pre id='line811' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line812")'> 812: #    return vec3.x()+vec3.y()+vec3.z()</pre>
<pre id='line812' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line813")'> 813: </pre>
<pre id='line813' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line814")'> 814: </pre>
<pre id='line814' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line815")'> 815: @cython.profile(False)</pre>
<pre id='line815' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line816")'> 816: cdef inline void operator_times (Vec3&amp; vec3, float scale):</pre>
<pre id='line816' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":816
 * 
 * @cython.profile(False)
 * cdef inline void operator_times (Vec3& vec3, float scale):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *      vec3[0] =  vec3[0] * scale
 *      vec3[1] =  vec3[1] * scale
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_operator_times(Vec3 &__pyx_v_vec3, float __pyx_v_scale) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("operator_times", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line817")'> 817:      vec3[0] =  vec3[0] * scale</pre>
<pre id='line817' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":817
 * @cython.profile(False)
 * cdef inline void operator_times (Vec3& vec3, float scale):
 *      vec3[0] =  vec3[0] * scale             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *      vec3[1] =  vec3[1] * scale
 *      vec3[2] =  vec3[2] * scale
 */
  (__pyx_v_vec3[0]) = ((__pyx_v_vec3[0]) * __pyx_v_scale);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line818")'> 818:      vec3[1] =  vec3[1] * scale</pre>
<pre id='line818' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":818
 * cdef inline void operator_times (Vec3& vec3, float scale):
 *      vec3[0] =  vec3[0] * scale
 *      vec3[1] =  vec3[1] * scale             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *      vec3[2] =  vec3[2] * scale
 * 
 */
  (__pyx_v_vec3[1]) = ((__pyx_v_vec3[1]) * __pyx_v_scale);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line819")'> 819:      vec3[2] =  vec3[2] * scale</pre>
<pre id='line819' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":819
 *      vec3[0] =  vec3[0] * scale
 *      vec3[1] =  vec3[1] * scale
 *      vec3[2] =  vec3[2] * scale             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * @cython.profile(False)
 */
  (__pyx_v_vec3[2]) = ((__pyx_v_vec3[2]) * __pyx_v_scale);

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line820")'> 820: </pre>
<pre id='line820' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line821")'> 821: @cython.profile(False)</pre>
<pre id='line821' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line822")'> 822: cdef inline float calc_distance_simulation(Simulation* sim, int atom_index_1, int atom_index_2):</pre>
<pre id='line822' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":822
 * 
 * @cython.profile(False)
 * cdef inline float calc_distance_simulation(Simulation* sim, int atom_index_1, int atom_index_2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef Vec3 vec1 = sim[0].atomPos(atom_index_1)
 */

static CYTHON_INLINE float __pyx_f_17shift_calculators_calc_distance_simulation(Simulation *__pyx_v_sim, int __pyx_v_atom_index_1, int __pyx_v_atom_index_2) {
  Vec3 __pyx_v_vec1;
  Vec3 __pyx_v_vec2;
  Vec3 __pyx_v_result;
  float __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_distance_simulation", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line823")'> 823: </pre>
<pre id='line823' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line824")'> 824:     cdef Vec3 vec1 = sim[0].atomPos(atom_index_1)</pre>
<pre id='line824' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":824
 * cdef inline float calc_distance_simulation(Simulation* sim, int atom_index_1, int atom_index_2):
 * 
 *     cdef Vec3 vec1 = sim[0].atomPos(atom_index_1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Vec3 vec2 = sim[0].atomPos(atom_index_2)
 *     cdef Vec3 result =  vec2 - vec1
 */
  __pyx_v_vec1 = (__pyx_v_sim[0]).atomPos(__pyx_v_atom_index_1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line825")'> 825:     cdef Vec3 vec2 = sim[0].atomPos(atom_index_2)</pre>
<pre id='line825' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":825
 * 
 *     cdef Vec3 vec1 = sim[0].atomPos(atom_index_1)
 *     cdef Vec3 vec2 = sim[0].atomPos(atom_index_2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Vec3 result =  vec2 - vec1
 *     return norm(result)
 */
  __pyx_v_vec2 = (__pyx_v_sim[0]).atomPos(__pyx_v_atom_index_2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line826")'> 826:     cdef Vec3 result =  vec2 - vec1</pre>
<pre id='line826' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":826
 *     cdef Vec3 vec1 = sim[0].atomPos(atom_index_1)
 *     cdef Vec3 vec2 = sim[0].atomPos(atom_index_2)
 *     cdef Vec3 result =  vec2 - vec1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return norm(result)
 * 
 */
  __pyx_v_result = (__pyx_v_vec2 - __pyx_v_vec1);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line827")'> 827:     return norm(result)</pre>
<pre id='line827' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":827
 *     cdef Vec3 vec2 = sim[0].atomPos(atom_index_2)
 *     cdef Vec3 result =  vec2 - vec1
 *     return norm(result)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_r = norm(__pyx_v_result);
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line828")'> 828: </pre>
<pre id='line828' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line829")'> 829: </pre>
<pre id='line829' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line830")'> 830: </pre>
<pre id='line830' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line831")'> 831: #</pre>
<pre id='line831' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line832")'> 832: #</pre>
<pre id='line832' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line833")'> 833: #cdef inline bint distance_less_than(int atom_index_1, atom_index_2, float target):</pre>
<pre id='line833' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line834")'> 834: #    cdef float total = 0.0</pre>
<pre id='line834' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line835")'> 835: #    cdef float diff</pre>
<pre id='line835' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line836")'> 836: #    cdef float target2  = target*target</pre>
<pre id='line836' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line837")'> 837: #</pre>
<pre id='line837' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line838")'> 838: #    cdef Vec3 vec1 = currentSimulation().atomPosArr().data(atom_index_1)</pre>
<pre id='line838' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line839")'> 839: #    cdef Vec3 vec2 = currentSimulation().atomPosArr().data(atom_index_2)</pre>
<pre id='line839' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line840")'> 840: #    cdef bint result  =  True</pre>
<pre id='line840' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line841")'> 841: #    for i in range(3):</pre>
<pre id='line841' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line842")'> 842: #        diff = vec1[i] - vec2[i]</pre>
<pre id='line842' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line843")'> 843: #        total += diff * diff</pre>
<pre id='line843' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line844")'> 844: #</pre>
<pre id='line844' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line845")'> 845: #        if total &gt; target2:</pre>
<pre id='line845' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line846")'> 846: #            result = False</pre>
<pre id='line846' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line847")'> 847: #            break</pre>
<pre id='line847' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line848")'> 848: #    return result</pre>
<pre id='line848' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line849")'> 849: </pre>
<pre id='line849' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line850")'> 850: </pre>
<pre id='line850' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line851")'> 851: </pre>
<pre id='line851' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line852")'> 852: </pre>
<pre id='line852' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line853")'> 853: </pre>
<pre id='line853' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line854")'> 854: #TODO how does currentSimulation().atomByID work inside</pre>
<pre id='line854' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line855")'> 855: @cython.profile(False)</pre>
<pre id='line855' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line856")'> 856: cdef inline float calc_dihedral_angle_simulation(Simulation* simulation, dihedral_ids dihedral_atom_ids):</pre>
<pre id='line856' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":856
 * #TODO how does currentSimulation().atomByID work inside
 * @cython.profile(False)
 * cdef inline float calc_dihedral_angle_simulation(Simulation* simulation, dihedral_ids dihedral_atom_ids):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */

static CYTHON_INLINE float __pyx_f_17shift_calculators_calc_dihedral_angle_simulation(Simulation *__pyx_v_simulation, struct __pyx_t_17shift_calculators_dihedral_ids __pyx_v_dihedral_atom_ids) {
  Atom __pyx_v_atom_1;
  Atom __pyx_v_atom_2;
  Atom __pyx_v_atom_3;
  Atom __pyx_v_atom_4;
  double __pyx_v_result;
  float __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_dihedral_angle_simulation", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line857")'> 857: </pre>
<pre id='line857' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line858")'> 858: </pre>
<pre id='line858' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line859")'> 859: </pre>
<pre id='line859' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line860")'> 860:     cdef Atom atom_1  = simulation[0].atomByID(dihedral_atom_ids.atom_id_1)</pre>
<pre id='line860' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":860
 * 
 * 
 *     cdef Atom atom_1  = simulation[0].atomByID(dihedral_atom_ids.atom_id_1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Atom atom_2  = simulation[0].atomByID(dihedral_atom_ids.atom_id_2)
 *     cdef Atom atom_3  = simulation[0].atomByID(dihedral_atom_ids.atom_id_3)
 */
  __pyx_v_atom_1 = (__pyx_v_simulation[0]).atomByID(__pyx_v_dihedral_atom_ids.atom_id_1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line861")'> 861:     cdef Atom atom_2  = simulation[0].atomByID(dihedral_atom_ids.atom_id_2)</pre>
<pre id='line861' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":861
 * 
 *     cdef Atom atom_1  = simulation[0].atomByID(dihedral_atom_ids.atom_id_1)
 *     cdef Atom atom_2  = simulation[0].atomByID(dihedral_atom_ids.atom_id_2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Atom atom_3  = simulation[0].atomByID(dihedral_atom_ids.atom_id_3)
 *     cdef Atom atom_4  = simulation[0].atomByID(dihedral_atom_ids.atom_id_4)
 */
  __pyx_v_atom_2 = (__pyx_v_simulation[0]).atomByID(__pyx_v_dihedral_atom_ids.atom_id_2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line862")'> 862:     cdef Atom atom_3  = simulation[0].atomByID(dihedral_atom_ids.atom_id_3)</pre>
<pre id='line862' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":862
 *     cdef Atom atom_1  = simulation[0].atomByID(dihedral_atom_ids.atom_id_1)
 *     cdef Atom atom_2  = simulation[0].atomByID(dihedral_atom_ids.atom_id_2)
 *     cdef Atom atom_3  = simulation[0].atomByID(dihedral_atom_ids.atom_id_3)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Atom atom_4  = simulation[0].atomByID(dihedral_atom_ids.atom_id_4)
 * 
 */
  __pyx_v_atom_3 = (__pyx_v_simulation[0]).atomByID(__pyx_v_dihedral_atom_ids.atom_id_3);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line863")'> 863:     cdef Atom atom_4  = simulation[0].atomByID(dihedral_atom_ids.atom_id_4)</pre>
<pre id='line863' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":863
 *     cdef Atom atom_2  = simulation[0].atomByID(dihedral_atom_ids.atom_id_2)
 *     cdef Atom atom_3  = simulation[0].atomByID(dihedral_atom_ids.atom_id_3)
 *     cdef Atom atom_4  = simulation[0].atomByID(dihedral_atom_ids.atom_id_4)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef double result = Dihedral(atom_1,atom_2,atom_3,atom_4).value()
 */
  __pyx_v_atom_4 = (__pyx_v_simulation[0]).atomByID(__pyx_v_dihedral_atom_ids.atom_id_4);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line864")'> 864: </pre>
<pre id='line864' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line865")'> 865:     cdef double result = Dihedral(atom_1,atom_2,atom_3,atom_4).value()</pre>
<pre id='line865' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":865
 *     cdef Atom atom_4  = simulation[0].atomByID(dihedral_atom_ids.atom_id_4)
 * 
 *     cdef double result = Dihedral(atom_1,atom_2,atom_3,atom_4).value()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return result
 * 
 */
  __pyx_v_result = Dihedral(__pyx_v_atom_1, __pyx_v_atom_2, __pyx_v_atom_3, __pyx_v_atom_4).value();
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line866")'> 866:     return result</pre>
<pre id='line866' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":866
 * 
 *     cdef double result = Dihedral(atom_1,atom_2,atom_3,atom_4).value()
 *     return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * @cython.profile(False)
 */
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line867")'> 867: </pre>
<pre id='line867' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line868")'> 868: @cython.profile(False)</pre>
<pre id='line868' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line869")'> 869: cdef inline float calc_bond_angle_simulation(Simulation* simulation, bond_angle_ids bond_angle_atom_ids):</pre>
<pre id='line869' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":869
 * 
 * @cython.profile(False)
 * cdef inline float calc_bond_angle_simulation(Simulation* simulation, bond_angle_ids bond_angle_atom_ids):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */

static CYTHON_INLINE float __pyx_f_17shift_calculators_calc_bond_angle_simulation(Simulation *__pyx_v_simulation, struct __pyx_t_17shift_calculators_bond_angle_ids __pyx_v_bond_angle_atom_ids) {
  Atom __pyx_v_atom_1;
  Atom __pyx_v_atom_2;
  Atom __pyx_v_atom_3;
  double __pyx_v_result;
  float __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("calc_bond_angle_simulation", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line870")'> 870: </pre>
<pre id='line870' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line871")'> 871: </pre>
<pre id='line871' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line872")'> 872:     cdef Atom atom_1  = simulation[0].atomByID(bond_angle_atom_ids.atom_id_1)</pre>
<pre id='line872' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":872
 * 
 * 
 *     cdef Atom atom_1  = simulation[0].atomByID(bond_angle_atom_ids.atom_id_1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Atom atom_2  = simulation[0].atomByID(bond_angle_atom_ids.atom_id_2)
 *     cdef Atom atom_3  = simulation[0].atomByID(bond_angle_atom_ids.atom_id_3)
 */
  __pyx_v_atom_1 = (__pyx_v_simulation[0]).atomByID(__pyx_v_bond_angle_atom_ids.atom_id_1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line873")'> 873:     cdef Atom atom_2  = simulation[0].atomByID(bond_angle_atom_ids.atom_id_2)</pre>
<pre id='line873' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":873
 * 
 *     cdef Atom atom_1  = simulation[0].atomByID(bond_angle_atom_ids.atom_id_1)
 *     cdef Atom atom_2  = simulation[0].atomByID(bond_angle_atom_ids.atom_id_2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Atom atom_3  = simulation[0].atomByID(bond_angle_atom_ids.atom_id_3)
 * 
 */
  __pyx_v_atom_2 = (__pyx_v_simulation[0]).atomByID(__pyx_v_bond_angle_atom_ids.atom_id_2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line874")'> 874:     cdef Atom atom_3  = simulation[0].atomByID(bond_angle_atom_ids.atom_id_3)</pre>
<pre id='line874' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":874
 *     cdef Atom atom_1  = simulation[0].atomByID(bond_angle_atom_ids.atom_id_1)
 *     cdef Atom atom_2  = simulation[0].atomByID(bond_angle_atom_ids.atom_id_2)
 *     cdef Atom atom_3  = simulation[0].atomByID(bond_angle_atom_ids.atom_id_3)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef double result = BondAngle(atom_1,atom_2,atom_3).value()
 */
  __pyx_v_atom_3 = (__pyx_v_simulation[0]).atomByID(__pyx_v_bond_angle_atom_ids.atom_id_3);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line875")'> 875: </pre>
<pre id='line875' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line876")'> 876:     cdef double result = BondAngle(atom_1,atom_2,atom_3).value()</pre>
<pre id='line876' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":876
 *     cdef Atom atom_3  = simulation[0].atomByID(bond_angle_atom_ids.atom_id_3)
 * 
 *     cdef double result = BondAngle(atom_1,atom_2,atom_3).value()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return result
 * 
 */
  __pyx_v_result = BondAngle(__pyx_v_atom_1, __pyx_v_atom_2, __pyx_v_atom_3).value();
</pre><pre class='line' style='background-color: #FFFF38' onclick='toggleDiv("line877")'> 877:     return result</pre>
<pre id='line877' class='code' style='background-color: #FFFF38'>
  /* "Cython_shift_calculator.pyx":877
 * 
 *     cdef double result = BondAngle(atom_1,atom_2,atom_3).value()
 *     return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_21Base_shift_calculator_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_21Base_shift_calculator_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_simulation = 0;
  PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__simulation,&__pyx_n_s__name,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__simulation)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 889; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 889; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_simulation = values[0];
    __pyx_v_name = ((PyObject*)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 889; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Base_shift_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&PyString_Type), 1, "name", 1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 889; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_21Base_shift_calculator___init__(((struct __pyx_obj_17shift_calculators_Base_shift_calculator *)__pyx_v_self), __pyx_v_simulation, __pyx_v_name);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line878")'> 878: </pre>
<pre id='line878' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line879")'> 879: </pre>
<pre id='line879' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line880")'> 880: cdef float DEFAULT_CUTOFF = 5.0</pre>
<pre id='line880' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":880
 * 
 * 
 * cdef float DEFAULT_CUTOFF = 5.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * cdef float DEFAULT_SMOOTHING_FACTOR = 1.0
 * cdef float DEFAULT_NB_CUTOFF = 5.0
 */
  __pyx_v_17shift_calculators_DEFAULT_CUTOFF = 5.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line881")'> 881: cdef float DEFAULT_SMOOTHING_FACTOR = 1.0</pre>
<pre id='line881' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":881
 * 
 * cdef float DEFAULT_CUTOFF = 5.0
 * cdef float DEFAULT_SMOOTHING_FACTOR = 1.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * cdef float DEFAULT_NB_CUTOFF = 5.0
 * 
 */
  __pyx_v_17shift_calculators_DEFAULT_SMOOTHING_FACTOR = 1.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line882")'> 882: cdef float DEFAULT_NB_CUTOFF = 5.0</pre>
<pre id='line882' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":882
 * cdef float DEFAULT_CUTOFF = 5.0
 * cdef float DEFAULT_SMOOTHING_FACTOR = 1.0
 * cdef float DEFAULT_NB_CUTOFF = 5.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef class Base_shift_calculator:
 */
  __pyx_v_17shift_calculators_DEFAULT_NB_CUTOFF = 5.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line883")'> 883: </pre>
<pre id='line883' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line884")'> 884: cdef class Base_shift_calculator:</pre>
<pre id='line884' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":884
 * cdef float DEFAULT_NB_CUTOFF = 5.0
 * 
 * cdef class Base_shift_calculator:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef bint _verbose
 *     cdef str _name
 */
struct __pyx_obj_17shift_calculators_Base_shift_calculator {
  PyObject_HEAD
  struct __pyx_vtabstruct_17shift_calculators_Base_shift_calculator *__pyx_vtab;
  int _verbose;
  PyObject *_name;
  EnsembleSimulation *_simulation;
};


/* "Cython_shift_calculator.pyx":884
 * cdef float DEFAULT_NB_CUTOFF = 5.0
 * 
 * cdef class Base_shift_calculator:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef bint _verbose
 *     cdef str _name
 */

struct __pyx_vtabstruct_17shift_calculators_Base_shift_calculator {
  int (*ensemble_size)(struct __pyx_obj_17shift_calculators_Base_shift_calculator *);
  int (*ensemble_member_index)(struct __pyx_obj_17shift_calculators_Base_shift_calculator *);
  int (*ensemble_array_offset)(struct __pyx_obj_17shift_calculators_Base_shift_calculator *, int);
};
static struct __pyx_vtabstruct_17shift_calculators_Base_shift_calculator *__pyx_vtabptr_17shift_calculators_Base_shift_calculator;
static CYTHON_INLINE int __pyx_f_17shift_calculators_21Base_shift_calculator_ensemble_size(struct __pyx_obj_17shift_calculators_Base_shift_calculator *);
static CYTHON_INLINE int __pyx_f_17shift_calculators_21Base_shift_calculator_ensemble_member_index(struct __pyx_obj_17shift_calculators_Base_shift_calculator *);
static CYTHON_INLINE int __pyx_f_17shift_calculators_21Base_shift_calculator_ensemble_array_offset(struct __pyx_obj_17shift_calculators_Base_shift_calculator *, int);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line885")'> 885:     cdef bint _verbose</pre>
<pre id='line885' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line886")'> 886:     cdef str _name</pre>
<pre id='line886' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line887")'> 887:     cdef EnsembleSimulation* _simulation</pre>
<pre id='line887' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line888")'> 888: </pre>
<pre id='line888' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line889")'> 889:     def __init__(self, simulation, str name):</pre>
<pre id='line889' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":889
 *     cdef EnsembleSimulation* _simulation
 * 
 *     def __init__(self, simulation, str name):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._verbose = False
 *             self._name = name
 */

static int __pyx_pf_17shift_calculators_21Base_shift_calculator___init__(struct __pyx_obj_17shift_calculators_Base_shift_calculator *__pyx_v_self, PyObject *__pyx_v_simulation, PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line890")'> 890:             self._verbose = False</pre>
<pre id='line890' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":890
 * 
 *     def __init__(self, simulation, str name):
 *             self._verbose = False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._name = name
 *             self._simulation =  simulationAsNative(simulation)
 */
  __pyx_v_self->_verbose = 0;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line891")'> 891:             self._name = name</pre>
<pre id='line891' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":891
 *     def __init__(self, simulation, str name):
 *             self._verbose = False
 *             self._name = name             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._simulation =  simulationAsNative(simulation)
 * 
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_name));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_name));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_name);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_name));
  __pyx_v_self->_name = __pyx_v_name;
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line892")'> 892:             self._simulation =  simulationAsNative(simulation)</pre>
<pre id='line892' class='code' style='background-color: #FFFF5e'>
  /* "Cython_shift_calculator.pyx":892
 *             self._verbose = False
 *             self._name = name
 *             self._simulation =  simulationAsNative(simulation)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_1 = __pyx_f_17shift_calculators_simulationAsNative(__pyx_v_simulation);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 892; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_simulation = __pyx_t_1;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Base_shift_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_21Base_shift_calculator_3set_verbose(PyObject *__pyx_v_self, PyObject *__pyx_arg_state); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_21Base_shift_calculator_3set_verbose(PyObject *__pyx_v_self, PyObject *__pyx_arg_state) {
  int __pyx_v_state;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_verbose (wrapper)", 0);
  assert(__pyx_arg_state); {
    __pyx_v_state = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_arg_state);<span class='error_goto'> if (unlikely((__pyx_v_state == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 896; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Base_shift_calculator.set_verbose", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_21Base_shift_calculator_2set_verbose(((struct __pyx_obj_17shift_calculators_Base_shift_calculator *)__pyx_v_self), ((int)__pyx_v_state));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line893")'> 893: </pre>
<pre id='line893' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line894")'> 894: </pre>
<pre id='line894' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line895")'> 895: </pre>
<pre id='line895' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line896")'> 896:     def set_verbose(self,bint state):</pre>
<pre id='line896' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":896
 * 
 * 
 *     def set_verbose(self,bint state):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._verbose =  state
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_21Base_shift_calculator_2set_verbose(struct __pyx_obj_17shift_calculators_Base_shift_calculator *__pyx_v_self, int __pyx_v_state) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_verbose", 0);
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line897")'> 897:         self._verbose =  state</pre>
<pre id='line897' class='code' style='background-color: #FFFFc4'>
  /* "Cython_shift_calculator.pyx":897
 * 
 *     def set_verbose(self,bint state):
 *         self._verbose =  state             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_self->_verbose = __pyx_v_state;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_21Base_shift_calculator_5_set_components(PyObject *__pyx_v_self, PyObject *__pyx_v_components); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_21Base_shift_calculator_5_set_components(PyObject *__pyx_v_self, PyObject *__pyx_v_components) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_components (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_21Base_shift_calculator_4_set_components(((struct __pyx_obj_17shift_calculators_Base_shift_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_components));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line898")'> 898: </pre>
<pre id='line898' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line899")'> 899: </pre>
<pre id='line899' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line900")'> 900: </pre>
<pre id='line900' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line901")'> 901:     def _set_components(self,components):</pre>
<pre id='line901' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":901
 * 
 * 
 *     def _set_components(self,components):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._bytes_to_components(components['ATOM'])
 *         self._simulation = <code><</code>EnsembleSimulation*><code><</code>size_t>int(components['SIMU'].this)
 */

static PyObject *__pyx_pf_17shift_calculators_21Base_shift_calculator_4_set_components(struct __pyx_obj_17shift_calculators_Base_shift_calculator *__pyx_v_self, PyObject *__pyx_v_components) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_components", 0);
</pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line902")'> 902:         self._bytes_to_components(components['ATOM'])</pre>
<pre id='line902' class='code' style='background-color: #FFFF4b'>
  /* "Cython_shift_calculator.pyx":902
 * 
 *     def _set_components(self,components):
 *         self._bytes_to_components(components['ATOM'])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._simulation = <code><</code>EnsembleSimulation*><code><</code>size_t>int(components['SIMU'].this)
 * 
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_29);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 902; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_components, ((PyObject *)__pyx_n_s__ATOM));<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 902; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 902; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 902; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF32' onclick='toggleDiv("line903")'> 903:         self._simulation = &lt;EnsembleSimulation*&gt;&lt;size_t&gt;int(components['SIMU'].this)</pre>
<pre id='line903' class='code' style='background-color: #FFFF32'>
  /* "Cython_shift_calculator.pyx":903
 *     def _set_components(self,components):
 *         self._bytes_to_components(components['ATOM'])
 *         self._simulation = <code><</code>EnsembleSimulation*><code><</code>size_t>int(components['SIMU'].this)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_components, ((PyObject *)__pyx_n_s__SIMU));<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 903; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__this);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 903; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 903; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 903; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 903; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_self->_simulation = ((EnsembleSimulation *)((size_t)__pyx_t_4));

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Base_shift_calculator._set_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line904")'> 904: </pre>
<pre id='line904' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line905")'> 905: </pre>
<pre id='line905' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line906")'> 906:     cdef inline int ensemble_size(self):</pre>
<pre id='line906' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":906
 * 
 * 
 *     cdef inline int ensemble_size(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._simulation[0].size()
 * 
 */

static CYTHON_INLINE int __pyx_f_17shift_calculators_21Base_shift_calculator_ensemble_size(struct __pyx_obj_17shift_calculators_Base_shift_calculator *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("ensemble_size", 0);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line907")'> 907:         return self._simulation[0].size()</pre>
<pre id='line907' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":907
 * 
 *     cdef inline int ensemble_size(self):
 *         return self._simulation[0].size()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline int ensemble_member_index(self):
 */
  __pyx_r = (__pyx_v_self->_simulation[0]).size();
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line908")'> 908: </pre>
<pre id='line908' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line909")'> 909:     cdef inline int ensemble_member_index(self):</pre>
<pre id='line909' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":909
 *         return self._simulation[0].size()
 * 
 *     cdef inline int ensemble_member_index(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._simulation[0].member()[0].memberIndex()
 * 
 */

static CYTHON_INLINE int __pyx_f_17shift_calculators_21Base_shift_calculator_ensemble_member_index(struct __pyx_obj_17shift_calculators_Base_shift_calculator *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("ensemble_member_index", 0);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line910")'> 910:         return self._simulation[0].member()[0].memberIndex()</pre>
<pre id='line910' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":910
 * 
 *     cdef inline int ensemble_member_index(self):
 *         return self._simulation[0].member()[0].memberIndex()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline int ensemble_array_offset(self,int index):
 */
  __pyx_r = ((__pyx_v_self->_simulation[0]).member()[0]).memberIndex();
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line911")'> 911: </pre>
<pre id='line911' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line912")'> 912:     cdef inline int ensemble_array_offset(self,int index):</pre>
<pre id='line912' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":912
 *         return self._simulation[0].member()[0].memberIndex()
 * 
 *     cdef inline int ensemble_array_offset(self,int index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return (self.ensemble_size() * index) + self.ensemble_member_index()
 * 
 */

static CYTHON_INLINE int __pyx_f_17shift_calculators_21Base_shift_calculator_ensemble_array_offset(struct __pyx_obj_17shift_calculators_Base_shift_calculator *__pyx_v_self, int __pyx_v_index) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("ensemble_array_offset", 0);
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line913")'> 913:         return (self.ensemble_size() * index) + self.ensemble_member_index()</pre>
<pre id='line913' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":913
 * 
 *     cdef inline int ensemble_array_offset(self,int index):
 *         return (self.ensemble_size() * index) + self.ensemble_member_index()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_r = ((__pyx_f_17shift_calculators_21Base_shift_calculator_ensemble_size(__pyx_v_self) * __pyx_v_index) + __pyx_f_17shift_calculators_21Base_shift_calculator_ensemble_member_index(__pyx_v_self));
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_33Fast_random_coil_shift_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_33Fast_random_coil_shift_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED PyObject *__pyx_v_simulation = 0;
  CYTHON_UNUSED PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__simulation,&__pyx_n_s__name,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject*)__pyx_kp_s_30);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__simulation)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 922; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_simulation = values[0];
    __pyx_v_name = ((PyObject*)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 922; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_random_coil_shift_calculator.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&PyString_Type), 1, "name", 1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 922; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_33Fast_random_coil_shift_calculator___cinit__(((struct __pyx_obj_17shift_calculators_Fast_random_coil_shift_calculator *)__pyx_v_self), __pyx_v_simulation, __pyx_v_name);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line914")'> 914: </pre>
<pre id='line914' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line915")'> 915: </pre>
<pre id='line915' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line916")'> 916: cdef class Fast_random_coil_shift_calculator(Base_shift_calculator):</pre>
<pre id='line916' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":916
 * 
 * 
 * cdef class Fast_random_coil_shift_calculator(Base_shift_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef Random_coil_component* _compiled_components
 */
struct __pyx_obj_17shift_calculators_Fast_random_coil_shift_calculator {
  struct __pyx_obj_17shift_calculators_Base_shift_calculator __pyx_base;
  struct __pyx_t_17shift_calculators_Random_coil_component *_compiled_components;
  int _num_components;
  PyObject *_raw_data;
};


/* "Cython_shift_calculator.pyx":916
 * 
 * 
 * cdef class Fast_random_coil_shift_calculator(Base_shift_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef Random_coil_component* _compiled_components
 */

struct __pyx_vtabstruct_17shift_calculators_Fast_random_coil_shift_calculator {
  struct __pyx_vtabstruct_17shift_calculators_Base_shift_calculator __pyx_base;
};
static struct __pyx_vtabstruct_17shift_calculators_Fast_random_coil_shift_calculator *__pyx_vtabptr_17shift_calculators_Fast_random_coil_shift_calculator;

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line917")'> 917: </pre>
<pre id='line917' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line918")'> 918:     cdef Random_coil_component* _compiled_components</pre>
<pre id='line918' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line919")'> 919:     cdef int _num_components</pre>
<pre id='line919' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line920")'> 920:     cdef object _raw_data</pre>
<pre id='line920' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line921")'> 921: </pre>
<pre id='line921' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line922")'> 922:     def __cinit__(self, simulation,  str name = "not set"):</pre>
<pre id='line922' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":922
 *     cdef object _raw_data
 * 
 *     def __cinit__(self, simulation,  str name = "not set"):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._raw_data = None
 *         self._compiled_components  = NULL
 */

static int __pyx_pf_17shift_calculators_33Fast_random_coil_shift_calculator___cinit__(struct __pyx_obj_17shift_calculators_Fast_random_coil_shift_calculator *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_simulation, CYTHON_UNUSED PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line923")'> 923:         self._raw_data = None</pre>
<pre id='line923' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":923
 * 
 *     def __cinit__(self, simulation,  str name = "not set"):
 *         self._raw_data = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components  = NULL
 *         self._num_components =  0
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_raw_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_raw_data);
  __pyx_v_self->_raw_data = Py_None;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line924")'> 924:         self._compiled_components  = NULL</pre>
<pre id='line924' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":924
 *     def __cinit__(self, simulation,  str name = "not set"):
 *         self._raw_data = None
 *         self._compiled_components  = NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components =  0
 * 
 */
  __pyx_v_self->_compiled_components = NULL;
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line925")'> 925:         self._num_components =  0</pre>
<pre id='line925' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":925
 *         self._raw_data = None
 *         self._compiled_components  = NULL
 *         self._num_components =  0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __init__(self, simulation, str name = "not set"):
 */
  __pyx_v_self->_num_components = 0;

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_33Fast_random_coil_shift_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_33Fast_random_coil_shift_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_simulation = 0;
  PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__simulation,&__pyx_n_s__name,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject*)__pyx_kp_s_30);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__simulation)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 927; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_simulation = values[0];
    __pyx_v_name = ((PyObject*)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 927; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_random_coil_shift_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&PyString_Type), 1, "name", 1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 927; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_33Fast_random_coil_shift_calculator_2__init__(((struct __pyx_obj_17shift_calculators_Fast_random_coil_shift_calculator *)__pyx_v_self), __pyx_v_simulation, __pyx_v_name);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line926")'> 926: </pre>
<pre id='line926' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line927")'> 927:     def __init__(self, simulation, str name = "not set"):</pre>
<pre id='line927' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":927
 *         self._num_components =  0
 * 
 *     def __init__(self, simulation, str name = "not set"):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         Base_shift_calculator.__init__(self, simulation, name)
 * 
 */

static int __pyx_pf_17shift_calculators_33Fast_random_coil_shift_calculator_2__init__(struct __pyx_obj_17shift_calculators_Fast_random_coil_shift_calculator *__pyx_v_self, PyObject *__pyx_v_simulation, PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line928")'> 928:         Base_shift_calculator.__init__(self, simulation, name)</pre>
<pre id='line928' class='code' style='background-color: #FFFF3e'>
  /* "Cython_shift_calculator.pyx":928
 * 
 *     def __init__(self, simulation, str name = "not set"):
 *         Base_shift_calculator.__init__(self, simulation, name)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Base_shift_calculator)), __pyx_n_s____init__);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 928; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 928; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simulation);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_simulation);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_simulation);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_name));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, ((PyObject *)__pyx_v_name));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_name));
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 928; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_random_coil_shift_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_33Fast_random_coil_shift_calculator_5_bytes_to_components(PyObject *__pyx_v_self, PyObject *__pyx_v_data); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_33Fast_random_coil_shift_calculator_5_bytes_to_components(PyObject *__pyx_v_self, PyObject *__pyx_v_data) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_components (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_33Fast_random_coil_shift_calculator_4_bytes_to_components(((struct __pyx_obj_17shift_calculators_Fast_random_coil_shift_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_data));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line929")'> 929: </pre>
<pre id='line929' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line930")'> 930: #</pre>
<pre id='line930' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line931")'> 931: #    TODO: this needs to be removed</pre>
<pre id='line931' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line932")'> 932:     def _bytes_to_components(self, data):</pre>
<pre id='line932' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":932
 * #
 * #    TODO: this needs to be removed
 *     def _bytes_to_components(self, data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._raw_data =  data
 */

static PyObject *__pyx_pf_17shift_calculators_33Fast_random_coil_shift_calculator_4_bytes_to_components(struct __pyx_obj_17shift_calculators_Fast_random_coil_shift_calculator *__pyx_v_self, PyObject *__pyx_v_data) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_components", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line933")'> 933: </pre>
<pre id='line933' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line934")'> 934:         self._raw_data =  data</pre>
<pre id='line934' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":934
 *     def _bytes_to_components(self, data):
 * 
 *         self._raw_data =  data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components =  <code><</code>Random_coil_component*> <code><</code>size_t> ctypes.addressof(data)
 *         self._num_components =  len(data)/ sizeof(Random_coil_component)
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_raw_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_raw_data);
  __pyx_v_self->_raw_data = __pyx_v_data;
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line935")'> 935:         self._compiled_components =  &lt;Random_coil_component*&gt; &lt;size_t&gt; ctypes.addressof(data)</pre>
<pre id='line935' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":935
 * 
 *         self._raw_data =  data
 *         self._compiled_components =  <code><</code>Random_coil_component*> <code><</code>size_t> ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components =  len(data)/ sizeof(Random_coil_component)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 935; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 935; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 935; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 935; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 935; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_self->_compiled_components = ((struct __pyx_t_17shift_calculators_Random_coil_component *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line936")'> 936:         self._num_components =  len(data)/ sizeof(Random_coil_component)</pre>
<pre id='line936' class='code' style='background-color: #FFFF20'>
  /* "Cython_shift_calculator.pyx":936
 *         self._raw_data =  data
 *         self._compiled_components =  <code><</code>Random_coil_component*> <code><</code>size_t> ctypes.addressof(data)
 *         self._num_components =  len(data)/ sizeof(Random_coil_component)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 936; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_num_components = (__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Random_coil_component)));

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_random_coil_shift_calculator._bytes_to_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_33Fast_random_coil_shift_calculator_7__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_33Fast_random_coil_shift_calculator_7__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_components = 0;
  struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_shift_cache = 0;
  __Pyx_memviewslice __pyx_v_component_to_target = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_active_components = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__call__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__components,&__pyx_n_s__shift_cache,&__pyx_n_s__component_to_target,&__pyx_n_s__active_components,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__components)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__shift_cache)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 4, 4, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 940; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__component_to_target)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 4, 4, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 940; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__active_components)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 4, 4, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 940; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__call__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 940; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_components = values[0];
    __pyx_v_shift_cache = ((struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *)values[1]);
    __pyx_v_component_to_target = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[2]);<span class='error_goto'> if (unlikely(!__pyx_v_component_to_target.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 940; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_active_components = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[3]);<span class='error_goto'> if (unlikely(!__pyx_v_active_components.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 940; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 940; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_random_coil_shift_calculator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_shift_cache), __pyx_ptype_17shift_calculators_CDSSharedVectorFloat, 1, "shift_cache", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 940; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_33Fast_random_coil_shift_calculator_6__call__(((struct __pyx_obj_17shift_calculators_Fast_random_coil_shift_calculator *)__pyx_v_self), __pyx_v_components, __pyx_v_shift_cache, __pyx_v_component_to_target, __pyx_v_active_components);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line937")'> 937: </pre>
<pre id='line937' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line938")'> 938: </pre>
<pre id='line938' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line939")'> 939:     @cython.profile(False)</pre>
<pre id='line939' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line940")'> 940:     def __call__(self, object components, CDSSharedVectorFloat shift_cache, int[:] component_to_target,  int[:] active_components):</pre>
<pre id='line940' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":940
 * 
 *     @cython.profile(False)
 *     def __call__(self, object components, CDSSharedVectorFloat shift_cache, int[:] component_to_target,  int[:] active_components):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._set_components(components)
 *         cdef double start_time = 0.0
 */

static PyObject *__pyx_pf_17shift_calculators_33Fast_random_coil_shift_calculator_6__call__(struct __pyx_obj_17shift_calculators_Fast_random_coil_shift_calculator *__pyx_v_self, PyObject *__pyx_v_components, struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_shift_cache, __Pyx_memviewslice __pyx_v_component_to_target, __Pyx_memviewslice __pyx_v_active_components) {
  double __pyx_v_start_time;
  double __pyx_v_end_time;
  int __pyx_v_factor_index;
  int __pyx_v_component_index;
  int __pyx_v_offset;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__call__", 0);
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line941")'> 941:         self._set_components(components)</pre>
<pre id='line941' class='code' style='background-color: #FFFF55'>
  /* "Cython_shift_calculator.pyx":941
 *     @cython.profile(False)
 *     def __call__(self, object components, CDSSharedVectorFloat shift_cache, int[:] component_to_target,  int[:] active_components):
 *         self._set_components(components)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef double start_time = 0.0
 *         cdef double end_time = 0.0
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s___set_components);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 941; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 941; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_components);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_components);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_components);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 941; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line942")'> 942:         cdef double start_time = 0.0</pre>
<pre id='line942' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":942
 *     def __call__(self, object components, CDSSharedVectorFloat shift_cache, int[:] component_to_target,  int[:] active_components):
 *         self._set_components(components)
 *         cdef double start_time = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef double end_time = 0.0
 * 
 */
  __pyx_v_start_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line943")'> 943:         cdef double end_time = 0.0</pre>
<pre id='line943' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":943
 *         self._set_components(components)
 *         cdef double start_time = 0.0
 *         cdef double end_time = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if self._verbose:
 */
  __pyx_v_end_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line944")'> 944: </pre>
<pre id='line944' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line945")'> 945:         if self._verbose:</pre>
<pre id='line945' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":945
 *         cdef double end_time = 0.0
 * 
 *         if self._verbose:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             start_time=time()
 * 
 */
  if (__pyx_v_self->__pyx_base._verbose) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line946")'> 946:             start_time=time()</pre>
<pre id='line946' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":946
 * 
 *         if self._verbose:
 *             start_time=time()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef int factor_index = 0
 */
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__time);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 946; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 946; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_4 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_4 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 946; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_start_time = __pyx_t_4;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line947")'> 947: </pre>
<pre id='line947' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line948")'> 948:         cdef int factor_index = 0</pre>
<pre id='line948' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":948
 *             start_time=time()
 * 
 *         cdef int factor_index = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int component_index
 *         cdef int offset
 */
  __pyx_v_factor_index = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line949")'> 949:         cdef int component_index</pre>
<pre id='line949' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line950")'> 950:         cdef int offset</pre>
<pre id='line950' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line951")'> 951: </pre>
<pre id='line951' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line952")'> 952:         #TODO: note to cython list for componnt_index in active_components produces awful code!</pre>
<pre id='line952' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line953")'> 953:         for factor_index in range(len(active_components)):</pre>
<pre id='line953' class='code' style='background-color: #FFFF9f'>
  /* "Cython_shift_calculator.pyx":953
 * 
 *         #TODO: note to cython list for componnt_index in active_components produces awful code!
 *         for factor_index in range(len(active_components)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             component_index = active_components[factor_index]
 * 
 */
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_active_components, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 953; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 953; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  for (__pyx_t_6 = 0; __pyx_t_6 <code><</code> __pyx_t_5; __pyx_t_6+=1) {
    __pyx_v_factor_index = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line954")'> 954:             component_index = active_components[factor_index]</pre>
<pre id='line954' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":954
 *         #TODO: note to cython list for componnt_index in active_components produces awful code!
 *         for factor_index in range(len(active_components)):
 *             component_index = active_components[factor_index]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             offset = self.ensemble_array_offset(component_to_target[factor_index])
 */
    __pyx_t_7 = __pyx_v_factor_index;
    __pyx_v_component_index = (*((int *) ( /* dim=0 */ (__pyx_v_active_components.data + __pyx_t_7 * __pyx_v_active_components.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line955")'> 955: </pre>
<pre id='line955' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line956")'> 956:             offset = self.ensemble_array_offset(component_to_target[factor_index])</pre>
<pre id='line956' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":956
 *             component_index = active_components[factor_index]
 * 
 *             offset = self.ensemble_array_offset(component_to_target[factor_index])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             shift_cache.addToResult(offset,self._compiled_components[component_index].shift)
 * 
 */
    __pyx_t_8 = __pyx_v_factor_index;
    __pyx_v_offset = __pyx_f_17shift_calculators_21Base_shift_calculator_ensemble_array_offset(((struct __pyx_obj_17shift_calculators_Base_shift_calculator *)__pyx_v_self), (*((int *) ( /* dim=0 */ (__pyx_v_component_to_target.data + __pyx_t_8 * __pyx_v_component_to_target.strides[0]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line957")'> 957:             shift_cache.addToResult(offset,self._compiled_components[component_index].shift)</pre>
<pre id='line957' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":957
 * 
 *             offset = self.ensemble_array_offset(component_to_target[factor_index])
 *             shift_cache.addToResult(offset,self._compiled_components[component_index].shift)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if self._verbose:
 */
    __pyx_f_17shift_calculators_20CDSSharedVectorFloat_addToResult(__pyx_v_shift_cache, __pyx_v_offset, (__pyx_v_self->_compiled_components[__pyx_v_component_index]).shift);
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line958")'> 958: </pre>
<pre id='line958' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line959")'> 959:         if self._verbose:</pre>
<pre id='line959' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":959
 *             shift_cache.addToResult(offset,self._compiled_components[component_index].shift)
 * 
 *         if self._verbose:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             end_time = time()
 *             print '   distance shift components ' ,self._name,len(components), 'in', "%.17g" % (end_time-start_time), "seconds"
 */
  if (__pyx_v_self->__pyx_base._verbose) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line960")'> 960:             end_time = time()</pre>
<pre id='line960' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":960
 * 
 *         if self._verbose:
 *             end_time = time()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print '   distance shift components ' ,self._name,len(components), 'in', "%.17g" % (end_time-start_time), "seconds"
 * 
 */
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__time);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 960; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 960; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_4 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 960; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_end_time = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFF1a' onclick='toggleDiv("line961")'> 961:             print '   distance shift components ' ,self._name,len(components), 'in', "%.17g" % (end_time-start_time), "seconds"</pre>
<pre id='line961' class='code' style='background-color: #FFFF1a'>
    /* "Cython_shift_calculator.pyx":961
 *         if self._verbose:
 *             end_time = time()
 *             print '   distance shift components ' ,self._name,len(components), 'in', "%.17g" % (end_time-start_time), "seconds"             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef class Fast_distance_shift_calculator(Base_shift_calculator):
 */
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_components);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 961; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 961; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_end_time - __pyx_v_start_time));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 961; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_32), __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 961; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 961; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_31));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_kp_s_31));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_31));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self->__pyx_base._name));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, ((PyObject *)__pyx_v_self->__pyx_base._name));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_self->__pyx_base._name));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__in));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 3, ((PyObject *)__pyx_n_s__in));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__in));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 4, ((PyObject *)__pyx_t_1));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_1));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__seconds));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 5, ((PyObject *)__pyx_n_s__seconds));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__seconds));
    __pyx_t_3 = 0;
    __pyx_t_1 = 0;
    if (<span class='pyx_c_api'>__Pyx_Print</span>(0, ((PyObject *)__pyx_t_2), 1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 961; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    goto __pyx_L6;
  }
  __pyx_L6:;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_random_coil_shift_calculator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&__pyx_v_component_to_target, 1);
  __PYX_XDEC_MEMVIEW(&__pyx_v_active_components, 1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_30Fast_distance_shift_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_30Fast_distance_shift_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED PyObject *__pyx_v_simulation = 0;
  CYTHON_UNUSED PyObject *__pyx_v_smoothed = 0;
  CYTHON_UNUSED PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__simulation,&__pyx_n_s__smoothed,&__pyx_n_s__name,0};
    PyObject* values[3] = {0,0,0};
    values[2] = ((PyObject*)__pyx_kp_s_30);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__simulation)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__smoothed)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 0, 2, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 979; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 979; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_simulation = values[0];
    __pyx_v_smoothed = values[1];
    __pyx_v_name = ((PyObject*)values[2]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 0, 2, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 979; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_distance_shift_calculator.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&PyString_Type), 1, "name", 1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 979; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_30Fast_distance_shift_calculator___cinit__(((struct __pyx_obj_17shift_calculators_Fast_distance_shift_calculator *)__pyx_v_self), __pyx_v_simulation, __pyx_v_smoothed, __pyx_v_name);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line962")'> 962: </pre>
<pre id='line962' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line963")'> 963: cdef class Fast_distance_shift_calculator(Base_shift_calculator):</pre>
<pre id='line963' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":963
 *             print '   distance shift components ' ,self._name,len(components), 'in', "%.17g" % (end_time-start_time), "seconds"
 * 
 * cdef class Fast_distance_shift_calculator(Base_shift_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
struct __pyx_obj_17shift_calculators_Fast_distance_shift_calculator {
  struct __pyx_obj_17shift_calculators_Base_shift_calculator __pyx_base;
  int _target_atom_index;
  int _distance_atom_index_1;
  int _distance_atom_index_2;
  int _exponent_index;
  int _coefficient_index;
  int _smoothed;
  float _smoothing_factor;
  float _cutoff;
  struct __pyx_t_17shift_calculators_Distance_component *_compiled_components;
  int _num_components;
  PyObject *_raw_data;
};


/* "Cython_shift_calculator.pyx":963
 *             print '   distance shift components ' ,self._name,len(components), 'in', "%.17g" % (end_time-start_time), "seconds"
 * 
 * cdef class Fast_distance_shift_calculator(Base_shift_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */

struct __pyx_vtabstruct_17shift_calculators_Fast_distance_shift_calculator {
  struct __pyx_vtabstruct_17shift_calculators_Base_shift_calculator __pyx_base;
  struct __pyx_t_17shift_calculators_target_distant_atom (*_get_target_and_distant_atom_ids)(struct __pyx_obj_17shift_calculators_Fast_distance_shift_calculator *, int);
  struct __pyx_t_17shift_calculators_coefficient_exponent (*_get_coefficient_and_exponent)(struct __pyx_obj_17shift_calculators_Fast_distance_shift_calculator *, int);
};
static struct __pyx_vtabstruct_17shift_calculators_Fast_distance_shift_calculator *__pyx_vtabptr_17shift_calculators_Fast_distance_shift_calculator;
static CYTHON_INLINE struct __pyx_t_17shift_calculators_target_distant_atom __pyx_f_17shift_calculators_30Fast_distance_shift_calculator__get_target_and_distant_atom_ids(struct __pyx_obj_17shift_calculators_Fast_distance_shift_calculator *, int);
static CYTHON_INLINE struct __pyx_t_17shift_calculators_coefficient_exponent __pyx_f_17shift_calculators_30Fast_distance_shift_calculator__get_coefficient_and_exponent(struct __pyx_obj_17shift_calculators_Fast_distance_shift_calculator *, int);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line964")'> 964: </pre>
<pre id='line964' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line965")'> 965: </pre>
<pre id='line965' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line966")'> 966:     cdef int _target_atom_index</pre>
<pre id='line966' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line967")'> 967:     cdef int _distance_atom_index_1</pre>
<pre id='line967' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line968")'> 968:     cdef int _distance_atom_index_2</pre>
<pre id='line968' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line969")'> 969:     cdef int _exponent_index</pre>
<pre id='line969' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line970")'> 970:     cdef int _coefficient_index</pre>
<pre id='line970' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line971")'> 971:     cdef bint _smoothed</pre>
<pre id='line971' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line972")'> 972:     cdef float _smoothing_factor</pre>
<pre id='line972' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line973")'> 973:     cdef float _cutoff</pre>
<pre id='line973' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line974")'> 974: </pre>
<pre id='line974' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line975")'> 975:     cdef Distance_component* _compiled_components</pre>
<pre id='line975' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line976")'> 976:     cdef int _num_components</pre>
<pre id='line976' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line977")'> 977:     cdef object _raw_data</pre>
<pre id='line977' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line978")'> 978: </pre>
<pre id='line978' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line979")'> 979:     def __cinit__(self, simulation, smoothed, str name = "not set"):</pre>
<pre id='line979' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":979
 *     cdef object _raw_data
 * 
 *     def __cinit__(self, simulation, smoothed, str name = "not set"):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._raw_data = None
 *         self._compiled_components  = NULL
 */

static int __pyx_pf_17shift_calculators_30Fast_distance_shift_calculator___cinit__(struct __pyx_obj_17shift_calculators_Fast_distance_shift_calculator *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_simulation, CYTHON_UNUSED PyObject *__pyx_v_smoothed, CYTHON_UNUSED PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line980")'> 980:         self._raw_data = None</pre>
<pre id='line980' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":980
 * 
 *     def __cinit__(self, simulation, smoothed, str name = "not set"):
 *         self._raw_data = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components  = NULL
 *         self._num_components =  0
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_raw_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_raw_data);
  __pyx_v_self->_raw_data = Py_None;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line981")'> 981:         self._compiled_components  = NULL</pre>
<pre id='line981' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":981
 *     def __cinit__(self, simulation, smoothed, str name = "not set"):
 *         self._raw_data = None
 *         self._compiled_components  = NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components =  0
 * 
 */
  __pyx_v_self->_compiled_components = NULL;
</pre><pre class='line' style='background-color: #FFFF31' onclick='toggleDiv("line982")'> 982:         self._num_components =  0</pre>
<pre id='line982' class='code' style='background-color: #FFFF31'>
  /* "Cython_shift_calculator.pyx":982
 *         self._raw_data = None
 *         self._compiled_components  = NULL
 *         self._num_components =  0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __init__(self, simulation, smoothed, str name = "not set"):
 */
  __pyx_v_self->_num_components = 0;

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_30Fast_distance_shift_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_30Fast_distance_shift_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_simulation = 0;
  PyObject *__pyx_v_smoothed = 0;
  PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__simulation,&__pyx_n_s__smoothed,&__pyx_n_s__name,0};
    PyObject* values[3] = {0,0,0};
    values[2] = ((PyObject*)__pyx_kp_s_30);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__simulation)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__smoothed)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 2, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 984; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 984; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_simulation = values[0];
    __pyx_v_smoothed = values[1];
    __pyx_v_name = ((PyObject*)values[2]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 2, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 984; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_distance_shift_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&PyString_Type), 1, "name", 1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 984; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_30Fast_distance_shift_calculator_2__init__(((struct __pyx_obj_17shift_calculators_Fast_distance_shift_calculator *)__pyx_v_self), __pyx_v_simulation, __pyx_v_smoothed, __pyx_v_name);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line983")'> 983: </pre>
<pre id='line983' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line984")'> 984:     def __init__(self, simulation, smoothed, str name = "not set"):</pre>
<pre id='line984' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":984
 *         self._num_components =  0
 * 
 *     def __init__(self, simulation, smoothed, str name = "not set"):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         Base_shift_calculator.__init__(self, simulation, name)
 * 
 */

static int __pyx_pf_17shift_calculators_30Fast_distance_shift_calculator_2__init__(struct __pyx_obj_17shift_calculators_Fast_distance_shift_calculator *__pyx_v_self, PyObject *__pyx_v_simulation, PyObject *__pyx_v_smoothed, PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line985")'> 985:         Base_shift_calculator.__init__(self, simulation, name)</pre>
<pre id='line985' class='code' style='background-color: #FFFF4b'>
  /* "Cython_shift_calculator.pyx":985
 * 
 *     def __init__(self, simulation, smoothed, str name = "not set"):
 *         Base_shift_calculator.__init__(self, simulation, name)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._smoothed =  smoothed
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Base_shift_calculator)), __pyx_n_s____init__);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 985; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 985; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simulation);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_simulation);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_simulation);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_name));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, ((PyObject *)__pyx_v_name));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_name));
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 985; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line986")'> 986: </pre>
<pre id='line986' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line987")'> 987:         self._smoothed =  smoothed</pre>
<pre id='line987' class='code' style='background-color: #FFFF7f'>
  /* "Cython_shift_calculator.pyx":987
 *         Base_shift_calculator.__init__(self, simulation, name)
 * 
 *         self._smoothed =  smoothed             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._smoothing_factor =  DEFAULT_SMOOTHING_FACTOR
 * #
 */
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_v_smoothed);<span class='error_goto'> if (unlikely((__pyx_t_4 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 987; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_smoothed = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line988")'> 988:         self._smoothing_factor =  DEFAULT_SMOOTHING_FACTOR</pre>
<pre id='line988' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":988
 * 
 *         self._smoothed =  smoothed
 *         self._smoothing_factor =  DEFAULT_SMOOTHING_FACTOR             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #
 *         self._cutoff =  DEFAULT_CUTOFF
 */
  __pyx_v_self->_smoothing_factor = __pyx_v_17shift_calculators_DEFAULT_SMOOTHING_FACTOR;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line989")'> 989: #</pre>
<pre id='line989' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line990")'> 990:         self._cutoff =  DEFAULT_CUTOFF</pre>
<pre id='line990' class='code' style='background-color: #FFFF96'>
  /* "Cython_shift_calculator.pyx":990
 *         self._smoothing_factor =  DEFAULT_SMOOTHING_FACTOR
 * #
 *         self._cutoff =  DEFAULT_CUTOFF             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #
 * #    def set_cutoff(self, cutoff):
 */
  __pyx_v_self->_cutoff = __pyx_v_17shift_calculators_DEFAULT_CUTOFF;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_distance_shift_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_30Fast_distance_shift_calculator_5_bytes_to_components(PyObject *__pyx_v_self, PyObject *__pyx_v_data); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_30Fast_distance_shift_calculator_5_bytes_to_components(PyObject *__pyx_v_self, PyObject *__pyx_v_data) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_components (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_30Fast_distance_shift_calculator_4_bytes_to_components(((struct __pyx_obj_17shift_calculators_Fast_distance_shift_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_data));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line991")'> 991: #</pre>
<pre id='line991' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line992")'> 992: #    def set_cutoff(self, cutoff):</pre>
<pre id='line992' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line993")'> 993: #        self._cutoff =  cutoff</pre>
<pre id='line993' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line994")'> 994: #</pre>
<pre id='line994' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line995")'> 995: #    def set_smoothing_factor(self,smoothing_factor):</pre>
<pre id='line995' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line996")'> 996: #        self._smoothing_factor = smoothing_factor</pre>
<pre id='line996' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line997")'> 997: #</pre>
<pre id='line997' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line998")'> 998: #    TODO: this needs to be removed</pre>
<pre id='line998' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line999")'> 999:     def _bytes_to_components(self, data):</pre>
<pre id='line999' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":999
 * #
 * #    TODO: this needs to be removed
 *     def _bytes_to_components(self, data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._raw_data =  data
 */

static PyObject *__pyx_pf_17shift_calculators_30Fast_distance_shift_calculator_4_bytes_to_components(struct __pyx_obj_17shift_calculators_Fast_distance_shift_calculator *__pyx_v_self, PyObject *__pyx_v_data) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_components", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1000")'> 1000: </pre>
<pre id='line1000' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1001")'> 1001:         self._raw_data =  data</pre>
<pre id='line1001' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":1001
 *     def _bytes_to_components(self, data):
 * 
 *         self._raw_data =  data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components =  <code><</code>Distance_component*> <code><</code>size_t> ctypes.addressof(data)
 *         self._num_components =  len(data)/ sizeof(Distance_component)
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_raw_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_raw_data);
  __pyx_v_self->_raw_data = __pyx_v_data;
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line1002")'> 1002:         self._compiled_components =  &lt;Distance_component*&gt; &lt;size_t&gt; ctypes.addressof(data)</pre>
<pre id='line1002' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":1002
 * 
 *         self._raw_data =  data
 *         self._compiled_components =  <code><</code>Distance_component*> <code><</code>size_t> ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components =  len(data)/ sizeof(Distance_component)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1002; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1002; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1002; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1002; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1002; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_self->_compiled_components = ((struct __pyx_t_17shift_calculators_Distance_component *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line1003")'> 1003:         self._num_components =  len(data)/ sizeof(Distance_component)</pre>
<pre id='line1003' class='code' style='background-color: #FFFF73'>
  /* "Cython_shift_calculator.pyx":1003
 *         self._raw_data =  data
 *         self._compiled_components =  <code><</code>Distance_component*> <code><</code>size_t> ctypes.addressof(data)
 *         self._num_components =  len(data)/ sizeof(Distance_component)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1003; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_num_components = (__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Distance_component)));

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_distance_shift_calculator._bytes_to_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1004")'> 1004: </pre>
<pre id='line1004' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1005")'> 1005: </pre>
<pre id='line1005' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1006")'> 1006: </pre>
<pre id='line1006' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1007")'> 1007: </pre>
<pre id='line1007' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1008")'> 1008: </pre>
<pre id='line1008' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1009")'> 1009:     @cython.profile(False)</pre>
<pre id='line1009' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1010")'> 1010:     cdef inline target_distant_atom _get_target_and_distant_atom_ids(self, int index):</pre>
<pre id='line1010' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1010
 * 
 *     @cython.profile(False)
 *     cdef inline target_distant_atom _get_target_and_distant_atom_ids(self, int index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef target_distant_atom result
 * 
 */

static CYTHON_INLINE struct __pyx_t_17shift_calculators_target_distant_atom __pyx_f_17shift_calculators_30Fast_distance_shift_calculator__get_target_and_distant_atom_ids(struct __pyx_obj_17shift_calculators_Fast_distance_shift_calculator *__pyx_v_self, int __pyx_v_index) {
  struct __pyx_t_17shift_calculators_target_distant_atom __pyx_v_result;
  struct __pyx_t_17shift_calculators_target_distant_atom __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_get_target_and_distant_atom_ids", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1011")'> 1011:         cdef target_distant_atom result</pre>
<pre id='line1011' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1012")'> 1012: </pre>
<pre id='line1012' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1013")'> 1013:         result.target_atom_id = self._compiled_components[index].remote_atom_1</pre>
<pre id='line1013' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1013
 *         cdef target_distant_atom result
 * 
 *         result.target_atom_id = self._compiled_components[index].remote_atom_1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.distant_atom_id  = self._compiled_components[index].remote_atom_2
 *         return result
 */
  __pyx_t_1 = (__pyx_v_self->_compiled_components[__pyx_v_index]).remote_atom_1;
  __pyx_v_result.target_atom_id = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1014")'> 1014:         result.distant_atom_id  = self._compiled_components[index].remote_atom_2</pre>
<pre id='line1014' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1014
 * 
 *         result.target_atom_id = self._compiled_components[index].remote_atom_1
 *         result.distant_atom_id  = self._compiled_components[index].remote_atom_2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return result
 * 
 */
  __pyx_t_1 = (__pyx_v_self->_compiled_components[__pyx_v_index]).remote_atom_2;
  __pyx_v_result.distant_atom_id = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1015")'> 1015:         return result</pre>
<pre id='line1015' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":1015
 *         result.target_atom_id = self._compiled_components[index].remote_atom_1
 *         result.distant_atom_id  = self._compiled_components[index].remote_atom_2
 *         return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     @cython.profile(False)
 */
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;

  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1016")'> 1016: </pre>
<pre id='line1016' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1017")'> 1017:     @cython.profile(False)</pre>
<pre id='line1017' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1018")'> 1018:     cdef inline coefficient_exponent _get_coefficient_and_exponent(self, int index):</pre>
<pre id='line1018' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1018
 * 
 *     @cython.profile(False)
 *     cdef inline coefficient_exponent _get_coefficient_and_exponent(self, int index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef coefficient_exponent result
 * 
 */

static CYTHON_INLINE struct __pyx_t_17shift_calculators_coefficient_exponent __pyx_f_17shift_calculators_30Fast_distance_shift_calculator__get_coefficient_and_exponent(struct __pyx_obj_17shift_calculators_Fast_distance_shift_calculator *__pyx_v_self, int __pyx_v_index) {
  struct __pyx_t_17shift_calculators_coefficient_exponent __pyx_v_result;
  struct __pyx_t_17shift_calculators_coefficient_exponent __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_get_coefficient_and_exponent", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1019")'> 1019:         cdef coefficient_exponent result</pre>
<pre id='line1019' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1020")'> 1020: </pre>
<pre id='line1020' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1021")'> 1021: </pre>
<pre id='line1021' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1022")'> 1022:         result.coefficient = self._compiled_components[index].coefficient</pre>
<pre id='line1022' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1022
 * 
 * 
 *         result.coefficient = self._compiled_components[index].coefficient             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.exponent = self._compiled_components[index].exponent
 * 
 */
  __pyx_t_1 = (__pyx_v_self->_compiled_components[__pyx_v_index]).coefficient;
  __pyx_v_result.coefficient = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1023")'> 1023:         result.exponent = self._compiled_components[index].exponent</pre>
<pre id='line1023' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1023
 * 
 *         result.coefficient = self._compiled_components[index].coefficient
 *         result.exponent = self._compiled_components[index].exponent             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         return result
 */
  __pyx_t_1 = (__pyx_v_self->_compiled_components[__pyx_v_index]).exponent;
  __pyx_v_result.exponent = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1024")'> 1024: </pre>
<pre id='line1024' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF26' onclick='toggleDiv("line1025")'> 1025:         return result</pre>
<pre id='line1025' class='code' style='background-color: #FFFF26'>
  /* "Cython_shift_calculator.pyx":1025
 *         result.exponent = self._compiled_components[index].exponent
 * 
 *         return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     @cython.profile(False)
 */
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;

  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_30Fast_distance_shift_calculator_7__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_30Fast_distance_shift_calculator_7__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_components = 0;
  struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_shift_cache = 0;
  __Pyx_memviewslice __pyx_v_component_to_target = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_active_components = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__call__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__components,&__pyx_n_s__shift_cache,&__pyx_n_s__component_to_target,&__pyx_n_s__active_components,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__components)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__shift_cache)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 4, 4, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1028; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__component_to_target)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 4, 4, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1028; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__active_components)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 4, 4, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1028; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__call__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1028; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_components = values[0];
    __pyx_v_shift_cache = ((struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *)values[1]);
    __pyx_v_component_to_target = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[2]);<span class='error_goto'> if (unlikely(!__pyx_v_component_to_target.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1028; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_active_components = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[3]);<span class='error_goto'> if (unlikely(!__pyx_v_active_components.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1028; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1028; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_distance_shift_calculator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_shift_cache), __pyx_ptype_17shift_calculators_CDSSharedVectorFloat, 1, "shift_cache", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1028; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_30Fast_distance_shift_calculator_6__call__(((struct __pyx_obj_17shift_calculators_Fast_distance_shift_calculator *)__pyx_v_self), __pyx_v_components, __pyx_v_shift_cache, __pyx_v_component_to_target, __pyx_v_active_components);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1026")'> 1026: </pre>
<pre id='line1026' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1027")'> 1027:     @cython.profile(False)</pre>
<pre id='line1027' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1028")'> 1028:     def __call__(self, object components, CDSSharedVectorFloat shift_cache, int[:] component_to_target,  int[:] active_components):</pre>
<pre id='line1028' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1028
 * 
 *     @cython.profile(False)
 *     def __call__(self, object components, CDSSharedVectorFloat shift_cache, int[:] component_to_target,  int[:] active_components):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef double start_time = 0.0
 */

static PyObject *__pyx_pf_17shift_calculators_30Fast_distance_shift_calculator_6__call__(struct __pyx_obj_17shift_calculators_Fast_distance_shift_calculator *__pyx_v_self, PyObject *__pyx_v_components, struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_shift_cache, __Pyx_memviewslice __pyx_v_component_to_target, __Pyx_memviewslice __pyx_v_active_components) {
  double __pyx_v_start_time;
  double __pyx_v_end_time;
  float __pyx_v_smoothing_factor;
  float __pyx_v_ratio;
  struct __pyx_t_17shift_calculators_coefficient_exponent __pyx_v_coef_exp;
  int __pyx_v_target_atom_id;
  int __pyx_v_distant_atom_id;
  float __pyx_v_distance;
  int __pyx_v_factor_index;
  int __pyx_v_component_index;
  int __pyx_v_offset;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__call__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1029")'> 1029: </pre>
<pre id='line1029' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1030")'> 1030:         cdef double start_time = 0.0</pre>
<pre id='line1030' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1030
 *     def __call__(self, object components, CDSSharedVectorFloat shift_cache, int[:] component_to_target,  int[:] active_components):
 * 
 *         cdef double start_time = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef double end_time = 0.0
 * 
 */
  __pyx_v_start_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1031")'> 1031:         cdef double end_time = 0.0</pre>
<pre id='line1031' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1031
 * 
 *         cdef double start_time = 0.0
 *         cdef double end_time = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if self._verbose:
 */
  __pyx_v_end_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1032")'> 1032: </pre>
<pre id='line1032' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1033")'> 1033:         if self._verbose:</pre>
<pre id='line1033' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1033
 *         cdef double end_time = 0.0
 * 
 *         if self._verbose:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             start_time=time()
 * 
 */
  if (__pyx_v_self->__pyx_base._verbose) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line1034")'> 1034:             start_time=time()</pre>
<pre id='line1034' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":1034
 * 
 *         if self._verbose:
 *             start_time=time()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._set_components(components)
 */
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__time);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1034; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1034; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1034; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_start_time = __pyx_t_3;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1035")'> 1035: </pre>
<pre id='line1035' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line1036")'> 1036:         self._set_components(components)</pre>
<pre id='line1036' class='code' style='background-color: #FFFF55'>
  /* "Cython_shift_calculator.pyx":1036
 *             start_time=time()
 * 
 *         self._set_components(components)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef float smoothing_factor = self._smoothing_factor
 *         cdef float ratio
 */
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s___set_components);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1036; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1036; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_components);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_components);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_components);
  __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1036; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1037")'> 1037:         cdef float smoothing_factor = self._smoothing_factor</pre>
<pre id='line1037' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1037
 * 
 *         self._set_components(components)
 *         cdef float smoothing_factor = self._smoothing_factor             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef float ratio
 *         cdef float result
 */
  __pyx_t_5 = __pyx_v_self->_smoothing_factor;
  __pyx_v_smoothing_factor = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1038")'> 1038:         cdef float ratio</pre>
<pre id='line1038' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1039")'> 1039:         cdef float result</pre>
<pre id='line1039' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1040")'> 1040:         cdef coefficient_exponent coef_exp</pre>
<pre id='line1040' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1041")'> 1041:         cdef float coefficent</pre>
<pre id='line1041' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1042")'> 1042:         cdef float exponent</pre>
<pre id='line1042' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1043")'> 1043:         cdef object component</pre>
<pre id='line1043' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1044")'> 1044:         cdef int target_atom_id</pre>
<pre id='line1044' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1045")'> 1045:         cdef int distant_atom_id</pre>
<pre id='line1045' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1046")'> 1046:         cdef float distance</pre>
<pre id='line1046' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1047")'> 1047: </pre>
<pre id='line1047' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1048")'> 1048: </pre>
<pre id='line1048' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1049")'> 1049: </pre>
<pre id='line1049' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1050")'> 1050:         if self._verbose:</pre>
<pre id='line1050' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1050
 * 
 * 
 *         if self._verbose:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             start_time = time()
 * 
 */
  if (__pyx_v_self->__pyx_base._verbose) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line1051")'> 1051:             start_time = time()</pre>
<pre id='line1051' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":1051
 * 
 *         if self._verbose:
 *             start_time = time()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef int factor_index = 0
 */
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__time);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1051; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_4, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1051; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1051; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_start_time = __pyx_t_3;
    goto __pyx_L4;
  }
  __pyx_L4:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1052")'> 1052: </pre>
<pre id='line1052' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1053")'> 1053:         cdef int factor_index = 0</pre>
<pre id='line1053' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1053
 *             start_time = time()
 * 
 *         cdef int factor_index = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int component_index
 *         cdef int offset
 */
  __pyx_v_factor_index = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1054")'> 1054:         cdef int component_index</pre>
<pre id='line1054' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1055")'> 1055:         cdef int offset</pre>
<pre id='line1055' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1056")'> 1056: </pre>
<pre id='line1056' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1057")'> 1057:         #TODO: note to cython list for componnt_index in active_components produces awful code!</pre>
<pre id='line1057' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line1058")'> 1058:         for factor_index in range(len(active_components)):</pre>
<pre id='line1058' class='code' style='background-color: #FFFF9f'>
  /* "Cython_shift_calculator.pyx":1058
 * 
 *         #TODO: note to cython list for componnt_index in active_components produces awful code!
 *         for factor_index in range(len(active_components)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             component_index = active_components[factor_index]
 * 
 */
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_active_components, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1058; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_6 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1058; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (__pyx_t_7 = 0; __pyx_t_7 <code><</code> __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_factor_index = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1059")'> 1059:             component_index = active_components[factor_index]</pre>
<pre id='line1059' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1059
 *         #TODO: note to cython list for componnt_index in active_components produces awful code!
 *         for factor_index in range(len(active_components)):
 *             component_index = active_components[factor_index]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #             component = components[index]
 */
    __pyx_t_8 = __pyx_v_factor_index;
    __pyx_v_component_index = (*((int *) ( /* dim=0 */ (__pyx_v_active_components.data + __pyx_t_8 * __pyx_v_active_components.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1060")'> 1060: </pre>
<pre id='line1060' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1061")'> 1061: #             component = components[index]</pre>
<pre id='line1061' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1062")'> 1062: </pre>
<pre id='line1062' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1063")'> 1063: </pre>
<pre id='line1063' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1064")'> 1064:             target_atom_id = self._compiled_components[component_index].remote_atom_1</pre>
<pre id='line1064' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1064
 * 
 * 
 *             target_atom_id = self._compiled_components[component_index].remote_atom_1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             distant_atom_id  = self._compiled_components[component_index].remote_atom_2
 * 
 */
    __pyx_t_9 = (__pyx_v_self->_compiled_components[__pyx_v_component_index]).remote_atom_1;
    __pyx_v_target_atom_id = __pyx_t_9;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1065")'> 1065:             distant_atom_id  = self._compiled_components[component_index].remote_atom_2</pre>
<pre id='line1065' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1065
 * 
 *             target_atom_id = self._compiled_components[component_index].remote_atom_1
 *             distant_atom_id  = self._compiled_components[component_index].remote_atom_2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_t_9 = (__pyx_v_self->_compiled_components[__pyx_v_component_index]).remote_atom_2;
    __pyx_v_distant_atom_id = __pyx_t_9;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1066")'> 1066: </pre>
<pre id='line1066' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1067")'> 1067: </pre>
<pre id='line1067' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1068")'> 1068:             coef_exp = self._get_coefficient_and_exponent(component_index)</pre>
<pre id='line1068' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1068
 * 
 * 
 *             coef_exp = self._get_coefficient_and_exponent(component_index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             distance =calc_distance_simulation(self._simulation, target_atom_id, distant_atom_id)
 *     #        Atom_utils._calculate_distance(target_atom_index, sidechain_atom_index)
 */
    __pyx_v_coef_exp = __pyx_f_17shift_calculators_30Fast_distance_shift_calculator__get_coefficient_and_exponent(__pyx_v_self, __pyx_v_component_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1069")'> 1069:             distance =calc_distance_simulation(self._simulation, target_atom_id, distant_atom_id)</pre>
<pre id='line1069' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1069
 * 
 *             coef_exp = self._get_coefficient_and_exponent(component_index)
 *             distance =calc_distance_simulation(self._simulation, target_atom_id, distant_atom_id)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     #        Atom_utils._calculate_distance(target_atom_index, sidechain_atom_index)
 * 
 */
    __pyx_v_distance = __pyx_f_17shift_calculators_calc_distance_simulation(__pyx_v_self->__pyx_base._simulation, __pyx_v_target_atom_id, __pyx_v_distant_atom_id);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1070")'> 1070:     #        Atom_utils._calculate_distance(target_atom_index, sidechain_atom_index)</pre>
<pre id='line1070' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1071")'> 1071: </pre>
<pre id='line1071' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1072")'> 1072:             if self._smoothed:</pre>
<pre id='line1072' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1072
 *     #        Atom_utils._calculate_distance(target_atom_index, sidechain_atom_index)
 * 
 *             if self._smoothed:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 ratio = distance / self._cutoff
 *                 smoothing_factor = 1.0 - ratio ** 8
 */
    if (__pyx_v_self->_smoothed) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1073")'> 1073:                 ratio = distance / self._cutoff</pre>
<pre id='line1073' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1073
 * 
 *             if self._smoothed:
 *                 ratio = distance / self._cutoff             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 smoothing_factor = 1.0 - ratio ** 8
 * 
 */
      __pyx_v_ratio = (__pyx_v_distance / __pyx_v_self->_cutoff);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1074")'> 1074:                 smoothing_factor = 1.0 - ratio ** 8</pre>
<pre id='line1074' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1074
 *             if self._smoothed:
 *                 ratio = distance / self._cutoff
 *                 smoothing_factor = 1.0 - ratio ** 8             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             offset = self.ensemble_array_offset(component_to_target[factor_index])
 */
      __pyx_v_smoothing_factor = (1.0 - powf(__pyx_v_ratio, 8.0));
      goto __pyx_L7;
    }
    __pyx_L7:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1075")'> 1075: </pre>
<pre id='line1075' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1076")'> 1076:             offset = self.ensemble_array_offset(component_to_target[factor_index])</pre>
<pre id='line1076' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1076
 *                 smoothing_factor = 1.0 - ratio ** 8
 * 
 *             offset = self.ensemble_array_offset(component_to_target[factor_index])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             shift_cache.addToResult(offset, smoothing_factor * pow(distance,  coef_exp.exponent) * coef_exp.coefficient)
 * 
 */
    __pyx_t_9 = __pyx_v_factor_index;
    __pyx_v_offset = __pyx_f_17shift_calculators_21Base_shift_calculator_ensemble_array_offset(((struct __pyx_obj_17shift_calculators_Base_shift_calculator *)__pyx_v_self), (*((int *) ( /* dim=0 */ (__pyx_v_component_to_target.data + __pyx_t_9 * __pyx_v_component_to_target.strides[0]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1077")'> 1077:             shift_cache.addToResult(offset, smoothing_factor * pow(distance,  coef_exp.exponent) * coef_exp.coefficient)</pre>
<pre id='line1077' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1077
 * 
 *             offset = self.ensemble_array_offset(component_to_target[factor_index])
 *             shift_cache.addToResult(offset, smoothing_factor * pow(distance,  coef_exp.exponent) * coef_exp.coefficient)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if self._verbose:
 */
    __pyx_f_17shift_calculators_20CDSSharedVectorFloat_addToResult(__pyx_v_shift_cache, __pyx_v_offset, ((__pyx_v_smoothing_factor * pow(__pyx_v_distance, __pyx_v_coef_exp.exponent)) * __pyx_v_coef_exp.coefficient));
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1078")'> 1078: </pre>
<pre id='line1078' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1079")'> 1079:         if self._verbose:</pre>
<pre id='line1079' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1079
 *             shift_cache.addToResult(offset, smoothing_factor * pow(distance,  coef_exp.exponent) * coef_exp.coefficient)
 * 
 *         if self._verbose:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             end_time = time()
 *             print '   distance shift components ' ,self._name,len(components), 'in', "%.17g" % (end_time-start_time), "seconds"
 */
  if (__pyx_v_self->__pyx_base._verbose) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line1080")'> 1080:             end_time = time()</pre>
<pre id='line1080' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":1080
 * 
 *         if self._verbose:
 *             end_time = time()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print '   distance shift components ' ,self._name,len(components), 'in', "%.17g" % (end_time-start_time), "seconds"
 * 
 */
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__time);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1080; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1080; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1080; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_end_time = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF1c' onclick='toggleDiv("line1081")'> 1081:             print '   distance shift components ' ,self._name,len(components), 'in', "%.17g" % (end_time-start_time), "seconds"</pre>
<pre id='line1081' class='code' style='background-color: #FFFF1c'>
    /* "Cython_shift_calculator.pyx":1081
 *         if self._verbose:
 *             end_time = time()
 *             print '   distance shift components ' ,self._name,len(components), 'in', "%.17g" % (end_time-start_time), "seconds"             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_t_6 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_components);<span class='error_goto'> if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1081; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1081; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_end_time - __pyx_v_start_time));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1081; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_32), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1081; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1081; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_31));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_kp_s_31));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_31));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self->__pyx_base._name));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_self->__pyx_base._name));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_self->__pyx_base._name));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_t_4);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__in));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 3, ((PyObject *)__pyx_n_s__in));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__in));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 4, ((PyObject *)__pyx_t_2));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_2));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__seconds));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 5, ((PyObject *)__pyx_n_s__seconds));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__seconds));
    __pyx_t_4 = 0;
    __pyx_t_2 = 0;
    if (<span class='pyx_c_api'>__Pyx_Print</span>(0, ((PyObject *)__pyx_t_1), 1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1081; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    goto __pyx_L8;
  }
  __pyx_L8:;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_distance_shift_calculator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&__pyx_v_component_to_target, 1);
  __PYX_XDEC_MEMVIEW(&__pyx_v_active_components, 1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_30Fast_dihedral_shift_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_30Fast_dihedral_shift_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED PyObject *__pyx_v_simulation = 0;
  CYTHON_UNUSED PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__simulation,&__pyx_n_s__name,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject*)__pyx_kp_s_30);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__simulation)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1092; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_simulation = values[0];
    __pyx_v_name = ((PyObject*)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1092; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_dihedral_shift_calculator.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&PyString_Type), 1, "name", 1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1092; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_30Fast_dihedral_shift_calculator___cinit__(((struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *)__pyx_v_self), __pyx_v_simulation, __pyx_v_name);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1082")'> 1082: </pre>
<pre id='line1082' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1083")'> 1083: </pre>
<pre id='line1083' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1084")'> 1084: </pre>
<pre id='line1084' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1085")'> 1085: </pre>
<pre id='line1085' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1086")'> 1086: cdef class Fast_dihedral_shift_calculator(Base_shift_calculator):</pre>
<pre id='line1086' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1086
 * 
 * 
 * cdef class Fast_dihedral_shift_calculator(Base_shift_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef Dihedral_component *_compiled_components
 */
struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator {
  struct __pyx_obj_17shift_calculators_Base_shift_calculator __pyx_base;
  struct __pyx_t_17shift_calculators_Dihedral_component *_compiled_components;
  int _num_components;
  PyObject *_raw_data;
};


/* "Cython_shift_calculator.pyx":1086
 * 
 * 
 * cdef class Fast_dihedral_shift_calculator(Base_shift_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef Dihedral_component *_compiled_components
 */

struct __pyx_vtabstruct_17shift_calculators_Fast_dihedral_shift_calculator {
  struct __pyx_vtabstruct_17shift_calculators_Base_shift_calculator __pyx_base;
  PyObject *(*_get_component)(struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *, int);
  struct __pyx_t_17shift_calculators_dihedral_ids (*_get_dihedral_atom_ids)(struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *, int);
  struct __pyx_t_17shift_calculators_dihedral_parameters (*_get_parameters)(struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *, int);
  float (*_get_coefficient)(struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *, int);
};
static struct __pyx_vtabstruct_17shift_calculators_Fast_dihedral_shift_calculator *__pyx_vtabptr_17shift_calculators_Fast_dihedral_shift_calculator;
static CYTHON_INLINE PyObject *__pyx_f_17shift_calculators_30Fast_dihedral_shift_calculator__get_component(struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *, int);
static CYTHON_INLINE struct __pyx_t_17shift_calculators_dihedral_ids __pyx_f_17shift_calculators_30Fast_dihedral_shift_calculator__get_dihedral_atom_ids(struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *, int);
static CYTHON_INLINE struct __pyx_t_17shift_calculators_dihedral_parameters __pyx_f_17shift_calculators_30Fast_dihedral_shift_calculator__get_parameters(struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *, int);
static CYTHON_INLINE float __pyx_f_17shift_calculators_30Fast_dihedral_shift_calculator__get_coefficient(struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *, int);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1087")'> 1087: </pre>
<pre id='line1087' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1088")'> 1088:     cdef Dihedral_component *_compiled_components</pre>
<pre id='line1088' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1089")'> 1089:     cdef int _num_components</pre>
<pre id='line1089' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1090")'> 1090:     cdef object _raw_data</pre>
<pre id='line1090' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1091")'> 1091: </pre>
<pre id='line1091' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1092")'> 1092:     def __cinit__(self, simulation, str name = "not set"):</pre>
<pre id='line1092' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1092
 *     cdef object _raw_data
 * 
 *     def __cinit__(self, simulation, str name = "not set"):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._raw_data =  None
 *         self._compiled_components = NULL
 */

static int __pyx_pf_17shift_calculators_30Fast_dihedral_shift_calculator___cinit__(struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_simulation, CYTHON_UNUSED PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1093")'> 1093:         self._raw_data =  None</pre>
<pre id='line1093' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":1093
 * 
 *     def __cinit__(self, simulation, str name = "not set"):
 *         self._raw_data =  None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components = NULL
 *         self._num_components = 0
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_raw_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_raw_data);
  __pyx_v_self->_raw_data = Py_None;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1094")'> 1094:         self._compiled_components = NULL</pre>
<pre id='line1094' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1094
 *     def __cinit__(self, simulation, str name = "not set"):
 *         self._raw_data =  None
 *         self._compiled_components = NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components = 0
 * 
 */
  __pyx_v_self->_compiled_components = NULL;
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line1095")'> 1095:         self._num_components = 0</pre>
<pre id='line1095' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":1095
 *         self._raw_data =  None
 *         self._compiled_components = NULL
 *         self._num_components = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_self->_num_components = 0;

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_30Fast_dihedral_shift_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_30Fast_dihedral_shift_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_simulation = 0;
  PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__simulation,&__pyx_n_s__name,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject*)__pyx_kp_s_30);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__simulation)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1098; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_simulation = values[0];
    __pyx_v_name = ((PyObject*)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1098; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_dihedral_shift_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&PyString_Type), 1, "name", 1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1098; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_30Fast_dihedral_shift_calculator_2__init__(((struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *)__pyx_v_self), __pyx_v_simulation, __pyx_v_name);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1096")'> 1096: </pre>
<pre id='line1096' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1097")'> 1097: </pre>
<pre id='line1097' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1098")'> 1098:     def __init__(self, simulation, str name = "not set"):</pre>
<pre id='line1098' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1098
 * 
 * 
 *     def __init__(self, simulation, str name = "not set"):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         Base_shift_calculator.__init__(self, simulation, name)
 * 
 */

static int __pyx_pf_17shift_calculators_30Fast_dihedral_shift_calculator_2__init__(struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *__pyx_v_self, PyObject *__pyx_v_simulation, PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line1099")'> 1099:         Base_shift_calculator.__init__(self, simulation, name)</pre>
<pre id='line1099' class='code' style='background-color: #FFFF3e'>
  /* "Cython_shift_calculator.pyx":1099
 * 
 *     def __init__(self, simulation, str name = "not set"):
 *         Base_shift_calculator.__init__(self, simulation, name)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Base_shift_calculator)), __pyx_n_s____init__);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1099; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1099; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simulation);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_simulation);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_simulation);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_name));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, ((PyObject *)__pyx_v_name));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_name));
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1099; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_dihedral_shift_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_30Fast_dihedral_shift_calculator_5_bytes_to_components(PyObject *__pyx_v_self, PyObject *__pyx_v_data); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_30Fast_dihedral_shift_calculator_5_bytes_to_components(PyObject *__pyx_v_self, PyObject *__pyx_v_data) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_components (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_30Fast_dihedral_shift_calculator_4_bytes_to_components(((struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_data));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1100")'> 1100: </pre>
<pre id='line1100' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1101")'> 1101: </pre>
<pre id='line1101' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1102")'> 1102:     def  _bytes_to_components(self, data):</pre>
<pre id='line1102' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1102
 * 
 * 
 *     def  _bytes_to_components(self, data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._raw_data =  data
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_30Fast_dihedral_shift_calculator_4_bytes_to_components(struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *__pyx_v_self, PyObject *__pyx_v_data) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_components", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1103")'> 1103:         self._raw_data =  data</pre>
<pre id='line1103' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":1103
 * 
 *     def  _bytes_to_components(self, data):
 *         self._raw_data =  data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._compiled_components =  <code><</code>Dihedral_component*> <code><</code>size_t> ctypes.addressof(data)
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_raw_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_raw_data);
  __pyx_v_self->_raw_data = __pyx_v_data;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1104")'> 1104: </pre>
<pre id='line1104' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line1105")'> 1105:         self._compiled_components =  &lt;Dihedral_component*&gt; &lt;size_t&gt; ctypes.addressof(data)</pre>
<pre id='line1105' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":1105
 *         self._raw_data =  data
 * 
 *         self._compiled_components =  <code><</code>Dihedral_component*> <code><</code>size_t> ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components =  len(data)/ sizeof(Dihedral_component)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_self->_compiled_components = ((struct __pyx_t_17shift_calculators_Dihedral_component *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line1106")'> 1106:         self._num_components =  len(data)/ sizeof(Dihedral_component)</pre>
<pre id='line1106' class='code' style='background-color: #FFFF73'>
  /* "Cython_shift_calculator.pyx":1106
 * 
 *         self._compiled_components =  <code><</code>Dihedral_component*> <code><</code>size_t> ctypes.addressof(data)
 *         self._num_components =  len(data)/ sizeof(Dihedral_component)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_num_components = (__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Dihedral_component)));

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_dihedral_shift_calculator._bytes_to_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1107")'> 1107: </pre>
<pre id='line1107' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1108")'> 1108: </pre>
<pre id='line1108' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1109")'> 1109:     cdef inline _get_component(self,int index):</pre>
<pre id='line1109' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1109
 * 
 * 
 *     cdef inline _get_component(self,int index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._components[index]
 * 
 */

static CYTHON_INLINE PyObject *__pyx_f_17shift_calculators_30Fast_dihedral_shift_calculator__get_component(struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *__pyx_v_self, int __pyx_v_index) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_get_component", 0);
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line1110")'> 1110:         return self._components[index]</pre>
<pre id='line1110' class='code' style='background-color: #FFFF66'>
  /* "Cython_shift_calculator.pyx":1110
 * 
 *     cdef inline _get_component(self,int index):
 *         return self._components[index]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     @cython.profile(False)
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s___components);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, __pyx_v_index, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_dihedral_shift_calculator._get_component", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1111")'> 1111: </pre>
<pre id='line1111' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1112")'> 1112:     @cython.profile(False)</pre>
<pre id='line1112' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1113")'> 1113:     cdef inline dihedral_ids _get_dihedral_atom_ids(self, int index):</pre>
<pre id='line1113' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1113
 * 
 *     @cython.profile(False)
 *     cdef inline dihedral_ids _get_dihedral_atom_ids(self, int index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef dihedral_ids result
 * 
 */

static CYTHON_INLINE struct __pyx_t_17shift_calculators_dihedral_ids __pyx_f_17shift_calculators_30Fast_dihedral_shift_calculator__get_dihedral_atom_ids(struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *__pyx_v_self, int __pyx_v_index) {
  struct __pyx_t_17shift_calculators_dihedral_ids __pyx_v_result;
  struct __pyx_t_17shift_calculators_dihedral_ids __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_get_dihedral_atom_ids", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1114")'> 1114:         cdef dihedral_ids result</pre>
<pre id='line1114' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1115")'> 1115: </pre>
<pre id='line1115' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1116")'> 1116:         result.atom_id_1 = self._compiled_components[index].dihedral_atoms[0]</pre>
<pre id='line1116' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1116
 *         cdef dihedral_ids result
 * 
 *         result.atom_id_1 = self._compiled_components[index].dihedral_atoms[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.atom_id_2 = self._compiled_components[index].dihedral_atoms[1]
 *         result.atom_id_3 = self._compiled_components[index].dihedral_atoms[2]
 */
  __pyx_v_result.atom_id_1 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).dihedral_atoms[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1117")'> 1117:         result.atom_id_2 = self._compiled_components[index].dihedral_atoms[1]</pre>
<pre id='line1117' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1117
 * 
 *         result.atom_id_1 = self._compiled_components[index].dihedral_atoms[0]
 *         result.atom_id_2 = self._compiled_components[index].dihedral_atoms[1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.atom_id_3 = self._compiled_components[index].dihedral_atoms[2]
 *         result.atom_id_4 = self._compiled_components[index].dihedral_atoms[3]
 */
  __pyx_v_result.atom_id_2 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).dihedral_atoms[1]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1118")'> 1118:         result.atom_id_3 = self._compiled_components[index].dihedral_atoms[2]</pre>
<pre id='line1118' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1118
 *         result.atom_id_1 = self._compiled_components[index].dihedral_atoms[0]
 *         result.atom_id_2 = self._compiled_components[index].dihedral_atoms[1]
 *         result.atom_id_3 = self._compiled_components[index].dihedral_atoms[2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.atom_id_4 = self._compiled_components[index].dihedral_atoms[3]
 * 
 */
  __pyx_v_result.atom_id_3 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).dihedral_atoms[2]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1119")'> 1119:         result.atom_id_4 = self._compiled_components[index].dihedral_atoms[3]</pre>
<pre id='line1119' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1119
 *         result.atom_id_2 = self._compiled_components[index].dihedral_atoms[1]
 *         result.atom_id_3 = self._compiled_components[index].dihedral_atoms[2]
 *         result.atom_id_4 = self._compiled_components[index].dihedral_atoms[3]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         return result
 */
  __pyx_v_result.atom_id_4 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).dihedral_atoms[3]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1120")'> 1120: </pre>
<pre id='line1120' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1121")'> 1121:         return result</pre>
<pre id='line1121' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":1121
 *         result.atom_id_4 = self._compiled_components[index].dihedral_atoms[3]
 * 
 *         return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline dihedral_parameters _get_parameters(self, int index):
 */
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;

  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1122")'> 1122: </pre>
<pre id='line1122' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1123")'> 1123:     cdef inline dihedral_parameters _get_parameters(self, int index):</pre>
<pre id='line1123' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1123
 *         return result
 * 
 *     cdef inline dihedral_parameters _get_parameters(self, int index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef dihedral_parameters result
 */

static CYTHON_INLINE struct __pyx_t_17shift_calculators_dihedral_parameters __pyx_f_17shift_calculators_30Fast_dihedral_shift_calculator__get_parameters(struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *__pyx_v_self, int __pyx_v_index) {
  struct __pyx_t_17shift_calculators_dihedral_parameters __pyx_v_result;
  struct __pyx_t_17shift_calculators_dihedral_parameters __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_get_parameters", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1124")'> 1124: </pre>
<pre id='line1124' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1125")'> 1125:         cdef dihedral_parameters result</pre>
<pre id='line1125' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1126")'> 1126: </pre>
<pre id='line1126' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1127")'> 1127:         result.param_0 = self._compiled_components[index].parameters[0]</pre>
<pre id='line1127' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1127
 *         cdef dihedral_parameters result
 * 
 *         result.param_0 = self._compiled_components[index].parameters[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.param_1 = self._compiled_components[index].parameters[3]
 *         result.param_2 = self._compiled_components[index].parameters[1]
 */
  __pyx_v_result.param_0 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).parameters[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1128")'> 1128:         result.param_1 = self._compiled_components[index].parameters[3]</pre>
<pre id='line1128' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1128
 * 
 *         result.param_0 = self._compiled_components[index].parameters[0]
 *         result.param_1 = self._compiled_components[index].parameters[3]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.param_2 = self._compiled_components[index].parameters[1]
 *         result.param_3 = self._compiled_components[index].parameters[4]
 */
  __pyx_v_result.param_1 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).parameters[3]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1129")'> 1129:         result.param_2 = self._compiled_components[index].parameters[1]</pre>
<pre id='line1129' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1129
 *         result.param_0 = self._compiled_components[index].parameters[0]
 *         result.param_1 = self._compiled_components[index].parameters[3]
 *         result.param_2 = self._compiled_components[index].parameters[1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.param_3 = self._compiled_components[index].parameters[4]
 *         result.param_4 = self._compiled_components[index].parameters[2]
 */
  __pyx_v_result.param_2 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).parameters[1]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1130")'> 1130:         result.param_3 = self._compiled_components[index].parameters[4]</pre>
<pre id='line1130' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1130
 *         result.param_1 = self._compiled_components[index].parameters[3]
 *         result.param_2 = self._compiled_components[index].parameters[1]
 *         result.param_3 = self._compiled_components[index].parameters[4]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.param_4 = self._compiled_components[index].parameters[2]
 * 
 */
  __pyx_v_result.param_3 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).parameters[4]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1131")'> 1131:         result.param_4 = self._compiled_components[index].parameters[2]</pre>
<pre id='line1131' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1131
 *         result.param_2 = self._compiled_components[index].parameters[1]
 *         result.param_3 = self._compiled_components[index].parameters[4]
 *         result.param_4 = self._compiled_components[index].parameters[2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_result.param_4 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).parameters[2]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1132")'> 1132: </pre>
<pre id='line1132' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1133")'> 1133: </pre>
<pre id='line1133' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1134")'> 1134: </pre>
<pre id='line1134' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1135")'> 1135: </pre>
<pre id='line1135' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1136")'> 1136:         return result</pre>
<pre id='line1136' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":1136
 * 
 * 
 *         return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     @cython.profile(False)
 */
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;

  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1137")'> 1137: </pre>
<pre id='line1137' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1138")'> 1138:     @cython.profile(False)</pre>
<pre id='line1138' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1139")'> 1139:     cdef inline float _get_coefficient(self, int index):</pre>
<pre id='line1139' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1139
 * 
 *     @cython.profile(False)
 *     cdef inline float _get_coefficient(self, int index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._compiled_components[index].coefficient
 * 
 */

static CYTHON_INLINE float __pyx_f_17shift_calculators_30Fast_dihedral_shift_calculator__get_coefficient(struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *__pyx_v_self, int __pyx_v_index) {
  float __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_get_coefficient", 0);
</pre><pre class='line' style='background-color: #FFFF26' onclick='toggleDiv("line1140")'> 1140:         return self._compiled_components[index].coefficient</pre>
<pre id='line1140' class='code' style='background-color: #FFFF26'>
  /* "Cython_shift_calculator.pyx":1140
 *     @cython.profile(False)
 *     cdef inline float _get_coefficient(self, int index):
 *         return self._compiled_components[index].coefficient             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     @cython.profile(True)
 */
  __pyx_r = (__pyx_v_self->_compiled_components[__pyx_v_index]).coefficient;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_30Fast_dihedral_shift_calculator_7__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_30Fast_dihedral_shift_calculator_7__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_components = 0;
  struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_shift_cache = 0;
  __Pyx_memviewslice __pyx_v_component_to_target = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_active_components = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__call__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__components,&__pyx_n_s__shift_cache,&__pyx_n_s__component_to_target,&__pyx_n_s__active_components,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__components)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__shift_cache)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 4, 4, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1146; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__component_to_target)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 4, 4, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1146; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__active_components)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 4, 4, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1146; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__call__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1146; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_components = values[0];
    __pyx_v_shift_cache = ((struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *)values[1]);
    __pyx_v_component_to_target = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[2]);<span class='error_goto'> if (unlikely(!__pyx_v_component_to_target.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1146; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_active_components = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[3]);<span class='error_goto'> if (unlikely(!__pyx_v_active_components.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1146; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1146; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_dihedral_shift_calculator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_shift_cache), __pyx_ptype_17shift_calculators_CDSSharedVectorFloat, 1, "shift_cache", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_30Fast_dihedral_shift_calculator_6__call__(((struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *)__pyx_v_self), __pyx_v_components, __pyx_v_shift_cache, __pyx_v_component_to_target, __pyx_v_active_components);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1141")'> 1141: </pre>
<pre id='line1141' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1142")'> 1142:     @cython.profile(True)</pre>
<pre id='line1142' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1143")'> 1143:     #TODO: architecture different from force calculator no base function/class</pre>
<pre id='line1143' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1144")'> 1144:     #TODO: still uses component to result...</pre>
<pre id='line1144' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1145")'> 1145:     #TODO: add common force and shift base class</pre>
<pre id='line1145' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1146")'> 1146:     def __call__(self, object components, CDSSharedVectorFloat shift_cache, int[:] component_to_target, int[:] active_components):</pre>
<pre id='line1146' class='code' style='background-color: #FFFFd4'>
/* "Cython_shift_calculator.pyx":1146
 *     #TODO: still uses component to result...
 *     #TODO: add common force and shift base class
 *     def __call__(self, object components, CDSSharedVectorFloat shift_cache, int[:] component_to_target, int[:] active_components):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef float angle
 */

static PyObject *__pyx_pf_17shift_calculators_30Fast_dihedral_shift_calculator_6__call__(struct __pyx_obj_17shift_calculators_Fast_dihedral_shift_calculator *__pyx_v_self, PyObject *__pyx_v_components, struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_shift_cache, __Pyx_memviewslice __pyx_v_component_to_target, __Pyx_memviewslice __pyx_v_active_components) {
  float __pyx_v_angle;
  float __pyx_v_angle_term;
  float __pyx_v_shift;
  float __pyx_v_coefficient;
  struct __pyx_t_17shift_calculators_dihedral_parameters __pyx_v_parameters;
  struct __pyx_t_17shift_calculators_dihedral_ids __pyx_v_dihedral_atom_ids;
  double __pyx_v_start_time;
  double __pyx_v_end_time;
  int __pyx_v_factor_index;
  int __pyx_v_component_index;
  int __pyx_v_offset;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__call__", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("__call__", __pyx_f[0], 1146);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1147")'> 1147: </pre>
<pre id='line1147' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1148")'> 1148:         cdef float angle</pre>
<pre id='line1148' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1149")'> 1149:         cdef float angle_term</pre>
<pre id='line1149' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1150")'> 1150:         cdef float shift</pre>
<pre id='line1150' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1151")'> 1151:         cdef float coefficient</pre>
<pre id='line1151' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1152")'> 1152:         cdef dihedral_parameters parameters</pre>
<pre id='line1152' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1153")'> 1153:         cdef dihedral_ids dihedral_atom_ids</pre>
<pre id='line1153' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1154")'> 1154:         cdef double start_time = 0.0</pre>
<pre id='line1154' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1154
 *         cdef dihedral_parameters parameters
 *         cdef dihedral_ids dihedral_atom_ids
 *         cdef double start_time = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef double end_time = 0.0
 * 
 */
  __pyx_v_start_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1155")'> 1155:         cdef double end_time = 0.0</pre>
<pre id='line1155' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1155
 *         cdef dihedral_ids dihedral_atom_ids
 *         cdef double start_time = 0.0
 *         cdef double end_time = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_end_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1156")'> 1156: </pre>
<pre id='line1156' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1157")'> 1157: </pre>
<pre id='line1157' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1158")'> 1158: </pre>
<pre id='line1158' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1159")'> 1159:         if self._verbose:</pre>
<pre id='line1159' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1159
 * 
 * 
 *         if self._verbose:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             start_time = time()
 *         cdef int factor_index
 */
  if (__pyx_v_self->__pyx_base._verbose) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line1160")'> 1160:             start_time = time()</pre>
<pre id='line1160' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":1160
 * 
 *         if self._verbose:
 *             start_time = time()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int factor_index
 *         cdef int component_index
 */
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__time);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_start_time = __pyx_t_3;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1161")'> 1161:         cdef int factor_index</pre>
<pre id='line1161' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1162")'> 1162:         cdef int component_index</pre>
<pre id='line1162' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1163")'> 1163:         cdef int offset</pre>
<pre id='line1163' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1164")'> 1164: </pre>
<pre id='line1164' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line1165")'> 1165:         self._set_components(components)</pre>
<pre id='line1165' class='code' style='background-color: #FFFF55'>
  /* "Cython_shift_calculator.pyx":1165
 *         cdef int offset
 * 
 *         self._set_components(components)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for factor_index in range(len(active_components)):
 *             component_index = active_components[factor_index]
 */
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s___set_components);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_components);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_components);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_components);
  __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line1166")'> 1166:         for factor_index in range(len(active_components)):</pre>
<pre id='line1166' class='code' style='background-color: #FFFF9f'>
  /* "Cython_shift_calculator.pyx":1166
 * 
 *         self._set_components(components)
 *         for factor_index in range(len(active_components)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             component_index = active_components[factor_index]
 * 
 */
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_active_components, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  for (__pyx_t_6 = 0; __pyx_t_6 <code><</code> __pyx_t_5; __pyx_t_6+=1) {
    __pyx_v_factor_index = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1167")'> 1167:             component_index = active_components[factor_index]</pre>
<pre id='line1167' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1167
 *         self._set_components(components)
 *         for factor_index in range(len(active_components)):
 *             component_index = active_components[factor_index]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             dihedral_atom_ids = self._get_dihedral_atom_ids(component_index)
 */
    __pyx_t_7 = __pyx_v_factor_index;
    __pyx_v_component_index = (*((int *) ( /* dim=0 */ (__pyx_v_active_components.data + __pyx_t_7 * __pyx_v_active_components.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1168")'> 1168: </pre>
<pre id='line1168' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1169")'> 1169:             dihedral_atom_ids = self._get_dihedral_atom_ids(component_index)</pre>
<pre id='line1169' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1169
 *             component_index = active_components[factor_index]
 * 
 *             dihedral_atom_ids = self._get_dihedral_atom_ids(component_index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             coefficient = self._get_coefficient(component_index)
 */
    __pyx_v_dihedral_atom_ids = __pyx_f_17shift_calculators_30Fast_dihedral_shift_calculator__get_dihedral_atom_ids(__pyx_v_self, __pyx_v_component_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1170")'> 1170: </pre>
<pre id='line1170' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1171")'> 1171:             coefficient = self._get_coefficient(component_index)</pre>
<pre id='line1171' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1171
 *             dihedral_atom_ids = self._get_dihedral_atom_ids(component_index)
 * 
 *             coefficient = self._get_coefficient(component_index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             parameters = self._get_parameters(component_index)
 */
    __pyx_v_coefficient = __pyx_f_17shift_calculators_30Fast_dihedral_shift_calculator__get_coefficient(__pyx_v_self, __pyx_v_component_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1172")'> 1172: </pre>
<pre id='line1172' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1173")'> 1173:             parameters = self._get_parameters(component_index)</pre>
<pre id='line1173' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1173
 *             coefficient = self._get_coefficient(component_index)
 * 
 *             parameters = self._get_parameters(component_index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             angle = calc_dihedral_angle_simulation(self._simulation, dihedral_atom_ids)
 */
    __pyx_v_parameters = __pyx_f_17shift_calculators_30Fast_dihedral_shift_calculator__get_parameters(__pyx_v_self, __pyx_v_component_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1174")'> 1174: </pre>
<pre id='line1174' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1175")'> 1175:             angle = calc_dihedral_angle_simulation(self._simulation, dihedral_atom_ids)</pre>
<pre id='line1175' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1175
 *             parameters = self._get_parameters(component_index)
 * 
 *             angle = calc_dihedral_angle_simulation(self._simulation, dihedral_atom_ids)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             angle_term = parameters.param_0 * cos(3.0 * angle + parameters.param_1) + \
 */
    __pyx_v_angle = __pyx_f_17shift_calculators_calc_dihedral_angle_simulation(__pyx_v_self->__pyx_base._simulation, __pyx_v_dihedral_atom_ids);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1176")'> 1176: </pre>
<pre id='line1176' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1177")'> 1177:             angle_term = parameters.param_0 * cos(3.0 * angle + parameters.param_1) + \</pre>
<pre id='line1177' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1178")'> 1178:                          parameters.param_2 * cos(angle +  parameters.param_3) +      \</pre>
<pre id='line1178' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1179")'> 1179:                          parameters.param_4</pre>
<pre id='line1179' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1179
 *             angle_term = parameters.param_0 * cos(3.0 * angle + parameters.param_1) + \
 *                          parameters.param_2 * cos(angle +  parameters.param_3) +      \
 *                          parameters.param_4             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             shift = coefficient * angle_term
 * 
 */
    __pyx_v_angle_term = (((__pyx_v_parameters.param_0 * cos(((3.0 * __pyx_v_angle) + __pyx_v_parameters.param_1))) + (__pyx_v_parameters.param_2 * cos((__pyx_v_angle + __pyx_v_parameters.param_3)))) + __pyx_v_parameters.param_4);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1180")'> 1180:             shift = coefficient * angle_term</pre>
<pre id='line1180' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1180
 *                          parameters.param_2 * cos(angle +  parameters.param_3) +      \
 *                          parameters.param_4
 *             shift = coefficient * angle_term             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             offset = self.ensemble_array_offset(component_to_target[factor_index])
 */
    __pyx_v_shift = (__pyx_v_coefficient * __pyx_v_angle_term);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1181")'> 1181: </pre>
<pre id='line1181' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1182")'> 1182:             offset = self.ensemble_array_offset(component_to_target[factor_index])</pre>
<pre id='line1182' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1182
 *             shift = coefficient * angle_term
 * 
 *             offset = self.ensemble_array_offset(component_to_target[factor_index])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             shift_cache.addToResult(offset,shift)
 * 
 */
    __pyx_t_8 = __pyx_v_factor_index;
    __pyx_v_offset = __pyx_f_17shift_calculators_21Base_shift_calculator_ensemble_array_offset(((struct __pyx_obj_17shift_calculators_Base_shift_calculator *)__pyx_v_self), (*((int *) ( /* dim=0 */ (__pyx_v_component_to_target.data + __pyx_t_8 * __pyx_v_component_to_target.strides[0]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1183")'> 1183:             shift_cache.addToResult(offset,shift)</pre>
<pre id='line1183' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1183
 * 
 *             offset = self.ensemble_array_offset(component_to_target[factor_index])
 *             shift_cache.addToResult(offset,shift)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if self._verbose:
 */
    __pyx_f_17shift_calculators_20CDSSharedVectorFloat_addToResult(__pyx_v_shift_cache, __pyx_v_offset, __pyx_v_shift);
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1184")'> 1184: </pre>
<pre id='line1184' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1185")'> 1185:         if self._verbose:</pre>
<pre id='line1185' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1185
 *             shift_cache.addToResult(offset,shift)
 * 
 *         if self._verbose:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             end_time = time()
 *             print '   dihedral shift components ',len(components), 'in', "%.17g" %  (end_time-start_time), "seconds"
 */
  if (__pyx_v_self->__pyx_base._verbose) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line1186")'> 1186:             end_time = time()</pre>
<pre id='line1186' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":1186
 * 
 *         if self._verbose:
 *             end_time = time()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print '   dihedral shift components ',len(components), 'in', "%.17g" %  (end_time-start_time), "seconds"
 * 
 */
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__time);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_4, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_end_time = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF1c' onclick='toggleDiv("line1187")'> 1187:             print '   dihedral shift components ',len(components), 'in', "%.17g" %  (end_time-start_time), "seconds"</pre>
<pre id='line1187' class='code' style='background-color: #FFFF1c'>
    /* "Cython_shift_calculator.pyx":1187
 *         if self._verbose:
 *             end_time = time()
 *             print '   dihedral shift components ',len(components), 'in', "%.17g" %  (end_time-start_time), "seconds"             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef class Fast_ring_shift_calculator(Base_shift_calculator):
 */
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_components);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_end_time - __pyx_v_start_time));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_32), __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_33));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, ((PyObject *)__pyx_kp_s_33));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_33));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__in));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, ((PyObject *)__pyx_n_s__in));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__in));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 3, ((PyObject *)__pyx_t_2));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_2));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__seconds));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 4, ((PyObject *)__pyx_n_s__seconds));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__seconds));
    __pyx_t_1 = 0;
    __pyx_t_2 = 0;
    if (<span class='pyx_c_api'>__Pyx_Print</span>(0, ((PyObject *)__pyx_t_4), 1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    goto __pyx_L6;
  }
  __pyx_L6:;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_dihedral_shift_calculator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&__pyx_v_component_to_target, 1);
  __PYX_XDEC_MEMVIEW(&__pyx_v_active_components, 1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED PyObject *__pyx_v_simulation = 0;
  CYTHON_UNUSED PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__simulation,&__pyx_n_s__name,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject*)__pyx_kp_s_30);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__simulation)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1204; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_simulation = values[0];
    __pyx_v_name = ((PyObject*)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1204; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_shift_calculator.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&PyString_Type), 1, "name", 1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_shift_calculator___cinit__(((struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *)__pyx_v_self), __pyx_v_simulation, __pyx_v_name);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1188")'> 1188: </pre>
<pre id='line1188' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1189")'> 1189: cdef class Fast_ring_shift_calculator(Base_shift_calculator):</pre>
<pre id='line1189' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1189
 *             print '   dihedral shift components ',len(components), 'in', "%.17g" %  (end_time-start_time), "seconds"
 * 
 * cdef class Fast_ring_shift_calculator(Base_shift_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Vec3_list _centre_cache
 *     cdef Vec3_list _normal_cache
 */
struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator {
  struct __pyx_obj_17shift_calculators_Base_shift_calculator __pyx_base;
  struct __pyx_obj_17shift_calculators_Vec3_list *_centre_cache;
  struct __pyx_obj_17shift_calculators_Vec3_list *_normal_cache;
  struct __pyx_t_17shift_calculators_Ring_target_component *_compiled_components;
  int _num_components;
  PyObject *raw_data;
  struct __pyx_t_17shift_calculators_Ring_component *_compiled_ring_components;
  int _num_ring_components;
  PyObject *_raw_ring_component_data;
  struct __pyx_obj_17shift_calculators_Coef_components *_compiled_coef_components;
};


/* "Cython_shift_calculator.pyx":1189
 *             print '   dihedral shift components ',len(components), 'in', "%.17g" %  (end_time-start_time), "seconds"
 * 
 * cdef class Fast_ring_shift_calculator(Base_shift_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Vec3_list _centre_cache
 *     cdef Vec3_list _normal_cache
 */

struct __pyx_vtabstruct_17shift_calculators_Fast_ring_shift_calculator {
  struct __pyx_vtabstruct_17shift_calculators_Base_shift_calculator __pyx_base;
  void (*_bytes_to_ring_components)(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *, PyObject *);
  Vec3 *(*_get_ring_normal)(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *, int);
  Vec3 *(*_get_ring_centre)(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *, int);
  float (*_calc_sub_component_shift)(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *, int, int, float, int __pyx_skip_dispatch);
};
static struct __pyx_vtabstruct_17shift_calculators_Fast_ring_shift_calculator *__pyx_vtabptr_17shift_calculators_Fast_ring_shift_calculator;
static CYTHON_INLINE Vec3 *__pyx_f_17shift_calculators_26Fast_ring_shift_calculator__get_ring_normal(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *, int);
static CYTHON_INLINE Vec3 *__pyx_f_17shift_calculators_26Fast_ring_shift_calculator__get_ring_centre(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *, int);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1190")'> 1190:     cdef Vec3_list _centre_cache</pre>
<pre id='line1190' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1191")'> 1191:     cdef Vec3_list _normal_cache</pre>
<pre id='line1191' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1192")'> 1192: </pre>
<pre id='line1192' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1193")'> 1193:     cdef Ring_target_component* _compiled_components</pre>
<pre id='line1193' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1194")'> 1194:     cdef int _num_components</pre>
<pre id='line1194' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1195")'> 1195:     cdef object raw_data</pre>
<pre id='line1195' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1196")'> 1196: </pre>
<pre id='line1196' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1197")'> 1197:     cdef Ring_component* _compiled_ring_components</pre>
<pre id='line1197' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1198")'> 1198:     cdef int _num_ring_components</pre>
<pre id='line1198' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1199")'> 1199:     cdef object _raw_ring_component_data</pre>
<pre id='line1199' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1200")'> 1200: </pre>
<pre id='line1200' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1201")'> 1201: </pre>
<pre id='line1201' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1202")'> 1202:     cdef Coef_components _compiled_coef_components</pre>
<pre id='line1202' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1203")'> 1203: </pre>
<pre id='line1203' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1204")'> 1204:     def __cinit__(self, simulation, str name = "not set"):</pre>
<pre id='line1204' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1204
 *     cdef Coef_components _compiled_coef_components
 * 
 *     def __cinit__(self, simulation, str name = "not set"):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.raw_data = None
 *         self._compiled_components = NULL
 */

static int __pyx_pf_17shift_calculators_26Fast_ring_shift_calculator___cinit__(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_simulation, CYTHON_UNUSED PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1205")'> 1205:         self.raw_data = None</pre>
<pre id='line1205' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":1205
 * 
 *     def __cinit__(self, simulation, str name = "not set"):
 *         self.raw_data = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components = NULL
 *         self._num_components = 0
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->raw_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->raw_data);
  __pyx_v_self->raw_data = Py_None;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1206")'> 1206:         self._compiled_components = NULL</pre>
<pre id='line1206' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1206
 *     def __cinit__(self, simulation, str name = "not set"):
 *         self.raw_data = None
 *         self._compiled_components = NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components = 0
 * 
 */
  __pyx_v_self->_compiled_components = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1207")'> 1207:         self._num_components = 0</pre>
<pre id='line1207' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1207
 *         self.raw_data = None
 *         self._compiled_components = NULL
 *         self._num_components = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._compiled_ring_components = NULL
 */
  __pyx_v_self->_num_components = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1208")'> 1208: </pre>
<pre id='line1208' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1209")'> 1209:         self._compiled_ring_components = NULL</pre>
<pre id='line1209' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1209
 *         self._num_components = 0
 * 
 *         self._compiled_ring_components = NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_ring_components = 0
 *         self._raw_ring_component_data = None
 */
  __pyx_v_self->_compiled_ring_components = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1210")'> 1210:         self._num_ring_components = 0</pre>
<pre id='line1210' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1210
 * 
 *         self._compiled_ring_components = NULL
 *         self._num_ring_components = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._raw_ring_component_data = None
 * 
 */
  __pyx_v_self->_num_ring_components = 0;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1211")'> 1211:         self._raw_ring_component_data = None</pre>
<pre id='line1211' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":1211
 *         self._compiled_ring_components = NULL
 *         self._num_ring_components = 0
 *         self._raw_ring_component_data = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         #note this is not a raw array of structs it's a compiled python class
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_raw_ring_component_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_raw_ring_component_data);
  __pyx_v_self->_raw_ring_component_data = Py_None;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1212")'> 1212: </pre>
<pre id='line1212' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1213")'> 1213:         #note this is not a raw array of structs it's a compiled python class</pre>
<pre id='line1213' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1214")'> 1214:         self._compiled_coef_components = None</pre>
<pre id='line1214' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":1214
 * 
 *         #note this is not a raw array of structs it's a compiled python class
 *         self._compiled_coef_components = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._centre_cache = None
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_compiled_coef_components);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_compiled_coef_components));
  __pyx_v_self->_compiled_coef_components = ((struct __pyx_obj_17shift_calculators_Coef_components *)Py_None);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1215")'> 1215: </pre>
<pre id='line1215' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1216")'> 1216:         self._centre_cache = None</pre>
<pre id='line1216' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":1216
 *         self._compiled_coef_components = None
 * 
 *         self._centre_cache = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._normal_cache = None
 * 
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_centre_cache);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_centre_cache));
  __pyx_v_self->_centre_cache = ((struct __pyx_obj_17shift_calculators_Vec3_list *)Py_None);
</pre><pre class='line' style='background-color: #FFFF38' onclick='toggleDiv("line1217")'> 1217:         self._normal_cache = None</pre>
<pre id='line1217' class='code' style='background-color: #FFFF38'>
  /* "Cython_shift_calculator.pyx":1217
 * 
 *         self._centre_cache = None
 *         self._normal_cache = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __init__(self, simulation, str name = "not set"):
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_normal_cache);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_normal_cache));
  __pyx_v_self->_normal_cache = ((struct __pyx_obj_17shift_calculators_Vec3_list *)Py_None);

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_simulation = 0;
  PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__simulation,&__pyx_n_s__name,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject*)__pyx_kp_s_30);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__simulation)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1219; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_simulation = values[0];
    __pyx_v_name = ((PyObject*)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1219; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_shift_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&PyString_Type), 1, "name", 1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_shift_calculator_2__init__(((struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *)__pyx_v_self), __pyx_v_simulation, __pyx_v_name);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1218")'> 1218: </pre>
<pre id='line1218' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1219")'> 1219:     def __init__(self, simulation, str name = "not set"):</pre>
<pre id='line1219' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1219
 *         self._normal_cache = None
 * 
 *     def __init__(self, simulation, str name = "not set"):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         Base_shift_calculator.__init__(self,simulation, name)
 * 
 */

static int __pyx_pf_17shift_calculators_26Fast_ring_shift_calculator_2__init__(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *__pyx_v_self, PyObject *__pyx_v_simulation, PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line1220")'> 1220:         Base_shift_calculator.__init__(self,simulation, name)</pre>
<pre id='line1220' class='code' style='background-color: #FFFF3e'>
  /* "Cython_shift_calculator.pyx":1220
 * 
 *     def __init__(self, simulation, str name = "not set"):
 *         Base_shift_calculator.__init__(self,simulation, name)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def _bytes_to_components(self, data):
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Base_shift_calculator)), __pyx_n_s____init__);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1220; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1220; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simulation);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_simulation);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_simulation);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_name));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, ((PyObject *)__pyx_v_name));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_name));
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1220; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_shift_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_5_bytes_to_components(PyObject *__pyx_v_self, PyObject *__pyx_v_data); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_5_bytes_to_components(PyObject *__pyx_v_self, PyObject *__pyx_v_data) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_components (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_shift_calculator_4_bytes_to_components(((struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_data));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1221")'> 1221: </pre>
<pre id='line1221' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1222")'> 1222:     def _bytes_to_components(self, data):</pre>
<pre id='line1222' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1222
 *         Base_shift_calculator.__init__(self,simulation, name)
 * 
 *     def _bytes_to_components(self, data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.raw_data =  data
 *         self._compiled_components =  <code><</code>Ring_target_component*> <code><</code>size_t> ctypes.addressof(data)
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_ring_shift_calculator_4_bytes_to_components(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *__pyx_v_self, PyObject *__pyx_v_data) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_components", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1223")'> 1223:         self.raw_data =  data</pre>
<pre id='line1223' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":1223
 * 
 *     def _bytes_to_components(self, data):
 *         self.raw_data =  data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components =  <code><</code>Ring_target_component*> <code><</code>size_t> ctypes.addressof(data)
 *         self._num_components =  len(data)/ sizeof(Ring_target_component)
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->raw_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->raw_data);
  __pyx_v_self->raw_data = __pyx_v_data;
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line1224")'> 1224:         self._compiled_components =  &lt;Ring_target_component*&gt; &lt;size_t&gt; ctypes.addressof(data)</pre>
<pre id='line1224' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":1224
 *     def _bytes_to_components(self, data):
 *         self.raw_data =  data
 *         self._compiled_components =  <code><</code>Ring_target_component*> <code><</code>size_t> ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components =  len(data)/ sizeof(Ring_target_component)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_self->_compiled_components = ((struct __pyx_t_17shift_calculators_Ring_target_component *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line1225")'> 1225:         self._num_components =  len(data)/ sizeof(Ring_target_component)</pre>
<pre id='line1225' class='code' style='background-color: #FFFF6e'>
  /* "Cython_shift_calculator.pyx":1225
 *         self.raw_data =  data
 *         self._compiled_components =  <code><</code>Ring_target_component*> <code><</code>size_t> ctypes.addressof(data)
 *         self._num_components =  len(data)/ sizeof(Ring_target_component)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_num_components = (__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Ring_target_component)));

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_shift_calculator._bytes_to_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_7_set_normal_cache(PyObject *__pyx_v_self, PyObject *__pyx_v_normals); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_7_set_normal_cache(PyObject *__pyx_v_self, PyObject *__pyx_v_normals) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_normal_cache (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_shift_calculator_6_set_normal_cache(((struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_normals));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1226")'> 1226: </pre>
<pre id='line1226' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1227")'> 1227: </pre>
<pre id='line1227' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1228")'> 1228: </pre>
<pre id='line1228' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1229")'> 1229: </pre>
<pre id='line1229' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1230")'> 1230: </pre>
<pre id='line1230' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1231")'> 1231:     def _set_normal_cache(self,normals):</pre>
<pre id='line1231' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1231
 * 
 * 
 *     def _set_normal_cache(self,normals):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._normal_cache = <code><</code>Vec3_list> normals
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_ring_shift_calculator_6_set_normal_cache(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *__pyx_v_self, PyObject *__pyx_v_normals) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_normal_cache", 0);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1232")'> 1232:         self._normal_cache = &lt;Vec3_list&gt; normals</pre>
<pre id='line1232' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":1232
 * 
 *     def _set_normal_cache(self,normals):
 *         self._normal_cache = <code><</code>Vec3_list> normals             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def _set_centre_cache(self,centres):
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)((struct __pyx_obj_17shift_calculators_Vec3_list *)__pyx_v_normals)));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_normals);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_normal_cache);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_normal_cache));
  __pyx_v_self->_normal_cache = ((struct __pyx_obj_17shift_calculators_Vec3_list *)__pyx_v_normals);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_9_set_centre_cache(PyObject *__pyx_v_self, PyObject *__pyx_v_centres); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_9_set_centre_cache(PyObject *__pyx_v_self, PyObject *__pyx_v_centres) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_centre_cache (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_shift_calculator_8_set_centre_cache(((struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_centres));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1233")'> 1233: </pre>
<pre id='line1233' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1234")'> 1234:     def _set_centre_cache(self,centres):</pre>
<pre id='line1234' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1234
 *         self._normal_cache = <code><</code>Vec3_list> normals
 * 
 *     def _set_centre_cache(self,centres):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._centre_cache = <code><</code>Vec3_list> centres
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_ring_shift_calculator_8_set_centre_cache(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *__pyx_v_self, PyObject *__pyx_v_centres) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_centre_cache", 0);
</pre><pre class='line' style='background-color: #FFFF37' onclick='toggleDiv("line1235")'> 1235:         self._centre_cache = &lt;Vec3_list&gt; centres</pre>
<pre id='line1235' class='code' style='background-color: #FFFF37'>
  /* "Cython_shift_calculator.pyx":1235
 * 
 *     def _set_centre_cache(self,centres):
 *         self._centre_cache = <code><</code>Vec3_list> centres             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def _set_coef_components(self,coef_components, component_offsets):
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)((struct __pyx_obj_17shift_calculators_Vec3_list *)__pyx_v_centres)));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_centres);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_centre_cache);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_centre_cache));
  __pyx_v_self->_centre_cache = ((struct __pyx_obj_17shift_calculators_Vec3_list *)__pyx_v_centres);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_11_set_coef_components(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_11_set_coef_components(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_coef_components = 0;
  PyObject *__pyx_v_component_offsets = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_coef_components (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__coef_components,&__pyx_n_s__component_offsets,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__coef_components)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__component_offsets)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_set_coef_components", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1237; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_set_coef_components") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1237; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_coef_components = values[0];
    __pyx_v_component_offsets = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_set_coef_components", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1237; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_shift_calculator._set_coef_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_shift_calculator_10_set_coef_components(((struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *)__pyx_v_self), __pyx_v_coef_components, __pyx_v_component_offsets);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1236")'> 1236: </pre>
<pre id='line1236' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1237")'> 1237:     def _set_coef_components(self,coef_components, component_offsets):</pre>
<pre id='line1237' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1237
 *         self._centre_cache = <code><</code>Vec3_list> centres
 * 
 *     def _set_coef_components(self,coef_components, component_offsets):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_coef_components = Coef_components(coef_components, component_offsets)
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_ring_shift_calculator_10_set_coef_components(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *__pyx_v_self, PyObject *__pyx_v_coef_components, PyObject *__pyx_v_component_offsets) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_coef_components", 0);
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line1238")'> 1238:         self._compiled_coef_components = Coef_components(coef_components, component_offsets)</pre>
<pre id='line1238' class='code' style='background-color: #FFFF4f'>
  /* "Cython_shift_calculator.pyx":1238
 * 
 *     def _set_coef_components(self,coef_components, component_offsets):
 *         self._compiled_coef_components = Coef_components(coef_components, component_offsets)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void _bytes_to_ring_components(self, data):
 */
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1238; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_coef_components);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_coef_components);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_coef_components);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_component_offsets);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_component_offsets);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_component_offsets);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Coef_components)), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1238; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_compiled_coef_components);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_compiled_coef_components));
  __pyx_v_self->_compiled_coef_components = ((struct __pyx_obj_17shift_calculators_Coef_components *)__pyx_t_2);
  __pyx_t_2 = 0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_shift_calculator._set_coef_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1239")'> 1239: </pre>
<pre id='line1239' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1240")'> 1240:     cdef void _bytes_to_ring_components(self, data):</pre>
<pre id='line1240' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1240
 *         self._compiled_coef_components = Coef_components(coef_components, component_offsets)
 * 
 *     cdef void _bytes_to_ring_components(self, data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._raw_ring_component_data =  data
 *         self._compiled_ring_components =  <code><</code>Ring_component*> <code><</code>size_t> ctypes.addressof(data)
 */

static void __pyx_f_17shift_calculators_26Fast_ring_shift_calculator__bytes_to_ring_components(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *__pyx_v_self, PyObject *__pyx_v_data) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_ring_components", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1241")'> 1241:         self._raw_ring_component_data =  data</pre>
<pre id='line1241' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":1241
 * 
 *     cdef void _bytes_to_ring_components(self, data):
 *         self._raw_ring_component_data =  data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_ring_components =  <code><</code>Ring_component*> <code><</code>size_t> ctypes.addressof(data)
 *         self._num_ring_components =  len(data)/ sizeof(Ring_component)
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_raw_ring_component_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_raw_ring_component_data);
  __pyx_v_self->_raw_ring_component_data = __pyx_v_data;
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line1242")'> 1242:         self._compiled_ring_components =  &lt;Ring_component*&gt; &lt;size_t&gt; ctypes.addressof(data)</pre>
<pre id='line1242' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":1242
 *     cdef void _bytes_to_ring_components(self, data):
 *         self._raw_ring_component_data =  data
 *         self._compiled_ring_components =  <code><</code>Ring_component*> <code><</code>size_t> ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_ring_components =  len(data)/ sizeof(Ring_component)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_self->_compiled_ring_components = ((struct __pyx_t_17shift_calculators_Ring_component *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line1243")'> 1243:         self._num_ring_components =  len(data)/ sizeof(Ring_component)</pre>
<pre id='line1243' class='code' style='background-color: #FFFF73'>
  /* "Cython_shift_calculator.pyx":1243
 *         self._raw_ring_component_data =  data
 *         self._compiled_ring_components =  <code><</code>Ring_component*> <code><</code>size_t> ctypes.addressof(data)
 *         self._num_ring_components =  len(data)/ sizeof(Ring_component)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_num_ring_components = (__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Ring_component)));

  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Fast_ring_shift_calculator._bytes_to_ring_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_13_set_ring_components(PyObject *__pyx_v_self, PyObject *__pyx_v_ring_components); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_13_set_ring_components(PyObject *__pyx_v_self, PyObject *__pyx_v_ring_components) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_ring_components (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_shift_calculator_12_set_ring_components(((struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_ring_components));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1244")'> 1244: </pre>
<pre id='line1244' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1245")'> 1245: </pre>
<pre id='line1245' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1246")'> 1246:     #TODO: not needed ?</pre>
<pre id='line1246' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1247")'> 1247:     def _set_ring_components(self,ring_components):</pre>
<pre id='line1247' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1247
 * 
 *     #TODO: not needed ?
 *     def _set_ring_components(self,ring_components):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self. _bytes_to_ring_components(ring_components)
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_ring_shift_calculator_12_set_ring_components(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *__pyx_v_self, PyObject *__pyx_v_ring_components) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_ring_components", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1248")'> 1248:         self. _bytes_to_ring_components(ring_components)</pre>
<pre id='line1248' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":1248
 *     #TODO: not needed ?
 *     def _set_ring_components(self,ring_components):
 *         self. _bytes_to_ring_components(ring_components)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  ((struct __pyx_vtabstruct_17shift_calculators_Fast_ring_shift_calculator *)__pyx_v_self->__pyx_base.__pyx_vtab)->_bytes_to_ring_components(__pyx_v_self, __pyx_v_ring_components);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1249")'> 1249: </pre>
<pre id='line1249' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1250")'> 1250: </pre>
<pre id='line1250' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1251")'> 1251: </pre>
<pre id='line1251' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1252")'> 1252:     @cython.profile(False)</pre>
<pre id='line1252' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1253")'> 1253:     cdef inline Vec3* _get_ring_normal(self, int ring_id):</pre>
<pre id='line1253' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1253
 * 
 *     @cython.profile(False)
 *     cdef inline Vec3* _get_ring_normal(self, int ring_id):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return  self._normal_cache.get(ring_id)
 * 
 */

static CYTHON_INLINE Vec3 *__pyx_f_17shift_calculators_26Fast_ring_shift_calculator__get_ring_normal(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *__pyx_v_self, int __pyx_v_ring_id) {
  Vec3 *__pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_get_ring_normal", 0);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1254")'> 1254:         return  self._normal_cache.get(ring_id)</pre>
<pre id='line1254' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":1254
 *     @cython.profile(False)
 *     cdef inline Vec3* _get_ring_normal(self, int ring_id):
 *         return  self._normal_cache.get(ring_id)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     @cython.profile(False)
 */
  __pyx_r = __pyx_f_17shift_calculators_9Vec3_list_get(__pyx_v_self->_normal_cache, __pyx_v_ring_id);
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1255")'> 1255: </pre>
<pre id='line1255' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1256")'> 1256:     @cython.profile(False)</pre>
<pre id='line1256' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1257")'> 1257:     cdef inline Vec3* _get_ring_centre(self, int ring_id):</pre>
<pre id='line1257' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1257
 * 
 *     @cython.profile(False)
 *     cdef inline Vec3* _get_ring_centre(self, int ring_id):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return  self._centre_cache.get(ring_id)
 * 
 */

static CYTHON_INLINE Vec3 *__pyx_f_17shift_calculators_26Fast_ring_shift_calculator__get_ring_centre(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *__pyx_v_self, int __pyx_v_ring_id) {
  Vec3 *__pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_get_ring_centre", 0);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1258")'> 1258:         return  self._centre_cache.get(ring_id)</pre>
<pre id='line1258' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":1258
 *     @cython.profile(False)
 *     cdef inline Vec3* _get_ring_centre(self, int ring_id):
 *         return  self._centre_cache.get(ring_id)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cpdef float  _calc_sub_component_shift(self, int target_atom_id, int ring_id, float coefficient):
 */
  __pyx_r = __pyx_f_17shift_calculators_9Vec3_list_get(__pyx_v_self->_centre_cache, __pyx_v_ring_id);
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1259")'> 1259: </pre>
<pre id='line1259' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF14' onclick='toggleDiv("line1260")'> 1260:     cpdef float  _calc_sub_component_shift(self, int target_atom_id, int ring_id, float coefficient):</pre>
<pre id='line1260' class='code' style='background-color: #FFFF14'>
/* "Cython_shift_calculator.pyx":1260
 *         return  self._centre_cache.get(ring_id)
 * 
 *     cpdef float  _calc_sub_component_shift(self, int target_atom_id, int ring_id, float coefficient):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Vec3 target_atom_pos
 */

static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_15_calc_sub_component_shift(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static float __pyx_f_17shift_calculators_26Fast_ring_shift_calculator__calc_sub_component_shift(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *__pyx_v_self, int __pyx_v_target_atom_id, int __pyx_v_ring_id, float __pyx_v_coefficient, int __pyx_skip_dispatch) {
  Vec3 __pyx_v_target_atom_pos;
  Vec3 __pyx_v_ring_centre;
  Vec3 __pyx_v_ring_normal;
  Vec3 __pyx_v_direction_vector;
  float __pyx_v_distance;
  float __pyx_v_distance3;
  float __pyx_v_angle;
  float __pyx_v_contrib;
  PyObject *__pyx_v_length_normal = NULL;
  float __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calc_sub_component_shift", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_34);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_15_calc_sub_component_shift)) {
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_target_atom_id);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_ring_id);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_coefficient);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_3);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_t_4);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
      __pyx_t_2 = 0;
      __pyx_t_3 = 0;
      __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
      __pyx_t_6 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_6 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_r = __pyx_t_6;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }

/* "Cython_shift_calculator.pyx":1260
 *         return  self._centre_cache.get(ring_id)
 * 
 *     cpdef float  _calc_sub_component_shift(self, int target_atom_id, int ring_id, float coefficient):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Vec3 target_atom_pos
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_ring_shift_calculator_14_calc_sub_component_shift(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *__pyx_v_self, int __pyx_v_target_atom_id, int __pyx_v_ring_id, float __pyx_v_coefficient) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calc_sub_component_shift", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((struct __pyx_vtabstruct_17shift_calculators_Fast_ring_shift_calculator *)__pyx_v_self->__pyx_base.__pyx_vtab)->_calc_sub_component_shift(__pyx_v_self, __pyx_v_target_atom_id, __pyx_v_ring_id, __pyx_v_coefficient, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_shift_calculator._calc_sub_component_shift", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_17__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_17__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_components = 0;
  struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_shift_cache = 0;
  __Pyx_memviewslice __pyx_v_component_to_target = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_active_components = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__call__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__components,&__pyx_n_s__shift_cache,&__pyx_n_s__component_to_target,&__pyx_n_s__active_components,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__components)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__shift_cache)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 4, 4, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1288; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__component_to_target)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 4, 4, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1288; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__active_components)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 4, 4, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1288; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__call__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1288; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_components = values[0];
    __pyx_v_shift_cache = ((struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *)values[1]);
    __pyx_v_component_to_target = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[2]);<span class='error_goto'> if (unlikely(!__pyx_v_component_to_target.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1288; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_active_components = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[3]);<span class='error_goto'> if (unlikely(!__pyx_v_active_components.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1288; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1288; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_shift_calculator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_shift_cache), __pyx_ptype_17shift_calculators_CDSSharedVectorFloat, 1, "shift_cache", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1288; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_shift_calculator_16__call__(((struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *)__pyx_v_self), __pyx_v_components, __pyx_v_shift_cache, __pyx_v_component_to_target, __pyx_v_active_components);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1261")'> 1261: </pre>
<pre id='line1261' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1262")'> 1262:         cdef Vec3 target_atom_pos</pre>
<pre id='line1262' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1263")'> 1263:         cdef Vec3 ring_centre</pre>
<pre id='line1263' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1264")'> 1264:         cdef Vec3 ring_normal</pre>
<pre id='line1264' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1265")'> 1265:         cdef float lenght_normal</pre>
<pre id='line1265' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1266")'> 1266:         cdef Vec3 direction_vector</pre>
<pre id='line1266' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1267")'> 1267:         cdef float distance, distance3, angle, contrib</pre>
<pre id='line1267' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1268")'> 1268: </pre>
<pre id='line1268' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1269")'> 1269:         target_atom_pos =  self._simulation[0].atomPos(target_atom_id)</pre>
<pre id='line1269' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1269
 *         cdef float distance, distance3, angle, contrib
 * 
 *         target_atom_pos =  self._simulation[0].atomPos(target_atom_id)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         ring_centre = self._get_ring_centre(ring_id)[0]
 * 
 */
  __pyx_v_target_atom_pos = (__pyx_v_self->__pyx_base._simulation[0]).atomPos(__pyx_v_target_atom_id);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1270")'> 1270:         ring_centre = self._get_ring_centre(ring_id)[0]</pre>
<pre id='line1270' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1270
 * 
 *         target_atom_pos =  self._simulation[0].atomPos(target_atom_id)
 *         ring_centre = self._get_ring_centre(ring_id)[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         #TODO add this to a cache the same way that camshift does
 */
  __pyx_v_ring_centre = (__pyx_f_17shift_calculators_26Fast_ring_shift_calculator__get_ring_centre(__pyx_v_self, __pyx_v_ring_id)[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1271")'> 1271: </pre>
<pre id='line1271' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1272")'> 1272:         #TODO add this to a cache the same way that camshift does</pre>
<pre id='line1272' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1273")'> 1273:         ring_normal = self._get_ring_normal(ring_id)[0]</pre>
<pre id='line1273' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1273
 * 
 *         #TODO add this to a cache the same way that camshift does
 *         ring_normal = self._get_ring_normal(ring_id)[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         length_normal = norm(ring_normal)
 * 
 */
  __pyx_v_ring_normal = (__pyx_f_17shift_calculators_26Fast_ring_shift_calculator__get_ring_normal(__pyx_v_self, __pyx_v_ring_id)[0]);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1274")'> 1274:         length_normal = norm(ring_normal)</pre>
<pre id='line1274' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":1274
 *         #TODO add this to a cache the same way that camshift does
 *         ring_normal = self._get_ring_normal(ring_id)[0]
 *         length_normal = norm(ring_normal)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         #correct name?
 */
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(norm(__pyx_v_ring_normal));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_length_normal = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1275")'> 1275: </pre>
<pre id='line1275' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1276")'> 1276:         #correct name?</pre>
<pre id='line1276' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1277")'> 1277:         direction_vector = target_atom_pos - ring_centre</pre>
<pre id='line1277' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1277
 * 
 *         #correct name?
 *         direction_vector = target_atom_pos - ring_centre             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         distance = norm(direction_vector)
 */
  __pyx_v_direction_vector = (__pyx_v_target_atom_pos - __pyx_v_ring_centre);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1278")'> 1278: </pre>
<pre id='line1278' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1279")'> 1279:         distance = norm(direction_vector)</pre>
<pre id='line1279' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1279
 *         direction_vector = target_atom_pos - ring_centre
 * 
 *         distance = norm(direction_vector)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         distance3 = distance ** 3
 * 
 */
  __pyx_v_distance = norm(__pyx_v_direction_vector);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1280")'> 1280:         distance3 = distance ** 3</pre>
<pre id='line1280' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1280
 * 
 *         distance = norm(direction_vector)
 *         distance3 = distance ** 3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         angle = dot(direction_vector, ring_normal) / (distance * length_normal)
 */
  __pyx_v_distance3 = powf(__pyx_v_distance, 3.0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1281")'> 1281: </pre>
<pre id='line1281' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF39' onclick='toggleDiv("line1282")'> 1282:         angle = dot(direction_vector, ring_normal) / (distance * length_normal)</pre>
<pre id='line1282' class='code' style='background-color: #FFFF39'>
  /* "Cython_shift_calculator.pyx":1282
 *         distance3 = distance ** 3
 * 
 *         angle = dot(direction_vector, ring_normal) / (distance * length_normal)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         contrib = (1.0 - 3.0 * angle ** 2) / distance3
 * 
 */
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(dot(__pyx_v_direction_vector, __pyx_v_ring_normal));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_distance);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_v_length_normal);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_6 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_6 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_angle = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1283")'> 1283:         contrib = (1.0 - 3.0 * angle ** 2) / distance3</pre>
<pre id='line1283' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1283
 * 
 *         angle = dot(direction_vector, ring_normal) / (distance * length_normal)
 *         contrib = (1.0 - 3.0 * angle ** 2) / distance3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         return contrib * coefficient
 */
  __pyx_v_contrib = ((1.0 - (3.0 * powf(__pyx_v_angle, 2.0))) / __pyx_v_distance3);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1284")'> 1284: </pre>
<pre id='line1284' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF1c' onclick='toggleDiv("line1285")'> 1285:         return contrib * coefficient</pre>
<pre id='line1285' class='code' style='background-color: #FFFF1c'>
  /* "Cython_shift_calculator.pyx":1285
 *         contrib = (1.0 - 3.0 * angle ** 2) / distance3
 * 
 *         return contrib * coefficient             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     @cython.profile(True)
 */
  __pyx_r = (__pyx_v_contrib * __pyx_v_coefficient);
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Fast_ring_shift_calculator._calc_sub_component_shift", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_length_normal);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_15_calc_sub_component_shift(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_shift_calculator_15_calc_sub_component_shift(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_target_atom_id;
  int __pyx_v_ring_id;
  float __pyx_v_coefficient;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calc_sub_component_shift (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__target_atom_id,&__pyx_n_s__ring_id,&__pyx_n_s__coefficient,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__target_atom_id)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__ring_id)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calc_sub_component_shift", 1, 3, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1260; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__coefficient)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calc_sub_component_shift", 1, 3, 3, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1260; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_calc_sub_component_shift") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1260; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_target_atom_id = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_target_atom_id == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1260; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_ring_id = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_ring_id == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1260; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_coefficient = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_coefficient == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1260; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calc_sub_component_shift", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1260; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_shift_calculator._calc_sub_component_shift", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_shift_calculator_14_calc_sub_component_shift(((struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *)__pyx_v_self), __pyx_v_target_atom_id, __pyx_v_ring_id, __pyx_v_coefficient);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1286")'> 1286: </pre>
<pre id='line1286' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1287")'> 1287:     @cython.profile(True)</pre>
<pre id='line1287' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1288")'> 1288:     def __call__(self, object components, CDSSharedVectorFloat shift_cache, int[:] component_to_target, int[:] active_components):</pre>
<pre id='line1288' class='code' style='background-color: #FFFFd4'>
/* "Cython_shift_calculator.pyx":1288
 * 
 *     @cython.profile(True)
 *     def __call__(self, object components, CDSSharedVectorFloat shift_cache, int[:] component_to_target, int[:] active_components):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef int target_atom_id
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_ring_shift_calculator_16__call__(struct __pyx_obj_17shift_calculators_Fast_ring_shift_calculator *__pyx_v_self, PyObject *__pyx_v_components, struct __pyx_obj_17shift_calculators_CDSSharedVectorFloat *__pyx_v_shift_cache, __Pyx_memviewslice __pyx_v_component_to_target, __Pyx_memviewslice __pyx_v_active_components) {
  int __pyx_v_target_atom_id;
  int __pyx_v_atom_type_id;
  int __pyx_v_ring_id;
  float __pyx_v_coefficient;
  double __pyx_v_start_time;
  double __pyx_v_end_time;
  struct __pyx_t_17shift_calculators_Component_Offsets *__pyx_v_coeff_offset;
  struct __pyx_t_17shift_calculators_Coef_component *__pyx_v_coef_component;
  int __pyx_v_factor_index;
  int __pyx_v_component_index;
  int __pyx_v_offset;
  double __pyx_v_shift;
  int __pyx_v_coef_offset;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__call__", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("__call__", __pyx_f[0], 1288);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1289")'> 1289: </pre>
<pre id='line1289' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1290")'> 1290:         cdef int target_atom_id</pre>
<pre id='line1290' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1291")'> 1291:         cdef int atom_type_id</pre>
<pre id='line1291' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1292")'> 1292:         cdef int ring_id</pre>
<pre id='line1292' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1293")'> 1293:         cdef float coefficient</pre>
<pre id='line1293' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1294")'> 1294:         cdef double start_time = 0.0</pre>
<pre id='line1294' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1294
 *         cdef int ring_id
 *         cdef float coefficient
 *         cdef double start_time = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef double end_time =0.0
 *         cdef Component_Offsets* coeff_offset
 */
  __pyx_v_start_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1295")'> 1295:         cdef double end_time =0.0</pre>
<pre id='line1295' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1295
 *         cdef float coefficient
 *         cdef double start_time = 0.0
 *         cdef double end_time =0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Component_Offsets* coeff_offset
 *         cdef Coef_component* coef_component
 */
  __pyx_v_end_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1296")'> 1296:         cdef Component_Offsets* coeff_offset</pre>
<pre id='line1296' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1297")'> 1297:         cdef Coef_component* coef_component</pre>
<pre id='line1297' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1298")'> 1298: </pre>
<pre id='line1298' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1299")'> 1299:         if self._verbose:</pre>
<pre id='line1299' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1299
 *         cdef Coef_component* coef_component
 * 
 *         if self._verbose:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             start_time = time()
 * 
 */
  if (__pyx_v_self->__pyx_base._verbose) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line1300")'> 1300:             start_time = time()</pre>
<pre id='line1300' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":1300
 * 
 *         if self._verbose:
 *             start_time = time()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__time);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_start_time = __pyx_t_3;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1301")'> 1301: </pre>
<pre id='line1301' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1302")'> 1302: </pre>
<pre id='line1302' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1303")'> 1303: </pre>
<pre id='line1303' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line1304")'> 1304:         self._set_components(components)</pre>
<pre id='line1304' class='code' style='background-color: #FFFF55'>
  /* "Cython_shift_calculator.pyx":1304
 * 
 * 
 *         self._set_components(components)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef int factor_index
 */
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s___set_components);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_components);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_components);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_components);
  __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1305")'> 1305: </pre>
<pre id='line1305' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1306")'> 1306:         cdef int factor_index</pre>
<pre id='line1306' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1307")'> 1307:         cdef int component_index</pre>
<pre id='line1307' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1308")'> 1308:         cdef int offset</pre>
<pre id='line1308' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1309")'> 1309: </pre>
<pre id='line1309' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line1310")'> 1310:         for factor_index in range(len(active_components)):</pre>
<pre id='line1310' class='code' style='background-color: #FFFF9f'>
  /* "Cython_shift_calculator.pyx":1310
 *         cdef int offset
 * 
 *         for factor_index in range(len(active_components)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             component_index = active_components[factor_index]
 * 
 */
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_active_components, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  for (__pyx_t_6 = 0; __pyx_t_6 <code><</code> __pyx_t_5; __pyx_t_6+=1) {
    __pyx_v_factor_index = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1311")'> 1311:             component_index = active_components[factor_index]</pre>
<pre id='line1311' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1311
 * 
 *         for factor_index in range(len(active_components)):
 *             component_index = active_components[factor_index]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             target_atom_id = self._compiled_components[component_index].target_atom_id
 */
    __pyx_t_7 = __pyx_v_factor_index;
    __pyx_v_component_index = (*((int *) ( /* dim=0 */ (__pyx_v_active_components.data + __pyx_t_7 * __pyx_v_active_components.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1312")'> 1312: </pre>
<pre id='line1312' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1313")'> 1313:             target_atom_id = self._compiled_components[component_index].target_atom_id</pre>
<pre id='line1313' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1313
 *             component_index = active_components[factor_index]
 * 
 *             target_atom_id = self._compiled_components[component_index].target_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             atom_type_id = self._compiled_components[component_index].atom_type_id
 * 
 */
    __pyx_t_8 = (__pyx_v_self->_compiled_components[__pyx_v_component_index]).target_atom_id;
    __pyx_v_target_atom_id = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1314")'> 1314:             atom_type_id = self._compiled_components[component_index].atom_type_id</pre>
<pre id='line1314' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1314
 * 
 *             target_atom_id = self._compiled_components[component_index].target_atom_id
 *             atom_type_id = self._compiled_components[component_index].atom_type_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             shift = 0.0
 */
    __pyx_t_8 = (__pyx_v_self->_compiled_components[__pyx_v_component_index]).atom_type_id;
    __pyx_v_atom_type_id = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1315")'> 1315: </pre>
<pre id='line1315' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1316")'> 1316:             shift = 0.0</pre>
<pre id='line1316' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1316
 *             atom_type_id = self._compiled_components[component_index].atom_type_id
 * 
 *             shift = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             coeff_offset =  self._compiled_coef_components.get_id_offsets(atom_type_id)
 */
    __pyx_v_shift = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1317")'> 1317: </pre>
<pre id='line1317' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1318")'> 1318:             coeff_offset =  self._compiled_coef_components.get_id_offsets(atom_type_id)</pre>
<pre id='line1318' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1318
 *             shift = 0.0
 * 
 *             coeff_offset =  self._compiled_coef_components.get_id_offsets(atom_type_id)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             for coef_offset in range(coeff_offset[0].offset,coeff_offset[0].offset+coeff_offset[0].length):
 */
    __pyx_v_coeff_offset = __pyx_f_17shift_calculators_15Coef_components_get_id_offsets(__pyx_v_self->_compiled_coef_components, __pyx_v_atom_type_id);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1319")'> 1319: </pre>
<pre id='line1319' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1320")'> 1320:             for coef_offset in range(coeff_offset[0].offset,coeff_offset[0].offset+coeff_offset[0].length):</pre>
<pre id='line1320' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1320
 *             coeff_offset =  self._compiled_coef_components.get_id_offsets(atom_type_id)
 * 
 *             for coef_offset in range(coeff_offset[0].offset,coeff_offset[0].offset+coeff_offset[0].length):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #                TODO: remove magic numbers or add structs
 *                 coef_component = self._compiled_coef_components.get_component(coef_offset)
 */
    __pyx_t_8 = ((__pyx_v_coeff_offset[0]).offset + (__pyx_v_coeff_offset[0]).length);
    for (__pyx_t_9 = (__pyx_v_coeff_offset[0]).offset; __pyx_t_9 <code><</code> __pyx_t_8; __pyx_t_9+=1) {
      __pyx_v_coef_offset = __pyx_t_9;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1321")'> 1321: #                TODO: remove magic numbers or add structs</pre>
<pre id='line1321' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1322")'> 1322:                 coef_component = self._compiled_coef_components.get_component(coef_offset)</pre>
<pre id='line1322' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1322
 *             for coef_offset in range(coeff_offset[0].offset,coeff_offset[0].offset+coeff_offset[0].length):
 * #                TODO: remove magic numbers or add structs
 *                 coef_component = self._compiled_coef_components.get_component(coef_offset)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 ring_id = coef_component[0].ring_id
 */
      __pyx_v_coef_component = __pyx_f_17shift_calculators_15Coef_components_get_component(__pyx_v_self->_compiled_coef_components, __pyx_v_coef_offset);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1323")'> 1323: </pre>
<pre id='line1323' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1324")'> 1324:                 ring_id = coef_component[0].ring_id</pre>
<pre id='line1324' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1324
 *                 coef_component = self._compiled_coef_components.get_component(coef_offset)
 * 
 *                 ring_id = coef_component[0].ring_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 coefficient = coef_component[0].coefficient
 *                 shift += self._calc_sub_component_shift(target_atom_id,  ring_id, coefficient)
 */
      __pyx_t_10 = (__pyx_v_coef_component[0]).ring_id;
      __pyx_v_ring_id = __pyx_t_10;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1325")'> 1325:                 coefficient = coef_component[0].coefficient</pre>
<pre id='line1325' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1325
 * 
 *                 ring_id = coef_component[0].ring_id
 *                 coefficient = coef_component[0].coefficient             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 shift += self._calc_sub_component_shift(target_atom_id,  ring_id, coefficient)
 * 
 */
      __pyx_t_11 = (__pyx_v_coef_component[0]).coefficient;
      __pyx_v_coefficient = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1326")'> 1326:                 shift += self._calc_sub_component_shift(target_atom_id,  ring_id, coefficient)</pre>
<pre id='line1326' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1326
 *                 ring_id = coef_component[0].ring_id
 *                 coefficient = coef_component[0].coefficient
 *                 shift += self._calc_sub_component_shift(target_atom_id,  ring_id, coefficient)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             offset = self.ensemble_array_offset(component_to_target[factor_index])
 */
      __pyx_v_shift = (__pyx_v_shift + ((struct __pyx_vtabstruct_17shift_calculators_Fast_ring_shift_calculator *)__pyx_v_self->__pyx_base.__pyx_vtab)->_calc_sub_component_shift(__pyx_v_self, __pyx_v_target_atom_id, __pyx_v_ring_id, __pyx_v_coefficient, 0));
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1327")'> 1327: </pre>
<pre id='line1327' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1328")'> 1328:             offset = self.ensemble_array_offset(component_to_target[factor_index])</pre>
<pre id='line1328' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1328
 *                 shift += self._calc_sub_component_shift(target_atom_id,  ring_id, coefficient)
 * 
 *             offset = self.ensemble_array_offset(component_to_target[factor_index])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             shift_cache.addToResult(offset,shift)
 * 
 */
    __pyx_t_8 = __pyx_v_factor_index;
    __pyx_v_offset = __pyx_f_17shift_calculators_21Base_shift_calculator_ensemble_array_offset(((struct __pyx_obj_17shift_calculators_Base_shift_calculator *)__pyx_v_self), (*((int *) ( /* dim=0 */ (__pyx_v_component_to_target.data + __pyx_t_8 * __pyx_v_component_to_target.strides[0]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1329")'> 1329:             shift_cache.addToResult(offset,shift)</pre>
<pre id='line1329' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1329
 * 
 *             offset = self.ensemble_array_offset(component_to_target[factor_index])
 *             shift_cache.addToResult(offset,shift)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if self._verbose:
 */
    __pyx_f_17shift_calculators_20CDSSharedVectorFloat_addToResult(__pyx_v_shift_cache, __pyx_v_offset, __pyx_v_shift);
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1330")'> 1330: </pre>
<pre id='line1330' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1331")'> 1331:         if self._verbose:</pre>
<pre id='line1331' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1331
 *             shift_cache.addToResult(offset,shift)
 * 
 *         if self._verbose:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             end_time = time()
 *             print '   ring shift components ' ,self._name,len(components), 'in', "%.17g" %  (end_time-start_time), "seconds"
 */
  if (__pyx_v_self->__pyx_base._verbose) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line1332")'> 1332:             end_time = time()</pre>
<pre id='line1332' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":1332
 * 
 *         if self._verbose:
 *             end_time = time()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print '   ring shift components ' ,self._name,len(components), 'in', "%.17g" %  (end_time-start_time), "seconds"
 * 
 */
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__time);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_4, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_end_time = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF1f' onclick='toggleDiv("line1333")'> 1333:             print '   ring shift components ' ,self._name,len(components), 'in', "%.17g" %  (end_time-start_time), "seconds"</pre>
<pre id='line1333' class='code' style='background-color: #FFFF1f'>
    /* "Cython_shift_calculator.pyx":1333
 *         if self._verbose:
 *             end_time = time()
 *             print '   ring shift components ' ,self._name,len(components), 'in', "%.17g" %  (end_time-start_time), "seconds"             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #
 */
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_components);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_end_time - __pyx_v_start_time));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_32), __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_35));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, ((PyObject *)__pyx_kp_s_35));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_35));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self->__pyx_base._name));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, ((PyObject *)__pyx_v_self->__pyx_base._name));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_self->__pyx_base._name));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__in));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 3, ((PyObject *)__pyx_n_s__in));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__in));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 4, ((PyObject *)__pyx_t_2));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_2));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__seconds));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 5, ((PyObject *)__pyx_n_s__seconds));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__seconds));
    __pyx_t_1 = 0;
    __pyx_t_2 = 0;
    if (<span class='pyx_c_api'>__Pyx_Print</span>(0, ((PyObject *)__pyx_t_4), 1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    goto __pyx_L8;
  }
  __pyx_L8:;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_shift_calculator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&__pyx_v_component_to_target, 1);
  __PYX_XDEC_MEMVIEW(&__pyx_v_active_components, 1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_25Fast_ring_data_calculator_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_25Fast_ring_data_calculator_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_simulation = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__simulation,0};
    PyObject* values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__simulation)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1342; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 1) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
    }
    __pyx_v_simulation = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 1, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1342; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_data_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_25Fast_ring_data_calculator___init__(((struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *)__pyx_v_self), __pyx_v_simulation);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1334")'> 1334: </pre>
<pre id='line1334' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1335")'> 1335: #</pre>
<pre id='line1335' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1336")'> 1336: cdef int RING_ATOM_IDS = 1</pre>
<pre id='line1336' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1336
 * 
 * #
 * cdef int RING_ATOM_IDS = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef class Fast_ring_data_calculator:
 */
  __pyx_v_17shift_calculators_RING_ATOM_IDS = 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1337")'> 1337: </pre>
<pre id='line1337' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1338")'> 1338: cdef class Fast_ring_data_calculator:</pre>
<pre id='line1338' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1338
 * cdef int RING_ATOM_IDS = 1
 * 
 * cdef class Fast_ring_data_calculator:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef bint _verbose
 *     cdef EnsembleSimulation* _simulation
 */
struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator {
  PyObject_HEAD
  struct __pyx_vtabstruct_17shift_calculators_Fast_ring_data_calculator *__pyx_vtab;
  int _verbose;
  EnsembleSimulation *_simulation;
};


/* "Cython_shift_calculator.pyx":1338
 * cdef int RING_ATOM_IDS = 1
 * 
 * cdef class Fast_ring_data_calculator:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef bint _verbose
 *     cdef EnsembleSimulation* _simulation
 */

struct __pyx_vtabstruct_17shift_calculators_Fast_ring_data_calculator {
  void (*_calculate_one_ring_centre)(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *, PyObject *, Vec3 *);
  void (*_calculate_normal)(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *, int *, Vec3 *);
  void (*_calculate_one_ring_normal)(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *, PyObject *, Vec3 *);
  void (*_build_atom_triplet)(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *, PyObject *, int *);
  void (*_average_2_vec_3)(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *, Vec3 &, Vec3 &, Vec3 *);
};
static struct __pyx_vtabstruct_17shift_calculators_Fast_ring_data_calculator *__pyx_vtabptr_17shift_calculators_Fast_ring_data_calculator;
static CYTHON_INLINE void __pyx_f_17shift_calculators_25Fast_ring_data_calculator__calculate_one_ring_centre(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *, PyObject *, Vec3 *);
static CYTHON_INLINE void __pyx_f_17shift_calculators_25Fast_ring_data_calculator__calculate_normal(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *, int *, Vec3 *);
static CYTHON_INLINE void __pyx_f_17shift_calculators_25Fast_ring_data_calculator__calculate_one_ring_normal(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *, PyObject *, Vec3 *);
static CYTHON_INLINE void __pyx_f_17shift_calculators_25Fast_ring_data_calculator__build_atom_triplet(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *, PyObject *, int *);
static CYTHON_INLINE void __pyx_f_17shift_calculators_25Fast_ring_data_calculator__average_2_vec_3(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *, Vec3 &, Vec3 &, Vec3 *);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1339")'> 1339:     cdef bint _verbose</pre>
<pre id='line1339' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1340")'> 1340:     cdef EnsembleSimulation* _simulation</pre>
<pre id='line1340' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1341")'> 1341: </pre>
<pre id='line1341' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1342")'> 1342:     def __init__(self,simulation):</pre>
<pre id='line1342' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1342
 *     cdef EnsembleSimulation* _simulation
 * 
 *     def __init__(self,simulation):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._verbose = False
 *         self._simulation = simulationAsNative(simulation)
 */

static int __pyx_pf_17shift_calculators_25Fast_ring_data_calculator___init__(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *__pyx_v_self, PyObject *__pyx_v_simulation) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1343")'> 1343:         self._verbose = False</pre>
<pre id='line1343' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1343
 * 
 *     def __init__(self,simulation):
 *         self._verbose = False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._simulation = simulationAsNative(simulation)
 * 
 */
  __pyx_v_self->_verbose = 0;
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line1344")'> 1344:         self._simulation = simulationAsNative(simulation)</pre>
<pre id='line1344' class='code' style='background-color: #FFFFb6'>
  /* "Cython_shift_calculator.pyx":1344
 *     def __init__(self,simulation):
 *         self._verbose = False
 *         self._simulation = simulationAsNative(simulation)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_1 = __pyx_f_17shift_calculators_simulationAsNative(__pyx_v_simulation);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_simulation = __pyx_t_1;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_data_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_25Fast_ring_data_calculator_3set_verbose(PyObject *__pyx_v_self, PyObject *__pyx_v_on); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_25Fast_ring_data_calculator_3set_verbose(PyObject *__pyx_v_self, PyObject *__pyx_v_on) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_verbose (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_25Fast_ring_data_calculator_2set_verbose(((struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_on));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1345")'> 1345: </pre>
<pre id='line1345' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1346")'> 1346: </pre>
<pre id='line1346' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1347")'> 1347:     def set_verbose(self,on):</pre>
<pre id='line1347' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1347
 * 
 * 
 *     def set_verbose(self,on):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._verbose =  on
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_25Fast_ring_data_calculator_2set_verbose(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *__pyx_v_self, PyObject *__pyx_v_on) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_verbose", 0);
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line1348")'> 1348:         self._verbose =  on</pre>
<pre id='line1348' class='code' style='background-color: #FFFF6a'>
  /* "Cython_shift_calculator.pyx":1348
 * 
 *     def set_verbose(self,on):
 *         self._verbose =  on             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline void _calculate_one_ring_centre(self, ring_component, Vec3* result):
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_v_on);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_verbose = __pyx_t_1;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_data_calculator.set_verbose", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1349")'> 1349: </pre>
<pre id='line1349' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1350")'> 1350:     cdef inline void _calculate_one_ring_centre(self, ring_component, Vec3* result):</pre>
<pre id='line1350' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1350
 *         self._verbose =  on
 * 
 *     cdef inline void _calculate_one_ring_centre(self, ring_component, Vec3* result):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         atom_ids = ring_component[RING_ATOM_IDS]
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_25Fast_ring_data_calculator__calculate_one_ring_centre(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *__pyx_v_self, PyObject *__pyx_v_ring_component, Vec3 *__pyx_v_result) {
  PyObject *__pyx_v_atom_ids = NULL;
  float __pyx_v_num_atom_ids;
  int __pyx_v_atom_id;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calculate_one_ring_centre", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1351")'> 1351: </pre>
<pre id='line1351' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1352")'> 1352:         atom_ids = ring_component[RING_ATOM_IDS]</pre>
<pre id='line1352' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":1352
 *     cdef inline void _calculate_one_ring_centre(self, ring_component, Vec3* result):
 * 
 *         atom_ids = ring_component[RING_ATOM_IDS]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef float num_atom_ids = len(atom_ids)
 *         cdef Vec3 total
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_ring_component, __pyx_v_17shift_calculators_RING_ATOM_IDS, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_atom_ids = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1353")'> 1353:         cdef float num_atom_ids = len(atom_ids)</pre>
<pre id='line1353' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":1353
 * 
 *         atom_ids = ring_component[RING_ATOM_IDS]
 *         cdef float num_atom_ids = len(atom_ids)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3 total
 *         cdef int atom_id
 */
  __pyx_t_2 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_atom_ids);<span class='error_goto'> if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_num_atom_ids = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1354")'> 1354:         cdef Vec3 total</pre>
<pre id='line1354' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1355")'> 1355:         cdef int atom_id</pre>
<pre id='line1355' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1356")'> 1356: </pre>
<pre id='line1356' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1357")'> 1357:         result[0]=Vec3(0.0,0.0,0.0)</pre>
<pre id='line1357' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1357
 *         cdef int atom_id
 * 
 *         result[0]=Vec3(0.0,0.0,0.0)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for atom_id in atom_ids:
 *             result[0] += self._simulation.atomPos(atom_id)
 */
  (__pyx_v_result[0]) = Vec3(0.0, 0.0, 0.0);
</pre><pre class='line' style='background-color: #FFFF24' onclick='toggleDiv("line1358")'> 1358:         for atom_id in atom_ids:</pre>
<pre id='line1358' class='code' style='background-color: #FFFF24'>
  /* "Cython_shift_calculator.pyx":1358
 * 
 *         result[0]=Vec3(0.0,0.0,0.0)
 *         for atom_id in atom_ids:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             result[0] += self._simulation.atomPos(atom_id)
 * 
 */
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_atom_ids) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_atom_ids)) {
    __pyx_t_1 = __pyx_v_atom_ids; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_atom_ids);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext;
  }
  for (;;) {
    if (!__pyx_t_3 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_3 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    }
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_atom_id = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1359")'> 1359:             result[0] += self._simulation.atomPos(atom_id)</pre>
<pre id='line1359' class='code' style='background-color: #FFFFe7'>
    /* "Cython_shift_calculator.pyx":1359
 *         result[0]=Vec3(0.0,0.0,0.0)
 *         for atom_id in atom_ids:
 *             result[0] += self._simulation.atomPos(atom_id)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         operator_times(result[0],1.0/float(num_atom_ids))
 */
    (__pyx_v_result[0]) += __pyx_v_self->_simulation->atomPos(__pyx_v_atom_id);
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1360")'> 1360: </pre>
<pre id='line1360' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line1361")'> 1361:         operator_times(result[0],1.0/float(num_atom_ids))</pre>
<pre id='line1361' class='code' style='background-color: #FFFF9f'>
  /* "Cython_shift_calculator.pyx":1361
 *             result[0] += self._simulation.atomPos(atom_id)
 * 
 *         operator_times(result[0],1.0/float(num_atom_ids))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #
 */
  __pyx_f_17shift_calculators_operator_times((__pyx_v_result[0]), (1.0 / ((double)__pyx_v_num_atom_ids)));

  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Fast_ring_data_calculator._calculate_one_ring_centre", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_atom_ids);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1362")'> 1362: </pre>
<pre id='line1362' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1363")'> 1363: #</pre>
<pre id='line1363' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1364")'> 1364: </pre>
<pre id='line1364' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1365")'> 1365: </pre>
<pre id='line1365' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1366")'> 1366: </pre>
<pre id='line1366' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1367")'> 1367: #    def _check_ring_size_ok(self, atom_ids):</pre>
<pre id='line1367' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1368")'> 1368: #        num_atom_ids = len(atom_ids)</pre>
<pre id='line1368' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1369")'> 1369: #        if num_atom_ids &lt; 5 or num_atom_ids &gt; 6:</pre>
<pre id='line1369' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1370")'> 1370: #            template = "ring normals function is only implemented for 5 or six member rings i got %d atoms"</pre>
<pre id='line1370' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1371")'> 1371: #            msg = template % num_atom_ids</pre>
<pre id='line1371' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1372")'> 1372: #            raise Exception(msg)</pre>
<pre id='line1372' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1373")'> 1373: #</pre>
<pre id='line1373' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1374")'> 1374: </pre>
<pre id='line1374' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1375")'> 1375:     cdef inline void  _calculate_normal(self, int[3] atom_id_triplet, Vec3* result):</pre>
<pre id='line1375' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1375
 * #
 * 
 *     cdef inline void  _calculate_normal(self, int[3] atom_id_triplet, Vec3* result):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Vec3 normal
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_25Fast_ring_data_calculator__calculate_normal(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *__pyx_v_self, int *__pyx_v_atom_id_triplet, Vec3 *__pyx_v_result) {
  Vec3 __pyx_v_vec_1;
  Vec3 __pyx_v_vec_2;
  Vec3 __pyx_v_atom_vector_1;
  Vec3 __pyx_v_atom_vector_2;
  Vec3 __pyx_v_atom_vector_3;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calculate_normal", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1376")'> 1376: </pre>
<pre id='line1376' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1377")'> 1377:         cdef Vec3 normal</pre>
<pre id='line1377' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1378")'> 1378:         cdef Vec3 vec_1</pre>
<pre id='line1378' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1379")'> 1379:         cdef Vec3 vec_2</pre>
<pre id='line1379' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1380")'> 1380: </pre>
<pre id='line1380' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1381")'> 1381:         cdef Vec3 atom_vector_1, atom_vector_2, atom_vector_3</pre>
<pre id='line1381' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1382")'> 1382: </pre>
<pre id='line1382' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1383")'> 1383:         atom_vector_1 = self._simulation[0].atomPos(atom_id_triplet[0])</pre>
<pre id='line1383' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1383
 *         cdef Vec3 atom_vector_1, atom_vector_2, atom_vector_3
 * 
 *         atom_vector_1 = self._simulation[0].atomPos(atom_id_triplet[0])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         atom_vector_2 = self._simulation[0].atomPos(atom_id_triplet[1])
 *         atom_vector_3 = self._simulation[0].atomPos(atom_id_triplet[2])
 */
  __pyx_v_atom_vector_1 = (__pyx_v_self->_simulation[0]).atomPos((__pyx_v_atom_id_triplet[0]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1384")'> 1384:         atom_vector_2 = self._simulation[0].atomPos(atom_id_triplet[1])</pre>
<pre id='line1384' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1384
 * 
 *         atom_vector_1 = self._simulation[0].atomPos(atom_id_triplet[0])
 *         atom_vector_2 = self._simulation[0].atomPos(atom_id_triplet[1])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         atom_vector_3 = self._simulation[0].atomPos(atom_id_triplet[2])
 * 
 */
  __pyx_v_atom_vector_2 = (__pyx_v_self->_simulation[0]).atomPos((__pyx_v_atom_id_triplet[1]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1385")'> 1385:         atom_vector_3 = self._simulation[0].atomPos(atom_id_triplet[2])</pre>
<pre id='line1385' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1385
 *         atom_vector_1 = self._simulation[0].atomPos(atom_id_triplet[0])
 *         atom_vector_2 = self._simulation[0].atomPos(atom_id_triplet[1])
 *         atom_vector_3 = self._simulation[0].atomPos(atom_id_triplet[2])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         vec_1 =  atom_vector_1 -atom_vector_2
 */
  __pyx_v_atom_vector_3 = (__pyx_v_self->_simulation[0]).atomPos((__pyx_v_atom_id_triplet[2]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1386")'> 1386: </pre>
<pre id='line1386' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1387")'> 1387:         vec_1 =  atom_vector_1 -atom_vector_2</pre>
<pre id='line1387' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1387
 *         atom_vector_3 = self._simulation[0].atomPos(atom_id_triplet[2])
 * 
 *         vec_1 =  atom_vector_1 -atom_vector_2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         vec_2 =  atom_vector_3- atom_vector_2
 * 
 */
  __pyx_v_vec_1 = (__pyx_v_atom_vector_1 - __pyx_v_atom_vector_2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1388")'> 1388:         vec_2 =  atom_vector_3- atom_vector_2</pre>
<pre id='line1388' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1388
 * 
 *         vec_1 =  atom_vector_1 -atom_vector_2
 *         vec_2 =  atom_vector_3- atom_vector_2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         result[0] =  cross(vec_1,vec_2)
 */
  __pyx_v_vec_2 = (__pyx_v_atom_vector_3 - __pyx_v_atom_vector_2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1389")'> 1389: </pre>
<pre id='line1389' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1390")'> 1390:         result[0] =  cross(vec_1,vec_2)</pre>
<pre id='line1390' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":1390
 *         vec_2 =  atom_vector_3- atom_vector_2
 * 
 *         result[0] =  cross(vec_1,vec_2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     #TODO could try newells method http://www.opengl.org/wiki/Calculating_a_Surface_Normal
 */
  (__pyx_v_result[0]) = cross(__pyx_v_vec_1, __pyx_v_vec_2);

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1391")'> 1391: </pre>
<pre id='line1391' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1392")'> 1392:     #TODO could try newells method http://www.opengl.org/wiki/Calculating_a_Surface_Normal</pre>
<pre id='line1392' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1393")'> 1393:     cdef inline  void  _calculate_one_ring_normal(self, ring_component, Vec3* result):</pre>
<pre id='line1393' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1393
 * 
 *     #TODO could try newells method http://www.opengl.org/wiki/Calculating_a_Surface_Normal
 *     cdef inline  void  _calculate_one_ring_normal(self, ring_component, Vec3* result):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         atom_ids = ring_component[RING_ATOM_IDS]
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_25Fast_ring_data_calculator__calculate_one_ring_normal(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *__pyx_v_self, PyObject *__pyx_v_ring_component, Vec3 *__pyx_v_result) {
  PyObject *__pyx_v_atom_ids = NULL;
  int *__pyx_v_atom_triplet_1;
  int *__pyx_v_atom_triplet_2;
  Vec3 __pyx_v_normal_1;
  Vec3 __pyx_v_normal_2;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calculate_one_ring_normal", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1394")'> 1394: </pre>
<pre id='line1394' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1395")'> 1395:         atom_ids = ring_component[RING_ATOM_IDS]</pre>
<pre id='line1395' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":1395
 *     cdef inline  void  _calculate_one_ring_normal(self, ring_component, Vec3* result):
 * 
 *         atom_ids = ring_component[RING_ATOM_IDS]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #        self._check_ring_size_ok(atom_ids)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_ring_component, __pyx_v_17shift_calculators_RING_ATOM_IDS, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_atom_ids = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1396")'> 1396: #        self._check_ring_size_ok(atom_ids)</pre>
<pre id='line1396' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1397")'> 1397: </pre>
<pre id='line1397' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1398")'> 1398:         cdef int* atom_triplet_1 = [0,0,0]</pre>
<pre id='line1398' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1398
 * #        self._check_ring_size_ok(atom_ids)
 * 
 *         cdef int* atom_triplet_1 = [0,0,0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int* atom_triplet_2 = [0,0,0]
 *         self._build_atom_triplet(atom_ids[:3], atom_triplet_1)
 */
  __pyx_t_2[0] = 0;
  __pyx_t_2[1] = 0;
  __pyx_t_2[2] = 0;
  __pyx_v_atom_triplet_1 = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1399")'> 1399:         cdef int* atom_triplet_2 = [0,0,0]</pre>
<pre id='line1399' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1399
 * 
 *         cdef int* atom_triplet_1 = [0,0,0]
 *         cdef int* atom_triplet_2 = [0,0,0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._build_atom_triplet(atom_ids[:3], atom_triplet_1)
 *         self._build_atom_triplet(atom_ids[-3:], atom_triplet_2)
 */
  __pyx_t_3[0] = 0;
  __pyx_t_3[1] = 0;
  __pyx_t_3[2] = 0;
  __pyx_v_atom_triplet_2 = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line1400")'> 1400:         self._build_atom_triplet(atom_ids[:3], atom_triplet_1)</pre>
<pre id='line1400' class='code' style='background-color: #FFFF9f'>
  /* "Cython_shift_calculator.pyx":1400
 *         cdef int* atom_triplet_1 = [0,0,0]
 *         cdef int* atom_triplet_2 = [0,0,0]
 *         self._build_atom_triplet(atom_ids[:3], atom_triplet_1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._build_atom_triplet(atom_ids[-3:], atom_triplet_2)
 * 
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PySequence_GetSlice</span>(__pyx_v_atom_ids, 0, 3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1400; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_f_17shift_calculators_25Fast_ring_data_calculator__build_atom_triplet(__pyx_v_self, __pyx_t_1, __pyx_v_atom_triplet_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line1401")'> 1401:         self._build_atom_triplet(atom_ids[-3:], atom_triplet_2)</pre>
<pre id='line1401' class='code' style='background-color: #FFFF9f'>
  /* "Cython_shift_calculator.pyx":1401
 *         cdef int* atom_triplet_2 = [0,0,0]
 *         self._build_atom_triplet(atom_ids[:3], atom_triplet_1)
 *         self._build_atom_triplet(atom_ids[-3:], atom_triplet_2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PySequence_GetSlice</span>(__pyx_v_atom_ids, -3, PY_SSIZE_T_MAX);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_f_17shift_calculators_25Fast_ring_data_calculator__build_atom_triplet(__pyx_v_self, __pyx_t_1, __pyx_v_atom_triplet_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1402")'> 1402: </pre>
<pre id='line1402' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1403")'> 1403: </pre>
<pre id='line1403' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1404")'> 1404:         cdef Vec3 normal_1</pre>
<pre id='line1404' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1405")'> 1405:         self._calculate_normal(atom_triplet_1, &amp;normal_1)</pre>
<pre id='line1405' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1405
 * 
 *         cdef Vec3 normal_1
 *         self._calculate_normal(atom_triplet_1, &normal_1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3 normal_2
 *         self._calculate_normal(atom_triplet_2,  &normal_2)
 */
  __pyx_f_17shift_calculators_25Fast_ring_data_calculator__calculate_normal(__pyx_v_self, __pyx_v_atom_triplet_1, (&__pyx_v_normal_1));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1406")'> 1406:         cdef Vec3 normal_2</pre>
<pre id='line1406' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1407")'> 1407:         self._calculate_normal(atom_triplet_2,  &amp;normal_2)</pre>
<pre id='line1407' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1407
 *         self._calculate_normal(atom_triplet_1, &normal_1)
 *         cdef Vec3 normal_2
 *         self._calculate_normal(atom_triplet_2,  &normal_2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._average_2_vec_3(normal_1, normal_2, result)
 */
  __pyx_f_17shift_calculators_25Fast_ring_data_calculator__calculate_normal(__pyx_v_self, __pyx_v_atom_triplet_2, (&__pyx_v_normal_2));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1408")'> 1408: </pre>
<pre id='line1408' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1409")'> 1409:         self._average_2_vec_3(normal_1, normal_2, result)</pre>
<pre id='line1409' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":1409
 *         self._calculate_normal(atom_triplet_2,  &normal_2)
 * 
 *         self._average_2_vec_3(normal_1, normal_2, result)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline void  _build_atom_triplet(self,atom_ids, int[3]& result):
 */
  __pyx_f_17shift_calculators_25Fast_ring_data_calculator__average_2_vec_3(__pyx_v_self, __pyx_v_normal_1, __pyx_v_normal_2, __pyx_v_result);

  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Fast_ring_data_calculator._calculate_one_ring_normal", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_atom_ids);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1410")'> 1410: </pre>
<pre id='line1410' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1411")'> 1411:     cdef inline void  _build_atom_triplet(self,atom_ids, int[3]&amp; result):</pre>
<pre id='line1411' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1411
 *         self._average_2_vec_3(normal_1, normal_2, result)
 * 
 *     cdef inline void  _build_atom_triplet(self,atom_ids, int[3]& result):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int i
 *         for i in range(3):
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_25Fast_ring_data_calculator__build_atom_triplet(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *__pyx_v_self, PyObject *__pyx_v_atom_ids, int *__pyx_v_result) {
  int __pyx_v_i;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_build_atom_triplet", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1412")'> 1412:         cdef int i</pre>
<pre id='line1412' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1413")'> 1413:         for i in range(3):</pre>
<pre id='line1413' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1413
 *     cdef inline void  _build_atom_triplet(self,atom_ids, int[3]& result):
 *         cdef int i
 *         for i in range(3):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             result[i] = atom_ids[i]
 * 
 */
  for (__pyx_t_1 = 0; __pyx_t_1 <code><</code> 3; __pyx_t_1+=1) {
    __pyx_v_i = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line1414")'> 1414:             result[i] = atom_ids[i]</pre>
<pre id='line1414' class='code' style='background-color: #FFFF5e'>
    /* "Cython_shift_calculator.pyx":1414
 *         cdef int i
 *         for i in range(3):
 *             result[i] = atom_ids[i]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_atom_ids, __pyx_v_i, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_3 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    (__pyx_v_result[__pyx_v_i]) = __pyx_t_3;
  }

  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Fast_ring_data_calculator._build_atom_triplet", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1415")'> 1415: </pre>
<pre id='line1415' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1416")'> 1416: </pre>
<pre id='line1416' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1417")'> 1417:     cdef inline void _average_2_vec_3(self, Vec3&amp; vector_1, Vec3&amp; vector_2, Vec3* result):</pre>
<pre id='line1417' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1417
 * 
 * 
 *     cdef inline void _average_2_vec_3(self, Vec3& vector_1, Vec3& vector_2, Vec3* result):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result[0] =  vector_1 + vector_2
 * 
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_25Fast_ring_data_calculator__average_2_vec_3(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *__pyx_v_self, Vec3 &__pyx_v_vector_1, Vec3 &__pyx_v_vector_2, Vec3 *__pyx_v_result) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_average_2_vec_3", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1418")'> 1418:         result[0] =  vector_1 + vector_2</pre>
<pre id='line1418' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1418
 * 
 *     cdef inline void _average_2_vec_3(self, Vec3& vector_1, Vec3& vector_2, Vec3* result):
 *         result[0] =  vector_1 + vector_2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         operator_times(result[0], 1.0/2.0)
 */
  (__pyx_v_result[0]) = (__pyx_v_vector_1 + __pyx_v_vector_2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1419")'> 1419: </pre>
<pre id='line1419' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2d' onclick='toggleDiv("line1420")'> 1420:         operator_times(result[0], 1.0/2.0)</pre>
<pre id='line1420' class='code' style='background-color: #FFFF2d'>
  /* "Cython_shift_calculator.pyx":1420
 *         result[0] =  vector_1 + vector_2
 * 
 *         operator_times(result[0], 1.0/2.0)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_f_17shift_calculators_operator_times((__pyx_v_result[0]), (1.0 / 2.0));

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_25Fast_ring_data_calculator_5__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_25Fast_ring_data_calculator_5__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_rings = 0;
  struct __pyx_obj_17shift_calculators_Vec3_list *__pyx_v_normals = 0;
  struct __pyx_obj_17shift_calculators_Vec3_list *__pyx_v_centres = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__call__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__rings,&__pyx_n_s__normals,&__pyx_n_s__centres,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__rings)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__normals)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 3, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1424; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__centres)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 3, 3, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1424; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__call__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1424; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_rings = values[0];
    __pyx_v_normals = ((struct __pyx_obj_17shift_calculators_Vec3_list *)values[1]);
    __pyx_v_centres = ((struct __pyx_obj_17shift_calculators_Vec3_list *)values[2]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1424; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_data_calculator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_normals), __pyx_ptype_17shift_calculators_Vec3_list, 1, "normals", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1424; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_centres), __pyx_ptype_17shift_calculators_Vec3_list, 1, "centres", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1424; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_25Fast_ring_data_calculator_4__call__(((struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *)__pyx_v_self), __pyx_v_rings, __pyx_v_normals, __pyx_v_centres);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1421")'> 1421: </pre>
<pre id='line1421' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1422")'> 1422: </pre>
<pre id='line1422' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1423")'> 1423:     @cython.profile(True)</pre>
<pre id='line1423' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1424")'> 1424:     def __call__(self, rings, Vec3_list normals, Vec3_list centres):</pre>
<pre id='line1424' class='code' style='background-color: #FFFFd4'>
/* "Cython_shift_calculator.pyx":1424
 * 
 *     @cython.profile(True)
 *     def __call__(self, rings, Vec3_list normals, Vec3_list centres):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef double start_time = 0.0
 *         cdef double end_time = 0.0
 */

static PyObject *__pyx_pf_17shift_calculators_25Fast_ring_data_calculator_4__call__(struct __pyx_obj_17shift_calculators_Fast_ring_data_calculator *__pyx_v_self, PyObject *__pyx_v_rings, struct __pyx_obj_17shift_calculators_Vec3_list *__pyx_v_normals, struct __pyx_obj_17shift_calculators_Vec3_list *__pyx_v_centres) {
  double __pyx_v_start_time;
  double __pyx_v_end_time;
  int __pyx_v_ring_id;
  PyObject *__pyx_v_ring_component = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__call__", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("__call__", __pyx_f[0], 1424);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1425")'> 1425:         cdef double start_time = 0.0</pre>
<pre id='line1425' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1425
 *     @cython.profile(True)
 *     def __call__(self, rings, Vec3_list normals, Vec3_list centres):
 *         cdef double start_time = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef double end_time = 0.0
 * 
 */
  __pyx_v_start_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1426")'> 1426:         cdef double end_time = 0.0</pre>
<pre id='line1426' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1426
 *     def __call__(self, rings, Vec3_list normals, Vec3_list centres):
 *         cdef double start_time = 0.0
 *         cdef double end_time = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if self._verbose:
 */
  __pyx_v_end_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1427")'> 1427: </pre>
<pre id='line1427' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1428")'> 1428:         if self._verbose:</pre>
<pre id='line1428' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1428
 *         cdef double end_time = 0.0
 * 
 *         if self._verbose:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             start_time = time()
 * 
 */
  if (__pyx_v_self->_verbose) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line1429")'> 1429:             start_time = time()</pre>
<pre id='line1429' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":1429
 * 
 *         if self._verbose:
 *             start_time = time()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         normals.set_length(len(rings))
 */
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__time);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_start_time = __pyx_t_3;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1430")'> 1430: </pre>
<pre id='line1430' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line1431")'> 1431:         normals.set_length(len(rings))</pre>
<pre id='line1431' class='code' style='background-color: #FFFF9f'>
  /* "Cython_shift_calculator.pyx":1431
 *             start_time = time()
 * 
 *         normals.set_length(len(rings))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         centres.set_length(len(rings))
 *         cdef int ring_id
 */
  __pyx_t_4 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_rings);<span class='error_goto'> if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1431; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = ((struct __pyx_vtabstruct_17shift_calculators_Vec3_list *)__pyx_v_normals->__pyx_vtab)->set_length(__pyx_v_normals, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1431; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line1432")'> 1432:         centres.set_length(len(rings))</pre>
<pre id='line1432' class='code' style='background-color: #FFFF9f'>
  /* "Cython_shift_calculator.pyx":1432
 * 
 *         normals.set_length(len(rings))
 *         centres.set_length(len(rings))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int ring_id
 *         for ring_id,ring_component in enumerate(rings):
 */
  __pyx_t_4 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_rings);<span class='error_goto'> if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = ((struct __pyx_vtabstruct_17shift_calculators_Vec3_list *)__pyx_v_centres->__pyx_vtab)->set_length(__pyx_v_centres, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1433")'> 1433:         cdef int ring_id</pre>
<pre id='line1433' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line1434")'> 1434:         for ring_id,ring_component in enumerate(rings):</pre>
<pre id='line1434' class='code' style='background-color: #FFFF2a'>
  /* "Cython_shift_calculator.pyx":1434
 *         centres.set_length(len(rings))
 *         cdef int ring_id
 *         for ring_id,ring_component in enumerate(rings):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             ring_id = ring_component[0]
 * 
 */
  __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_rings) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_rings)) {
    __pyx_t_2 = __pyx_v_rings; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_4 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_rings);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_6 = Py_TYPE(__pyx_t_2)->tp_iternext;
  }
  for (;;) {
    if (!__pyx_t_6 && <span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) {
      if (__pyx_t_4 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else if (!__pyx_t_6 && <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
      if (__pyx_t_4 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #endif
    } else {
      __pyx_t_1 = __pyx_t_6(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        if (<span class='py_c_api'>PyErr_Occurred</span>()) {
          if (likely(<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ring_component);
    __pyx_v_ring_component = __pyx_t_1;
    __pyx_t_1 = 0;
    __pyx_v_ring_id = __pyx_t_5;
    __pyx_t_5 = (__pyx_t_5 + 1);
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line1435")'> 1435:             ring_id = ring_component[0]</pre>
<pre id='line1435' class='code' style='background-color: #FFFF6e'>
    /* "Cython_shift_calculator.pyx":1435
 *         cdef int ring_id
 *         for ring_id,ring_component in enumerate(rings):
 *             ring_id = ring_component[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             self._calculate_one_ring_centre(ring_component, centres.get(ring_id))
 */
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_ring_component, 0, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1435; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_7 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1435; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_ring_id = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1436")'> 1436: </pre>
<pre id='line1436' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1437")'> 1437:             self._calculate_one_ring_centre(ring_component, centres.get(ring_id))</pre>
<pre id='line1437' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1437
 *             ring_id = ring_component[0]
 * 
 *             self._calculate_one_ring_centre(ring_component, centres.get(ring_id))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_f_17shift_calculators_25Fast_ring_data_calculator__calculate_one_ring_centre(__pyx_v_self, __pyx_v_ring_component, __pyx_f_17shift_calculators_9Vec3_list_get(__pyx_v_centres, __pyx_v_ring_id));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1438")'> 1438: </pre>
<pre id='line1438' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1439")'> 1439: </pre>
<pre id='line1439' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1440")'> 1440:             self._calculate_one_ring_normal(ring_component, normals.get(ring_id))</pre>
<pre id='line1440' class='code' style='background-color: #FFFFe7'>
    /* "Cython_shift_calculator.pyx":1440
 * 
 * 
 *             self._calculate_one_ring_normal(ring_component, normals.get(ring_id))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #             normal_component = ring_id, normal
 * #             normals.add_component(normal_component)
 */
    __pyx_f_17shift_calculators_25Fast_ring_data_calculator__calculate_one_ring_normal(__pyx_v_self, __pyx_v_ring_component, __pyx_f_17shift_calculators_9Vec3_list_get(__pyx_v_normals, __pyx_v_ring_id));
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1441")'> 1441: #             normal_component = ring_id, normal</pre>
<pre id='line1441' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1442")'> 1442: #             normals.add_component(normal_component)</pre>
<pre id='line1442' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1443")'> 1443: </pre>
<pre id='line1443' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1444")'> 1444:         if self._verbose:</pre>
<pre id='line1444' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1444
 * #             normals.add_component(normal_component)
 * 
 *         if self._verbose:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             end_time = time()
 *             print '   ring data centres: ',len(rings), ' normals ', len(normals), 'in', "%.17g" %  (end_time-start_time), "seconds"
 */
  if (__pyx_v_self->_verbose) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line1445")'> 1445:             end_time = time()</pre>
<pre id='line1445' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":1445
 * 
 *         if self._verbose:
 *             end_time = time()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print '   ring data centres: ',len(rings), ' normals ', len(normals), 'in', "%.17g" %  (end_time-start_time), "seconds"
 * 
 */
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__time);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1445; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1445; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1445; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_end_time = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF19' onclick='toggleDiv("line1446")'> 1446:             print '   ring data centres: ',len(rings), ' normals ', len(normals), 'in', "%.17g" %  (end_time-start_time), "seconds"</pre>
<pre id='line1446' class='code' style='background-color: #FFFF19'>
    /* "Cython_shift_calculator.pyx":1446
 *         if self._verbose:
 *             end_time = time()
 *             print '   ring data centres: ',len(rings), ' normals ', len(normals), 'in', "%.17g" %  (end_time-start_time), "seconds"             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #TODO: add common base class with Non bonded calculator
 */
    __pyx_t_4 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_rings);<span class='error_goto'> if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1446; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1446; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_4 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_v_normals));<span class='error_goto'> if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1446; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1446; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_end_time - __pyx_v_start_time));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1446; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_32), __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1446; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_9));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1446; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_36));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, ((PyObject *)__pyx_kp_s_36));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_36));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_37));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2, ((PyObject *)__pyx_kp_s_37));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_37));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 3, __pyx_t_2);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__in));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 4, ((PyObject *)__pyx_n_s__in));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__in));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 5, ((PyObject *)__pyx_t_9));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_9));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__seconds));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 6, ((PyObject *)__pyx_n_s__seconds));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__seconds));
    __pyx_t_1 = 0;
    __pyx_t_2 = 0;
    __pyx_t_9 = 0;
    if (<span class='pyx_c_api'>__Pyx_Print</span>(0, ((PyObject *)__pyx_t_8), 1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1446; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
    goto __pyx_L6;
  }
  __pyx_L6:;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_data_calculator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ring_component);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_29Fast_hydrogen_bond_calculator_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_29Fast_hydrogen_bond_calculator_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_simulation = 0;
  PyObject *__pyx_v_cutoff_distance = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__simulation,&__pyx_n_s__cutoff_distance,0};
    PyObject* values[2] = {0,0};
    values[1] = __pyx_k_38;
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__simulation)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__cutoff_distance);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1455; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_simulation = values[0];
    __pyx_v_cutoff_distance = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1455; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_hydrogen_bond_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_29Fast_hydrogen_bond_calculator___init__(((struct __pyx_obj_17shift_calculators_Fast_hydrogen_bond_calculator *)__pyx_v_self), __pyx_v_simulation, __pyx_v_cutoff_distance);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1447")'> 1447: </pre>
<pre id='line1447' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1448")'> 1448: #TODO: add common base class with Non bonded calculator</pre>
<pre id='line1448' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1449")'> 1449: cdef class Fast_hydrogen_bond_calculator:</pre>
<pre id='line1449' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1449
 * 
 * #TODO: add common base class with Non bonded calculator
 * cdef class Fast_hydrogen_bond_calculator:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef float _cutoff_distance
 *     cdef bint _verbose
 */
struct __pyx_obj_17shift_calculators_Fast_hydrogen_bond_calculator {
  PyObject_HEAD
  struct __pyx_vtabstruct_17shift_calculators_Fast_hydrogen_bond_calculator *__pyx_vtab;
  float _cutoff_distance;
  int _verbose;
  EnsembleSimulation *_simulation;
  int _min_residue_seperation;
};


/* "Cython_shift_calculator.pyx":1449
 * 
 * #TODO: add common base class with Non bonded calculator
 * cdef class Fast_hydrogen_bond_calculator:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef float _cutoff_distance
 *     cdef bint _verbose
 */

struct __pyx_vtabstruct_17shift_calculators_Fast_hydrogen_bond_calculator {
  int (*_bytes_to_components)(struct __pyx_obj_17shift_calculators_Fast_hydrogen_bond_calculator *, PyObject *, struct __pyx_t_17shift_calculators_Hydrogen_bond_component **);
  int (*_bytes_to_parameters)(struct __pyx_obj_17shift_calculators_Fast_hydrogen_bond_calculator *, PyObject *, struct __pyx_t_17shift_calculators_Hydrogen_bond_parameter **);
  int (*_bytes_to_donor_lookup)(struct __pyx_obj_17shift_calculators_Fast_hydrogen_bond_calculator *, PyObject *, struct __pyx_t_17shift_calculators_Hydrogen_bond_donor_lookup **);
  int (*_bytes_to_acceptor_lookup)(struct __pyx_obj_17shift_calculators_Fast_hydrogen_bond_calculator *, PyObject *, struct __pyx_t_17shift_calculators_Hydrogen_bond_acceptor_lookup **);
  int (*_filter_by_residue)(struct __pyx_obj_17shift_calculators_Fast_hydrogen_bond_calculator *, char *, int, char *, int);
  float (*_calc_energy)(struct __pyx_obj_17shift_calculators_Fast_hydrogen_bond_calculator *, float, struct __pyx_t_17shift_calculators_Hydrogen_bond_parameter);
};
static struct __pyx_vtabstruct_17shift_calculators_Fast_hydrogen_bond_calculator *__pyx_vtabptr_17shift_calculators_Fast_hydrogen_bond_calculator;
static CYTHON_INLINE int __pyx_f_17shift_calculators_29Fast_hydrogen_bond_calculator__filter_by_residue(struct __pyx_obj_17shift_calculators_Fast_hydrogen_bond_calculator *, char *, int, char *, int);
static CYTHON_INLINE float __pyx_f_17shift_calculators_29Fast_hydrogen_bond_calculator__calc_energy(struct __pyx_obj_17shift_calculators_Fast_hydrogen_bond_calculator *, float, struct __pyx_t_17shift_calculators_Hydrogen_bond_parameter);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1450")'> 1450:     cdef float _cutoff_distance</pre>
<pre id='line1450' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1451")'> 1451:     cdef bint _verbose</pre>
<pre id='line1451' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1452")'> 1452:     cdef EnsembleSimulation* _simulation</pre>
<pre id='line1452' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1453")'> 1453:     cdef int _min_residue_seperation</pre>
<pre id='line1453' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1454")'> 1454: </pre>
<pre id='line1454' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1455")'> 1455:     def __init__(self,simulation,cutoff_distance=5.0):</pre>
<pre id='line1455' class='code' style='background-color: #FFFFaa'>
/* "Cython_shift_calculator.pyx":1455
 *     cdef int _min_residue_seperation
 * 
 *     def __init__(self,simulation,cutoff_distance=5.0):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._simulation = simulationAsNative(simulation)
 *         self._min_residue_seperation =  1
 */

static int __pyx_pf_17shift_calculators_29Fast_hydrogen_bond_calculator___init__(struct __pyx_obj_17shift_calculators_Fast_hydrogen_bond_calculator *__pyx_v_self, PyObject *__pyx_v_simulation, PyObject *__pyx_v_cutoff_distance) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);

  /* "Cython_shift_calculator.pyx":1455
 *     cdef int _min_residue_seperation
 * 
 *     def __init__(self,simulation,cutoff_distance=5.0):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._simulation = simulationAsNative(simulation)
 *         self._min_residue_seperation =  1
 */
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(5.0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1455; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_k_38 = __pyx_t_2;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1456")'> 1456:         self._simulation = simulationAsNative(simulation)</pre>
<pre id='line1456' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1456
 * 
 *     def __init__(self,simulation,cutoff_distance=5.0):
 *         self._simulation = simulationAsNative(simulation)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._min_residue_seperation =  1
 * 
 */
  __pyx_t_1 = __pyx_f_17shift_calculators_simulationAsNative(__pyx_v_simulation);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1456; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_simulation = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1457")'> 1457:         self._min_residue_seperation =  1</pre>
<pre id='line1457' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1457
 *     def __init__(self,simulation,cutoff_distance=5.0):
 *         self._simulation = simulationAsNative(simulation)
 *         self._min_residue_seperation =  1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._cutoff_distance =  cutoff_distance
 */
  __pyx_v_self->_min_residue_seperation = 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1458")'> 1458: </pre>
<pre id='line1458' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line1459")'> 1459:         self._cutoff_distance =  cutoff_distance</pre>
<pre id='line1459' class='code' style='background-color: #FFFF7f'>
  /* "Cython_shift_calculator.pyx":1459
 *         self._min_residue_seperation =  1
 * 
 *         self._cutoff_distance =  cutoff_distance             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._verbose =  False
 * 
 */
  __pyx_t_2 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_cutoff_distance);<span class='error_goto'> if (unlikely((__pyx_t_2 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1459; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_cutoff_distance = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line1460")'> 1460:         self._verbose =  False</pre>
<pre id='line1460' class='code' style='background-color: #FFFFb6'>
  /* "Cython_shift_calculator.pyx":1460
 * 
 *         self._cutoff_distance =  cutoff_distance
 *         self._verbose =  False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_self->_verbose = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_hydrogen_bond_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_29Fast_hydrogen_bond_calculator_3set_verbose(PyObject *__pyx_v_self, PyObject *__pyx_v_on); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_29Fast_hydrogen_bond_calculator_3set_verbose(PyObject *__pyx_v_self, PyObject *__pyx_v_on) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_verbose (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_29Fast_hydrogen_bond_calculator_2set_verbose(((struct __pyx_obj_17shift_calculators_Fast_hydrogen_bond_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_on));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1461")'> 1461: </pre>
<pre id='line1461' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1462")'> 1462: </pre>
<pre id='line1462' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1463")'> 1463:     def set_verbose(self,on):</pre>
<pre id='line1463' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1463
 * 
 * 
 *     def set_verbose(self,on):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._verbose=on
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_29Fast_hydrogen_bond_calculator_2set_verbose(struct __pyx_obj_17shift_calculators_Fast_hydrogen_bond_calculator *__pyx_v_self, PyObject *__pyx_v_on) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_verbose", 0);
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line1464")'> 1464:         self._verbose=on</pre>
<pre id='line1464' class='code' style='background-color: #FFFF6a'>
  /* "Cython_shift_calculator.pyx":1464
 * 
 *     def set_verbose(self,on):
 *         self._verbose=on             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef   int _bytes_to_components(self, data, Hydrogen_bond_component** target_pointer):
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_v_on);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_verbose = __pyx_t_1;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_hydrogen_bond_calculator.set_verbose", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1465")'> 1465: </pre>
<pre id='line1465' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1466")'> 1466:     cdef   int _bytes_to_components(self, data, Hydrogen_bond_component** target_pointer):</pre>
<pre id='line1466' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1466
 *         self._verbose=on
 * 
 *     cdef   int _bytes_to_components(self, data, Hydrogen_bond_component** target_pointer):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         target_pointer[0] =  <code><</code>Hydrogen_bond_component*> <code><</code>size_t> ctypes.addressof(data)
 *         return len(data)/ sizeof(Hydrogen_bond_component)
 */

static int __pyx_f_17shift_calculators_29Fast_hydrogen_bond_calculator__bytes_to_components(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Fast_hydrogen_bond_calculator *__pyx_v_self, PyObject *__pyx_v_data, struct __pyx_t_17shift_calculators_Hydrogen_bond_component **__pyx_v_target_pointer) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_components", 0);
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line1467")'> 1467:         target_pointer[0] =  &lt;Hydrogen_bond_component*&gt; &lt;size_t&gt; ctypes.addressof(data)</pre>
<pre id='line1467' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":1467
 * 
 *     cdef   int _bytes_to_components(self, data, Hydrogen_bond_component** target_pointer):
 *         target_pointer[0] =  <code><</code>Hydrogen_bond_component*> <code><</code>size_t> ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return len(data)/ sizeof(Hydrogen_bond_component)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1467; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1467; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1467; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1467; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1467; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  (__pyx_v_target_pointer[0]) = ((struct __pyx_t_17shift_calculators_Hydrogen_bond_component *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line1468")'> 1468:         return len(data)/ sizeof(Hydrogen_bond_component)</pre>
<pre id='line1468' class='code' style='background-color: #FFFF79'>
  /* "Cython_shift_calculator.pyx":1468
 *     cdef   int _bytes_to_components(self, data, Hydrogen_bond_component** target_pointer):
 *         target_pointer[0] =  <code><</code>Hydrogen_bond_component*> <code><</code>size_t> ctypes.addressof(data)
 *         return len(data)/ sizeof(Hydrogen_bond_component)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef  int _bytes_to_parameters(self,data, Hydrogen_bond_parameter** target_pointer):
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1468; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = (__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Hydrogen_bond_component)));
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Fast_hydrogen_bond_calculator._bytes_to_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1469")'> 1469: </pre>
<pre id='line1469' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1470")'> 1470:     cdef  int _bytes_to_parameters(self,data, Hydrogen_bond_parameter** target_pointer):</pre>
<pre id='line1470' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1470
 *         return len(data)/ sizeof(Hydrogen_bond_component)
 * 
 *     cdef  int _bytes_to_parameters(self,data, Hydrogen_bond_parameter** target_pointer):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         target_pointer[0] =  <code><</code>Hydrogen_bond_parameter*> <code><</code>size_t> ctypes.addressof(data)
 *         return len(data)/ sizeof(Hydrogen_bond_parameter)
 */

static int __pyx_f_17shift_calculators_29Fast_hydrogen_bond_calculator__bytes_to_parameters(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Fast_hydrogen_bond_calculator *__pyx_v_self, PyObject *__pyx_v_data, struct __pyx_t_17shift_calculators_Hydrogen_bond_parameter **__pyx_v_target_pointer) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_parameters", 0);
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line1471")'> 1471:         target_pointer[0] =  &lt;Hydrogen_bond_parameter*&gt; &lt;size_t&gt; ctypes.addressof(data)</pre>
<pre id='line1471' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":1471
 * 
 *     cdef  int _bytes_to_parameters(self,data, Hydrogen_bond_parameter** target_pointer):
 *         target_pointer[0] =  <code><</code>Hydrogen_bond_parameter*> <code><</code>size_t> ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return len(data)/ sizeof(Hydrogen_bond_parameter)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  (__pyx_v_target_pointer[0]) = ((struct __pyx_t_17shift_calculators_Hydrogen_bond_parameter *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line1472")'> 1472:         return len(data)/ sizeof(Hydrogen_bond_parameter)</pre>
<pre id='line1472' class='code' style='background-color: #FFFF79'>
  /* "Cython_shift_calculator.pyx":1472
 *     cdef  int _bytes_to_parameters(self,data, Hydrogen_bond_parameter** target_pointer):
 *         target_pointer[0] =  <code><</code>Hydrogen_bond_parameter*> <code><</code>size_t> ctypes.addressof(data)
 *         return len(data)/ sizeof(Hydrogen_bond_parameter)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef  int _bytes_to_donor_lookup(self,data, Hydrogen_bond_donor_lookup** target_pointer):
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1472; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = (__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Hydrogen_bond_parameter)));
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Fast_hydrogen_bond_calculator._bytes_to_parameters", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1473")'> 1473: </pre>
<pre id='line1473' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1474")'> 1474:     cdef  int _bytes_to_donor_lookup(self,data, Hydrogen_bond_donor_lookup** target_pointer):</pre>
<pre id='line1474' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1474
 *         return len(data)/ sizeof(Hydrogen_bond_parameter)
 * 
 *     cdef  int _bytes_to_donor_lookup(self,data, Hydrogen_bond_donor_lookup** target_pointer):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         target_pointer[0] =  <code><</code>Hydrogen_bond_donor_lookup*> <code><</code>size_t> ctypes.addressof(data)
 *         return len(data)/ sizeof(Hydrogen_bond_donor_lookup)
 */

static int __pyx_f_17shift_calculators_29Fast_hydrogen_bond_calculator__bytes_to_donor_lookup(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Fast_hydrogen_bond_calculator *__pyx_v_self, PyObject *__pyx_v_data, struct __pyx_t_17shift_calculators_Hydrogen_bond_donor_lookup **__pyx_v_target_pointer) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_donor_lookup", 0);
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line1475")'> 1475:         target_pointer[0] =  &lt;Hydrogen_bond_donor_lookup*&gt; &lt;size_t&gt; ctypes.addressof(data)</pre>
<pre id='line1475' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":1475
 * 
 *     cdef  int _bytes_to_donor_lookup(self,data, Hydrogen_bond_donor_lookup** target_pointer):
 *         target_pointer[0] =  <code><</code>Hydrogen_bond_donor_lookup*> <code><</code>size_t> ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return len(data)/ sizeof(Hydrogen_bond_donor_lookup)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1475; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1475; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1475; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1475; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1475; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  (__pyx_v_target_pointer[0]) = ((struct __pyx_t_17shift_calculators_Hydrogen_bond_donor_lookup *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line1476")'> 1476:         return len(data)/ sizeof(Hydrogen_bond_donor_lookup)</pre>
<pre id='line1476' class='code' style='background-color: #FFFF79'>
  /* "Cython_shift_calculator.pyx":1476
 *     cdef  int _bytes_to_donor_lookup(self,data, Hydrogen_bond_donor_lookup** target_pointer):
 *         target_pointer[0] =  <code><</code>Hydrogen_bond_donor_lookup*> <code><</code>size_t> ctypes.addressof(data)
 *         return len(data)/ sizeof(Hydrogen_bond_donor_lookup)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef  int _bytes_to_acceptor_lookup(self,data, Hydrogen_bond_acceptor_lookup** target_pointer):
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1476; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = (__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Hydrogen_bond_donor_lookup)));
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Fast_hydrogen_bond_calculator._bytes_to_donor_lookup", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1477")'> 1477: </pre>
<pre id='line1477' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1478")'> 1478:     cdef  int _bytes_to_acceptor_lookup(self,data, Hydrogen_bond_acceptor_lookup** target_pointer):</pre>
<pre id='line1478' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1478
 *         return len(data)/ sizeof(Hydrogen_bond_donor_lookup)
 * 
 *     cdef  int _bytes_to_acceptor_lookup(self,data, Hydrogen_bond_acceptor_lookup** target_pointer):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         target_pointer[0] =  <code><</code>Hydrogen_bond_acceptor_lookup*> <code><</code>size_t> ctypes.addressof(data)
 *         return len(data)/ sizeof(Hydrogen_bond_acceptor_lookup)
 */

static int __pyx_f_17shift_calculators_29Fast_hydrogen_bond_calculator__bytes_to_acceptor_lookup(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Fast_hydrogen_bond_calculator *__pyx_v_self, PyObject *__pyx_v_data, struct __pyx_t_17shift_calculators_Hydrogen_bond_acceptor_lookup **__pyx_v_target_pointer) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_acceptor_lookup", 0);
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line1479")'> 1479:         target_pointer[0] =  &lt;Hydrogen_bond_acceptor_lookup*&gt; &lt;size_t&gt; ctypes.addressof(data)</pre>
<pre id='line1479' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":1479
 * 
 *     cdef  int _bytes_to_acceptor_lookup(self,data, Hydrogen_bond_acceptor_lookup** target_pointer):
 *         target_pointer[0] =  <code><</code>Hydrogen_bond_acceptor_lookup*> <code><</code>size_t> ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return len(data)/ sizeof(Hydrogen_bond_acceptor_lookup)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  (__pyx_v_target_pointer[0]) = ((struct __pyx_t_17shift_calculators_Hydrogen_bond_acceptor_lookup *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line1480")'> 1480:         return len(data)/ sizeof(Hydrogen_bond_acceptor_lookup)</pre>
<pre id='line1480' class='code' style='background-color: #FFFF79'>
  /* "Cython_shift_calculator.pyx":1480
 *     cdef  int _bytes_to_acceptor_lookup(self,data, Hydrogen_bond_acceptor_lookup** target_pointer):
 *         target_pointer[0] =  <code><</code>Hydrogen_bond_acceptor_lookup*> <code><</code>size_t> ctypes.addressof(data)
 *         return len(data)/ sizeof(Hydrogen_bond_acceptor_lookup)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline bint _filter_by_residue(self, char* seg_1, int residue_1, char* seg_2, int residue_2):
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1480; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = (__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Hydrogen_bond_acceptor_lookup)));
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Fast_hydrogen_bond_calculator._bytes_to_acceptor_lookup", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1481")'> 1481: </pre>
<pre id='line1481' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1482")'> 1482:     cdef inline bint _filter_by_residue(self, char* seg_1, int residue_1, char* seg_2, int residue_2):</pre>
<pre id='line1482' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1482
 *         return len(data)/ sizeof(Hydrogen_bond_acceptor_lookup)
 * 
 *     cdef inline bint _filter_by_residue(self, char* seg_1, int residue_1, char* seg_2, int residue_2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int sequence_distance
 *         cdef bint result
 */

static CYTHON_INLINE int __pyx_f_17shift_calculators_29Fast_hydrogen_bond_calculator__filter_by_residue(struct __pyx_obj_17shift_calculators_Fast_hydrogen_bond_calculator *__pyx_v_self, char *__pyx_v_seg_1, int __pyx_v_residue_1, char *__pyx_v_seg_2, int __pyx_v_residue_2) {
  int __pyx_v_sequence_distance;
  int __pyx_v_result;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_filter_by_residue", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1483")'> 1483:         cdef int sequence_distance</pre>
<pre id='line1483' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1484")'> 1484:         cdef bint result</pre>
<pre id='line1484' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1485")'> 1485: </pre>
<pre id='line1485' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1486")'> 1486:         result = False</pre>
<pre id='line1486' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1486
 *         cdef bint result
 * 
 *         result = False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if strcmp(seg_1, seg_2) == 0:
 */
  __pyx_v_result = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1487")'> 1487: </pre>
<pre id='line1487' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1488")'> 1488:         if strcmp(seg_1, seg_2) == 0:</pre>
<pre id='line1488' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1488
 *         result = False
 * 
 *         if strcmp(seg_1, seg_2) == 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             sequence_distance =abs(residue_1-residue_2)
 *             if sequence_distance <code><</code> self._min_residue_seperation:
 */
  __pyx_t_1 = (strcmp(__pyx_v_seg_1, __pyx_v_seg_2) == 0);
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1489")'> 1489:             sequence_distance =abs(residue_1-residue_2)</pre>
<pre id='line1489' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1489
 * 
 *         if strcmp(seg_1, seg_2) == 0:
 *             sequence_distance =abs(residue_1-residue_2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if sequence_distance <code><</code> self._min_residue_seperation:
 *                 result =True
 */
    __pyx_t_2 = __Pyx_abs_int((__pyx_v_residue_1 - __pyx_v_residue_2)); 
    __pyx_v_sequence_distance = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1490")'> 1490:             if sequence_distance &lt; self._min_residue_seperation:</pre>
<pre id='line1490' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1490
 *         if strcmp(seg_1, seg_2) == 0:
 *             sequence_distance =abs(residue_1-residue_2)
 *             if sequence_distance <code><</code> self._min_residue_seperation:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 result =True
 *         return result
 */
    __pyx_t_1 = (__pyx_v_sequence_distance <code><</code> __pyx_v_self->_min_residue_seperation);
    if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1491")'> 1491:                 result =True</pre>
<pre id='line1491' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1491
 *             sequence_distance =abs(residue_1-residue_2)
 *             if sequence_distance <code><</code> self._min_residue_seperation:
 *                 result =True             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return result
 * 
 */
      __pyx_v_result = 1;
      goto __pyx_L4;
    }
    __pyx_L4:;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1492")'> 1492:         return result</pre>
<pre id='line1492' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":1492
 *             if sequence_distance <code><</code> self._min_residue_seperation:
 *                 result =True
 *         return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline float _calc_energy(self, float distance_or_angle, Hydrogen_bond_parameter params):
 */
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1493")'> 1493: </pre>
<pre id='line1493' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1494")'> 1494:     cdef inline float _calc_energy(self, float distance_or_angle, Hydrogen_bond_parameter params):</pre>
<pre id='line1494' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1494
 *         return result
 * 
 *     cdef inline float _calc_energy(self, float distance_or_angle, Hydrogen_bond_parameter params):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */

static CYTHON_INLINE float __pyx_f_17shift_calculators_29Fast_hydrogen_bond_calculator__calc_energy(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Fast_hydrogen_bond_calculator *__pyx_v_self, float __pyx_v_distance_or_angle, struct __pyx_t_17shift_calculators_Hydrogen_bond_parameter __pyx_v_params) {
  float __pyx_v_term_1;
  float __pyx_v_term_2;
  float __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calc_energy", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1495")'> 1495: </pre>
<pre id='line1495' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1496")'> 1496: </pre>
<pre id='line1496' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1497")'> 1497:         cdef float term_1 = (params.p[1]/distance_or_angle) + params.p[3]</pre>
<pre id='line1497' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1497
 * 
 * 
 *         cdef float term_1 = (params.p[1]/distance_or_angle) + params.p[3]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef float term_2 = (params.p[2]/distance_or_angle) + params.p[4]
 * 
 */
  __pyx_v_term_1 = (((__pyx_v_params.p[1]) / __pyx_v_distance_or_angle) + (__pyx_v_params.p[3]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1498")'> 1498:         cdef float term_2 = (params.p[2]/distance_or_angle) + params.p[4]</pre>
<pre id='line1498' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1498
 * 
 *         cdef float term_1 = (params.p[1]/distance_or_angle) + params.p[3]
 *         cdef float term_2 = (params.p[2]/distance_or_angle) + params.p[4]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         return params.p[0] * (term_1**params.r - term_2**params.s) + params.p[5]
 */
  __pyx_v_term_2 = (((__pyx_v_params.p[2]) / __pyx_v_distance_or_angle) + (__pyx_v_params.p[4]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1499")'> 1499: </pre>
<pre id='line1499' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2d' onclick='toggleDiv("line1500")'> 1500:         return params.p[0] * (term_1**params.r - term_2**params.s) + params.p[5]</pre>
<pre id='line1500' class='code' style='background-color: #FFFF2d'>
  /* "Cython_shift_calculator.pyx":1500
 *         cdef float term_2 = (params.p[2]/distance_or_angle) + params.p[4]
 * 
 *         return params.p[0] * (term_1**params.r - term_2**params.s) + params.p[5]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     @cython.profile(True)
 */
  __pyx_r = (((__pyx_v_params.p[0]) * (powf(__pyx_v_term_1, __pyx_v_params.r) - powf(__pyx_v_term_2, __pyx_v_params.s))) + (__pyx_v_params.p[5]));
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_29Fast_hydrogen_bond_calculator_5__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_29Fast_hydrogen_bond_calculator_5__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_components = 0;
  __Pyx_memviewslice __pyx_v_donor_energies = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_acceptor_energies = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__call__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__components,&__pyx_n_s__donor_energies,&__pyx_n_s__acceptor_energies,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__components)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__donor_energies)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 3, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1503; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__acceptor_energies)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 3, 3, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1503; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__call__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1503; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_components = values[0];
    __pyx_v_donor_energies = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(values[1]);<span class='error_goto'> if (unlikely(!__pyx_v_donor_energies.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1503; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_acceptor_energies = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(values[2]);<span class='error_goto'> if (unlikely(!__pyx_v_acceptor_energies.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1503; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1503; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_hydrogen_bond_calculator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_29Fast_hydrogen_bond_calculator_4__call__(((struct __pyx_obj_17shift_calculators_Fast_hydrogen_bond_calculator *)__pyx_v_self), __pyx_v_components, __pyx_v_donor_energies, __pyx_v_acceptor_energies);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1501")'> 1501: </pre>
<pre id='line1501' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1502")'> 1502:     @cython.profile(True)</pre>
<pre id='line1502' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1503")'> 1503:     def __call__(self, components, float[:] donor_energies, float[:] acceptor_energies):#,  Hydrogen_bond_energy_list energy_list):</pre>
<pre id='line1503' class='code' style='background-color: #FFFFd4'>
/* "Cython_shift_calculator.pyx":1503
 * 
 *     @cython.profile(True)
 *     def __call__(self, components, float[:] donor_energies, float[:] acceptor_energies):#,  Hydrogen_bond_energy_list energy_list):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         donor_list = components['DONR']
 */

static PyObject *__pyx_pf_17shift_calculators_29Fast_hydrogen_bond_calculator_4__call__(struct __pyx_obj_17shift_calculators_Fast_hydrogen_bond_calculator *__pyx_v_self, PyObject *__pyx_v_components, __Pyx_memviewslice __pyx_v_donor_energies, __Pyx_memviewslice __pyx_v_acceptor_energies) {
  PyObject *__pyx_v_donor_list = NULL;
  PyObject *__pyx_v_acceptor_list = NULL;
  PyObject *__pyx_v_parameters = NULL;
  PyObject *__pyx_v_donor_indices = NULL;
  PyObject *__pyx_v_acceptor_indices = NULL;
  struct __pyx_t_17shift_calculators_Hydrogen_bond_component *__pyx_v_donor_components;
  int __pyx_v_num_donor_components;
  struct __pyx_t_17shift_calculators_Hydrogen_bond_component *__pyx_v_acceptor_components;
  int __pyx_v_num_acceptor_components;
  struct __pyx_t_17shift_calculators_Hydrogen_bond_donor_lookup *__pyx_v_donor_lookup;
  CYTHON_UNUSED int __pyx_v_num_donor_lookup_components;
  struct __pyx_t_17shift_calculators_Hydrogen_bond_parameter *__pyx_v_hydrogen_bond_parameters;
  CYTHON_UNUSED int __pyx_v_num_parameters;
  struct __pyx_t_17shift_calculators_Hydrogen_bond_acceptor_lookup *__pyx_v_acceptor_lookup;
  CYTHON_UNUSED int __pyx_v_num_acceptor_lookup_components;
  double __pyx_v_start_time;
  double __pyx_v_end_time;
  Atom __pyx_v_atom_1;
  Atom __pyx_v_atom_2;
  CYTHON_UNUSED int __pyx_v_current_acceptor;
  int __pyx_v_atom_id_1;
  int __pyx_v_atom_id_2;
  float __pyx_v_distance;
  float __pyx_v_min_distance;
  float __pyx_v_FLT_MAX;
  struct __pyx_t_17shift_calculators_bond_angle_ids __pyx_v_bond_angle_atom_ids;
  char *__pyx_v_seg_1;
  char *__pyx_v_seg_2;
  int __pyx_v_residue_1;
  int __pyx_v_residue_2;
  struct __pyx_t_17shift_calculators_Hydrogen_bond_parameter __pyx_v_params_dist;
  struct __pyx_t_17shift_calculators_Hydrogen_bond_parameter __pyx_v_params_angle_1;
  struct __pyx_t_17shift_calculators_Hydrogen_bond_parameter __pyx_v_params_angle_2;
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_residue_distance_ok;
  int __pyx_v_donor_index;
  int __pyx_v_acceptor_index;
  int __pyx_v_donor_direct_atom_id;
  int __pyx_v_donor_indirect_atom_id;
  int __pyx_v_acceptor_direct_atom_id;
  int __pyx_v_acceptor_indirect_atom_id;
  PyObject *__pyx_v_angle_1 = NULL;
  PyObject *__pyx_v_angle_2 = NULL;
  int __pyx_v_donor_atom_type_id;
  int __pyx_v_acceptor_atom_type_id;
  int __pyx_v_acceptor_id;
  int __pyx_v_param_id_dist;
  int __pyx_v_param_id_angle_1;
  int __pyx_v_param_id_angle_2;
  PyObject *__pyx_v_energy_dist = NULL;
  PyObject *__pyx_v_energy_ang_1 = NULL;
  PyObject *__pyx_v_energy_ang_2 = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__call__", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("__call__", __pyx_f[0], 1503);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1504")'> 1504: </pre>
<pre id='line1504' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1505")'> 1505:         donor_list = components['DONR']</pre>
<pre id='line1505' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":1505
 *     def __call__(self, components, float[:] donor_energies, float[:] acceptor_energies):#,  Hydrogen_bond_energy_list energy_list):
 * 
 *         donor_list = components['DONR']             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         acceptor_list =  components['ACCP']
 *         parameters =  components['PARA']
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_components, ((PyObject *)__pyx_n_s__DONR));<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1505; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_donor_list = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1506")'> 1506:         acceptor_list =  components['ACCP']</pre>
<pre id='line1506' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":1506
 * 
 *         donor_list = components['DONR']
 *         acceptor_list =  components['ACCP']             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         parameters =  components['PARA']
 *         donor_indices = components['DIDX']
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_components, ((PyObject *)__pyx_n_s__ACCP));<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_acceptor_list = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1507")'> 1507:         parameters =  components['PARA']</pre>
<pre id='line1507' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":1507
 *         donor_list = components['DONR']
 *         acceptor_list =  components['ACCP']
 *         parameters =  components['PARA']             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         donor_indices = components['DIDX']
 *         acceptor_indices = components['AIDX']
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_components, ((PyObject *)__pyx_n_s__PARA));<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1507; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_parameters = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1508")'> 1508:         donor_indices = components['DIDX']</pre>
<pre id='line1508' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":1508
 *         acceptor_list =  components['ACCP']
 *         parameters =  components['PARA']
 *         donor_indices = components['DIDX']             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         acceptor_indices = components['AIDX']
 * 
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_components, ((PyObject *)__pyx_n_s__DIDX));<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1508; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_donor_indices = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1509")'> 1509:         acceptor_indices = components['AIDX']</pre>
<pre id='line1509' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":1509
 *         parameters =  components['PARA']
 *         donor_indices = components['DIDX']
 *         acceptor_indices = components['AIDX']             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if self._verbose:
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_components, ((PyObject *)__pyx_n_s__AIDX));<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_acceptor_indices = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1510")'> 1510: </pre>
<pre id='line1510' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1511")'> 1511:         if self._verbose:</pre>
<pre id='line1511' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1511
 *         acceptor_indices = components['AIDX']
 * 
 *         if self._verbose:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print '***** BUILD HYDROGEN BOND LIST ******'
 * 
 */
  if (__pyx_v_self->_verbose) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1512")'> 1512:             print '***** BUILD HYDROGEN BOND LIST ******'</pre>
<pre id='line1512' class='code' style='background-color: #FFFFd4'>
    /* "Cython_shift_calculator.pyx":1512
 * 
 *         if self._verbose:
 *             print '***** BUILD HYDROGEN BOND LIST ******'             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef  Hydrogen_bond_component* donor_components
 */
    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, ((PyObject *)__pyx_kp_s_39)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1512; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1513")'> 1513: </pre>
<pre id='line1513' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1514")'> 1514:         cdef  Hydrogen_bond_component* donor_components</pre>
<pre id='line1514' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1515")'> 1515:         cdef int num_donor_components = self._bytes_to_components(donor_list,&amp;donor_components)</pre>
<pre id='line1515' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1515
 * 
 *         cdef  Hydrogen_bond_component* donor_components
 *         cdef int num_donor_components = self._bytes_to_components(donor_list,&donor_components)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Hydrogen_bond_component* acceptor_components
 */
  __pyx_v_num_donor_components = ((struct __pyx_vtabstruct_17shift_calculators_Fast_hydrogen_bond_calculator *)__pyx_v_self->__pyx_vtab)->_bytes_to_components(__pyx_v_self, __pyx_v_donor_list, (&__pyx_v_donor_components));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1516")'> 1516: </pre>
<pre id='line1516' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1517")'> 1517:         cdef Hydrogen_bond_component* acceptor_components</pre>
<pre id='line1517' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1518")'> 1518:         cdef int num_acceptor_components = self._bytes_to_components(acceptor_list,&amp;acceptor_components)</pre>
<pre id='line1518' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1518
 * 
 *         cdef Hydrogen_bond_component* acceptor_components
 *         cdef int num_acceptor_components = self._bytes_to_components(acceptor_list,&acceptor_components)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Hydrogen_bond_donor_lookup* donor_lookup
 */
  __pyx_v_num_acceptor_components = ((struct __pyx_vtabstruct_17shift_calculators_Fast_hydrogen_bond_calculator *)__pyx_v_self->__pyx_vtab)->_bytes_to_components(__pyx_v_self, __pyx_v_acceptor_list, (&__pyx_v_acceptor_components));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1519")'> 1519: </pre>
<pre id='line1519' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1520")'> 1520:         cdef Hydrogen_bond_donor_lookup* donor_lookup</pre>
<pre id='line1520' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1521")'> 1521:         cdef int num_donor_lookup_components = self._bytes_to_donor_lookup(donor_indices,&amp;donor_lookup)</pre>
<pre id='line1521' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1521
 * 
 *         cdef Hydrogen_bond_donor_lookup* donor_lookup
 *         cdef int num_donor_lookup_components = self._bytes_to_donor_lookup(donor_indices,&donor_lookup)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Hydrogen_bond_parameter* hydrogen_bond_parameters
 */
  __pyx_v_num_donor_lookup_components = ((struct __pyx_vtabstruct_17shift_calculators_Fast_hydrogen_bond_calculator *)__pyx_v_self->__pyx_vtab)->_bytes_to_donor_lookup(__pyx_v_self, __pyx_v_donor_indices, (&__pyx_v_donor_lookup));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1522")'> 1522: </pre>
<pre id='line1522' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1523")'> 1523:         cdef Hydrogen_bond_parameter* hydrogen_bond_parameters</pre>
<pre id='line1523' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1524")'> 1524:         cdef int num_parameters = self._bytes_to_parameters(parameters, &amp;hydrogen_bond_parameters)</pre>
<pre id='line1524' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1524
 * 
 *         cdef Hydrogen_bond_parameter* hydrogen_bond_parameters
 *         cdef int num_parameters = self._bytes_to_parameters(parameters, &hydrogen_bond_parameters)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Hydrogen_bond_acceptor_lookup* acceptor_lookup
 */
  __pyx_v_num_parameters = ((struct __pyx_vtabstruct_17shift_calculators_Fast_hydrogen_bond_calculator *)__pyx_v_self->__pyx_vtab)->_bytes_to_parameters(__pyx_v_self, __pyx_v_parameters, (&__pyx_v_hydrogen_bond_parameters));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1525")'> 1525: </pre>
<pre id='line1525' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1526")'> 1526:         cdef Hydrogen_bond_acceptor_lookup* acceptor_lookup</pre>
<pre id='line1526' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1527")'> 1527:         cdef int num_acceptor_lookup_components = self._bytes_to_acceptor_lookup(acceptor_indices,&amp;acceptor_lookup)</pre>
<pre id='line1527' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1527
 * 
 *         cdef Hydrogen_bond_acceptor_lookup* acceptor_lookup
 *         cdef int num_acceptor_lookup_components = self._bytes_to_acceptor_lookup(acceptor_indices,&acceptor_lookup)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef double start_time = 0.0
 */
  __pyx_v_num_acceptor_lookup_components = ((struct __pyx_vtabstruct_17shift_calculators_Fast_hydrogen_bond_calculator *)__pyx_v_self->__pyx_vtab)->_bytes_to_acceptor_lookup(__pyx_v_self, __pyx_v_acceptor_indices, (&__pyx_v_acceptor_lookup));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1528")'> 1528: </pre>
<pre id='line1528' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1529")'> 1529:         cdef double start_time = 0.0</pre>
<pre id='line1529' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1529
 *         cdef int num_acceptor_lookup_components = self._bytes_to_acceptor_lookup(acceptor_indices,&acceptor_lookup)
 * 
 *         cdef double start_time = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef double end_time = 0.0
 * 
 */
  __pyx_v_start_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1530")'> 1530:         cdef double end_time = 0.0</pre>
<pre id='line1530' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1530
 * 
 *         cdef double start_time = 0.0
 *         cdef double end_time = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Atom atom_1, atom_2
 */
  __pyx_v_end_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1531")'> 1531: </pre>
<pre id='line1531' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1532")'> 1532:         cdef Atom atom_1, atom_2</pre>
<pre id='line1532' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1533")'> 1533:         cdef int current_acceptor</pre>
<pre id='line1533' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1534")'> 1534:         cdef int atom_id_1,atom_id_2</pre>
<pre id='line1534' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1535")'> 1535:         cdef float distance</pre>
<pre id='line1535' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1536")'> 1536:         cdef float min_distance</pre>
<pre id='line1536' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1537")'> 1537:         cdef float FLT_MAX=1000000.0 #TODO: replacce with header</pre>
<pre id='line1537' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1537
 *         cdef float distance
 *         cdef float min_distance
 *         cdef float FLT_MAX=1000000.0 #TODO: replacce with header             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef bond_angle_ids bond_angle_atom_ids
 */
  __pyx_v_FLT_MAX = 1000000.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1538")'> 1538: </pre>
<pre id='line1538' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1539")'> 1539:         cdef bond_angle_ids bond_angle_atom_ids</pre>
<pre id='line1539' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1540")'> 1540: </pre>
<pre id='line1540' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1541")'> 1541:         cdef char *seg_1, *seg_2</pre>
<pre id='line1541' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1542")'> 1542:         cdef int residue_1, residue_2</pre>
<pre id='line1542' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1543")'> 1543: </pre>
<pre id='line1543' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1544")'> 1544:         cdef Hydrogen_bond_parameter params_dist</pre>
<pre id='line1544' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1545")'> 1545:         cdef Hydrogen_bond_parameter params_angle_1</pre>
<pre id='line1545' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1546")'> 1546:         cdef Hydrogen_bond_parameter params_angle_2</pre>
<pre id='line1546' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1547")'> 1547: </pre>
<pre id='line1547' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1548")'> 1548:         if self._verbose:</pre>
<pre id='line1548' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1548
 *         cdef Hydrogen_bond_parameter params_angle_2
 * 
 *         if self._verbose:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             start_time = time()
 * 
 */
  if (__pyx_v_self->_verbose) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line1549")'> 1549:             start_time = time()</pre>
<pre id='line1549' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":1549
 * 
 *         if self._verbose:
 *             start_time = time()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__time);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1549; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1549; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1549; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_start_time = __pyx_t_3;
    goto __pyx_L4;
  }
  __pyx_L4:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1550")'> 1550: </pre>
<pre id='line1550' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1551")'> 1551: </pre>
<pre id='line1551' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1552")'> 1552:         cdef int i</pre>
<pre id='line1552' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1553")'> 1553: </pre>
<pre id='line1553' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1554")'> 1554: #         hydrogen_bond_list.clear()</pre>
<pre id='line1554' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1555")'> 1555:         for i in range(num_donor_components):</pre>
<pre id='line1555' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1555
 * 
 * #         hydrogen_bond_list.clear()
 *         for i in range(num_donor_components):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             atom_id_1 = donor_components[i].direct_atom_id
 * 
 */
  __pyx_t_4 = __pyx_v_num_donor_components;
  for (__pyx_t_5 = 0; __pyx_t_5 <code><</code> __pyx_t_4; __pyx_t_5+=1) {
    __pyx_v_i = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1556")'> 1556:             atom_id_1 = donor_components[i].direct_atom_id</pre>
<pre id='line1556' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1556
 * #         hydrogen_bond_list.clear()
 *         for i in range(num_donor_components):
 *             atom_id_1 = donor_components[i].direct_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             atom_1 = self._simulation[0].atomByID(atom_id_1)
 */
    __pyx_t_6 = (__pyx_v_donor_components[__pyx_v_i]).direct_atom_id;
    __pyx_v_atom_id_1 = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1557")'> 1557: </pre>
<pre id='line1557' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1558")'> 1558:             atom_1 = self._simulation[0].atomByID(atom_id_1)</pre>
<pre id='line1558' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1558
 *             atom_id_1 = donor_components[i].direct_atom_id
 * 
 *             atom_1 = self._simulation[0].atomByID(atom_id_1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             seg_1 =  <code><</code>char *>atom_1.segmentName()
 *             residue_1 = atom_1.residueNum()
 */
    __pyx_v_atom_1 = (__pyx_v_self->_simulation[0]).atomByID(__pyx_v_atom_id_1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1559")'> 1559:             seg_1 =  &lt;char *&gt;atom_1.segmentName()</pre>
<pre id='line1559' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1559
 * 
 *             atom_1 = self._simulation[0].atomByID(atom_id_1)
 *             seg_1 =  <code><</code>char *>atom_1.segmentName()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             residue_1 = atom_1.residueNum()
 * 
 */
    __pyx_v_seg_1 = ((char *)__pyx_v_atom_1.segmentName());
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1560")'> 1560:             residue_1 = atom_1.residueNum()</pre>
<pre id='line1560' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1560
 *             atom_1 = self._simulation[0].atomByID(atom_id_1)
 *             seg_1 =  <code><</code>char *>atom_1.segmentName()
 *             residue_1 = atom_1.residueNum()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             current_acceptor = -1
 */
    __pyx_v_residue_1 = __pyx_v_atom_1.residueNum();
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1561")'> 1561: </pre>
<pre id='line1561' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1562")'> 1562:             current_acceptor = -1</pre>
<pre id='line1562' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1562
 *             residue_1 = atom_1.residueNum()
 * 
 *             current_acceptor = -1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             min_distance = FLT_MAX
 * 
 */
    __pyx_v_current_acceptor = -1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1563")'> 1563:             min_distance = FLT_MAX</pre>
<pre id='line1563' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1563
 * 
 *             current_acceptor = -1
 *             min_distance = FLT_MAX             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             for j in range(num_acceptor_components):
 */
    __pyx_v_min_distance = __pyx_v_FLT_MAX;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1564")'> 1564: </pre>
<pre id='line1564' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1565")'> 1565:             for j in range(num_acceptor_components):</pre>
<pre id='line1565' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1565
 *             min_distance = FLT_MAX
 * 
 *             for j in range(num_acceptor_components):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 atom_id_2  = acceptor_components[j].direct_atom_id
 * 
 */
    __pyx_t_6 = __pyx_v_num_acceptor_components;
    for (__pyx_t_7 = 0; __pyx_t_7 <code><</code> __pyx_t_6; __pyx_t_7+=1) {
      __pyx_v_j = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1566")'> 1566:                 atom_id_2  = acceptor_components[j].direct_atom_id</pre>
<pre id='line1566' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1566
 * 
 *             for j in range(num_acceptor_components):
 *                 atom_id_2  = acceptor_components[j].direct_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 atom_2 = self._simulation[0].atomByID(atom_id_2)
 */
      __pyx_t_8 = (__pyx_v_acceptor_components[__pyx_v_j]).direct_atom_id;
      __pyx_v_atom_id_2 = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1567")'> 1567: </pre>
<pre id='line1567' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1568")'> 1568:                 atom_2 = self._simulation[0].atomByID(atom_id_2)</pre>
<pre id='line1568' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1568
 *                 atom_id_2  = acceptor_components[j].direct_atom_id
 * 
 *                 atom_2 = self._simulation[0].atomByID(atom_id_2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
      __pyx_v_atom_2 = (__pyx_v_self->_simulation[0]).atomByID(__pyx_v_atom_id_2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1569")'> 1569: </pre>
<pre id='line1569' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1570")'> 1570: </pre>
<pre id='line1570' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1571")'> 1571:                 seg_2 = &lt;char*&gt;atom_2.segmentName()</pre>
<pre id='line1571' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1571
 * 
 * 
 *                 seg_2 = <code><</code>char*>atom_2.segmentName()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 residue_2 =  atom_2.residueNum()
 * 
 */
      __pyx_v_seg_2 = ((char *)__pyx_v_atom_2.segmentName());
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1572")'> 1572:                 residue_2 =  atom_2.residueNum()</pre>
<pre id='line1572' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1572
 * 
 *                 seg_2 = <code><</code>char*>atom_2.segmentName()
 *                 residue_2 =  atom_2.residueNum()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 distance = norm(atom_1.pos() - atom_2.pos())
 */
      __pyx_v_residue_2 = __pyx_v_atom_2.residueNum();
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1573")'> 1573: </pre>
<pre id='line1573' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1574")'> 1574:                 distance = norm(atom_1.pos() - atom_2.pos())</pre>
<pre id='line1574' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1574
 *                 residue_2 =  atom_2.residueNum()
 * 
 *                 distance = norm(atom_1.pos() - atom_2.pos())             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 residue_distance_ok = not self._filter_by_residue(seg_1, residue_1, seg_2, residue_2)
 * 
 */
      __pyx_v_distance = norm((__pyx_v_atom_1.pos() - __pyx_v_atom_2.pos()));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1575")'> 1575:                 residue_distance_ok = not self._filter_by_residue(seg_1, residue_1, seg_2, residue_2)</pre>
<pre id='line1575' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1575
 * 
 *                 distance = norm(atom_1.pos() - atom_2.pos())
 *                 residue_distance_ok = not self._filter_by_residue(seg_1, residue_1, seg_2, residue_2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 if distance <code><</code> min_distance and residue_distance_ok:
 */
      __pyx_v_residue_distance_ok = (!__pyx_f_17shift_calculators_29Fast_hydrogen_bond_calculator__filter_by_residue(__pyx_v_self, __pyx_v_seg_1, __pyx_v_residue_1, __pyx_v_seg_2, __pyx_v_residue_2));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1576")'> 1576: </pre>
<pre id='line1576' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1577")'> 1577:                 if distance &lt; min_distance and residue_distance_ok:</pre>
<pre id='line1577' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1577
 *                 residue_distance_ok = not self._filter_by_residue(seg_1, residue_1, seg_2, residue_2)
 * 
 *                 if distance <code><</code> min_distance and residue_distance_ok:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     donor_index = i
 *                     acceptor_index  = j
 */
      __pyx_t_9 = (__pyx_v_distance <code><</code> __pyx_v_min_distance);
      if (__pyx_t_9) {
        __pyx_t_10 = __pyx_v_residue_distance_ok;
      } else {
        __pyx_t_10 = __pyx_t_9;
      }
      if (__pyx_t_10) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1578")'> 1578:                     donor_index = i</pre>
<pre id='line1578' class='code' style='background-color: #FFFFff'>
        /* "Cython_shift_calculator.pyx":1578
 * 
 *                 if distance <code><</code> min_distance and residue_distance_ok:
 *                     donor_index = i             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     acceptor_index  = j
 *                     min_distance = distance
 */
        __pyx_v_donor_index = __pyx_v_i;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1579")'> 1579:                     acceptor_index  = j</pre>
<pre id='line1579' class='code' style='background-color: #FFFFff'>
        /* "Cython_shift_calculator.pyx":1579
 *                 if distance <code><</code> min_distance and residue_distance_ok:
 *                     donor_index = i
 *                     acceptor_index  = j             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     min_distance = distance
 * 
 */
        __pyx_v_acceptor_index = __pyx_v_j;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1580")'> 1580:                     min_distance = distance</pre>
<pre id='line1580' class='code' style='background-color: #FFFFff'>
        /* "Cython_shift_calculator.pyx":1580
 *                     donor_index = i
 *                     acceptor_index  = j
 *                     min_distance = distance             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             if  min_distance <code><</code> 3.0:
 */
        __pyx_v_min_distance = __pyx_v_distance;
        goto __pyx_L9;
      }
      __pyx_L9:;
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1581")'> 1581: </pre>
<pre id='line1581' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1582")'> 1582:             if  min_distance &lt; 3.0:</pre>
<pre id='line1582' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1582
 *                     min_distance = distance
 * 
 *             if  min_distance <code><</code> 3.0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 donor_direct_atom_id = donor_components[donor_index].direct_atom_id
 *                 donor_indirect_atom_id = donor_components[donor_index].indirect_atom_id
 */
    __pyx_t_10 = (__pyx_v_min_distance <code><</code> 3.0);
    if (__pyx_t_10) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1583")'> 1583:                 donor_direct_atom_id = donor_components[donor_index].direct_atom_id</pre>
<pre id='line1583' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1583
 * 
 *             if  min_distance <code><</code> 3.0:
 *                 donor_direct_atom_id = donor_components[donor_index].direct_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 donor_indirect_atom_id = donor_components[donor_index].indirect_atom_id
 *                 acceptor_direct_atom_id = acceptor_components[acceptor_index].direct_atom_id
 */
      __pyx_t_6 = (__pyx_v_donor_components[__pyx_v_donor_index]).direct_atom_id;
      __pyx_v_donor_direct_atom_id = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1584")'> 1584:                 donor_indirect_atom_id = donor_components[donor_index].indirect_atom_id</pre>
<pre id='line1584' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1584
 *             if  min_distance <code><</code> 3.0:
 *                 donor_direct_atom_id = donor_components[donor_index].direct_atom_id
 *                 donor_indirect_atom_id = donor_components[donor_index].indirect_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 acceptor_direct_atom_id = acceptor_components[acceptor_index].direct_atom_id
 *                 acceptor_indirect_atom_id = acceptor_components[acceptor_index].indirect_atom_id
 */
      __pyx_t_6 = (__pyx_v_donor_components[__pyx_v_donor_index]).indirect_atom_id;
      __pyx_v_donor_indirect_atom_id = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1585")'> 1585:                 acceptor_direct_atom_id = acceptor_components[acceptor_index].direct_atom_id</pre>
<pre id='line1585' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1585
 *                 donor_direct_atom_id = donor_components[donor_index].direct_atom_id
 *                 donor_indirect_atom_id = donor_components[donor_index].indirect_atom_id
 *                 acceptor_direct_atom_id = acceptor_components[acceptor_index].direct_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 acceptor_indirect_atom_id = acceptor_components[acceptor_index].indirect_atom_id
 * 
 */
      __pyx_t_6 = (__pyx_v_acceptor_components[__pyx_v_acceptor_index]).direct_atom_id;
      __pyx_v_acceptor_direct_atom_id = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1586")'> 1586:                 acceptor_indirect_atom_id = acceptor_components[acceptor_index].indirect_atom_id</pre>
<pre id='line1586' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1586
 *                 donor_indirect_atom_id = donor_components[donor_index].indirect_atom_id
 *                 acceptor_direct_atom_id = acceptor_components[acceptor_index].direct_atom_id
 *                 acceptor_indirect_atom_id = acceptor_components[acceptor_index].indirect_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 bond_angle_atom_ids.atom_id_1 = donor_direct_atom_id
 */
      __pyx_t_6 = (__pyx_v_acceptor_components[__pyx_v_acceptor_index]).indirect_atom_id;
      __pyx_v_acceptor_indirect_atom_id = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1587")'> 1587: </pre>
<pre id='line1587' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1588")'> 1588:                 bond_angle_atom_ids.atom_id_1 = donor_direct_atom_id</pre>
<pre id='line1588' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1588
 *                 acceptor_indirect_atom_id = acceptor_components[acceptor_index].indirect_atom_id
 * 
 *                 bond_angle_atom_ids.atom_id_1 = donor_direct_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 bond_angle_atom_ids.atom_id_2 = acceptor_direct_atom_id
 *                 bond_angle_atom_ids.atom_id_3 = acceptor_indirect_atom_id
 */
      __pyx_v_bond_angle_atom_ids.atom_id_1 = __pyx_v_donor_direct_atom_id;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1589")'> 1589:                 bond_angle_atom_ids.atom_id_2 = acceptor_direct_atom_id</pre>
<pre id='line1589' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1589
 * 
 *                 bond_angle_atom_ids.atom_id_1 = donor_direct_atom_id
 *                 bond_angle_atom_ids.atom_id_2 = acceptor_direct_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 bond_angle_atom_ids.atom_id_3 = acceptor_indirect_atom_id
 * 
 */
      __pyx_v_bond_angle_atom_ids.atom_id_2 = __pyx_v_acceptor_direct_atom_id;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1590")'> 1590:                 bond_angle_atom_ids.atom_id_3 = acceptor_indirect_atom_id</pre>
<pre id='line1590' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1590
 *                 bond_angle_atom_ids.atom_id_1 = donor_direct_atom_id
 *                 bond_angle_atom_ids.atom_id_2 = acceptor_direct_atom_id
 *                 bond_angle_atom_ids.atom_id_3 = acceptor_indirect_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 angle_1 = calc_bond_angle_simulation(self._simulation, bond_angle_atom_ids)
 */
      __pyx_v_bond_angle_atom_ids.atom_id_3 = __pyx_v_acceptor_indirect_atom_id;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1591")'> 1591: </pre>
<pre id='line1591' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line1592")'> 1592:                 angle_1 = calc_bond_angle_simulation(self._simulation, bond_angle_atom_ids)</pre>
<pre id='line1592' class='code' style='background-color: #FFFF9f'>
      /* "Cython_shift_calculator.pyx":1592
 *                 bond_angle_atom_ids.atom_id_3 = acceptor_indirect_atom_id
 * 
 *                 angle_1 = calc_bond_angle_simulation(self._simulation, bond_angle_atom_ids)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #
 */
      __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_17shift_calculators_calc_bond_angle_simulation(__pyx_v_self->_simulation, __pyx_v_bond_angle_atom_ids));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1592; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_angle_1);
      __pyx_v_angle_1 = __pyx_t_2;
      __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1593")'> 1593: </pre>
<pre id='line1593' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1594")'> 1594: #</pre>
<pre id='line1594' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1595")'> 1595:                 bond_angle_atom_ids.atom_id_1 = donor_indirect_atom_id</pre>
<pre id='line1595' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1595
 * 
 * #
 *                 bond_angle_atom_ids.atom_id_1 = donor_indirect_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 bond_angle_atom_ids.atom_id_2 = donor_direct_atom_id
 *                 bond_angle_atom_ids.atom_id_3 = acceptor_direct_atom_id
 */
      __pyx_v_bond_angle_atom_ids.atom_id_1 = __pyx_v_donor_indirect_atom_id;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1596")'> 1596:                 bond_angle_atom_ids.atom_id_2 = donor_direct_atom_id</pre>
<pre id='line1596' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1596
 * #
 *                 bond_angle_atom_ids.atom_id_1 = donor_indirect_atom_id
 *                 bond_angle_atom_ids.atom_id_2 = donor_direct_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 bond_angle_atom_ids.atom_id_3 = acceptor_direct_atom_id
 * 
 */
      __pyx_v_bond_angle_atom_ids.atom_id_2 = __pyx_v_donor_direct_atom_id;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1597")'> 1597:                 bond_angle_atom_ids.atom_id_3 = acceptor_direct_atom_id</pre>
<pre id='line1597' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1597
 *                 bond_angle_atom_ids.atom_id_1 = donor_indirect_atom_id
 *                 bond_angle_atom_ids.atom_id_2 = donor_direct_atom_id
 *                 bond_angle_atom_ids.atom_id_3 = acceptor_direct_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 angle_2 = calc_bond_angle_simulation(self._simulation, bond_angle_atom_ids)
 */
      __pyx_v_bond_angle_atom_ids.atom_id_3 = __pyx_v_acceptor_direct_atom_id;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1598")'> 1598: </pre>
<pre id='line1598' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line1599")'> 1599:                 angle_2 = calc_bond_angle_simulation(self._simulation, bond_angle_atom_ids)</pre>
<pre id='line1599' class='code' style='background-color: #FFFF9f'>
      /* "Cython_shift_calculator.pyx":1599
 *                 bond_angle_atom_ids.atom_id_3 = acceptor_direct_atom_id
 * 
 *                 angle_2 = calc_bond_angle_simulation(self._simulation, bond_angle_atom_ids)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 if (angle_1 > PI/2.0 and angle_1 <code><</code> PI *3.0/2.0) and (angle_2 > PI/2.0 and angle_2 <code><</code> PI *3.0/2.0):
 */
      __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_17shift_calculators_calc_bond_angle_simulation(__pyx_v_self->_simulation, __pyx_v_bond_angle_atom_ids));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1599; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_angle_2);
      __pyx_v_angle_2 = __pyx_t_2;
      __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1600")'> 1600: </pre>
<pre id='line1600' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line1601")'> 1601:                 if (angle_1 &gt; PI/2.0 and angle_1 &lt; PI *3.0/2.0) and (angle_2 &gt; PI/2.0 and angle_2 &lt; PI *3.0/2.0):</pre>
<pre id='line1601' class='code' style='background-color: #FFFF20'>
      /* "Cython_shift_calculator.pyx":1601
 *                 angle_2 = calc_bond_angle_simulation(self._simulation, bond_angle_atom_ids)
 * 
 *                 if (angle_1 > PI/2.0 and angle_1 <code><</code> PI *3.0/2.0) and (angle_2 > PI/2.0 and angle_2 <code><</code> PI *3.0/2.0):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                     donor_atom_type_id  = donor_components[donor_index].atom_type_id
 */
      __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_17shift_calculators_PI / 2.0));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_angle_1, __pyx_t_2, Py_GT); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_10 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_10 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (__pyx_t_10) {
        __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_17shift_calculators_PI * 3.0) / 2.0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_angle_1, __pyx_t_1, Py_LT); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_9 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_9 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_11 = __pyx_t_9;
      } else {
        __pyx_t_11 = __pyx_t_10;
      }
      if (__pyx_t_11) {
        __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_17shift_calculators_PI / 2.0));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_angle_2, __pyx_t_2, Py_GT); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_10 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_10 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (__pyx_t_10) {
          __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_17shift_calculators_PI * 3.0) / 2.0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
          __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_angle_2, __pyx_t_1, Py_LT); <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGOTREF</span></span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_t_9 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_9 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          __pyx_t_12 = __pyx_t_9;
        } else {
          __pyx_t_12 = __pyx_t_10;
        }
        __pyx_t_10 = __pyx_t_12;
      } else {
        __pyx_t_10 = __pyx_t_11;
      }
      if (__pyx_t_10) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1602")'> 1602: </pre>
<pre id='line1602' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1603")'> 1603:                     donor_atom_type_id  = donor_components[donor_index].atom_type_id</pre>
<pre id='line1603' class='code' style='background-color: #FFFFff'>
        /* "Cython_shift_calculator.pyx":1603
 *                 if (angle_1 > PI/2.0 and angle_1 <code><</code> PI *3.0/2.0) and (angle_2 > PI/2.0 and angle_2 <code><</code> PI *3.0/2.0):
 * 
 *                     donor_atom_type_id  = donor_components[donor_index].atom_type_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     acceptor_atom_type_id = acceptor_components[acceptor_index].atom_type_id
 *                     acceptor_id = donor_lookup[donor_atom_type_id].acceptor_offset[acceptor_atom_type_id]
 */
        __pyx_t_6 = (__pyx_v_donor_components[__pyx_v_donor_index]).atom_type_id;
        __pyx_v_donor_atom_type_id = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1604")'> 1604:                     acceptor_atom_type_id = acceptor_components[acceptor_index].atom_type_id</pre>
<pre id='line1604' class='code' style='background-color: #FFFFff'>
        /* "Cython_shift_calculator.pyx":1604
 * 
 *                     donor_atom_type_id  = donor_components[donor_index].atom_type_id
 *                     acceptor_atom_type_id = acceptor_components[acceptor_index].atom_type_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     acceptor_id = donor_lookup[donor_atom_type_id].acceptor_offset[acceptor_atom_type_id]
 * 
 */
        __pyx_t_6 = (__pyx_v_acceptor_components[__pyx_v_acceptor_index]).atom_type_id;
        __pyx_v_acceptor_atom_type_id = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1605")'> 1605:                     acceptor_id = donor_lookup[donor_atom_type_id].acceptor_offset[acceptor_atom_type_id]</pre>
<pre id='line1605' class='code' style='background-color: #FFFFff'>
        /* "Cython_shift_calculator.pyx":1605
 *                     donor_atom_type_id  = donor_components[donor_index].atom_type_id
 *                     acceptor_atom_type_id = acceptor_components[acceptor_index].atom_type_id
 *                     acceptor_id = donor_lookup[donor_atom_type_id].acceptor_offset[acceptor_atom_type_id]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                     param_id_dist = acceptor_lookup[acceptor_id].parameter_indices[0]
 */
        __pyx_v_acceptor_id = ((__pyx_v_donor_lookup[__pyx_v_donor_atom_type_id]).acceptor_offset[__pyx_v_acceptor_atom_type_id]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1606")'> 1606: </pre>
<pre id='line1606' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1607")'> 1607:                     param_id_dist = acceptor_lookup[acceptor_id].parameter_indices[0]</pre>
<pre id='line1607' class='code' style='background-color: #FFFFff'>
        /* "Cython_shift_calculator.pyx":1607
 *                     acceptor_id = donor_lookup[donor_atom_type_id].acceptor_offset[acceptor_atom_type_id]
 * 
 *                     param_id_dist = acceptor_lookup[acceptor_id].parameter_indices[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     param_id_angle_1 = acceptor_lookup[acceptor_id].parameter_indices[1]
 *                     param_id_angle_2 = acceptor_lookup[acceptor_id].parameter_indices[2]
 */
        __pyx_v_param_id_dist = ((__pyx_v_acceptor_lookup[__pyx_v_acceptor_id]).parameter_indices[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1608")'> 1608:                     param_id_angle_1 = acceptor_lookup[acceptor_id].parameter_indices[1]</pre>
<pre id='line1608' class='code' style='background-color: #FFFFff'>
        /* "Cython_shift_calculator.pyx":1608
 * 
 *                     param_id_dist = acceptor_lookup[acceptor_id].parameter_indices[0]
 *                     param_id_angle_1 = acceptor_lookup[acceptor_id].parameter_indices[1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     param_id_angle_2 = acceptor_lookup[acceptor_id].parameter_indices[2]
 *     #
 */
        __pyx_v_param_id_angle_1 = ((__pyx_v_acceptor_lookup[__pyx_v_acceptor_id]).parameter_indices[1]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1609")'> 1609:                     param_id_angle_2 = acceptor_lookup[acceptor_id].parameter_indices[2]</pre>
<pre id='line1609' class='code' style='background-color: #FFFFff'>
        /* "Cython_shift_calculator.pyx":1609
 *                     param_id_dist = acceptor_lookup[acceptor_id].parameter_indices[0]
 *                     param_id_angle_1 = acceptor_lookup[acceptor_id].parameter_indices[1]
 *                     param_id_angle_2 = acceptor_lookup[acceptor_id].parameter_indices[2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     #
 *                     params_dist  = hydrogen_bond_parameters[param_id_dist]
 */
        __pyx_v_param_id_angle_2 = ((__pyx_v_acceptor_lookup[__pyx_v_acceptor_id]).parameter_indices[2]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1610")'> 1610:     #</pre>
<pre id='line1610' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1611")'> 1611:                     params_dist  = hydrogen_bond_parameters[param_id_dist]</pre>
<pre id='line1611' class='code' style='background-color: #FFFFff'>
        /* "Cython_shift_calculator.pyx":1611
 *                     param_id_angle_2 = acceptor_lookup[acceptor_id].parameter_indices[2]
 *     #
 *                     params_dist  = hydrogen_bond_parameters[param_id_dist]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     params_angle_1  = hydrogen_bond_parameters[param_id_angle_1]
 *                     params_angle_2  = hydrogen_bond_parameters[param_id_angle_2]
 */
        __pyx_v_params_dist = (__pyx_v_hydrogen_bond_parameters[__pyx_v_param_id_dist]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1612")'> 1612:                     params_angle_1  = hydrogen_bond_parameters[param_id_angle_1]</pre>
<pre id='line1612' class='code' style='background-color: #FFFFff'>
        /* "Cython_shift_calculator.pyx":1612
 *     #
 *                     params_dist  = hydrogen_bond_parameters[param_id_dist]
 *                     params_angle_1  = hydrogen_bond_parameters[param_id_angle_1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     params_angle_2  = hydrogen_bond_parameters[param_id_angle_2]
 * 
 */
        __pyx_v_params_angle_1 = (__pyx_v_hydrogen_bond_parameters[__pyx_v_param_id_angle_1]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1613")'> 1613:                     params_angle_2  = hydrogen_bond_parameters[param_id_angle_2]</pre>
<pre id='line1613' class='code' style='background-color: #FFFFff'>
        /* "Cython_shift_calculator.pyx":1613
 *                     params_dist  = hydrogen_bond_parameters[param_id_dist]
 *                     params_angle_1  = hydrogen_bond_parameters[param_id_angle_1]
 *                     params_angle_2  = hydrogen_bond_parameters[param_id_angle_2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                     energy_dist = self._calc_energy(min_distance,params_dist)
 */
        __pyx_v_params_angle_2 = (__pyx_v_hydrogen_bond_parameters[__pyx_v_param_id_angle_2]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1614")'> 1614: </pre>
<pre id='line1614' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line1615")'> 1615:                     energy_dist = self._calc_energy(min_distance,params_dist)</pre>
<pre id='line1615' class='code' style='background-color: #FFFF9f'>
        /* "Cython_shift_calculator.pyx":1615
 *                     params_angle_2  = hydrogen_bond_parameters[param_id_angle_2]
 * 
 *                     energy_dist = self._calc_energy(min_distance,params_dist)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     energy_ang_1 = self._calc_energy(angle_1 / PI * 180.0, params_angle_1)
 *                     energy_ang_2 = self._calc_energy(angle_2 / PI * 180.0, params_angle_2)
 */
        __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_17shift_calculators_29Fast_hydrogen_bond_calculator__calc_energy(__pyx_v_self, __pyx_v_min_distance, __pyx_v_params_dist));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1615; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_energy_dist);
        __pyx_v_energy_dist = __pyx_t_2;
        __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF33' onclick='toggleDiv("line1616")'> 1616:                     energy_ang_1 = self._calc_energy(angle_1 / PI * 180.0, params_angle_1)</pre>
<pre id='line1616' class='code' style='background-color: #FFFF33'>
        /* "Cython_shift_calculator.pyx":1616
 * 
 *                     energy_dist = self._calc_energy(min_distance,params_dist)
 *                     energy_ang_1 = self._calc_energy(angle_1 / PI * 180.0, params_angle_1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     energy_ang_2 = self._calc_energy(angle_2 / PI * 180.0, params_angle_2)
 * 
 */
        __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_17shift_calculators_PI);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1616; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        __pyx_t_1 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_v_angle_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1616; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(180.0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1616; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        __pyx_t_13 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1616; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_14 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_13);<span class='error_goto'> if (unlikely((__pyx_t_14 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1616; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
        __pyx_t_13 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_17shift_calculators_29Fast_hydrogen_bond_calculator__calc_energy(__pyx_v_self, __pyx_t_14, __pyx_v_params_angle_1));<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1616; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_energy_ang_1);
        __pyx_v_energy_ang_1 = __pyx_t_13;
        __pyx_t_13 = 0;
</pre><pre class='line' style='background-color: #FFFF33' onclick='toggleDiv("line1617")'> 1617:                     energy_ang_2 = self._calc_energy(angle_2 / PI * 180.0, params_angle_2)</pre>
<pre id='line1617' class='code' style='background-color: #FFFF33'>
        /* "Cython_shift_calculator.pyx":1617
 *                     energy_dist = self._calc_energy(min_distance,params_dist)
 *                     energy_ang_1 = self._calc_energy(angle_1 / PI * 180.0, params_angle_1)
 *                     energy_ang_2 = self._calc_energy(angle_2 / PI * 180.0, params_angle_2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                     if donor_components[donor_index].backbone > -1:
 */
        __pyx_t_13 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_17shift_calculators_PI);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1617; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
        __pyx_t_2 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_v_angle_2, __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1617; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
        __pyx_t_13 = <span class='py_c_api'>PyFloat_FromDouble</span>(180.0);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1617; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1617; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
        __pyx_t_14 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_14 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1617; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_17shift_calculators_29Fast_hydrogen_bond_calculator__calc_energy(__pyx_v_self, __pyx_t_14, __pyx_v_params_angle_2));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1617; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_energy_ang_2);
        __pyx_v_energy_ang_2 = __pyx_t_1;
        __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1618")'> 1618: </pre>
<pre id='line1618' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1619")'> 1619:                     if donor_components[donor_index].backbone &gt; -1:</pre>
<pre id='line1619' class='code' style='background-color: #FFFFff'>
        /* "Cython_shift_calculator.pyx":1619
 *                     energy_ang_2 = self._calc_energy(angle_2 / PI * 180.0, params_angle_2)
 * 
 *                     if donor_components[donor_index].backbone > -1:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         donor_energies[donor_components[donor_index].backbone*3] = energy_dist
 *                         donor_energies[donor_components[donor_index].backbone*3+1] = energy_ang_1
 */
        __pyx_t_10 = ((__pyx_v_donor_components[__pyx_v_donor_index]).backbone > -1);
        if (__pyx_t_10) {
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line1620")'> 1620:                         donor_energies[donor_components[donor_index].backbone*3] = energy_dist</pre>
<pre id='line1620' class='code' style='background-color: #FFFF7f'>
          /* "Cython_shift_calculator.pyx":1620
 * 
 *                     if donor_components[donor_index].backbone > -1:
 *                         donor_energies[donor_components[donor_index].backbone*3] = energy_dist             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         donor_energies[donor_components[donor_index].backbone*3+1] = energy_ang_1
 *                         donor_energies[donor_components[donor_index].backbone*3+2] = energy_ang_2
 */
          __pyx_t_14 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_energy_dist);<span class='error_goto'> if (unlikely((__pyx_t_14 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1620; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          __pyx_t_15 = ((__pyx_v_donor_components[__pyx_v_donor_index]).backbone * 3);
          *((float *) ( /* dim=0 */ (__pyx_v_donor_energies.data + __pyx_t_15 * __pyx_v_donor_energies.strides[0]) )) = __pyx_t_14;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line1621")'> 1621:                         donor_energies[donor_components[donor_index].backbone*3+1] = energy_ang_1</pre>
<pre id='line1621' class='code' style='background-color: #FFFF7f'>
          /* "Cython_shift_calculator.pyx":1621
 *                     if donor_components[donor_index].backbone > -1:
 *                         donor_energies[donor_components[donor_index].backbone*3] = energy_dist
 *                         donor_energies[donor_components[donor_index].backbone*3+1] = energy_ang_1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         donor_energies[donor_components[donor_index].backbone*3+2] = energy_ang_2
 * #
 */
          __pyx_t_14 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_energy_ang_1);<span class='error_goto'> if (unlikely((__pyx_t_14 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1621; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          __pyx_t_16 = (((__pyx_v_donor_components[__pyx_v_donor_index]).backbone * 3) + 1);
          *((float *) ( /* dim=0 */ (__pyx_v_donor_energies.data + __pyx_t_16 * __pyx_v_donor_energies.strides[0]) )) = __pyx_t_14;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line1622")'> 1622:                         donor_energies[donor_components[donor_index].backbone*3+2] = energy_ang_2</pre>
<pre id='line1622' class='code' style='background-color: #FFFF7f'>
          /* "Cython_shift_calculator.pyx":1622
 *                         donor_energies[donor_components[donor_index].backbone*3] = energy_dist
 *                         donor_energies[donor_components[donor_index].backbone*3+1] = energy_ang_1
 *                         donor_energies[donor_components[donor_index].backbone*3+2] = energy_ang_2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #
 *                     if acceptor_components[acceptor_index].backbone > -1:
 */
          __pyx_t_14 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_energy_ang_2);<span class='error_goto'> if (unlikely((__pyx_t_14 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1622; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          __pyx_t_17 = (((__pyx_v_donor_components[__pyx_v_donor_index]).backbone * 3) + 2);
          *((float *) ( /* dim=0 */ (__pyx_v_donor_energies.data + __pyx_t_17 * __pyx_v_donor_energies.strides[0]) )) = __pyx_t_14;
          goto __pyx_L12;
        }
        __pyx_L12:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1623")'> 1623: #</pre>
<pre id='line1623' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1624")'> 1624:                     if acceptor_components[acceptor_index].backbone &gt; -1:</pre>
<pre id='line1624' class='code' style='background-color: #FFFFff'>
        /* "Cython_shift_calculator.pyx":1624
 *                         donor_energies[donor_components[donor_index].backbone*3+2] = energy_ang_2
 * #
 *                     if acceptor_components[acceptor_index].backbone > -1:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         acceptor_energies[acceptor_components[acceptor_index].backbone*3] = energy_dist
 *                         acceptor_energies[acceptor_components[acceptor_index].backbone*3+1] = energy_ang_1
 */
        __pyx_t_10 = ((__pyx_v_acceptor_components[__pyx_v_acceptor_index]).backbone > -1);
        if (__pyx_t_10) {
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line1625")'> 1625:                         acceptor_energies[acceptor_components[acceptor_index].backbone*3] = energy_dist</pre>
<pre id='line1625' class='code' style='background-color: #FFFF7f'>
          /* "Cython_shift_calculator.pyx":1625
 * #
 *                     if acceptor_components[acceptor_index].backbone > -1:
 *                         acceptor_energies[acceptor_components[acceptor_index].backbone*3] = energy_dist             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         acceptor_energies[acceptor_components[acceptor_index].backbone*3+1] = energy_ang_1
 *                         acceptor_energies[acceptor_components[acceptor_index].backbone*3+2] = energy_ang_2
 */
          __pyx_t_14 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_energy_dist);<span class='error_goto'> if (unlikely((__pyx_t_14 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1625; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          __pyx_t_18 = ((__pyx_v_acceptor_components[__pyx_v_acceptor_index]).backbone * 3);
          *((float *) ( /* dim=0 */ (__pyx_v_acceptor_energies.data + __pyx_t_18 * __pyx_v_acceptor_energies.strides[0]) )) = __pyx_t_14;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line1626")'> 1626:                         acceptor_energies[acceptor_components[acceptor_index].backbone*3+1] = energy_ang_1</pre>
<pre id='line1626' class='code' style='background-color: #FFFF7f'>
          /* "Cython_shift_calculator.pyx":1626
 *                     if acceptor_components[acceptor_index].backbone > -1:
 *                         acceptor_energies[acceptor_components[acceptor_index].backbone*3] = energy_dist
 *                         acceptor_energies[acceptor_components[acceptor_index].backbone*3+1] = energy_ang_1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         acceptor_energies[acceptor_components[acceptor_index].backbone*3+2] = energy_ang_2
 * 
 */
          __pyx_t_14 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_energy_ang_1);<span class='error_goto'> if (unlikely((__pyx_t_14 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1626; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          __pyx_t_19 = (((__pyx_v_acceptor_components[__pyx_v_acceptor_index]).backbone * 3) + 1);
          *((float *) ( /* dim=0 */ (__pyx_v_acceptor_energies.data + __pyx_t_19 * __pyx_v_acceptor_energies.strides[0]) )) = __pyx_t_14;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line1627")'> 1627:                         acceptor_energies[acceptor_components[acceptor_index].backbone*3+2] = energy_ang_2</pre>
<pre id='line1627' class='code' style='background-color: #FFFF7f'>
          /* "Cython_shift_calculator.pyx":1627
 *                         acceptor_energies[acceptor_components[acceptor_index].backbone*3] = energy_dist
 *                         acceptor_energies[acceptor_components[acceptor_index].backbone*3+1] = energy_ang_1
 *                         acceptor_energies[acceptor_components[acceptor_index].backbone*3+2] = energy_ang_2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
          __pyx_t_14 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_energy_ang_2);<span class='error_goto'> if (unlikely((__pyx_t_14 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1627; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          __pyx_t_20 = (((__pyx_v_acceptor_components[__pyx_v_acceptor_index]).backbone * 3) + 2);
          *((float *) ( /* dim=0 */ (__pyx_v_acceptor_energies.data + __pyx_t_20 * __pyx_v_acceptor_energies.strides[0]) )) = __pyx_t_14;
          goto __pyx_L13;
        }
        __pyx_L13:;
        goto __pyx_L11;
      }
      __pyx_L11:;
      goto __pyx_L10;
    }
    __pyx_L10:;
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1628")'> 1628: </pre>
<pre id='line1628' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1629")'> 1629: </pre>
<pre id='line1629' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1630")'> 1630:         if self._verbose:</pre>
<pre id='line1630' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1630
 * 
 * 
 *         if self._verbose:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             end_time = time()
 *             print '   hydrogen donors: ',len(donor_list),' acceptors: ', len(acceptor_list),' in', "%.17g" %  (end_time-start_time), "seconds"
 */
  if (__pyx_v_self->_verbose) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line1631")'> 1631:             end_time = time()</pre>
<pre id='line1631' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":1631
 * 
 *         if self._verbose:
 *             end_time = time()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print '   hydrogen donors: ',len(donor_list),' acceptors: ', len(acceptor_list),' in', "%.17g" %  (end_time-start_time), "seconds"
 * 
 */
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__time);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1631; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_13 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1631; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_13);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1631; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_v_end_time = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF14' onclick='toggleDiv("line1632")'> 1632:             print '   hydrogen donors: ',len(donor_list),' acceptors: ', len(acceptor_list),' in', "%.17g" %  (end_time-start_time), "seconds"</pre>
<pre id='line1632' class='code' style='background-color: #FFFF14'>
    /* "Cython_shift_calculator.pyx":1632
 *         if self._verbose:
 *             end_time = time()
 *             print '   hydrogen donors: ',len(donor_list),' acceptors: ', len(acceptor_list),' in', "%.17g" %  (end_time-start_time), "seconds"             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_t_21 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_donor_list);<span class='error_goto'> if (unlikely(__pyx_t_21 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1632; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_13 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1632; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
    __pyx_t_21 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_acceptor_list);<span class='error_goto'> if (unlikely(__pyx_t_21 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1632; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1632; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_end_time - __pyx_v_start_time));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1632; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_22 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_32), __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1632; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_22));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1632; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_40));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_kp_s_40));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_40));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_13);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_41));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, ((PyObject *)__pyx_kp_s_41));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_41));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 3, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_42));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 4, ((PyObject *)__pyx_kp_s_42));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_42));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 5, ((PyObject *)__pyx_t_22));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_22));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__seconds));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 6, ((PyObject *)__pyx_n_s__seconds));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__seconds));
    __pyx_t_13 = 0;
    __pyx_t_1 = 0;
    __pyx_t_22 = 0;
    if (<span class='pyx_c_api'>__Pyx_Print</span>(0, ((PyObject *)__pyx_t_2), 1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1632; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    goto __pyx_L14;
  }
  __pyx_L14:;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_hydrogen_bond_calculator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_donor_list);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_acceptor_list);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_parameters);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_donor_indices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_acceptor_indices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_angle_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_angle_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_energy_dist);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_energy_ang_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_energy_ang_2);
  __PYX_XDEC_MEMVIEW(&__pyx_v_donor_energies, 1);
  __PYX_XDEC_MEMVIEW(&__pyx_v_acceptor_energies, 1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_26Fast_non_bonded_calculator_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_26Fast_non_bonded_calculator_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_simulation = 0;
  PyObject *__pyx_v_min_residue_seperation = 0;
  PyObject *__pyx_v_cutoff_distance = 0;
  PyObject *__pyx_v_jitter = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__simulation,&__pyx_n_s_43,&__pyx_n_s__cutoff_distance,&__pyx_n_s__jitter,0};
    PyObject* values[4] = {0,0,0,0};
    values[2] = __pyx_k_44;
    values[3] = __pyx_k_45;
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__simulation)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_43)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 2, 4, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1643; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__cutoff_distance);
          if (value) { values[2] = value; kw_args--; }
        }
        case  3:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__jitter);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1643; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_simulation = values[0];
    __pyx_v_min_residue_seperation = values[1];
    __pyx_v_cutoff_distance = values[2];
    __pyx_v_jitter = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 2, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1643; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_non_bonded_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_non_bonded_calculator___init__(((struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *)__pyx_v_self), __pyx_v_simulation, __pyx_v_min_residue_seperation, __pyx_v_cutoff_distance, __pyx_v_jitter);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1633")'> 1633: </pre>
<pre id='line1633' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1634")'> 1634: </pre>
<pre id='line1634' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1635")'> 1635: cdef class Fast_non_bonded_calculator:</pre>
<pre id='line1635' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1635
 * 
 * 
 * cdef class Fast_non_bonded_calculator:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int _min_residue_seperation
 *     cdef float _cutoff_distance
 */
struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator {
  PyObject_HEAD
  struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_calculator *__pyx_vtab;
  int _min_residue_seperation;
  float _cutoff_distance;
  float _jitter;
  float _full_cutoff_distance;
  int _verbose;
  EnsembleSimulation *_simulation;
};


/* "Cython_shift_calculator.pyx":1635
 * 
 * 
 * cdef class Fast_non_bonded_calculator:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int _min_residue_seperation
 *     cdef float _cutoff_distance
 */

struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_calculator {
  int (*_filter_by_residue)(struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *, char *, int, char *, int);
  int (*_is_non_bonded)(struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *, int, int);
  int (*_bytes_to_target_components)(struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *, PyObject *, struct __pyx_t_17shift_calculators_Non_bonded_target_component **);
  int (*_bytes_to_remote_components)(struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *, PyObject *, struct __pyx_t_17shift_calculators_Non_bonded_remote_atom_component **);
};
static struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_calculator *__pyx_vtabptr_17shift_calculators_Fast_non_bonded_calculator;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1636")'> 1636:     cdef int _min_residue_seperation</pre>
<pre id='line1636' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1637")'> 1637:     cdef float _cutoff_distance</pre>
<pre id='line1637' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1638")'> 1638:     cdef float _jitter</pre>
<pre id='line1638' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1639")'> 1639:     cdef float _full_cutoff_distance</pre>
<pre id='line1639' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1640")'> 1640:     cdef bint _verbose</pre>
<pre id='line1640' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1641")'> 1641:     cdef EnsembleSimulation* _simulation</pre>
<pre id='line1641' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1642")'> 1642: </pre>
<pre id='line1642' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line1643")'> 1643:     def __init__(self,simulation, min_residue_seperation,cutoff_distance=5.0,jitter=0.2):</pre>
<pre id='line1643' class='code' style='background-color: #FFFF7f'>
/* "Cython_shift_calculator.pyx":1643
 *     cdef EnsembleSimulation* _simulation
 * 
 *     def __init__(self,simulation, min_residue_seperation,cutoff_distance=5.0,jitter=0.2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._simulation = simulationAsNative(simulation)
 * 
 */

static int __pyx_pf_17shift_calculators_26Fast_non_bonded_calculator___init__(struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *__pyx_v_self, PyObject *__pyx_v_simulation, PyObject *__pyx_v_min_residue_seperation, PyObject *__pyx_v_cutoff_distance, PyObject *__pyx_v_jitter) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);

  /* "Cython_shift_calculator.pyx":1643
 *     cdef EnsembleSimulation* _simulation
 * 
 *     def __init__(self,simulation, min_residue_seperation,cutoff_distance=5.0,jitter=0.2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._simulation = simulationAsNative(simulation)
 * 
 */
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(5.0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1643; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_k_44 = __pyx_t_2;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(0.2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1643; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_k_45 = __pyx_t_2;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1644")'> 1644:         self._simulation = simulationAsNative(simulation)</pre>
<pre id='line1644' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1644
 * 
 *     def __init__(self,simulation, min_residue_seperation,cutoff_distance=5.0,jitter=0.2):
 *         self._simulation = simulationAsNative(simulation)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._min_residue_seperation =  min_residue_seperation
 */
  __pyx_t_1 = __pyx_f_17shift_calculators_simulationAsNative(__pyx_v_simulation);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1644; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_simulation = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1645")'> 1645: </pre>
<pre id='line1645' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line1646")'> 1646:         self._min_residue_seperation =  min_residue_seperation</pre>
<pre id='line1646' class='code' style='background-color: #FFFF7f'>
  /* "Cython_shift_calculator.pyx":1646
 *         self._simulation = simulationAsNative(simulation)
 * 
 *         self._min_residue_seperation =  min_residue_seperation             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._cutoff_distance =  cutoff_distance
 *         self._jitter = jitter
 */
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_min_residue_seperation);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1646; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_min_residue_seperation = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line1647")'> 1647:         self._cutoff_distance =  cutoff_distance</pre>
<pre id='line1647' class='code' style='background-color: #FFFF7f'>
  /* "Cython_shift_calculator.pyx":1647
 * 
 *         self._min_residue_seperation =  min_residue_seperation
 *         self._cutoff_distance =  cutoff_distance             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._jitter = jitter
 *         self._full_cutoff_distance =  self._cutoff_distance + self._jitter
 */
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_cutoff_distance);<span class='error_goto'> if (unlikely((__pyx_t_3 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1647; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_cutoff_distance = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line1648")'> 1648:         self._jitter = jitter</pre>
<pre id='line1648' class='code' style='background-color: #FFFF7f'>
  /* "Cython_shift_calculator.pyx":1648
 *         self._min_residue_seperation =  min_residue_seperation
 *         self._cutoff_distance =  cutoff_distance
 *         self._jitter = jitter             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._full_cutoff_distance =  self._cutoff_distance + self._jitter
 *         self._verbose =  False
 */
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_jitter);<span class='error_goto'> if (unlikely((__pyx_t_3 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1648; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_jitter = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1649")'> 1649:         self._full_cutoff_distance =  self._cutoff_distance + self._jitter</pre>
<pre id='line1649' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1649
 *         self._cutoff_distance =  cutoff_distance
 *         self._jitter = jitter
 *         self._full_cutoff_distance =  self._cutoff_distance + self._jitter             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._verbose =  False
 * 
 */
  __pyx_v_self->_full_cutoff_distance = (__pyx_v_self->_cutoff_distance + __pyx_v_self->_jitter);
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line1650")'> 1650:         self._verbose =  False</pre>
<pre id='line1650' class='code' style='background-color: #FFFFb6'>
  /* "Cython_shift_calculator.pyx":1650
 *         self._jitter = jitter
 *         self._full_cutoff_distance =  self._cutoff_distance + self._jitter
 *         self._verbose =  False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_self->_verbose = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_non_bonded_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_non_bonded_calculator_3set_verbose(PyObject *__pyx_v_self, PyObject *__pyx_v_on); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_non_bonded_calculator_3set_verbose(PyObject *__pyx_v_self, PyObject *__pyx_v_on) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_verbose (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_non_bonded_calculator_2set_verbose(((struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_on));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1651")'> 1651: </pre>
<pre id='line1651' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1652")'> 1652: </pre>
<pre id='line1652' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1653")'> 1653:     def set_verbose(self,on):</pre>
<pre id='line1653' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1653
 * 
 * 
 *     def set_verbose(self,on):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._verbose=on
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_non_bonded_calculator_2set_verbose(struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *__pyx_v_self, PyObject *__pyx_v_on) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_verbose", 0);
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line1654")'> 1654:         self._verbose=on</pre>
<pre id='line1654' class='code' style='background-color: #FFFF6a'>
  /* "Cython_shift_calculator.pyx":1654
 * 
 *     def set_verbose(self,on):
 *         self._verbose=on             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline bint _filter_by_residue(self, char* seg_1, int residue_1, char* seg_2, int residue_2):
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_v_on);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1654; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_verbose = __pyx_t_1;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_non_bonded_calculator.set_verbose", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1655")'> 1655: </pre>
<pre id='line1655' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1656")'> 1656:     cdef inline bint _filter_by_residue(self, char* seg_1, int residue_1, char* seg_2, int residue_2):</pre>
<pre id='line1656' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1656
 *         self._verbose=on
 * 
 *     cdef inline bint _filter_by_residue(self, char* seg_1, int residue_1, char* seg_2, int residue_2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int sequence_distance
 *         cdef bint result
 */

static CYTHON_INLINE int __pyx_f_17shift_calculators_26Fast_non_bonded_calculator__filter_by_residue(struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *__pyx_v_self, char *__pyx_v_seg_1, int __pyx_v_residue_1, char *__pyx_v_seg_2, int __pyx_v_residue_2) {
  int __pyx_v_sequence_distance;
  int __pyx_v_result;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_filter_by_residue", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1657")'> 1657:         cdef int sequence_distance</pre>
<pre id='line1657' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1658")'> 1658:         cdef bint result</pre>
<pre id='line1658' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1659")'> 1659: </pre>
<pre id='line1659' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1660")'> 1660:         result = False</pre>
<pre id='line1660' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1660
 *         cdef bint result
 * 
 *         result = False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if strcmp(seg_1, seg_2) == 0:
 */
  __pyx_v_result = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1661")'> 1661: </pre>
<pre id='line1661' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1662")'> 1662:         if strcmp(seg_1, seg_2) == 0:</pre>
<pre id='line1662' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1662
 *         result = False
 * 
 *         if strcmp(seg_1, seg_2) == 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             sequence_distance =abs(residue_1-residue_2)
 *             if sequence_distance <code><</code> self._min_residue_seperation:
 */
  __pyx_t_1 = (strcmp(__pyx_v_seg_1, __pyx_v_seg_2) == 0);
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1663")'> 1663:             sequence_distance =abs(residue_1-residue_2)</pre>
<pre id='line1663' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1663
 * 
 *         if strcmp(seg_1, seg_2) == 0:
 *             sequence_distance =abs(residue_1-residue_2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if sequence_distance <code><</code> self._min_residue_seperation:
 *                 result =True
 */
    __pyx_t_2 = __Pyx_abs_int((__pyx_v_residue_1 - __pyx_v_residue_2)); 
    __pyx_v_sequence_distance = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1664")'> 1664:             if sequence_distance &lt; self._min_residue_seperation:</pre>
<pre id='line1664' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1664
 *         if strcmp(seg_1, seg_2) == 0:
 *             sequence_distance =abs(residue_1-residue_2)
 *             if sequence_distance <code><</code> self._min_residue_seperation:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 result =True
 *         return result
 */
    __pyx_t_1 = (__pyx_v_sequence_distance <code><</code> __pyx_v_self->_min_residue_seperation);
    if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1665")'> 1665:                 result =True</pre>
<pre id='line1665' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1665
 *             sequence_distance =abs(residue_1-residue_2)
 *             if sequence_distance <code><</code> self._min_residue_seperation:
 *                 result =True             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return result
 * 
 */
      __pyx_v_result = 1;
      goto __pyx_L4;
    }
    __pyx_L4:;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1666")'> 1666:         return result</pre>
<pre id='line1666' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":1666
 *             if sequence_distance <code><</code> self._min_residue_seperation:
 *                 result =True
 *         return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline bint  _is_non_bonded(self, int atom_id_1, int atom_id_2):
 */
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1667")'> 1667: </pre>
<pre id='line1667' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1668")'> 1668:     cdef inline bint  _is_non_bonded(self, int atom_id_1, int atom_id_2):</pre>
<pre id='line1668' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1668
 *         return result
 * 
 *     cdef inline bint  _is_non_bonded(self, int atom_id_1, int atom_id_2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Atom atom_1, atom_2
 */

static CYTHON_INLINE int __pyx_f_17shift_calculators_26Fast_non_bonded_calculator__is_non_bonded(struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *__pyx_v_self, int __pyx_v_atom_id_1, int __pyx_v_atom_id_2) {
  Atom __pyx_v_atom_1;
  Atom __pyx_v_atom_2;
  char *__pyx_v_seg_1;
  char *__pyx_v_seg_2;
  int __pyx_v_residue_1;
  int __pyx_v_residue_2;
  int __pyx_v_is_non_bonded;
  float __pyx_v_distance;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_is_non_bonded", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1669")'> 1669: </pre>
<pre id='line1669' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1670")'> 1670:         cdef Atom atom_1, atom_2</pre>
<pre id='line1670' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1671")'> 1671:         cdef char *seg_1, *seg_2</pre>
<pre id='line1671' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1672")'> 1672:         cdef int residue_1, residue_2</pre>
<pre id='line1672' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1673")'> 1673:         cdef bint is_non_bonded</pre>
<pre id='line1673' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1674")'> 1674:         cdef float distance</pre>
<pre id='line1674' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1675")'> 1675: </pre>
<pre id='line1675' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1676")'> 1676:         atom_1 = self._simulation[0].atomByID(atom_id_1)</pre>
<pre id='line1676' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1676
 *         cdef float distance
 * 
 *         atom_1 = self._simulation[0].atomByID(atom_id_1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         atom_2 = self._simulation[0].atomByID(atom_id_2)
 * 
 */
  __pyx_v_atom_1 = (__pyx_v_self->_simulation[0]).atomByID(__pyx_v_atom_id_1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1677")'> 1677:         atom_2 = self._simulation[0].atomByID(atom_id_2)</pre>
<pre id='line1677' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1677
 * 
 *         atom_1 = self._simulation[0].atomByID(atom_id_1)
 *         atom_2 = self._simulation[0].atomByID(atom_id_2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         seg_1 =  <code><</code>char *>atom_1.segmentName()
 */
  __pyx_v_atom_2 = (__pyx_v_self->_simulation[0]).atomByID(__pyx_v_atom_id_2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1678")'> 1678: </pre>
<pre id='line1678' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1679")'> 1679:         seg_1 =  &lt;char *&gt;atom_1.segmentName()</pre>
<pre id='line1679' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1679
 *         atom_2 = self._simulation[0].atomByID(atom_id_2)
 * 
 *         seg_1 =  <code><</code>char *>atom_1.segmentName()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         residue_1 = atom_1.residueNum()
 * 
 */
  __pyx_v_seg_1 = ((char *)__pyx_v_atom_1.segmentName());
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1680")'> 1680:         residue_1 = atom_1.residueNum()</pre>
<pre id='line1680' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1680
 * 
 *         seg_1 =  <code><</code>char *>atom_1.segmentName()
 *         residue_1 = atom_1.residueNum()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         seg_2 = <code><</code>char*>atom_2.segmentName()
 */
  __pyx_v_residue_1 = __pyx_v_atom_1.residueNum();
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1681")'> 1681: </pre>
<pre id='line1681' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1682")'> 1682:         seg_2 = &lt;char*&gt;atom_2.segmentName()</pre>
<pre id='line1682' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1682
 *         residue_1 = atom_1.residueNum()
 * 
 *         seg_2 = <code><</code>char*>atom_2.segmentName()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         residue_2 =  atom_2.residueNum()
 * 
 */
  __pyx_v_seg_2 = ((char *)__pyx_v_atom_2.segmentName());
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1683")'> 1683:         residue_2 =  atom_2.residueNum()</pre>
<pre id='line1683' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1683
 * 
 *         seg_2 = <code><</code>char*>atom_2.segmentName()
 *         residue_2 =  atom_2.residueNum()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         is_non_bonded = True
 */
  __pyx_v_residue_2 = __pyx_v_atom_2.residueNum();
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1684")'> 1684: </pre>
<pre id='line1684' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1685")'> 1685:         is_non_bonded = True</pre>
<pre id='line1685' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1685
 *         residue_2 =  atom_2.residueNum()
 * 
 *         is_non_bonded = True             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if self._filter_by_residue(seg_1, residue_1, seg_2, residue_2):
 *             is_non_bonded = False
 */
  __pyx_v_is_non_bonded = 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1686")'> 1686:         if self._filter_by_residue(seg_1, residue_1, seg_2, residue_2):</pre>
<pre id='line1686' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1686
 * 
 *         is_non_bonded = True
 *         if self._filter_by_residue(seg_1, residue_1, seg_2, residue_2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             is_non_bonded = False
 *         else:
 */
  __pyx_t_1 = __pyx_f_17shift_calculators_26Fast_non_bonded_calculator__filter_by_residue(__pyx_v_self, __pyx_v_seg_1, __pyx_v_residue_1, __pyx_v_seg_2, __pyx_v_residue_2);
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1687")'> 1687:             is_non_bonded = False</pre>
<pre id='line1687' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1687
 *         is_non_bonded = True
 *         if self._filter_by_residue(seg_1, residue_1, seg_2, residue_2):
 *             is_non_bonded = False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             distance = norm(atom_1.pos() - atom_2.pos())
 */
    __pyx_v_is_non_bonded = 0;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1688")'> 1688:         else:</pre>
<pre id='line1688' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1689")'> 1689:             distance = norm(atom_1.pos() - atom_2.pos())</pre>
<pre id='line1689' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1689
 *             is_non_bonded = False
 *         else:
 *             distance = norm(atom_1.pos() - atom_2.pos())             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             is_non_bonded =  distance <code><</code> self._full_cutoff_distance
 *         return is_non_bonded
 */
    __pyx_v_distance = norm((__pyx_v_atom_1.pos() - __pyx_v_atom_2.pos()));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1690")'> 1690:             is_non_bonded =  distance &lt; self._full_cutoff_distance</pre>
<pre id='line1690' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1690
 *         else:
 *             distance = norm(atom_1.pos() - atom_2.pos())
 *             is_non_bonded =  distance <code><</code> self._full_cutoff_distance             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return is_non_bonded
 * 
 */
    __pyx_v_is_non_bonded = (__pyx_v_distance <code><</code> __pyx_v_self->_full_cutoff_distance);
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1691")'> 1691:         return is_non_bonded</pre>
<pre id='line1691' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":1691
 *             distance = norm(atom_1.pos() - atom_2.pos())
 *             is_non_bonded =  distance <code><</code> self._full_cutoff_distance
 *         return is_non_bonded             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #     cdef struct Non_bonded_target_component:
 */
  __pyx_r = __pyx_v_is_non_bonded;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1692")'> 1692: </pre>
<pre id='line1692' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1693")'> 1693: #     cdef struct Non_bonded_target_component:</pre>
<pre id='line1693' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1694")'> 1694: #       int target_atom_id</pre>
<pre id='line1694' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1695")'> 1695: #       int atom_type_id</pre>
<pre id='line1695' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1696")'> 1696: #</pre>
<pre id='line1696' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1697")'> 1697: # cdef struct Non_bonded_remote_atom_component:</pre>
<pre id='line1697' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1698")'> 1698: #       int remote_atom</pre>
<pre id='line1698' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1699")'> 1699: #       int chem_type[2] # one for each sphere</pre>
<pre id='line1699' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1700")'> 1700: </pre>
<pre id='line1700' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1701")'> 1701:     cdef   int _bytes_to_target_components(self, data, Non_bonded_target_component** target_pointer):</pre>
<pre id='line1701' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1701
 * #       int chem_type[2] # one for each sphere
 * 
 *     cdef   int _bytes_to_target_components(self, data, Non_bonded_target_component** target_pointer):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         target_pointer[0] =  <code><</code>Non_bonded_target_component*> <code><</code>size_t> ctypes.addressof(data)
 */

static int __pyx_f_17shift_calculators_26Fast_non_bonded_calculator__bytes_to_target_components(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *__pyx_v_self, PyObject *__pyx_v_data, struct __pyx_t_17shift_calculators_Non_bonded_target_component **__pyx_v_target_pointer) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_target_components", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1702")'> 1702: </pre>
<pre id='line1702' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line1703")'> 1703:         target_pointer[0] =  &lt;Non_bonded_target_component*&gt; &lt;size_t&gt; ctypes.addressof(data)</pre>
<pre id='line1703' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":1703
 *     cdef   int _bytes_to_target_components(self, data, Non_bonded_target_component** target_pointer):
 * 
 *         target_pointer[0] =  <code><</code>Non_bonded_target_component*> <code><</code>size_t> ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return len(data)/ sizeof(Non_bonded_target_component)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1703; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1703; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1703; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1703; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1703; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  (__pyx_v_target_pointer[0]) = ((struct __pyx_t_17shift_calculators_Non_bonded_target_component *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line1704")'> 1704:         return len(data)/ sizeof(Non_bonded_target_component)</pre>
<pre id='line1704' class='code' style='background-color: #FFFF79'>
  /* "Cython_shift_calculator.pyx":1704
 * 
 *         target_pointer[0] =  <code><</code>Non_bonded_target_component*> <code><</code>size_t> ctypes.addressof(data)
 *         return len(data)/ sizeof(Non_bonded_target_component)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef   int _bytes_to_remote_components(self, data, Non_bonded_remote_atom_component** remote_pointer):
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1704; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = (__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Non_bonded_target_component)));
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Fast_non_bonded_calculator._bytes_to_target_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1705")'> 1705: </pre>
<pre id='line1705' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1706")'> 1706:     cdef   int _bytes_to_remote_components(self, data, Non_bonded_remote_atom_component** remote_pointer):</pre>
<pre id='line1706' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1706
 *         return len(data)/ sizeof(Non_bonded_target_component)
 * 
 *     cdef   int _bytes_to_remote_components(self, data, Non_bonded_remote_atom_component** remote_pointer):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         remote_pointer[0] =  <code><</code>Non_bonded_remote_atom_component*> <code><</code>size_t> ctypes.addressof(data)
 */

static int __pyx_f_17shift_calculators_26Fast_non_bonded_calculator__bytes_to_remote_components(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *__pyx_v_self, PyObject *__pyx_v_data, struct __pyx_t_17shift_calculators_Non_bonded_remote_atom_component **__pyx_v_remote_pointer) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_remote_components", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1707")'> 1707: </pre>
<pre id='line1707' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line1708")'> 1708:         remote_pointer[0] =  &lt;Non_bonded_remote_atom_component*&gt; &lt;size_t&gt; ctypes.addressof(data)</pre>
<pre id='line1708' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":1708
 *     cdef   int _bytes_to_remote_components(self, data, Non_bonded_remote_atom_component** remote_pointer):
 * 
 *         remote_pointer[0] =  <code><</code>Non_bonded_remote_atom_component*> <code><</code>size_t> ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return len(data)/ sizeof(Non_bonded_remote_atom_component)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1708; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1708; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1708; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1708; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1708; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  (__pyx_v_remote_pointer[0]) = ((struct __pyx_t_17shift_calculators_Non_bonded_remote_atom_component *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFF27' onclick='toggleDiv("line1709")'> 1709:         return len(data)/ sizeof(Non_bonded_remote_atom_component)</pre>
<pre id='line1709' class='code' style='background-color: #FFFF27'>
  /* "Cython_shift_calculator.pyx":1709
 * 
 *         remote_pointer[0] =  <code><</code>Non_bonded_remote_atom_component*> <code><</code>size_t> ctypes.addressof(data)
 *         return len(data)/ sizeof(Non_bonded_remote_atom_component)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     @cython.profile(True)
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1709; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = (__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Non_bonded_remote_atom_component)));
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Fast_non_bonded_calculator._bytes_to_remote_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_non_bonded_calculator_5__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_non_bonded_calculator_5__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_atom_list_1 = 0;
  PyObject *__pyx_v_atom_list_2 = 0;
  struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_non_bonded_lists = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__call__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__atom_list_1,&__pyx_n_s__atom_list_2,&__pyx_n_s__non_bonded_lists,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__atom_list_1)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__atom_list_2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 3, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1712; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__non_bonded_lists)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 3, 3, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1712; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__call__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1712; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_atom_list_1 = values[0];
    __pyx_v_atom_list_2 = values[1];
    __pyx_v_non_bonded_lists = ((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)values[2]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1712; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_non_bonded_calculator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_non_bonded_lists), __pyx_ptype_17shift_calculators_Non_bonded_interaction_list, 1, "non_bonded_lists", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1712; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_non_bonded_calculator_4__call__(((struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *)__pyx_v_self), __pyx_v_atom_list_1, __pyx_v_atom_list_2, __pyx_v_non_bonded_lists);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1710")'> 1710: </pre>
<pre id='line1710' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1711")'> 1711:     @cython.profile(True)</pre>
<pre id='line1711' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1712")'> 1712:     def __call__(self, atom_list_1, atom_list_2,  Non_bonded_interaction_list non_bonded_lists):</pre>
<pre id='line1712' class='code' style='background-color: #FFFFd4'>
/* "Cython_shift_calculator.pyx":1712
 * 
 *     @cython.profile(True)
 *     def __call__(self, atom_list_1, atom_list_2,  Non_bonded_interaction_list non_bonded_lists):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if self._verbose:
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_non_bonded_calculator_4__call__(struct __pyx_obj_17shift_calculators_Fast_non_bonded_calculator *__pyx_v_self, PyObject *__pyx_v_atom_list_1, PyObject *__pyx_v_atom_list_2, struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *__pyx_v_non_bonded_lists) {
  struct __pyx_t_17shift_calculators_Non_bonded_target_component *__pyx_v_target_components;
  int __pyx_v_num_target_components;
  struct __pyx_t_17shift_calculators_Non_bonded_remote_atom_component *__pyx_v_remote_components;
  int __pyx_v_num_remote_components;
  double __pyx_v_start_time;
  double __pyx_v_end_time;
  int __pyx_v_i;
  int __pyx_v_atom_id_1;
  int __pyx_v_atom_id_2;
  int __pyx_v_j;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__call__", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("__call__", __pyx_f[0], 1712);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1713")'> 1713: </pre>
<pre id='line1713' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1714")'> 1714:         if self._verbose:</pre>
<pre id='line1714' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1714
 *     def __call__(self, atom_list_1, atom_list_2,  Non_bonded_interaction_list non_bonded_lists):
 * 
 *         if self._verbose:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print '***** BUILD NON BONDED ******'
 * 
 */
  if (__pyx_v_self->_verbose) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1715")'> 1715:             print '***** BUILD NON BONDED ******'</pre>
<pre id='line1715' class='code' style='background-color: #FFFFd4'>
    /* "Cython_shift_calculator.pyx":1715
 * 
 *         if self._verbose:
 *             print '***** BUILD NON BONDED ******'             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef  Non_bonded_target_component* target_components
 */
    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, ((PyObject *)__pyx_kp_s_46)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1715; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1716")'> 1716: </pre>
<pre id='line1716' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1717")'> 1717:         cdef  Non_bonded_target_component* target_components</pre>
<pre id='line1717' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1718")'> 1718:         cdef int num_target_components = self._bytes_to_target_components(atom_list_1,&amp;target_components)</pre>
<pre id='line1718' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1718
 * 
 *         cdef  Non_bonded_target_component* target_components
 *         cdef int num_target_components = self._bytes_to_target_components(atom_list_1,&target_components)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Non_bonded_remote_atom_component* remote_components
 */
  __pyx_v_num_target_components = ((struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_calculator *)__pyx_v_self->__pyx_vtab)->_bytes_to_target_components(__pyx_v_self, __pyx_v_atom_list_1, (&__pyx_v_target_components));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1719")'> 1719: </pre>
<pre id='line1719' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1720")'> 1720:         cdef Non_bonded_remote_atom_component* remote_components</pre>
<pre id='line1720' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1721")'> 1721:         cdef int num_remote_components = self._bytes_to_remote_components(atom_list_2,&amp;remote_components)</pre>
<pre id='line1721' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1721
 * 
 *         cdef Non_bonded_remote_atom_component* remote_components
 *         cdef int num_remote_components = self._bytes_to_remote_components(atom_list_2,&remote_components)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef double start_time = 0.0
 */
  __pyx_v_num_remote_components = ((struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_calculator *)__pyx_v_self->__pyx_vtab)->_bytes_to_remote_components(__pyx_v_self, __pyx_v_atom_list_2, (&__pyx_v_remote_components));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1722")'> 1722: </pre>
<pre id='line1722' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1723")'> 1723:         cdef double start_time = 0.0</pre>
<pre id='line1723' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1723
 *         cdef int num_remote_components = self._bytes_to_remote_components(atom_list_2,&remote_components)
 * 
 *         cdef double start_time = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef double end_time = 0.0
 *         if self._verbose:
 */
  __pyx_v_start_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1724")'> 1724:         cdef double end_time = 0.0</pre>
<pre id='line1724' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1724
 * 
 *         cdef double start_time = 0.0
 *         cdef double end_time = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if self._verbose:
 *             start_time = time()
 */
  __pyx_v_end_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1725")'> 1725:         if self._verbose:</pre>
<pre id='line1725' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1725
 *         cdef double start_time = 0.0
 *         cdef double end_time = 0.0
 *         if self._verbose:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             start_time = time()
 * 
 */
  if (__pyx_v_self->_verbose) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line1726")'> 1726:             start_time = time()</pre>
<pre id='line1726' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":1726
 *         cdef double end_time = 0.0
 *         if self._verbose:
 *             start_time = time()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__time);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1726; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1726; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1726; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_start_time = __pyx_t_3;
    goto __pyx_L4;
  }
  __pyx_L4:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1727")'> 1727: </pre>
<pre id='line1727' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1728")'> 1728: </pre>
<pre id='line1728' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1729")'> 1729:         cdef int i, atom_id_1, atom_id_2</pre>
<pre id='line1729' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1730")'> 1730: </pre>
<pre id='line1730' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line1731")'> 1731:         non_bonded_lists.clear()</pre>
<pre id='line1731' class='code' style='background-color: #FFFF73'>
  /* "Cython_shift_calculator.pyx":1731
 *         cdef int i, atom_id_1, atom_id_2
 * 
 *         non_bonded_lists.clear()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         for i in range(num_target_components):
 */
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_non_bonded_lists), __pyx_n_s__clear);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1732")'> 1732: </pre>
<pre id='line1732' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1733")'> 1733:         for i in range(num_target_components):</pre>
<pre id='line1733' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1733
 *         non_bonded_lists.clear()
 * 
 *         for i in range(num_target_components):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             atom_id_1 = target_components[i].target_atom_id
 * 
 */
  __pyx_t_4 = __pyx_v_num_target_components;
  for (__pyx_t_5 = 0; __pyx_t_5 <code><</code> __pyx_t_4; __pyx_t_5+=1) {
    __pyx_v_i = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1734")'> 1734:             atom_id_1 = target_components[i].target_atom_id</pre>
<pre id='line1734' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1734
 * 
 *         for i in range(num_target_components):
 *             atom_id_1 = target_components[i].target_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             for j in range(num_remote_components):
 */
    __pyx_t_6 = (__pyx_v_target_components[__pyx_v_i]).target_atom_id;
    __pyx_v_atom_id_1 = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1735")'> 1735: </pre>
<pre id='line1735' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1736")'> 1736:             for j in range(num_remote_components):</pre>
<pre id='line1736' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1736
 *             atom_id_1 = target_components[i].target_atom_id
 * 
 *             for j in range(num_remote_components):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 atom_id_2  = remote_components[j].remote_atom_id
 *                 if self._is_non_bonded(atom_id_1, atom_id_2):
 */
    __pyx_t_6 = __pyx_v_num_remote_components;
    for (__pyx_t_7 = 0; __pyx_t_7 <code><</code> __pyx_t_6; __pyx_t_7+=1) {
      __pyx_v_j = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1737")'> 1737:                 atom_id_2  = remote_components[j].remote_atom_id</pre>
<pre id='line1737' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1737
 * 
 *             for j in range(num_remote_components):
 *                 atom_id_2  = remote_components[j].remote_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if self._is_non_bonded(atom_id_1, atom_id_2):
 *                     non_bonded_lists.append(atom_id_1, i,j,i)
 */
      __pyx_t_8 = (__pyx_v_remote_components[__pyx_v_j]).remote_atom_id;
      __pyx_v_atom_id_2 = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1738")'> 1738:                 if self._is_non_bonded(atom_id_1, atom_id_2):</pre>
<pre id='line1738' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1738
 *             for j in range(num_remote_components):
 *                 atom_id_2  = remote_components[j].remote_atom_id
 *                 if self._is_non_bonded(atom_id_1, atom_id_2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     non_bonded_lists.append(atom_id_1, i,j,i)
 *         if self._verbose:
 */
      __pyx_t_9 = __pyx_f_17shift_calculators_26Fast_non_bonded_calculator__is_non_bonded(__pyx_v_self, __pyx_v_atom_id_1, __pyx_v_atom_id_2);
      if (__pyx_t_9) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1739")'> 1739:                     non_bonded_lists.append(atom_id_1, i,j,i)</pre>
<pre id='line1739' class='code' style='background-color: #FFFFff'>
        /* "Cython_shift_calculator.pyx":1739
 *                 atom_id_2  = remote_components[j].remote_atom_id
 *                 if self._is_non_bonded(atom_id_1, atom_id_2):
 *                     non_bonded_lists.append(atom_id_1, i,j,i)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if self._verbose:
 *             end_time = time()
 */
        __pyx_f_17shift_calculators_27Non_bonded_interaction_list_append(__pyx_v_non_bonded_lists, __pyx_v_atom_id_1, __pyx_v_i, __pyx_v_j, __pyx_v_i);
        goto __pyx_L9;
      }
      __pyx_L9:;
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1740")'> 1740:         if self._verbose:</pre>
<pre id='line1740' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1740
 *                 if self._is_non_bonded(atom_id_1, atom_id_2):
 *                     non_bonded_lists.append(atom_id_1, i,j,i)
 *         if self._verbose:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             end_time = time()
 *             print '   non bonded list targets: ',len(atom_list_1),' remotes: ', len(atom_list_2),' in', "%.17g" %  (end_time-start_time), "seconds"
 */
  if (__pyx_v_self->_verbose) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line1741")'> 1741:             end_time = time()</pre>
<pre id='line1741' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":1741
 *                     non_bonded_lists.append(atom_id_1, i,j,i)
 *         if self._verbose:
 *             end_time = time()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print '   non bonded list targets: ',len(atom_list_1),' remotes: ', len(atom_list_2),' in', "%.17g" %  (end_time-start_time), "seconds"
 * 
 */
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__time);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1741; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1741; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1741; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_end_time = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF1f' onclick='toggleDiv("line1742")'> 1742:             print '   non bonded list targets: ',len(atom_list_1),' remotes: ', len(atom_list_2),' in', "%.17g" %  (end_time-start_time), "seconds"</pre>
<pre id='line1742' class='code' style='background-color: #FFFF1f'>
    /* "Cython_shift_calculator.pyx":1742
 *         if self._verbose:
 *             end_time = time()
 *             print '   non bonded list targets: ',len(atom_list_1),' remotes: ', len(atom_list_2),' in', "%.17g" %  (end_time-start_time), "seconds"             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_t_10 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_atom_list_1);<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_10 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_atom_list_2);<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_end_time - __pyx_v_start_time));<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
    __pyx_t_12 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_32), __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_12));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_47));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, ((PyObject *)__pyx_kp_s_47));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_47));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_t_2);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_48));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 2, ((PyObject *)__pyx_kp_s_48));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_48));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 3, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_42));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 4, ((PyObject *)__pyx_kp_s_42));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_42));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 5, ((PyObject *)__pyx_t_12));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_12));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__seconds));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 6, ((PyObject *)__pyx_n_s__seconds));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__seconds));
    __pyx_t_2 = 0;
    __pyx_t_1 = 0;
    __pyx_t_12 = 0;
    if (<span class='pyx_c_api'>__Pyx_Print</span>(0, ((PyObject *)__pyx_t_11), 1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_11)); __pyx_t_11 = 0;
    goto __pyx_L10;
  }
  __pyx_L10:;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_non_bonded_calculator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_22Fast_energy_calculator_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_22Fast_energy_calculator_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) > 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) > 0) && unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__init__", 0))) return -1;
  __pyx_r = __pyx_pf_17shift_calculators_22Fast_energy_calculator___init__(((struct __pyx_obj_17shift_calculators_Fast_energy_calculator *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1743")'> 1743: </pre>
<pre id='line1743' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1744")'> 1744: </pre>
<pre id='line1744' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1745")'> 1745: cdef class Fast_energy_calculator:</pre>
<pre id='line1745' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1745
 * 
 * 
 * cdef class Fast_energy_calculator:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Constant_cache* _energy_term_cache
 *     cdef CDSVector[double]  *_theory_shifts
 */
struct __pyx_obj_17shift_calculators_Fast_energy_calculator {
  PyObject_HEAD
  struct __pyx_vtabstruct_17shift_calculators_Fast_energy_calculator *__pyx_vtab;
  struct __pyx_t_17shift_calculators_Constant_cache *_energy_term_cache;
  CDSVector<code><</code>double> *_theory_shifts;
  __Pyx_memviewslice _observed_shifts;
  int _verbose;
  int calls;
};


/* "Cython_shift_calculator.pyx":1745
 * 
 * 
 * cdef class Fast_energy_calculator:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef Constant_cache* _energy_term_cache
 *     cdef CDSVector[double]  *_theory_shifts
 */

struct __pyx_vtabstruct_17shift_calculators_Fast_energy_calculator {
  struct __pyx_t_17shift_calculators_Constant_cache *(*_get_energy_terms)(struct __pyx_obj_17shift_calculators_Fast_energy_calculator *, int);
  float (*_get_calculated_atom_shift)(struct __pyx_obj_17shift_calculators_Fast_energy_calculator *, int);
  float (*_get_observed_atom_shift)(struct __pyx_obj_17shift_calculators_Fast_energy_calculator *, int);
  float (*_get_shift_difference)(struct __pyx_obj_17shift_calculators_Fast_energy_calculator *, int, int);
  float (*_adjust_shift)(struct __pyx_obj_17shift_calculators_Fast_energy_calculator *, float, float);
  float (*_calc_one_energy)(struct __pyx_obj_17shift_calculators_Fast_energy_calculator *, int, int);
};
static struct __pyx_vtabstruct_17shift_calculators_Fast_energy_calculator *__pyx_vtabptr_17shift_calculators_Fast_energy_calculator;
static CYTHON_INLINE float __pyx_f_17shift_calculators_22Fast_energy_calculator__get_calculated_atom_shift(struct __pyx_obj_17shift_calculators_Fast_energy_calculator *, int);
static CYTHON_INLINE float __pyx_f_17shift_calculators_22Fast_energy_calculator__get_observed_atom_shift(struct __pyx_obj_17shift_calculators_Fast_energy_calculator *, int);
static CYTHON_INLINE float __pyx_f_17shift_calculators_22Fast_energy_calculator__get_shift_difference(struct __pyx_obj_17shift_calculators_Fast_energy_calculator *, int, int);
static CYTHON_INLINE float __pyx_f_17shift_calculators_22Fast_energy_calculator__adjust_shift(struct __pyx_obj_17shift_calculators_Fast_energy_calculator *, float, float);
static CYTHON_INLINE float __pyx_f_17shift_calculators_22Fast_energy_calculator__calc_one_energy(struct __pyx_obj_17shift_calculators_Fast_energy_calculator *, int, int);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1746")'> 1746:     cdef Constant_cache* _energy_term_cache</pre>
<pre id='line1746' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1747")'> 1747:     cdef CDSVector[double]  *_theory_shifts</pre>
<pre id='line1747' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1748")'> 1748:     cdef float[:] _observed_shifts</pre>
<pre id='line1748' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1749")'> 1749:     cdef bint _verbose</pre>
<pre id='line1749' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1750")'> 1750:     cdef int calls</pre>
<pre id='line1750' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1751")'> 1751: </pre>
<pre id='line1751' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1752")'> 1752:     def __init__(self):</pre>
<pre id='line1752' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1752
 *     cdef int calls
 * 
 *     def __init__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._energy_term_cache =  NULL
 *         self._theory_shifts =   NULL
 */

static int __pyx_pf_17shift_calculators_22Fast_energy_calculator___init__(struct __pyx_obj_17shift_calculators_Fast_energy_calculator *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1753")'> 1753:         self._energy_term_cache =  NULL</pre>
<pre id='line1753' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1753
 * 
 *     def __init__(self):
 *         self._energy_term_cache =  NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._theory_shifts =   NULL
 *         self._observed_shifts =  None
 */
  __pyx_v_self->_energy_term_cache = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1754")'> 1754:         self._theory_shifts =   NULL</pre>
<pre id='line1754' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1754
 *     def __init__(self):
 *         self._energy_term_cache =  NULL
 *         self._theory_shifts =   NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._observed_shifts =  None
 *         self._verbose = False
 */
  __pyx_v_self->_theory_shifts = NULL;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1755")'> 1755:         self._observed_shifts =  None</pre>
<pre id='line1755' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":1755
 *         self._energy_term_cache =  NULL
 *         self._theory_shifts =   NULL
 *         self._observed_shifts =  None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._verbose = False
 *         self.calls = 0
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(Py_None);
  if (unlikely(!__pyx_t_1.memview))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1755; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __PYX_XDEC_MEMVIEW(&__pyx_v_self->_observed_shifts, 0);
  __pyx_v_self->_observed_shifts = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1756")'> 1756:         self._verbose = False</pre>
<pre id='line1756' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1756
 *         self._theory_shifts =   NULL
 *         self._observed_shifts =  None
 *         self._verbose = False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.calls = 0
 * 
 */
  __pyx_v_self->_verbose = 0;
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line1757")'> 1757:         self.calls = 0</pre>
<pre id='line1757' class='code' style='background-color: #FFFFb6'>
  /* "Cython_shift_calculator.pyx":1757
 *         self._observed_shifts =  None
 *         self._verbose = False
 *         self.calls = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_self->calls = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&__pyx_t_1, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_energy_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_22Fast_energy_calculator_3set_verbose(PyObject *__pyx_v_self, PyObject *__pyx_v_on); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_22Fast_energy_calculator_3set_verbose(PyObject *__pyx_v_self, PyObject *__pyx_v_on) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_verbose (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_22Fast_energy_calculator_2set_verbose(((struct __pyx_obj_17shift_calculators_Fast_energy_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_on));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1758")'> 1758: </pre>
<pre id='line1758' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1759")'> 1759: </pre>
<pre id='line1759' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1760")'> 1760:     def set_verbose(self,on):</pre>
<pre id='line1760' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1760
 * 
 * 
 *     def set_verbose(self,on):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._verbose = on
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_22Fast_energy_calculator_2set_verbose(struct __pyx_obj_17shift_calculators_Fast_energy_calculator *__pyx_v_self, PyObject *__pyx_v_on) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_verbose", 0);
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line1761")'> 1761:         self._verbose = on</pre>
<pre id='line1761' class='code' style='background-color: #FFFF55'>
  /* "Cython_shift_calculator.pyx":1761
 * 
 *     def set_verbose(self,on):
 *         self._verbose = on             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def set_observed_shifts(self, float[:] observed_shifts):
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_v_on);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1761; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_verbose = __pyx_t_1;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_energy_calculator.set_verbose", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_22Fast_energy_calculator_5set_observed_shifts(PyObject *__pyx_v_self, PyObject *__pyx_arg_observed_shifts); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_22Fast_energy_calculator_5set_observed_shifts(PyObject *__pyx_v_self, PyObject *__pyx_arg_observed_shifts) {
  __Pyx_memviewslice __pyx_v_observed_shifts = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_observed_shifts (wrapper)", 0);
  assert(__pyx_arg_observed_shifts); {
    __pyx_v_observed_shifts = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_arg_observed_shifts);<span class='error_goto'> if (unlikely(!__pyx_v_observed_shifts.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1763; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_energy_calculator.set_observed_shifts", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_22Fast_energy_calculator_4set_observed_shifts(((struct __pyx_obj_17shift_calculators_Fast_energy_calculator *)__pyx_v_self), __pyx_v_observed_shifts);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1762")'> 1762: </pre>
<pre id='line1762' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1763")'> 1763:     def set_observed_shifts(self, float[:] observed_shifts):</pre>
<pre id='line1763' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1763
 *         self._verbose = on
 * 
 *     def set_observed_shifts(self, float[:] observed_shifts):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._observed_shifts =  observed_shifts
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_22Fast_energy_calculator_4set_observed_shifts(struct __pyx_obj_17shift_calculators_Fast_energy_calculator *__pyx_v_self, __Pyx_memviewslice __pyx_v_observed_shifts) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_observed_shifts", 0);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1764")'> 1764:         self._observed_shifts =  observed_shifts</pre>
<pre id='line1764' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":1764
 * 
 *     def set_observed_shifts(self, float[:] observed_shifts):
 *         self._observed_shifts =  observed_shifts             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def set_calculated_shifts(self, CDSVectorFloat calculated_shifts):
 */
  __PYX_XDEC_MEMVIEW(&__pyx_v_self->_observed_shifts, 0);
  __PYX_INC_MEMVIEW(&__pyx_v_observed_shifts, 0);
  __pyx_v_self->_observed_shifts = __pyx_v_observed_shifts;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __PYX_XDEC_MEMVIEW(&__pyx_v_observed_shifts, 1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_22Fast_energy_calculator_7set_calculated_shifts(PyObject *__pyx_v_self, PyObject *__pyx_v_calculated_shifts); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_22Fast_energy_calculator_7set_calculated_shifts(PyObject *__pyx_v_self, PyObject *__pyx_v_calculated_shifts) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_calculated_shifts (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_calculated_shifts), __pyx_ptype_17shift_calculators_CDSVectorFloat, 1, "calculated_shifts", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1766; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_22Fast_energy_calculator_6set_calculated_shifts(((struct __pyx_obj_17shift_calculators_Fast_energy_calculator *)__pyx_v_self), ((struct __pyx_obj_17shift_calculators_CDSVectorFloat *)__pyx_v_calculated_shifts));
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1765")'> 1765: </pre>
<pre id='line1765' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1766")'> 1766:     def set_calculated_shifts(self, CDSVectorFloat calculated_shifts):</pre>
<pre id='line1766' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1766
 *         self._observed_shifts =  observed_shifts
 * 
 *     def set_calculated_shifts(self, CDSVectorFloat calculated_shifts):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._theory_shifts = calculated_shifts.get_data()
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_22Fast_energy_calculator_6set_calculated_shifts(struct __pyx_obj_17shift_calculators_Fast_energy_calculator *__pyx_v_self, struct __pyx_obj_17shift_calculators_CDSVectorFloat *__pyx_v_calculated_shifts) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_calculated_shifts", 0);
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line1767")'> 1767:         self._theory_shifts = calculated_shifts.get_data()</pre>
<pre id='line1767' class='code' style='background-color: #FFFFc4'>
  /* "Cython_shift_calculator.pyx":1767
 * 
 *     def set_calculated_shifts(self, CDSVectorFloat calculated_shifts):
 *         self._theory_shifts = calculated_shifts.get_data()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def set_energy_term_cache(self, energy_term_cache ):
 */
  __pyx_v_self->_theory_shifts = ((struct __pyx_vtabstruct_17shift_calculators_CDSVectorFloat *)__pyx_v_calculated_shifts->__pyx_vtab)->get_data(__pyx_v_calculated_shifts);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_22Fast_energy_calculator_9set_energy_term_cache(PyObject *__pyx_v_self, PyObject *__pyx_v_energy_term_cache); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_22Fast_energy_calculator_9set_energy_term_cache(PyObject *__pyx_v_self, PyObject *__pyx_v_energy_term_cache) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_energy_term_cache (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_22Fast_energy_calculator_8set_energy_term_cache(((struct __pyx_obj_17shift_calculators_Fast_energy_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_energy_term_cache));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1768")'> 1768: </pre>
<pre id='line1768' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1769")'> 1769:     def set_energy_term_cache(self, energy_term_cache ):</pre>
<pre id='line1769' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1769
 *         self._theory_shifts = calculated_shifts.get_data()
 * 
 *     def set_energy_term_cache(self, energy_term_cache ):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._energy_term_cache =  <code><</code>Constant_cache*> <code><</code>size_t> ctypes.addressof(energy_term_cache)
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_22Fast_energy_calculator_8set_energy_term_cache(struct __pyx_obj_17shift_calculators_Fast_energy_calculator *__pyx_v_self, PyObject *__pyx_v_energy_term_cache) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_energy_term_cache", 0);
</pre><pre class='line' style='background-color: #FFFF33' onclick='toggleDiv("line1770")'> 1770:         self._energy_term_cache =  &lt;Constant_cache*&gt; &lt;size_t&gt; ctypes.addressof(energy_term_cache)</pre>
<pre id='line1770' class='code' style='background-color: #FFFF33'>
  /* "Cython_shift_calculator.pyx":1770
 * 
 *     def set_energy_term_cache(self, energy_term_cache ):
 *         self._energy_term_cache =  <code><</code>Constant_cache*> <code><</code>size_t> ctypes.addressof(energy_term_cache)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef Constant_cache* _get_energy_terms(self, int target_atom_index):
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_energy_term_cache);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_energy_term_cache);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_energy_term_cache);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_self->_energy_term_cache = ((struct __pyx_t_17shift_calculators_Constant_cache *)((size_t)__pyx_t_4));

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_energy_calculator.set_energy_term_cache", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1771")'> 1771: </pre>
<pre id='line1771' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1772")'> 1772:     cdef Constant_cache* _get_energy_terms(self, int target_atom_index):</pre>
<pre id='line1772' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1772
 *         self._energy_term_cache =  <code><</code>Constant_cache*> <code><</code>size_t> ctypes.addressof(energy_term_cache)
 * 
 *     cdef Constant_cache* _get_energy_terms(self, int target_atom_index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return &self._energy_term_cache[target_atom_index]
 * 
 */

static struct __pyx_t_17shift_calculators_Constant_cache *__pyx_f_17shift_calculators_22Fast_energy_calculator__get_energy_terms(struct __pyx_obj_17shift_calculators_Fast_energy_calculator *__pyx_v_self, int __pyx_v_target_atom_index) {
  struct __pyx_t_17shift_calculators_Constant_cache *__pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_get_energy_terms", 0);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1773")'> 1773:         return &amp;self._energy_term_cache[target_atom_index]</pre>
<pre id='line1773' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":1773
 * 
 *     cdef Constant_cache* _get_energy_terms(self, int target_atom_index):
 *         return &self._energy_term_cache[target_atom_index]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline float  _get_calculated_atom_shift(self, int index):
 */
  __pyx_r = (&(__pyx_v_self->_energy_term_cache[__pyx_v_target_atom_index]));
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1774")'> 1774: </pre>
<pre id='line1774' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1775")'> 1775:     cdef inline float  _get_calculated_atom_shift(self, int index):</pre>
<pre id='line1775' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1775
 *         return &self._energy_term_cache[target_atom_index]
 * 
 *     cdef inline float  _get_calculated_atom_shift(self, int index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._theory_shifts[0][index]
 * 
 */

static CYTHON_INLINE float __pyx_f_17shift_calculators_22Fast_energy_calculator__get_calculated_atom_shift(struct __pyx_obj_17shift_calculators_Fast_energy_calculator *__pyx_v_self, int __pyx_v_index) {
  float __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_get_calculated_atom_shift", 0);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1776")'> 1776:         return self._theory_shifts[0][index]</pre>
<pre id='line1776' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":1776
 * 
 *     cdef inline float  _get_calculated_atom_shift(self, int index):
 *         return self._theory_shifts[0][index]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline float _get_observed_atom_shift(self, int index):
 */
  __pyx_r = ((__pyx_v_self->_theory_shifts[0])[__pyx_v_index]);
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1777")'> 1777: </pre>
<pre id='line1777' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1778")'> 1778:     cdef inline float _get_observed_atom_shift(self, int index):</pre>
<pre id='line1778' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1778
 *         return self._theory_shifts[0][index]
 * 
 *     cdef inline float _get_observed_atom_shift(self, int index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._observed_shifts[index]
 * 
 */

static CYTHON_INLINE float __pyx_f_17shift_calculators_22Fast_energy_calculator__get_observed_atom_shift(struct __pyx_obj_17shift_calculators_Fast_energy_calculator *__pyx_v_self, int __pyx_v_index) {
  float __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_get_observed_atom_shift", 0);
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line1779")'> 1779:         return self._observed_shifts[index]</pre>
<pre id='line1779' class='code' style='background-color: #FFFF8d'>
  /* "Cython_shift_calculator.pyx":1779
 * 
 *     cdef inline float _get_observed_atom_shift(self, int index):
 *         return self._observed_shifts[index]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline float  _get_shift_difference(self, int target_atom_index, int index):
 */
  if (unlikely(!__pyx_v_self->_observed_shifts.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1779; __pyx_clineno = __LINE__; goto __pyx_L1_error;}}
  __pyx_t_1 = __pyx_v_index;
  __pyx_r = (*((float *) ( /* dim=0 */ (__pyx_v_self->_observed_shifts.data + __pyx_t_1 * __pyx_v_self->_observed_shifts.strides[0]) )));
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Fast_energy_calculator._get_observed_atom_shift", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1780")'> 1780: </pre>
<pre id='line1780' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1781")'> 1781:     cdef inline float  _get_shift_difference(self, int target_atom_index, int index):</pre>
<pre id='line1781' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1781
 *         return self._observed_shifts[index]
 * 
 *     cdef inline float  _get_shift_difference(self, int target_atom_index, int index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef float theory_shift
 *         cdef float observed_shift
 */

static CYTHON_INLINE float __pyx_f_17shift_calculators_22Fast_energy_calculator__get_shift_difference(struct __pyx_obj_17shift_calculators_Fast_energy_calculator *__pyx_v_self, CYTHON_UNUSED int __pyx_v_target_atom_index, int __pyx_v_index) {
  float __pyx_v_theory_shift;
  float __pyx_v_observed_shift;
  float __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_get_shift_difference", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1782")'> 1782:         cdef float theory_shift</pre>
<pre id='line1782' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1783")'> 1783:         cdef float observed_shift</pre>
<pre id='line1783' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1784")'> 1784:         theory_shift = self._get_calculated_atom_shift(index)</pre>
<pre id='line1784' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1784
 *         cdef float theory_shift
 *         cdef float observed_shift
 *         theory_shift = self._get_calculated_atom_shift(index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         observed_shift = self._get_observed_atom_shift(index)
 */
  __pyx_v_theory_shift = __pyx_f_17shift_calculators_22Fast_energy_calculator__get_calculated_atom_shift(__pyx_v_self, __pyx_v_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1785")'> 1785: </pre>
<pre id='line1785' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1786")'> 1786:         observed_shift = self._get_observed_atom_shift(index)</pre>
<pre id='line1786' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1786
 *         theory_shift = self._get_calculated_atom_shift(index)
 * 
 *         observed_shift = self._get_observed_atom_shift(index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         return observed_shift - theory_shift
 */
  __pyx_v_observed_shift = __pyx_f_17shift_calculators_22Fast_energy_calculator__get_observed_atom_shift(__pyx_v_self, __pyx_v_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1787")'> 1787: </pre>
<pre id='line1787' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1788")'> 1788:         return observed_shift - theory_shift</pre>
<pre id='line1788' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":1788
 *         observed_shift = self._get_observed_atom_shift(index)
 * 
 *         return observed_shift - theory_shift             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline float _adjust_shift(self, float shift_diff, float flat_bottom_shift_limit):
 */
  __pyx_r = (__pyx_v_observed_shift - __pyx_v_theory_shift);
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1789")'> 1789: </pre>
<pre id='line1789' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1790")'> 1790:     cdef inline float _adjust_shift(self, float shift_diff, float flat_bottom_shift_limit):</pre>
<pre id='line1790' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1790
 *         return observed_shift - theory_shift
 * 
 *     cdef inline float _adjust_shift(self, float shift_diff, float flat_bottom_shift_limit):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result  = 0.0
 *         if (shift_diff > 0.0):
 */

static CYTHON_INLINE float __pyx_f_17shift_calculators_22Fast_energy_calculator__adjust_shift(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Fast_energy_calculator *__pyx_v_self, float __pyx_v_shift_diff, float __pyx_v_flat_bottom_shift_limit) {
  double __pyx_v_result;
  float __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_adjust_shift", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1791")'> 1791:         result  = 0.0</pre>
<pre id='line1791' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1791
 * 
 *     cdef inline float _adjust_shift(self, float shift_diff, float flat_bottom_shift_limit):
 *         result  = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if (shift_diff > 0.0):
 *             result = shift_diff-flat_bottom_shift_limit
 */
  __pyx_v_result = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1792")'> 1792:         if (shift_diff &gt; 0.0):</pre>
<pre id='line1792' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1792
 *     cdef inline float _adjust_shift(self, float shift_diff, float flat_bottom_shift_limit):
 *         result  = 0.0
 *         if (shift_diff > 0.0):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             result = shift_diff-flat_bottom_shift_limit
 *         else:
 */
  __pyx_t_1 = (__pyx_v_shift_diff > 0.0);
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1793")'> 1793:             result = shift_diff-flat_bottom_shift_limit</pre>
<pre id='line1793' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1793
 *         result  = 0.0
 *         if (shift_diff > 0.0):
 *             result = shift_diff-flat_bottom_shift_limit             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             result = shift_diff + flat_bottom_shift_limit
 */
    __pyx_v_result = (__pyx_v_shift_diff - __pyx_v_flat_bottom_shift_limit);
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1794")'> 1794:         else:</pre>
<pre id='line1794' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1795")'> 1795:             result = shift_diff + flat_bottom_shift_limit</pre>
<pre id='line1795' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1795
 *             result = shift_diff-flat_bottom_shift_limit
 *         else:
 *             result = shift_diff + flat_bottom_shift_limit             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return result
 * 
 */
    __pyx_v_result = (__pyx_v_shift_diff + __pyx_v_flat_bottom_shift_limit);
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFF38' onclick='toggleDiv("line1796")'> 1796:         return result</pre>
<pre id='line1796' class='code' style='background-color: #FFFF38'>
  /* "Cython_shift_calculator.pyx":1796
 *         else:
 *             result = shift_diff + flat_bottom_shift_limit
 *         return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     @cython.profile(True)
 */
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_22Fast_energy_calculator_11__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_22Fast_energy_calculator_11__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_target_atom_ids = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_active_atom_ids = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__call__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__target_atom_ids,&__pyx_n_s__active_atom_ids,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__target_atom_ids)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__active_atom_ids);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__call__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1799; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_target_atom_ids = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0]);<span class='error_goto'> if (unlikely(!__pyx_v_target_atom_ids.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1799; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    if (values[1]) {
      __pyx_v_active_atom_ids = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[1]);<span class='error_goto'> if (unlikely(!__pyx_v_active_atom_ids.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1799; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_active_atom_ids = __pyx_k_49;
      __PYX_INC_MEMVIEW(&__pyx_v_active_atom_ids, 1);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1799; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_energy_calculator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_22Fast_energy_calculator_10__call__(((struct __pyx_obj_17shift_calculators_Fast_energy_calculator *)__pyx_v_self), __pyx_v_target_atom_ids, __pyx_v_active_atom_ids);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1797")'> 1797: </pre>
<pre id='line1797' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1798")'> 1798:     @cython.profile(True)</pre>
<pre id='line1798' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line1799")'> 1799:     def __call__(self,int[:] target_atom_ids, int[:] active_atom_ids=None):</pre>
<pre id='line1799' class='code' style='background-color: #FFFFb6'>
/* "Cython_shift_calculator.pyx":1799
 * 
 *     @cython.profile(True)
 *     def __call__(self,int[:] target_atom_ids, int[:] active_atom_ids=None):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef double start_time = 0.0
 */

static PyObject *__pyx_pf_17shift_calculators_22Fast_energy_calculator_10__call__(struct __pyx_obj_17shift_calculators_Fast_energy_calculator *__pyx_v_self, __Pyx_memviewslice __pyx_v_target_atom_ids, __Pyx_memviewslice __pyx_v_active_atom_ids) {
  double __pyx_v_start_time;
  double __pyx_v_end_time;
  float __pyx_v_energy;
  int __pyx_v_active_atom_id;
  int __pyx_v_target_atom_id;
  Py_ssize_t __pyx_v_i;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__call__", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("__call__", __pyx_f[0], 1799);

  /* "Cython_shift_calculator.pyx":1799
 * 
 *     @cython.profile(True)
 *     def __call__(self,int[:] target_atom_ids, int[:] active_atom_ids=None):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef double start_time = 0.0
 */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(Py_None);
  if (unlikely(!__pyx_t_4.memview))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1799; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_k_49 = __pyx_t_4;
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1800")'> 1800: </pre>
<pre id='line1800' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1801")'> 1801:         cdef double start_time = 0.0</pre>
<pre id='line1801' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1801
 *     def __call__(self,int[:] target_atom_ids, int[:] active_atom_ids=None):
 * 
 *         cdef double start_time = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef double end_time = 0.0
 *         cdef float energy
 */
  __pyx_v_start_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1802")'> 1802:         cdef double end_time = 0.0</pre>
<pre id='line1802' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1802
 * 
 *         cdef double start_time = 0.0
 *         cdef double end_time = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef float energy
 *         cdef int active_atom_id
 */
  __pyx_v_end_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1803")'> 1803:         cdef float energy</pre>
<pre id='line1803' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1804")'> 1804:         cdef int active_atom_id</pre>
<pre id='line1804' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1805")'> 1805:         cdef int target_atom_id</pre>
<pre id='line1805' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1806")'> 1806: </pre>
<pre id='line1806' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1807")'> 1807:         if self._verbose:</pre>
<pre id='line1807' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1807
 *         cdef int target_atom_id
 * 
 *         if self._verbose:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             start_time = time()
 * 
 */
  if (__pyx_v_self->_verbose) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line1808")'> 1808:             start_time = time()</pre>
<pre id='line1808' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":1808
 * 
 *         if self._verbose:
 *             start_time = time()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         energy = 0.0
 */
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__time);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1808; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1808; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1808; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_start_time = __pyx_t_3;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1809")'> 1809: </pre>
<pre id='line1809' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1810")'> 1810:         energy = 0.0</pre>
<pre id='line1810' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1810
 *             start_time = time()
 * 
 *         energy = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if active_atom_ids == None:
 */
  __pyx_v_energy = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1811")'> 1811: </pre>
<pre id='line1811' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1812")'> 1812:         if active_atom_ids == None:</pre>
<pre id='line1812' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1812
 *         energy = 0.0
 * 
 *         if active_atom_ids == None:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for i in range(target_atom_ids.shape[0]):
 *                 target_atom_id = target_atom_ids[i]
 */
  __pyx_t_4 = (((PyObject *) __pyx_v_active_atom_ids.memview) == Py_None);
  if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1813")'> 1813:             for i in range(target_atom_ids.shape[0]):</pre>
<pre id='line1813' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1813
 * 
 *         if active_atom_ids == None:
 *             for i in range(target_atom_ids.shape[0]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 target_atom_id = target_atom_ids[i]
 * 
 */
    __pyx_t_5 = (__pyx_v_target_atom_ids.shape[0]);
    for (__pyx_t_6 = 0; __pyx_t_6 <code><</code> __pyx_t_5; __pyx_t_6+=1) {
      __pyx_v_i = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1814")'> 1814:                 target_atom_id = target_atom_ids[i]</pre>
<pre id='line1814' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1814
 *         if active_atom_ids == None:
 *             for i in range(target_atom_ids.shape[0]):
 *                 target_atom_id = target_atom_ids[i]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 energy += self._calc_one_energy(target_atom_id, i)
 */
      __pyx_t_7 = __pyx_v_i;
      __pyx_v_target_atom_id = (*((int *) ( /* dim=0 */ (__pyx_v_target_atom_ids.data + __pyx_t_7 * __pyx_v_target_atom_ids.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1815")'> 1815: </pre>
<pre id='line1815' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1816")'> 1816:                 energy += self._calc_one_energy(target_atom_id, i)</pre>
<pre id='line1816' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1816
 *                 target_atom_id = target_atom_ids[i]
 * 
 *                 energy += self._calc_one_energy(target_atom_id, i)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             for i in  range(active_atom_ids.shape[0]):
 */
      __pyx_v_energy = (__pyx_v_energy + __pyx_f_17shift_calculators_22Fast_energy_calculator__calc_one_energy(__pyx_v_self, __pyx_v_target_atom_id, __pyx_v_i));
    }
    goto __pyx_L4;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1817")'> 1817:         else:</pre>
<pre id='line1817' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1818")'> 1818:             for i in  range(active_atom_ids.shape[0]):</pre>
<pre id='line1818' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1818
 *                 energy += self._calc_one_energy(target_atom_id, i)
 *         else:
 *             for i in  range(active_atom_ids.shape[0]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 active_atom_id = active_atom_ids[i]
 *                 target_atom_id = target_atom_ids[active_atom_id]
 */
    __pyx_t_5 = (__pyx_v_active_atom_ids.shape[0]);
    for (__pyx_t_6 = 0; __pyx_t_6 <code><</code> __pyx_t_5; __pyx_t_6+=1) {
      __pyx_v_i = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1819")'> 1819:                 active_atom_id = active_atom_ids[i]</pre>
<pre id='line1819' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1819
 *         else:
 *             for i in  range(active_atom_ids.shape[0]):
 *                 active_atom_id = active_atom_ids[i]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 target_atom_id = target_atom_ids[active_atom_id]
 * 
 */
      __pyx_t_8 = __pyx_v_i;
      __pyx_v_active_atom_id = (*((int *) ( /* dim=0 */ (__pyx_v_active_atom_ids.data + __pyx_t_8 * __pyx_v_active_atom_ids.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1820")'> 1820:                 target_atom_id = target_atom_ids[active_atom_id]</pre>
<pre id='line1820' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1820
 *             for i in  range(active_atom_ids.shape[0]):
 *                 active_atom_id = active_atom_ids[i]
 *                 target_atom_id = target_atom_ids[active_atom_id]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 energy += self._calc_one_energy(target_atom_id, active_atom_id)
 */
      __pyx_t_9 = __pyx_v_active_atom_id;
      __pyx_v_target_atom_id = (*((int *) ( /* dim=0 */ (__pyx_v_target_atom_ids.data + __pyx_t_9 * __pyx_v_target_atom_ids.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1821")'> 1821: </pre>
<pre id='line1821' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1822")'> 1822:                 energy += self._calc_one_energy(target_atom_id, active_atom_id)</pre>
<pre id='line1822' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1822
 *                 target_atom_id = target_atom_ids[active_atom_id]
 * 
 *                 energy += self._calc_one_energy(target_atom_id, active_atom_id)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if self._verbose:
 */
      __pyx_v_energy = (__pyx_v_energy + __pyx_f_17shift_calculators_22Fast_energy_calculator__calc_one_energy(__pyx_v_self, __pyx_v_target_atom_id, __pyx_v_active_atom_id));
    }
  }
  __pyx_L4:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1823")'> 1823: </pre>
<pre id='line1823' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1824")'> 1824:         if self._verbose:</pre>
<pre id='line1824' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1824
 *                 energy += self._calc_one_energy(target_atom_id, active_atom_id)
 * 
 *         if self._verbose:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             end_time = time()
 *             print '   energy calculator: ',len(target_atom_ids),' in', "%.17g" %  (end_time-start_time), "seconds"
 */
  if (__pyx_v_self->_verbose) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line1825")'> 1825:             end_time = time()</pre>
<pre id='line1825' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":1825
 * 
 *         if self._verbose:
 *             end_time = time()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print '   energy calculator: ',len(target_atom_ids),' in', "%.17g" %  (end_time-start_time), "seconds"
 * 
 */
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__time);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_end_time = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF35' onclick='toggleDiv("line1826")'> 1826:             print '   energy calculator: ',len(target_atom_ids),' in', "%.17g" %  (end_time-start_time), "seconds"</pre>
<pre id='line1826' class='code' style='background-color: #FFFF35'>
    /* "Cython_shift_calculator.pyx":1826
 *         if self._verbose:
 *             end_time = time()
 *             print '   energy calculator: ',len(target_atom_ids),' in', "%.17g" %  (end_time-start_time), "seconds"             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_target_atom_ids, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_end_time - __pyx_v_start_time));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_10 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_32), __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_10));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_50));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_kp_s_50));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_50));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_42));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, ((PyObject *)__pyx_kp_s_42));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_42));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 3, ((PyObject *)__pyx_t_10));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_10));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__seconds));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 4, ((PyObject *)__pyx_n_s__seconds));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__seconds));
    __pyx_t_1 = 0;
    __pyx_t_10 = 0;
    if (<span class='pyx_c_api'>__Pyx_Print</span>(0, ((PyObject *)__pyx_t_2), 1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    goto __pyx_L9;
  }
  __pyx_L9:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1827")'> 1827: </pre>
<pre id='line1827' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1828")'> 1828: </pre>
<pre id='line1828' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1829")'> 1829:         self.calls += 1</pre>
<pre id='line1829' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1829
 * 
 * 
 *         self.calls += 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return energy
 * 
 */
  __pyx_v_self->calls = (__pyx_v_self->calls + 1);
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line1830")'> 1830:         return energy</pre>
<pre id='line1830' class='code' style='background-color: #FFFF66'>
  /* "Cython_shift_calculator.pyx":1830
 * 
 *         self.calls += 1
 *         return energy             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline float _calc_one_energy(self, int target_atom_index, int index):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_energy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1830; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_energy_calculator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&__pyx_v_target_atom_ids, 1);
  __PYX_XDEC_MEMVIEW(&__pyx_v_active_atom_ids, 1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1831")'> 1831: </pre>
<pre id='line1831' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1832")'> 1832:     cdef inline float _calc_one_energy(self, int target_atom_index, int index):</pre>
<pre id='line1832' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1832
 *         return energy
 * 
 *     cdef inline float _calc_one_energy(self, int target_atom_index, int index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef float flat_bottom_shift_limit
 *         cdef float adjusted_shift_diff
 */

static CYTHON_INLINE float __pyx_f_17shift_calculators_22Fast_energy_calculator__calc_one_energy(struct __pyx_obj_17shift_calculators_Fast_energy_calculator *__pyx_v_self, int __pyx_v_target_atom_index, int __pyx_v_index) {
  float __pyx_v_flat_bottom_shift_limit;
  float __pyx_v_adjusted_shift_diff;
  float __pyx_v_end_harmonic;
  float __pyx_v_scale_harmonic;
  float __pyx_v_tanh_amplitude;
  float __pyx_v_tanh_elongation;
  float __pyx_v_tanh_y_offset;
  float __pyx_v_tanh_argument;
  float __pyx_v_energy;
  float __pyx_v_shift_diff;
  struct __pyx_t_17shift_calculators_Constant_cache *__pyx_v_energy_terms;
  float __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calc_one_energy", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1833")'> 1833:         cdef float flat_bottom_shift_limit</pre>
<pre id='line1833' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1834")'> 1834:         cdef float adjusted_shift_diff</pre>
<pre id='line1834' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1835")'> 1835:         cdef float end_harmonic</pre>
<pre id='line1835' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1836")'> 1836:         cdef float scale_harmonic</pre>
<pre id='line1836' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1837")'> 1837:         cdef float tanh_amplitude</pre>
<pre id='line1837' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1838")'> 1838:         cdef float tanh_elongation</pre>
<pre id='line1838' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1839")'> 1839:         cdef float tanh_y_offset</pre>
<pre id='line1839' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1840")'> 1840:         cdef float tanh_argument</pre>
<pre id='line1840' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1841")'> 1841:         cdef float energy</pre>
<pre id='line1841' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1842")'> 1842:         cdef float shift_diff</pre>
<pre id='line1842' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1843")'> 1843: </pre>
<pre id='line1843' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1844")'> 1844: </pre>
<pre id='line1844' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1845")'> 1845: </pre>
<pre id='line1845' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1846")'> 1846: </pre>
<pre id='line1846' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1847")'> 1847: </pre>
<pre id='line1847' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1848")'> 1848:         cdef float shift_diffs</pre>
<pre id='line1848' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1849")'> 1849:         cdef Constant_cache* energy_terms</pre>
<pre id='line1849' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1850")'> 1850: </pre>
<pre id='line1850' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1851")'> 1851:         shift_diff = self._get_shift_difference(target_atom_index, index)</pre>
<pre id='line1851' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1851
 *         cdef Constant_cache* energy_terms
 * 
 *         shift_diff = self._get_shift_difference(target_atom_index, index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         energy_terms = self._get_energy_terms(index)
 * 
 */
  __pyx_v_shift_diff = __pyx_f_17shift_calculators_22Fast_energy_calculator__get_shift_difference(__pyx_v_self, __pyx_v_target_atom_index, __pyx_v_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1852")'> 1852:         energy_terms = self._get_energy_terms(index)</pre>
<pre id='line1852' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1852
 * 
 *         shift_diff = self._get_shift_difference(target_atom_index, index)
 *         energy_terms = self._get_energy_terms(index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         flat_bottom_shift_limit = energy_terms[0].flat_bottom_shift_limit
 */
  __pyx_v_energy_terms = ((struct __pyx_vtabstruct_17shift_calculators_Fast_energy_calculator *)__pyx_v_self->__pyx_vtab)->_get_energy_terms(__pyx_v_self, __pyx_v_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1853")'> 1853: </pre>
<pre id='line1853' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1854")'> 1854:         flat_bottom_shift_limit = energy_terms[0].flat_bottom_shift_limit</pre>
<pre id='line1854' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1854
 *         energy_terms = self._get_energy_terms(index)
 * 
 *         flat_bottom_shift_limit = energy_terms[0].flat_bottom_shift_limit             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         energy = 0.0
 */
  __pyx_t_1 = (__pyx_v_energy_terms[0]).flat_bottom_shift_limit;
  __pyx_v_flat_bottom_shift_limit = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1855")'> 1855: </pre>
<pre id='line1855' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1856")'> 1856:         energy = 0.0</pre>
<pre id='line1856' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1856
 *         flat_bottom_shift_limit = energy_terms[0].flat_bottom_shift_limit
 * 
 *         energy = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if fabs(shift_diff) > flat_bottom_shift_limit:
 *             adjusted_shift_diff = self._adjust_shift(shift_diff, flat_bottom_shift_limit)
 */
  __pyx_v_energy = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1857")'> 1857:         if fabs(shift_diff) &gt; flat_bottom_shift_limit:</pre>
<pre id='line1857' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1857
 * 
 *         energy = 0.0
 *         if fabs(shift_diff) > flat_bottom_shift_limit:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             adjusted_shift_diff = self._adjust_shift(shift_diff, flat_bottom_shift_limit)
 * 
 */
  __pyx_t_2 = (fabs(__pyx_v_shift_diff) > __pyx_v_flat_bottom_shift_limit);
  if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1858")'> 1858:             adjusted_shift_diff = self._adjust_shift(shift_diff, flat_bottom_shift_limit)</pre>
<pre id='line1858' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1858
 *         energy = 0.0
 *         if fabs(shift_diff) > flat_bottom_shift_limit:
 *             adjusted_shift_diff = self._adjust_shift(shift_diff, flat_bottom_shift_limit)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             end_harmonic = energy_terms[0].end_harmonic
 */
    __pyx_v_adjusted_shift_diff = __pyx_f_17shift_calculators_22Fast_energy_calculator__adjust_shift(__pyx_v_self, __pyx_v_shift_diff, __pyx_v_flat_bottom_shift_limit);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1859")'> 1859: </pre>
<pre id='line1859' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1860")'> 1860:             end_harmonic = energy_terms[0].end_harmonic</pre>
<pre id='line1860' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1860
 *             adjusted_shift_diff = self._adjust_shift(shift_diff, flat_bottom_shift_limit)
 * 
 *             end_harmonic = energy_terms[0].end_harmonic             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             scale_harmonic = energy_terms[0].scale_harmonic
 * 
 */
    __pyx_t_1 = (__pyx_v_energy_terms[0]).end_harmonic;
    __pyx_v_end_harmonic = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1861")'> 1861:             scale_harmonic = energy_terms[0].scale_harmonic</pre>
<pre id='line1861' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1861
 * 
 *             end_harmonic = energy_terms[0].end_harmonic
 *             scale_harmonic = energy_terms[0].scale_harmonic             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_t_1 = (__pyx_v_energy_terms[0]).scale_harmonic;
    __pyx_v_scale_harmonic = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1862")'> 1862: </pre>
<pre id='line1862' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1863")'> 1863: </pre>
<pre id='line1863' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1864")'> 1864:             if adjusted_shift_diff &lt; end_harmonic:</pre>
<pre id='line1864' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1864
 * 
 * 
 *             if adjusted_shift_diff <code><</code> end_harmonic:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 energy += (adjusted_shift_diff/scale_harmonic)**2
 *             else:
 */
    __pyx_t_2 = (__pyx_v_adjusted_shift_diff <code><</code> __pyx_v_end_harmonic);
    if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1865")'> 1865:                 energy += (adjusted_shift_diff/scale_harmonic)**2</pre>
<pre id='line1865' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1865
 * 
 *             if adjusted_shift_diff <code><</code> end_harmonic:
 *                 energy += (adjusted_shift_diff/scale_harmonic)**2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 tanh_amplitude = energy_terms[0].tanh_amplitude
 */
      __pyx_v_energy = (__pyx_v_energy + powf((__pyx_v_adjusted_shift_diff / __pyx_v_scale_harmonic), 2.0));
      goto __pyx_L4;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1866")'> 1866:             else:</pre>
<pre id='line1866' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1867")'> 1867:                 tanh_amplitude = energy_terms[0].tanh_amplitude</pre>
<pre id='line1867' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1867
 *                 energy += (adjusted_shift_diff/scale_harmonic)**2
 *             else:
 *                 tanh_amplitude = energy_terms[0].tanh_amplitude             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 tanh_elongation = energy_terms[0].tanh_elongation
 *                 tanh_y_offset = energy_terms[0].tanh_y_offset
 */
      __pyx_t_1 = (__pyx_v_energy_terms[0]).tanh_amplitude;
      __pyx_v_tanh_amplitude = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1868")'> 1868:                 tanh_elongation = energy_terms[0].tanh_elongation</pre>
<pre id='line1868' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1868
 *             else:
 *                 tanh_amplitude = energy_terms[0].tanh_amplitude
 *                 tanh_elongation = energy_terms[0].tanh_elongation             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 tanh_y_offset = energy_terms[0].tanh_y_offset
 * 
 */
      __pyx_t_1 = (__pyx_v_energy_terms[0]).tanh_elongation;
      __pyx_v_tanh_elongation = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1869")'> 1869:                 tanh_y_offset = energy_terms[0].tanh_y_offset</pre>
<pre id='line1869' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1869
 *                 tanh_amplitude = energy_terms[0].tanh_amplitude
 *                 tanh_elongation = energy_terms[0].tanh_elongation
 *                 tanh_y_offset = energy_terms[0].tanh_y_offset             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 tanh_argument = tanh_elongation * (adjusted_shift_diff - end_harmonic)
 */
      __pyx_t_1 = (__pyx_v_energy_terms[0]).tanh_y_offset;
      __pyx_v_tanh_y_offset = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1870")'> 1870: </pre>
<pre id='line1870' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1871")'> 1871:                 tanh_argument = tanh_elongation * (adjusted_shift_diff - end_harmonic)</pre>
<pre id='line1871' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1871
 *                 tanh_y_offset = energy_terms[0].tanh_y_offset
 * 
 *                 tanh_argument = tanh_elongation * (adjusted_shift_diff - end_harmonic)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 energy += tanh_amplitude * tanh(tanh_argument) + tanh_y_offset;
 * 
 */
      __pyx_v_tanh_argument = (__pyx_v_tanh_elongation * (__pyx_v_adjusted_shift_diff - __pyx_v_end_harmonic));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1872")'> 1872:                 energy += tanh_amplitude * tanh(tanh_argument) + tanh_y_offset;</pre>
<pre id='line1872' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1872
 * 
 *                 tanh_argument = tanh_elongation * (adjusted_shift_diff - end_harmonic)
 *                 energy += tanh_amplitude * tanh(tanh_argument) + tanh_y_offset;             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
      __pyx_v_energy = (__pyx_v_energy + ((__pyx_v_tanh_amplitude * tanh(__pyx_v_tanh_argument)) + __pyx_v_tanh_y_offset));
    }
    __pyx_L4:;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1873")'> 1873: </pre>
<pre id='line1873' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1874")'> 1874: </pre>
<pre id='line1874' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2b' onclick='toggleDiv("line1875")'> 1875:         return energy</pre>
<pre id='line1875' class='code' style='background-color: #FFFF2b'>
  /* "Cython_shift_calculator.pyx":1875
 * 
 * 
 *         return energy             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef class Fast_force_factor_calculator(Fast_energy_calculator):
 */
  __pyx_r = __pyx_v_energy;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_28Fast_force_factor_calculator_1__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_28Fast_force_factor_calculator_1__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_target_atom_ids = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_result = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_active_atom_ids = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__call__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__target_atom_ids,&__pyx_n_s__result,&__pyx_n_s__active_atom_ids,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__target_atom_ids)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__result)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 3, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1880; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__active_atom_ids)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 3, 3, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1880; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__call__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1880; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_target_atom_ids = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0]);<span class='error_goto'> if (unlikely(!__pyx_v_target_atom_ids.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1880; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_result = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(values[1]);<span class='error_goto'> if (unlikely(!__pyx_v_result.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1880; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_active_atom_ids = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[2]);<span class='error_goto'> if (unlikely(!__pyx_v_active_atom_ids.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1880; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1880; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_force_factor_calculator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_28Fast_force_factor_calculator___call__(((struct __pyx_obj_17shift_calculators_Fast_force_factor_calculator *)__pyx_v_self), __pyx_v_target_atom_ids, __pyx_v_result, __pyx_v_active_atom_ids);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1876")'> 1876: </pre>
<pre id='line1876' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1877")'> 1877: cdef class Fast_force_factor_calculator(Fast_energy_calculator):</pre>
<pre id='line1877' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1877
 *         return energy
 * 
 * cdef class Fast_force_factor_calculator(Fast_energy_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     @cython.profile(True)
 */
struct __pyx_obj_17shift_calculators_Fast_force_factor_calculator {
  struct __pyx_obj_17shift_calculators_Fast_energy_calculator __pyx_base;
};


/* "Cython_shift_calculator.pyx":1877
 *         return energy
 * 
 * cdef class Fast_force_factor_calculator(Fast_energy_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     @cython.profile(True)
 */

struct __pyx_vtabstruct_17shift_calculators_Fast_force_factor_calculator {
  struct __pyx_vtabstruct_17shift_calculators_Fast_energy_calculator __pyx_base;
  float (*_calc_one_force_factor)(struct __pyx_obj_17shift_calculators_Fast_force_factor_calculator *, int, int);
};
static struct __pyx_vtabstruct_17shift_calculators_Fast_force_factor_calculator *__pyx_vtabptr_17shift_calculators_Fast_force_factor_calculator;
static CYTHON_INLINE float __pyx_f_17shift_calculators_28Fast_force_factor_calculator__calc_one_force_factor(struct __pyx_obj_17shift_calculators_Fast_force_factor_calculator *, int, int);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1878")'> 1878: </pre>
<pre id='line1878' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1879")'> 1879:     @cython.profile(True)</pre>
<pre id='line1879' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1880")'> 1880:     def __call__(self, int[:] target_atom_ids, float[:] result, int[:] active_atom_ids):</pre>
<pre id='line1880' class='code' style='background-color: #FFFFd4'>
/* "Cython_shift_calculator.pyx":1880
 * 
 *     @cython.profile(True)
 *     def __call__(self, int[:] target_atom_ids, float[:] result, int[:] active_atom_ids):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef double start_time =0.0
 *         cdef double end_time =0.0
 */

static PyObject *__pyx_pf_17shift_calculators_28Fast_force_factor_calculator___call__(struct __pyx_obj_17shift_calculators_Fast_force_factor_calculator *__pyx_v_self, __Pyx_memviewslice __pyx_v_target_atom_ids, __Pyx_memviewslice __pyx_v_result, __Pyx_memviewslice __pyx_v_active_atom_ids) {
  double __pyx_v_start_time;
  double __pyx_v_end_time;
  int __pyx_v_i;
  int __pyx_v_target_atom_id;
  int __pyx_v_active_atom_id;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__call__", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("__call__", __pyx_f[0], 1880);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1881")'> 1881:         cdef double start_time =0.0</pre>
<pre id='line1881' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1881
 *     @cython.profile(True)
 *     def __call__(self, int[:] target_atom_ids, float[:] result, int[:] active_atom_ids):
 *         cdef double start_time =0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef double end_time =0.0
 * 
 */
  __pyx_v_start_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1882")'> 1882:         cdef double end_time =0.0</pre>
<pre id='line1882' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1882
 *     def __call__(self, int[:] target_atom_ids, float[:] result, int[:] active_atom_ids):
 *         cdef double start_time =0.0
 *         cdef double end_time =0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef int i
 */
  __pyx_v_end_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1883")'> 1883: </pre>
<pre id='line1883' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1884")'> 1884:         cdef int i</pre>
<pre id='line1884' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1885")'> 1885: </pre>
<pre id='line1885' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1886")'> 1886:         if self._verbose:</pre>
<pre id='line1886' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1886
 *         cdef int i
 * 
 *         if self._verbose:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             start_time = time()
 * 
 */
  if (__pyx_v_self->__pyx_base._verbose) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line1887")'> 1887:             start_time = time()</pre>
<pre id='line1887' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":1887
 * 
 *         if self._verbose:
 *             start_time = time()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__time);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1887; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1887; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1887; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_start_time = __pyx_t_3;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1888")'> 1888: </pre>
<pre id='line1888' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1889")'> 1889: </pre>
<pre id='line1889' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1890")'> 1890:        #TODO: shouldn't be allocated each time</pre>
<pre id='line1890' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1891")'> 1891:         cdef int target_atom_id</pre>
<pre id='line1891' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1892")'> 1892:         cdef int active_atom_id</pre>
<pre id='line1892' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1893")'> 1893: </pre>
<pre id='line1893' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1894")'> 1894:         if active_atom_ids == None:</pre>
<pre id='line1894' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1894
 *         cdef int active_atom_id
 * 
 *         if active_atom_ids == None:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for i in range(target_atom_ids.shape[0]):
 *                 target_atom_id = target_atom_ids[i]
 */
  __pyx_t_4 = (((PyObject *) __pyx_v_active_atom_ids.memview) == Py_None);
  if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1895")'> 1895:             for i in range(target_atom_ids.shape[0]):</pre>
<pre id='line1895' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1895
 * 
 *         if active_atom_ids == None:
 *             for i in range(target_atom_ids.shape[0]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 target_atom_id = target_atom_ids[i]
 *                 result[i] = self._calc_one_force_factor(target_atom_id, i)
 */
    __pyx_t_5 = (__pyx_v_target_atom_ids.shape[0]);
    for (__pyx_t_6 = 0; __pyx_t_6 <code><</code> __pyx_t_5; __pyx_t_6+=1) {
      __pyx_v_i = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1896")'> 1896:                 target_atom_id = target_atom_ids[i]</pre>
<pre id='line1896' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1896
 *         if active_atom_ids == None:
 *             for i in range(target_atom_ids.shape[0]):
 *                 target_atom_id = target_atom_ids[i]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 result[i] = self._calc_one_force_factor(target_atom_id, i)
 *         else:
 */
      __pyx_t_7 = __pyx_v_i;
      __pyx_v_target_atom_id = (*((int *) ( /* dim=0 */ (__pyx_v_target_atom_ids.data + __pyx_t_7 * __pyx_v_target_atom_ids.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1897")'> 1897:                 result[i] = self._calc_one_force_factor(target_atom_id, i)</pre>
<pre id='line1897' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1897
 *             for i in range(target_atom_ids.shape[0]):
 *                 target_atom_id = target_atom_ids[i]
 *                 result[i] = self._calc_one_force_factor(target_atom_id, i)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             for i in  range(active_atom_ids.shape[0]):
 */
      __pyx_t_8 = __pyx_v_i;
      *((float *) ( /* dim=0 */ (__pyx_v_result.data + __pyx_t_8 * __pyx_v_result.strides[0]) )) = __pyx_f_17shift_calculators_28Fast_force_factor_calculator__calc_one_force_factor(__pyx_v_self, __pyx_v_target_atom_id, __pyx_v_i);
    }
    goto __pyx_L4;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1898")'> 1898:         else:</pre>
<pre id='line1898' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1899")'> 1899:             for i in  range(active_atom_ids.shape[0]):</pre>
<pre id='line1899' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1899
 *                 result[i] = self._calc_one_force_factor(target_atom_id, i)
 *         else:
 *             for i in  range(active_atom_ids.shape[0]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 active_atom_id = active_atom_ids[i]
 *                 target_atom_id = target_atom_ids[active_atom_id]
 */
    __pyx_t_5 = (__pyx_v_active_atom_ids.shape[0]);
    for (__pyx_t_6 = 0; __pyx_t_6 <code><</code> __pyx_t_5; __pyx_t_6+=1) {
      __pyx_v_i = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1900")'> 1900:                 active_atom_id = active_atom_ids[i]</pre>
<pre id='line1900' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1900
 *         else:
 *             for i in  range(active_atom_ids.shape[0]):
 *                 active_atom_id = active_atom_ids[i]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 target_atom_id = target_atom_ids[active_atom_id]
 * 
 */
      __pyx_t_9 = __pyx_v_i;
      __pyx_v_active_atom_id = (*((int *) ( /* dim=0 */ (__pyx_v_active_atom_ids.data + __pyx_t_9 * __pyx_v_active_atom_ids.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1901")'> 1901:                 target_atom_id = target_atom_ids[active_atom_id]</pre>
<pre id='line1901' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1901
 *             for i in  range(active_atom_ids.shape[0]):
 *                 active_atom_id = active_atom_ids[i]
 *                 target_atom_id = target_atom_ids[active_atom_id]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 result[i] = self._calc_one_force_factor(target_atom_id, active_atom_id)
 */
      __pyx_t_10 = __pyx_v_active_atom_id;
      __pyx_v_target_atom_id = (*((int *) ( /* dim=0 */ (__pyx_v_target_atom_ids.data + __pyx_t_10 * __pyx_v_target_atom_ids.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1902")'> 1902: </pre>
<pre id='line1902' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1903")'> 1903:                 result[i] = self._calc_one_force_factor(target_atom_id, active_atom_id)</pre>
<pre id='line1903' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1903
 *                 target_atom_id = target_atom_ids[active_atom_id]
 * 
 *                 result[i] = self._calc_one_force_factor(target_atom_id, active_atom_id)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if self._verbose:
 */
      __pyx_t_11 = __pyx_v_i;
      *((float *) ( /* dim=0 */ (__pyx_v_result.data + __pyx_t_11 * __pyx_v_result.strides[0]) )) = __pyx_f_17shift_calculators_28Fast_force_factor_calculator__calc_one_force_factor(__pyx_v_self, __pyx_v_target_atom_id, __pyx_v_active_atom_id);
    }
  }
  __pyx_L4:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1904")'> 1904: </pre>
<pre id='line1904' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1905")'> 1905:         if self._verbose:</pre>
<pre id='line1905' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1905
 *                 result[i] = self._calc_one_force_factor(target_atom_id, active_atom_id)
 * 
 *         if self._verbose:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             end_time = time()
 *             print '   force factors : ',len(target_atom_ids),' in', "%.17g" %  (end_time-start_time), "seconds"
 */
  if (__pyx_v_self->__pyx_base._verbose) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line1906")'> 1906:             end_time = time()</pre>
<pre id='line1906' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":1906
 * 
 *         if self._verbose:
 *             end_time = time()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print '   force factors : ',len(target_atom_ids),' in', "%.17g" %  (end_time-start_time), "seconds"
 * 
 */
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__time);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1906; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1906; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1906; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_end_time = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF2c' onclick='toggleDiv("line1907")'> 1907:             print '   force factors : ',len(target_atom_ids),' in', "%.17g" %  (end_time-start_time), "seconds"</pre>
<pre id='line1907' class='code' style='background-color: #FFFF2c'>
    /* "Cython_shift_calculator.pyx":1907
 *         if self._verbose:
 *             end_time = time()
 *             print '   force factors : ',len(target_atom_ids),' in', "%.17g" %  (end_time-start_time), "seconds"             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_target_atom_ids, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1907; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1907; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1907; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_end_time - __pyx_v_start_time));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1907; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_12 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_32), __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1907; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_12));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1907; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_51));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_kp_s_51));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_51));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_42));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, ((PyObject *)__pyx_kp_s_42));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_42));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 3, ((PyObject *)__pyx_t_12));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_12));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__seconds));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 4, ((PyObject *)__pyx_n_s__seconds));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__seconds));
    __pyx_t_1 = 0;
    __pyx_t_12 = 0;
    if (<span class='pyx_c_api'>__Pyx_Print</span>(0, ((PyObject *)__pyx_t_2), 1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1907; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    goto __pyx_L9;
  }
  __pyx_L9:;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_force_factor_calculator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&__pyx_v_target_atom_ids, 1);
  __PYX_XDEC_MEMVIEW(&__pyx_v_result, 1);
  __PYX_XDEC_MEMVIEW(&__pyx_v_active_atom_ids, 1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1908")'> 1908: </pre>
<pre id='line1908' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1909")'> 1909: </pre>
<pre id='line1909' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1910")'> 1910:     cdef inline float _calc_one_force_factor(self, int target_atom_id, int i):</pre>
<pre id='line1910' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1910
 * 
 * 
 *     cdef inline float _calc_one_force_factor(self, int target_atom_id, int i):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef float factor
 */

static CYTHON_INLINE float __pyx_f_17shift_calculators_28Fast_force_factor_calculator__calc_one_force_factor(struct __pyx_obj_17shift_calculators_Fast_force_factor_calculator *__pyx_v_self, int __pyx_v_target_atom_id, int __pyx_v_i) {
  float __pyx_v_factor;
  float __pyx_v_shift_diff;
  float __pyx_v_flat_bottom_shift_limit;
  struct __pyx_t_17shift_calculators_Constant_cache *__pyx_v_energy_terms;
  float __pyx_v_adjusted_shift_diff;
  float __pyx_v_end_harmonic;
  float __pyx_v_scale_harmonic;
  float __pyx_v_sqr_scale_harmonic;
  float __pyx_v_weight;
  float __pyx_v_tanh_amplitude;
  float __pyx_v_tanh_elongation;
  double __pyx_v_fact;
  float __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calc_one_force_factor", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1911")'> 1911: </pre>
<pre id='line1911' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1912")'> 1912:         cdef float factor</pre>
<pre id='line1912' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1913")'> 1913:         cdef float shift_diff</pre>
<pre id='line1913' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1914")'> 1914:         cdef float flat_bottom_shift_limit</pre>
<pre id='line1914' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1915")'> 1915:         cdef Constant_cache* energy_terms</pre>
<pre id='line1915' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1916")'> 1916:         cdef float adjusted_shift_diff</pre>
<pre id='line1916' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1917")'> 1917:         cdef float end_harmonic</pre>
<pre id='line1917' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1918")'> 1918:         cdef float scale_harmonic</pre>
<pre id='line1918' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1919")'> 1919:         cdef float sqr_scale_harmonic</pre>
<pre id='line1919' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1920")'> 1920:         cdef float weight</pre>
<pre id='line1920' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1921")'> 1921:         cdef float tanh_amplitude</pre>
<pre id='line1921' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1922")'> 1922:         cdef float tanh_elongation</pre>
<pre id='line1922' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1923")'> 1923: </pre>
<pre id='line1923' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1924")'> 1924:         factor = 0.0</pre>
<pre id='line1924' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1924
 *         cdef float tanh_elongation
 * 
 *         factor = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_factor = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1925")'> 1925: </pre>
<pre id='line1925' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1926")'> 1926: </pre>
<pre id='line1926' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1927")'> 1927:         shift_diff = self._get_shift_difference(target_atom_id, i)</pre>
<pre id='line1927' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1927
 * 
 * 
 *         shift_diff = self._get_shift_difference(target_atom_id, i)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         energy_terms = self._get_energy_terms(i)
 * 
 */
  __pyx_v_shift_diff = __pyx_f_17shift_calculators_22Fast_energy_calculator__get_shift_difference(((struct __pyx_obj_17shift_calculators_Fast_energy_calculator *)__pyx_v_self), __pyx_v_target_atom_id, __pyx_v_i);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1928")'> 1928:         energy_terms = self._get_energy_terms(i)</pre>
<pre id='line1928' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1928
 * 
 *         shift_diff = self._get_shift_difference(target_atom_id, i)
 *         energy_terms = self._get_energy_terms(i)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_energy_terms = ((struct __pyx_vtabstruct_17shift_calculators_Fast_force_factor_calculator *)__pyx_v_self->__pyx_base.__pyx_vtab)->__pyx_base._get_energy_terms(((struct __pyx_obj_17shift_calculators_Fast_energy_calculator *)__pyx_v_self), __pyx_v_i);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1929")'> 1929: </pre>
<pre id='line1929' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1930")'> 1930: </pre>
<pre id='line1930' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1931")'> 1931:         flat_bottom_shift_limit = energy_terms[0].flat_bottom_shift_limit</pre>
<pre id='line1931' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1931
 * 
 * 
 *         flat_bottom_shift_limit = energy_terms[0].flat_bottom_shift_limit             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if abs(shift_diff) > flat_bottom_shift_limit:
 */
  __pyx_t_1 = (__pyx_v_energy_terms[0]).flat_bottom_shift_limit;
  __pyx_v_flat_bottom_shift_limit = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1932")'> 1932: </pre>
<pre id='line1932' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1933")'> 1933:         if abs(shift_diff) &gt; flat_bottom_shift_limit:</pre>
<pre id='line1933' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1933
 *         flat_bottom_shift_limit = energy_terms[0].flat_bottom_shift_limit
 * 
 *         if abs(shift_diff) > flat_bottom_shift_limit:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             adjusted_shift_diff = self._adjust_shift(shift_diff, flat_bottom_shift_limit)
 *             end_harmonic = energy_terms[0].end_harmonic
 */
  __pyx_t_2 = (fabsf(__pyx_v_shift_diff) > __pyx_v_flat_bottom_shift_limit);
  if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1934")'> 1934:             adjusted_shift_diff = self._adjust_shift(shift_diff, flat_bottom_shift_limit)</pre>
<pre id='line1934' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1934
 * 
 *         if abs(shift_diff) > flat_bottom_shift_limit:
 *             adjusted_shift_diff = self._adjust_shift(shift_diff, flat_bottom_shift_limit)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             end_harmonic = energy_terms[0].end_harmonic
 *             scale_harmonic = energy_terms[0].scale_harmonic
 */
    __pyx_v_adjusted_shift_diff = __pyx_f_17shift_calculators_22Fast_energy_calculator__adjust_shift(((struct __pyx_obj_17shift_calculators_Fast_energy_calculator *)__pyx_v_self), __pyx_v_shift_diff, __pyx_v_flat_bottom_shift_limit);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1935")'> 1935:             end_harmonic = energy_terms[0].end_harmonic</pre>
<pre id='line1935' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1935
 *         if abs(shift_diff) > flat_bottom_shift_limit:
 *             adjusted_shift_diff = self._adjust_shift(shift_diff, flat_bottom_shift_limit)
 *             end_harmonic = energy_terms[0].end_harmonic             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             scale_harmonic = energy_terms[0].scale_harmonic
 *             sqr_scale_harmonic = scale_harmonic**2
 */
    __pyx_t_1 = (__pyx_v_energy_terms[0]).end_harmonic;
    __pyx_v_end_harmonic = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1936")'> 1936:             scale_harmonic = energy_terms[0].scale_harmonic</pre>
<pre id='line1936' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1936
 *             adjusted_shift_diff = self._adjust_shift(shift_diff, flat_bottom_shift_limit)
 *             end_harmonic = energy_terms[0].end_harmonic
 *             scale_harmonic = energy_terms[0].scale_harmonic             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             sqr_scale_harmonic = scale_harmonic**2
 * 
 */
    __pyx_t_1 = (__pyx_v_energy_terms[0]).scale_harmonic;
    __pyx_v_scale_harmonic = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1937")'> 1937:             sqr_scale_harmonic = scale_harmonic**2</pre>
<pre id='line1937' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1937
 *             end_harmonic = energy_terms[0].end_harmonic
 *             scale_harmonic = energy_terms[0].scale_harmonic
 *             sqr_scale_harmonic = scale_harmonic**2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             weight = energy_terms[0].weight
 */
    __pyx_v_sqr_scale_harmonic = powf(__pyx_v_scale_harmonic, 2.0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1938")'> 1938: </pre>
<pre id='line1938' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1939")'> 1939:             weight = energy_terms[0].weight</pre>
<pre id='line1939' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1939
 *             sqr_scale_harmonic = scale_harmonic**2
 * 
 *             weight = energy_terms[0].weight             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             tanh_amplitude = energy_terms[0].tanh_amplitude
 */
    __pyx_t_1 = (__pyx_v_energy_terms[0]).weight;
    __pyx_v_weight = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1940")'> 1940: </pre>
<pre id='line1940' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1941")'> 1941:             tanh_amplitude = energy_terms[0].tanh_amplitude</pre>
<pre id='line1941' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1941
 *             weight = energy_terms[0].weight
 * 
 *             tanh_amplitude = energy_terms[0].tanh_amplitude             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             tanh_elongation = energy_terms[0].tanh_elongation
 * 
 */
    __pyx_t_1 = (__pyx_v_energy_terms[0]).tanh_amplitude;
    __pyx_v_tanh_amplitude = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1942")'> 1942:             tanh_elongation = energy_terms[0].tanh_elongation</pre>
<pre id='line1942' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1942
 * 
 *             tanh_amplitude = energy_terms[0].tanh_amplitude
 *             tanh_elongation = energy_terms[0].tanh_elongation             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             # TODO: add factor and lambda to give fact
 */
    __pyx_t_1 = (__pyx_v_energy_terms[0]).tanh_elongation;
    __pyx_v_tanh_elongation = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1943")'> 1943: </pre>
<pre id='line1943' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1944")'> 1944:             # TODO: add factor and lambda to give fact</pre>
<pre id='line1944' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1945")'> 1945:             fact =1.0</pre>
<pre id='line1945' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1945
 * 
 *             # TODO: add factor and lambda to give fact
 *             fact =1.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if adjusted_shift_diff <code><</code> end_harmonic:
 *                 factor = 2.0 * weight * adjusted_shift_diff * fact / sqr_scale_harmonic;
 */
    __pyx_v_fact = 1.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1946")'> 1946:             if adjusted_shift_diff &lt; end_harmonic:</pre>
<pre id='line1946' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":1946
 *             # TODO: add factor and lambda to give fact
 *             fact =1.0
 *             if adjusted_shift_diff <code><</code> end_harmonic:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 factor = 2.0 * weight * adjusted_shift_diff * fact / sqr_scale_harmonic;
 *             else:
 */
    __pyx_t_2 = (__pyx_v_adjusted_shift_diff <code><</code> __pyx_v_end_harmonic);
    if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1947")'> 1947:                 factor = 2.0 * weight * adjusted_shift_diff * fact / sqr_scale_harmonic;</pre>
<pre id='line1947' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1947
 *             fact =1.0
 *             if adjusted_shift_diff <code><</code> end_harmonic:
 *                 factor = 2.0 * weight * adjusted_shift_diff * fact / sqr_scale_harmonic;             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             else:
 *                 factor = weight * tanh_amplitude * tanh_elongation / (cosh(tanh_elongation * (adjusted_shift_diff - end_harmonic)))**2.0 * fact;
 */
      __pyx_v_factor = ((((2.0 * __pyx_v_weight) * __pyx_v_adjusted_shift_diff) * __pyx_v_fact) / __pyx_v_sqr_scale_harmonic);
      goto __pyx_L4;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1948")'> 1948:             else:</pre>
<pre id='line1948' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1949")'> 1949:                 factor = weight * tanh_amplitude * tanh_elongation / (cosh(tanh_elongation * (adjusted_shift_diff - end_harmonic)))**2.0 * fact;</pre>
<pre id='line1949' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":1949
 *                 factor = 2.0 * weight * adjusted_shift_diff * fact / sqr_scale_harmonic;
 *             else:
 *                 factor = weight * tanh_amplitude * tanh_elongation / (cosh(tanh_elongation * (adjusted_shift_diff - end_harmonic)))**2.0 * fact;             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return factor
 * 
 */
      __pyx_v_factor = ((((__pyx_v_weight * __pyx_v_tanh_amplitude) * __pyx_v_tanh_elongation) / pow(cosh((__pyx_v_tanh_elongation * (__pyx_v_adjusted_shift_diff - __pyx_v_end_harmonic))), 2.0)) * __pyx_v_fact);
    }
    __pyx_L4:;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line1950")'> 1950:         return factor</pre>
<pre id='line1950' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":1950
 *             else:
 *                 factor = weight * tanh_amplitude * tanh_elongation / (cosh(tanh_elongation * (adjusted_shift_diff - end_harmonic)))**2.0 * fact;
 *         return factor             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_r = __pyx_v_factor;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_21Base_force_calculator_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_21Base_force_calculator_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED PyObject *__pyx_v_potential = 0;
  PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__potential,&__pyx_n_s__name,0};
    PyObject* values[2] = {0,0};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1951")'> 1951: </pre>
<pre id='line1951' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1952")'> 1952: </pre>
<pre id='line1952' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1953")'> 1953: cdef class Base_force_calculator:</pre>
<pre id='line1953' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1953
 * 
 * 
 * cdef class Base_force_calculator:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef bint _verbose
 */
struct __pyx_obj_17shift_calculators_Base_force_calculator {
  PyObject_HEAD
  struct __pyx_vtabstruct_17shift_calculators_Base_force_calculator *__pyx_vtab;
  int _verbose;
  Simulation *_simulation;
  PyObject *_name;
  __Pyx_memviewslice _active_components;
};


/* "Cython_shift_calculator.pyx":1953
 * 
 * 
 * cdef class Base_force_calculator:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef bint _verbose
 */

struct __pyx_vtabstruct_17shift_calculators_Base_force_calculator {
  void (*_do_calc_components)(struct __pyx_obj_17shift_calculators_Base_force_calculator *, __Pyx_memviewslice, __Pyx_memviewslice, struct __pyx_obj_17shift_calculators_Out_array *);
};
static struct __pyx_vtabstruct_17shift_calculators_Base_force_calculator *__pyx_vtabptr_17shift_calculators_Base_force_calculator;

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1954")'> 1954: </pre>
<pre id='line1954' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1955")'> 1955:     cdef bint _verbose</pre>
<pre id='line1955' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1956")'> 1956:     cdef Simulation* _simulation</pre>
<pre id='line1956' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1957")'> 1957:     cdef str _name</pre>
<pre id='line1957' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1958")'> 1958:     cdef int[:] _active_components</pre>
<pre id='line1958' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1959")'> 1959: </pre>
<pre id='line1959' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line1960")'> 1960:     def __init__(self,potential=None, name= "not set"):</pre>
<pre id='line1960' class='code' style='background-color: #FFFF3f'>
    /* "Cython_shift_calculator.pyx":1960
 *     cdef int[:] _active_components
 * 
 *     def __init__(self,potential=None, name= "not set"):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._verbose = False
 * 
 */
    values[0] = ((PyObject *)Py_None);
    values[1] = ((PyObject *)__pyx_kp_s_30);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__potential);
          if (value) { values[0] = value; kw_args--; }
        }
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1960; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_potential = values[0];
    __pyx_v_name = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 0, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1960; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Base_force_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_21Base_force_calculator___init__(((struct __pyx_obj_17shift_calculators_Base_force_calculator *)__pyx_v_self), __pyx_v_potential, __pyx_v_name);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

static int __pyx_pf_17shift_calculators_21Base_force_calculator___init__(struct __pyx_obj_17shift_calculators_Base_force_calculator *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_potential, PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1961")'> 1961:         self._verbose = False</pre>
<pre id='line1961' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1961
 * 
 *     def __init__(self,potential=None, name= "not set"):
 *         self._verbose = False             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_self->_verbose = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1962")'> 1962: </pre>
<pre id='line1962' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1963")'> 1963: </pre>
<pre id='line1963' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line1964")'> 1964:         self._name = name</pre>
<pre id='line1964' class='code' style='background-color: #FFFF62'>
  /* "Cython_shift_calculator.pyx":1964
 * 
 * 
 *         self._name = name             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  if (!(likely(<span class='py_c_api'>PyString_CheckExact</span>(__pyx_v_name))||((__pyx_v_name) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected str, got %.200s", Py_TYPE(__pyx_v_name)->tp_name), 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1964; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_name);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_name);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_name);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_name));
  __pyx_v_self->_name = ((PyObject*)__pyx_v_name);

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Base_force_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_21Base_force_calculator_3set_verbose(PyObject *__pyx_v_self, PyObject *__pyx_v_on); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_21Base_force_calculator_3set_verbose(PyObject *__pyx_v_self, PyObject *__pyx_v_on) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_verbose (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_21Base_force_calculator_2set_verbose(((struct __pyx_obj_17shift_calculators_Base_force_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_on));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1965")'> 1965: </pre>
<pre id='line1965' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1966")'> 1966: </pre>
<pre id='line1966' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1967")'> 1967:     def set_verbose(self,on):</pre>
<pre id='line1967' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1967
 * 
 * 
 *     def set_verbose(self,on):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._verbose = on
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_21Base_force_calculator_2set_verbose(struct __pyx_obj_17shift_calculators_Base_force_calculator *__pyx_v_self, PyObject *__pyx_v_on) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_verbose", 0);
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line1968")'> 1968:         self._verbose = on</pre>
<pre id='line1968' class='code' style='background-color: #FFFF66'>
  /* "Cython_shift_calculator.pyx":1968
 * 
 *     def set_verbose(self,on):
 *         self._verbose = on             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_v_on);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1968; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_verbose = __pyx_t_1;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Base_force_calculator.set_verbose", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_21Base_force_calculator_5_set_components(PyObject *__pyx_v_self, PyObject *__pyx_v_components); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_21Base_force_calculator_5_set_components(PyObject *__pyx_v_self, PyObject *__pyx_v_components) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_components (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_21Base_force_calculator_4_set_components(((struct __pyx_obj_17shift_calculators_Base_force_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_components));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1969")'> 1969: </pre>
<pre id='line1969' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1970")'> 1970: </pre>
<pre id='line1970' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1971")'> 1971: </pre>
<pre id='line1971' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1972")'> 1972:     def _set_components(self,components):</pre>
<pre id='line1972' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":1972
 * 
 * 
 *     def _set_components(self,components):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._bytes_to_components(components['ATOM'])
 *         self._simulation = <code><</code>Simulation*><code><</code>size_t>int(components['SIMU'].this)
 */

static PyObject *__pyx_pf_17shift_calculators_21Base_force_calculator_4_set_components(struct __pyx_obj_17shift_calculators_Base_force_calculator *__pyx_v_self, PyObject *__pyx_v_components) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_components", 0);
</pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line1973")'> 1973:         self._bytes_to_components(components['ATOM'])</pre>
<pre id='line1973' class='code' style='background-color: #FFFF4b'>
  /* "Cython_shift_calculator.pyx":1973
 * 
 *     def _set_components(self,components):
 *         self._bytes_to_components(components['ATOM'])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._simulation = <code><</code>Simulation*><code><</code>size_t>int(components['SIMU'].this)
 * 
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_29);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1973; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_components, ((PyObject *)__pyx_n_s__ATOM));<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1973; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1973; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1973; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF15' onclick='toggleDiv("line1974")'> 1974:         self._simulation = &lt;Simulation*&gt;&lt;size_t&gt;int(components['SIMU'].this)</pre>
<pre id='line1974' class='code' style='background-color: #FFFF15'>
  /* "Cython_shift_calculator.pyx":1974
 *     def _set_components(self,components):
 *         self._bytes_to_components(components['ATOM'])
 *         self._simulation = <code><</code>Simulation*><code><</code>size_t>int(components['SIMU'].this)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_components, ((PyObject *)__pyx_n_s__SIMU));<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1974; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__this);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1974; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1974; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1974; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1974; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_self->_simulation = ((Simulation *)((size_t)__pyx_t_4));

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Base_force_calculator._set_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_21Base_force_calculator_7__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_21Base_force_calculator_7__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_components = 0;
  __Pyx_memviewslice __pyx_v_component_to_result = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_force_factors = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces = 0;
  __Pyx_memviewslice __pyx_v_active_components = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__call__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__components,&__pyx_n_s__component_to_result,&__pyx_n_s__force_factors,&__pyx_n_s__forces,&__pyx_n_s__active_components,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__components)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__component_to_result)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 0, 4, 5, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1979; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__force_factors)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 0, 4, 5, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1979; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__forces)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 0, 4, 5, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1979; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__active_components);
          if (value) { values[4] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__call__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1979; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_components = values[0];
    __pyx_v_component_to_result = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[1]);<span class='error_goto'> if (unlikely(!__pyx_v_component_to_result.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1979; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_force_factors = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(values[2]);<span class='error_goto'> if (unlikely(!__pyx_v_force_factors.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1979; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_forces = ((struct __pyx_obj_17shift_calculators_Out_array *)values[3]);
    if (values[4]) {
      __pyx_v_active_components = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[4]);<span class='error_goto'> if (unlikely(!__pyx_v_active_components.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1979; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_active_components = __pyx_k_52;
      __PYX_INC_MEMVIEW(&__pyx_v_active_components, 1);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 0, 4, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1979; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Base_force_calculator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_forces), __pyx_ptype_17shift_calculators_Out_array, 1, "forces", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1979; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_21Base_force_calculator_6__call__(((struct __pyx_obj_17shift_calculators_Base_force_calculator *)__pyx_v_self), __pyx_v_components, __pyx_v_component_to_result, __pyx_v_force_factors, __pyx_v_forces, __pyx_v_active_components);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1975")'> 1975: </pre>
<pre id='line1975' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1976")'> 1976: </pre>
<pre id='line1976' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1977")'> 1977: #    TODO should most probably be a fixed array</pre>
<pre id='line1977' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1978")'> 1978:     @cython.profile(True)</pre>
<pre id='line1978' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line1979")'> 1979:     def __call__(self, object components, int[:] component_to_result, float[:] force_factors, Out_array forces, int[:] active_components=None):</pre>
<pre id='line1979' class='code' style='background-color: #FFFFb6'>
/* "Cython_shift_calculator.pyx":1979
 * #    TODO should most probably be a fixed array
 *     @cython.profile(True)
 *     def __call__(self, object components, int[:] component_to_result, float[:] force_factors, Out_array forces, int[:] active_components=None):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef double start_time =0.0
 */

static PyObject *__pyx_pf_17shift_calculators_21Base_force_calculator_6__call__(struct __pyx_obj_17shift_calculators_Base_force_calculator *__pyx_v_self, PyObject *__pyx_v_components, __Pyx_memviewslice __pyx_v_component_to_result, __Pyx_memviewslice __pyx_v_force_factors, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces, __Pyx_memviewslice __pyx_v_active_components) {
  double __pyx_v_start_time;
  double __pyx_v_end_time;
  PyObject *__pyx_r = NULL;
  __Pyx_TraceDeclarations
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__call__", 0);
  <span class='pyx_c_api'>__Pyx_TraceCall</span>("__call__", __pyx_f[0], 1979);

  /* "Cython_shift_calculator.pyx":1979
 * #    TODO should most probably be a fixed array
 *     @cython.profile(True)
 *     def __call__(self, object components, int[:] component_to_result, float[:] force_factors, Out_array forces, int[:] active_components=None):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef double start_time =0.0
 */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(Py_None);
  if (unlikely(!__pyx_t_5.memview))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1979; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_k_52 = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1980")'> 1980: </pre>
<pre id='line1980' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1981")'> 1981:         cdef double start_time =0.0</pre>
<pre id='line1981' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1981
 *     def __call__(self, object components, int[:] component_to_result, float[:] force_factors, Out_array forces, int[:] active_components=None):
 * 
 *         cdef double start_time =0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef double end_time =0.0
 *         if self._verbose:
 */
  __pyx_v_start_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1982")'> 1982:         cdef double end_time =0.0</pre>
<pre id='line1982' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1982
 * 
 *         cdef double start_time =0.0
 *         cdef double end_time =0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if self._verbose:
 *             start_time = time()
 */
  __pyx_v_end_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1983")'> 1983:         if self._verbose:</pre>
<pre id='line1983' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1983
 *         cdef double start_time =0.0
 *         cdef double end_time =0.0
 *         if self._verbose:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             start_time = time()
 * 
 */
  if (__pyx_v_self->_verbose) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line1984")'> 1984:             start_time = time()</pre>
<pre id='line1984' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":1984
 *         cdef double end_time =0.0
 *         if self._verbose:
 *             start_time = time()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._set_components(components)
 */
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__time);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1984; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1984; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1984; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_start_time = __pyx_t_3;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1985")'> 1985: </pre>
<pre id='line1985' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line1986")'> 1986:         self._set_components(components)</pre>
<pre id='line1986' class='code' style='background-color: #FFFF55'>
  /* "Cython_shift_calculator.pyx":1986
 *             start_time = time()
 * 
 *         self._set_components(components)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #        TODO rename component to result to something better
 *         self._active_components = active_components
 */
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_n_s___set_components);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1986; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1986; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_components);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_components);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_components);
  __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1986; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1987")'> 1987: #        TODO rename component to result to something better</pre>
<pre id='line1987' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1988")'> 1988:         self._active_components = active_components</pre>
<pre id='line1988' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1988
 *         self._set_components(components)
 * #        TODO rename component to result to something better
 *         self._active_components = active_components             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._do_calc_components(component_to_result, force_factors, forces)
 * 
 */
  __PYX_XDEC_MEMVIEW(&__pyx_v_self->_active_components, 0);
  __PYX_INC_MEMVIEW(&__pyx_v_active_components, 0);
  __pyx_v_self->_active_components = __pyx_v_active_components;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1989")'> 1989:         self._do_calc_components(component_to_result, force_factors, forces)</pre>
<pre id='line1989' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":1989
 * #        TODO rename component to result to something better
 *         self._active_components = active_components
 *         self._do_calc_components(component_to_result, force_factors, forces)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #        component_target_atom_ids = components.get_component_atom_ids()
 */
  ((struct __pyx_vtabstruct_17shift_calculators_Base_force_calculator *)__pyx_v_self->__pyx_vtab)->_do_calc_components(__pyx_v_self, __pyx_v_component_to_result, __pyx_v_force_factors, __pyx_v_forces);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1990")'> 1990: </pre>
<pre id='line1990' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1991")'> 1991: #        component_target_atom_ids = components.get_component_atom_ids()</pre>
<pre id='line1991' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1992")'> 1992: #        for i,target_atom_id in enumerate(target_atom_ids):</pre>
<pre id='line1992' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1993")'> 1993: #            if target_atom_id in component_target_atom_ids:</pre>
<pre id='line1993' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1994")'> 1994: #                try:</pre>
<pre id='line1994' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1995")'> 1995: #                    index_range = components.get_component_range(target_atom_id)</pre>
<pre id='line1995' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1996")'> 1996: #                except ValueError:</pre>
<pre id='line1996' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1997")'> 1997: #                    print "warning atom is not in list", target_atom_id, Atom_utils._get_atom_info_from_index(target_atom_id),self._name</pre>
<pre id='line1997' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1998")'> 1998: #                    index_range = []</pre>
<pre id='line1998' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1999")'> 1999: #                for index in range(*index_range):</pre>
<pre id='line1999' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2000")'> 2000: </pre>
<pre id='line2000' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2001")'> 2001:         if self._verbose:</pre>
<pre id='line2001' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2001
 * #                for index in range(*index_range):
 * 
 *         if self._verbose:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             end_time = time()
 *             print '   force calculator: ', self._name ,' ',len(components), ' in', "%.17g" %  (end_time-start_time), "seconds"
 */
  if (__pyx_v_self->_verbose) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line2002")'> 2002:             end_time = time()</pre>
<pre id='line2002' class='code' style='background-color: #FFFF57'>
    /* "Cython_shift_calculator.pyx":2002
 * 
 *         if self._verbose:
 *             end_time = time()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             print '   force calculator: ', self._name ,' ',len(components), ' in', "%.17g" %  (end_time-start_time), "seconds"
 * 
 */
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__time);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2002; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_4, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2002; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2002; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_end_time = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line2003")'> 2003:             print '   force calculator: ', self._name ,' ',len(components), ' in', "%.17g" %  (end_time-start_time), "seconds"</pre>
<pre id='line2003' class='code' style='background-color: #FFFF2a'>
    /* "Cython_shift_calculator.pyx":2003
 *         if self._verbose:
 *             end_time = time()
 *             print '   force calculator: ', self._name ,' ',len(components), ' in', "%.17g" %  (end_time-start_time), "seconds"             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void _do_calc_components(self, int[:] component_to_result,  float[:] force_factors, Out_array force):
 */
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_components);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2003; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2003; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_end_time - __pyx_v_start_time));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2003; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Remainder</span>(((PyObject *)__pyx_kp_s_32), __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2003; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2003; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_53));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, ((PyObject *)__pyx_kp_s_53));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_53));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self->_name));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, ((PyObject *)__pyx_v_self->_name));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_self->_name));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_54));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, ((PyObject *)__pyx_kp_s_54));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_54));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 3, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_kp_s_42));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 4, ((PyObject *)__pyx_kp_s_42));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_kp_s_42));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 5, ((PyObject *)__pyx_t_2));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_2));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__seconds));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 6, ((PyObject *)__pyx_n_s__seconds));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__seconds));
    __pyx_t_1 = 0;
    __pyx_t_2 = 0;
    if (<span class='pyx_c_api'>__Pyx_Print</span>(0, ((PyObject *)__pyx_t_4), 1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2003; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    goto __pyx_L4;
  }
  __pyx_L4:;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Base_force_calculator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&__pyx_v_component_to_result, 1);
  __PYX_XDEC_MEMVIEW(&__pyx_v_force_factors, 1);
  __PYX_XDEC_MEMVIEW(&__pyx_v_active_components, 1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_TraceReturn</span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2004")'> 2004: </pre>
<pre id='line2004' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2005")'> 2005:     cdef void _do_calc_components(self, int[:] component_to_result,  float[:] force_factors, Out_array force):</pre>
<pre id='line2005' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2005
 *             print '   force calculator: ', self._name ,' ',len(components), ' in', "%.17g" %  (end_time-start_time), "seconds"
 * 
 *     cdef void _do_calc_components(self, int[:] component_to_result,  float[:] force_factors, Out_array force):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         raise Exception("this should not be called!")
 * 
 */

static void __pyx_f_17shift_calculators_21Base_force_calculator__do_calc_components(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Base_force_calculator *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_component_to_result, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_force_factors, CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_force) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_do_calc_components", 0);
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line2006")'> 2006:         raise Exception("this should not be called!")</pre>
<pre id='line2006' class='code' style='background-color: #FFFF41'>
  /* "Cython_shift_calculator.pyx":2006
 * 
 *     cdef void _do_calc_components(self, int[:] component_to_result,  float[:] force_factors, Out_array force):
 *         raise Exception("this should not be called!")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_Exception, ((PyObject *)__pyx_k_tuple_56), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2006; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
 <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2006; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>

  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Base_force_calculator._do_calc_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_46Fast_distance_based_potential_force_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_46Fast_distance_based_potential_force_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) > 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) > 0) && unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__cinit__", 0))) return -1;
  __pyx_r = __pyx_pf_17shift_calculators_46Fast_distance_based_potential_force_calculator___cinit__(((struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

  /* "Cython_shift_calculator.pyx":2006
 * 
 *     cdef void _do_calc_components(self, int[:] component_to_result,  float[:] force_factors, Out_array force):
 *         raise Exception("this should not be called!")             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_k_tuple_56 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_kp_s_55));<span class='error_goto'> if (unlikely(!__pyx_k_tuple_56)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2006; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_tuple_56);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_56));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2007")'> 2007: </pre>
<pre id='line2007' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2008")'> 2008: </pre>
<pre id='line2008' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2009")'> 2009: </pre>
<pre id='line2009' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2010")'> 2010: </pre>
<pre id='line2010' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2011")'> 2011: cdef class Fast_distance_based_potential_force_calculator(Base_force_calculator):</pre>
<pre id='line2011' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2011
 * 
 * 
 * cdef class Fast_distance_based_potential_force_calculator(Base_force_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator {
  struct __pyx_obj_17shift_calculators_Base_force_calculator __pyx_base;
  int _target_atom_index;
  int _distance_atom_index_1;
  int _distance_atom_index_2;
  int _exponent_index;
  int _coefficient_index;
  int _smoothed;
  float _smoothing_factor;
  float _cutoff;
  struct __pyx_t_17shift_calculators_Distance_component *_compiled_components;
  int _num_components;
  PyObject *raw_data;
};


/* "Cython_shift_calculator.pyx":2011
 * 
 * 
 * cdef class Fast_distance_based_potential_force_calculator(Base_force_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */

struct __pyx_vtabstruct_17shift_calculators_Fast_distance_based_potential_force_calculator {
  struct __pyx_vtabstruct_17shift_calculators_Base_force_calculator __pyx_base;
  Vec3 (*_xyz_distances)(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *, int, int);
  float (*_sum_xyz_distances_2)(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *, int, int);
  float (*_cython_calc_single_force_factor)(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *, int, float);
  void (*_distance_calc_single_force_set)(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *, int, float, struct __pyx_obj_17shift_calculators_Out_array *);
};
static struct __pyx_vtabstruct_17shift_calculators_Fast_distance_based_potential_force_calculator *__pyx_vtabptr_17shift_calculators_Fast_distance_based_potential_force_calculator;
static CYTHON_INLINE Vec3 __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__xyz_distances(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *, int, int);
static CYTHON_INLINE float __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__sum_xyz_distances_2(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *, int, int);
static CYTHON_INLINE float __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__cython_calc_single_force_factor(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *, int, float);
static CYTHON_INLINE void __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__distance_calc_single_force_set(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *, int, float, struct __pyx_obj_17shift_calculators_Out_array *);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2012")'> 2012: </pre>
<pre id='line2012' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2013")'> 2013: </pre>
<pre id='line2013' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2014")'> 2014: </pre>
<pre id='line2014' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2015")'> 2015:     cdef int  _target_atom_index</pre>
<pre id='line2015' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2016")'> 2016:     cdef int  _distance_atom_index_1</pre>
<pre id='line2016' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2017")'> 2017:     cdef int  _distance_atom_index_2</pre>
<pre id='line2017' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2018")'> 2018:     cdef int  _exponent_index</pre>
<pre id='line2018' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2019")'> 2019:     cdef int  _coefficient_index</pre>
<pre id='line2019' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2020")'> 2020:     cdef bint  _smoothed</pre>
<pre id='line2020' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2021")'> 2021:     cdef float _smoothing_factor</pre>
<pre id='line2021' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2022")'> 2022:     cdef float _cutoff</pre>
<pre id='line2022' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2023")'> 2023:     cdef Distance_component* _compiled_components</pre>
<pre id='line2023' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2024")'> 2024:     cdef int _num_components</pre>
<pre id='line2024' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2025")'> 2025:     cdef object raw_data</pre>
<pre id='line2025' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2026")'> 2026: </pre>
<pre id='line2026' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2027")'> 2027:     def __cinit__(self):</pre>
<pre id='line2027' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2027
 *     cdef object raw_data
 * 
 *     def __cinit__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components  = NULL
 *         self._num_components =  0
 */

static int __pyx_pf_17shift_calculators_46Fast_distance_based_potential_force_calculator___cinit__(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2028")'> 2028:         self._compiled_components  = NULL</pre>
<pre id='line2028' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2028
 * 
 *     def __cinit__(self):
 *         self._compiled_components  = NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components =  0
 * 
 */
  __pyx_v_self->_compiled_components = NULL;
</pre><pre class='line' style='background-color: #FFFF32' onclick='toggleDiv("line2029")'> 2029:         self._num_components =  0</pre>
<pre id='line2029' class='code' style='background-color: #FFFF32'>
  /* "Cython_shift_calculator.pyx":2029
 *     def __cinit__(self):
 *         self._compiled_components  = NULL
 *         self._num_components =  0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __init__(self, bint smoothed, name="Not set"):
 */
  __pyx_v_self->_num_components = 0;

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_46Fast_distance_based_potential_force_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_46Fast_distance_based_potential_force_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_smoothed;
  PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__smoothed,&__pyx_n_s__name,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject *)__pyx_kp_s_57);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__smoothed)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2031; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_smoothed = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_smoothed == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2031; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_name = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2031; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_distance_based_potential_force_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_46Fast_distance_based_potential_force_calculator_2__init__(((struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *)__pyx_v_self), __pyx_v_smoothed, __pyx_v_name);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2030")'> 2030: </pre>
<pre id='line2030' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2031")'> 2031:     def __init__(self, bint smoothed, name="Not set"):</pre>
<pre id='line2031' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2031
 *         self._num_components =  0
 * 
 *     def __init__(self, bint smoothed, name="Not set"):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         super(Fast_distance_based_potential_force_calculator, self).__init__(name=name)
 *         self._smoothed =  smoothed
 */

static int __pyx_pf_17shift_calculators_46Fast_distance_based_potential_force_calculator_2__init__(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *__pyx_v_self, int __pyx_v_smoothed, PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFF34' onclick='toggleDiv("line2032")'> 2032:         super(Fast_distance_based_potential_force_calculator, self).__init__(name=name)</pre>
<pre id='line2032' class='code' style='background-color: #FFFF34'>
  /* "Cython_shift_calculator.pyx":2032
 * 
 *     def __init__(self, bint smoothed, name="Not set"):
 *         super(Fast_distance_based_potential_force_calculator, self).__init__(name=name)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._smoothed =  smoothed
 *         self._smoothing_factor =  DEFAULT_SMOOTHING_FACTOR
 */
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2032; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Fast_distance_based_potential_force_calculator)));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Fast_distance_based_potential_force_calculator)));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Fast_distance_based_potential_force_calculator)));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_self));
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_super, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2032; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s____init__);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2032; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2032; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, ((PyObject *)__pyx_n_s__name), __pyx_v_name) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2032; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), ((PyObject *)__pyx_t_2));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2032; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2033")'> 2033:         self._smoothed =  smoothed</pre>
<pre id='line2033' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2033
 *     def __init__(self, bint smoothed, name="Not set"):
 *         super(Fast_distance_based_potential_force_calculator, self).__init__(name=name)
 *         self._smoothed =  smoothed             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._smoothing_factor =  DEFAULT_SMOOTHING_FACTOR
 *         self._cutoff =  DEFAULT_CUTOFF
 */
  __pyx_v_self->_smoothed = __pyx_v_smoothed;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2034")'> 2034:         self._smoothing_factor =  DEFAULT_SMOOTHING_FACTOR</pre>
<pre id='line2034' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2034
 *         super(Fast_distance_based_potential_force_calculator, self).__init__(name=name)
 *         self._smoothed =  smoothed
 *         self._smoothing_factor =  DEFAULT_SMOOTHING_FACTOR             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._cutoff =  DEFAULT_CUTOFF
 * 
 */
  __pyx_v_self->_smoothing_factor = __pyx_v_17shift_calculators_DEFAULT_SMOOTHING_FACTOR;
</pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line2035")'> 2035:         self._cutoff =  DEFAULT_CUTOFF</pre>
<pre id='line2035' class='code' style='background-color: #FFFF96'>
  /* "Cython_shift_calculator.pyx":2035
 *         self._smoothed =  smoothed
 *         self._smoothing_factor =  DEFAULT_SMOOTHING_FACTOR
 *         self._cutoff =  DEFAULT_CUTOFF             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def set_cutoff(self, cutoff):
 */
  __pyx_v_self->_cutoff = __pyx_v_17shift_calculators_DEFAULT_CUTOFF;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_distance_based_potential_force_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_46Fast_distance_based_potential_force_calculator_5set_cutoff(PyObject *__pyx_v_self, PyObject *__pyx_v_cutoff); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_46Fast_distance_based_potential_force_calculator_5set_cutoff(PyObject *__pyx_v_self, PyObject *__pyx_v_cutoff) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_cutoff (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_46Fast_distance_based_potential_force_calculator_4set_cutoff(((struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_cutoff));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2036")'> 2036: </pre>
<pre id='line2036' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2037")'> 2037:     def set_cutoff(self, cutoff):</pre>
<pre id='line2037' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2037
 *         self._cutoff =  DEFAULT_CUTOFF
 * 
 *     def set_cutoff(self, cutoff):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._cutoff =  cutoff
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_46Fast_distance_based_potential_force_calculator_4set_cutoff(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *__pyx_v_self, PyObject *__pyx_v_cutoff) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_cutoff", 0);
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line2038")'> 2038:         self._cutoff =  cutoff</pre>
<pre id='line2038' class='code' style='background-color: #FFFF66'>
  /* "Cython_shift_calculator.pyx":2038
 * 
 *     def set_cutoff(self, cutoff):
 *         self._cutoff =  cutoff             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def set_smoothing_factor(self,smoothing_factor):
 */
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_cutoff);<span class='error_goto'> if (unlikely((__pyx_t_1 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2038; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_cutoff = __pyx_t_1;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_distance_based_potential_force_calculator.set_cutoff", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_46Fast_distance_based_potential_force_calculator_7set_smoothing_factor(PyObject *__pyx_v_self, PyObject *__pyx_v_smoothing_factor); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_46Fast_distance_based_potential_force_calculator_7set_smoothing_factor(PyObject *__pyx_v_self, PyObject *__pyx_v_smoothing_factor) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_smoothing_factor (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_46Fast_distance_based_potential_force_calculator_6set_smoothing_factor(((struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_smoothing_factor));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2039")'> 2039: </pre>
<pre id='line2039' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2040")'> 2040:     def set_smoothing_factor(self,smoothing_factor):</pre>
<pre id='line2040' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2040
 *         self._cutoff =  cutoff
 * 
 *     def set_smoothing_factor(self,smoothing_factor):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._smoothing_factor = smoothing_factor
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_46Fast_distance_based_potential_force_calculator_6set_smoothing_factor(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *__pyx_v_self, PyObject *__pyx_v_smoothing_factor) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_smoothing_factor", 0);
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line2041")'> 2041:         self._smoothing_factor = smoothing_factor</pre>
<pre id='line2041' class='code' style='background-color: #FFFF66'>
  /* "Cython_shift_calculator.pyx":2041
 * 
 *     def set_smoothing_factor(self,smoothing_factor):
 *         self._smoothing_factor = smoothing_factor             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_smoothing_factor);<span class='error_goto'> if (unlikely((__pyx_t_1 == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2041; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_smoothing_factor = __pyx_t_1;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_distance_based_potential_force_calculator.set_smoothing_factor", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_46Fast_distance_based_potential_force_calculator_9_bytes_to_components(PyObject *__pyx_v_self, PyObject *__pyx_v_data); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_46Fast_distance_based_potential_force_calculator_9_bytes_to_components(PyObject *__pyx_v_self, PyObject *__pyx_v_data) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_components (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_46Fast_distance_based_potential_force_calculator_8_bytes_to_components(((struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_data));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2042")'> 2042: </pre>
<pre id='line2042' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2043")'> 2043: </pre>
<pre id='line2043' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2044")'> 2044: </pre>
<pre id='line2044' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2045")'> 2045: </pre>
<pre id='line2045' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2046")'> 2046:     def _bytes_to_components(self, data):</pre>
<pre id='line2046' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2046
 * 
 * 
 *     def _bytes_to_components(self, data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self.raw_data =  data
 */

static PyObject *__pyx_pf_17shift_calculators_46Fast_distance_based_potential_force_calculator_8_bytes_to_components(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *__pyx_v_self, PyObject *__pyx_v_data) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_components", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2047")'> 2047: </pre>
<pre id='line2047' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2048")'> 2048:         self.raw_data =  data</pre>
<pre id='line2048' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":2048
 *     def _bytes_to_components(self, data):
 * 
 *         self.raw_data =  data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components =  <code><</code>Distance_component*> <code><</code>size_t> ctypes.addressof(data)
 *         self._num_components =  len(data)/ sizeof(Distance_component)
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->raw_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->raw_data);
  __pyx_v_self->raw_data = __pyx_v_data;
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line2049")'> 2049:         self._compiled_components =  &lt;Distance_component*&gt; &lt;size_t&gt; ctypes.addressof(data)</pre>
<pre id='line2049' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":2049
 * 
 *         self.raw_data =  data
 *         self._compiled_components =  <code><</code>Distance_component*> <code><</code>size_t> ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components =  len(data)/ sizeof(Distance_component)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2049; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2049; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2049; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2049; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2049; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_self->_compiled_components = ((struct __pyx_t_17shift_calculators_Distance_component *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFF1e' onclick='toggleDiv("line2050")'> 2050:         self._num_components =  len(data)/ sizeof(Distance_component)</pre>
<pre id='line2050' class='code' style='background-color: #FFFF1e'>
  /* "Cython_shift_calculator.pyx":2050
 *         self.raw_data =  data
 *         self._compiled_components =  <code><</code>Distance_component*> <code><</code>size_t> ctypes.addressof(data)
 *         self._num_components =  len(data)/ sizeof(Distance_component)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2050; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_num_components = (__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Distance_component)));

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_distance_based_potential_force_calculator._bytes_to_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_46Fast_distance_based_potential_force_calculator_11_calc_single_force_set(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_46Fast_distance_based_potential_force_calculator_11_calc_single_force_set(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_index;
  float __pyx_v_factor;
  struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calc_single_force_set (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__index,&__pyx_n_s__factor,&__pyx_n_s__forces,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__index)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__factor)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calc_single_force_set", 1, 3, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2054; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__forces)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calc_single_force_set", 1, 3, 3, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2054; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_calc_single_force_set") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2054; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_index = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_index == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2054; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_factor = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_factor == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2054; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_forces = ((struct __pyx_obj_17shift_calculators_Out_array *)values[2]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calc_single_force_set", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2054; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_distance_based_potential_force_calculator._calc_single_force_set", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_forces), __pyx_ptype_17shift_calculators_Out_array, 1, "forces", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2054; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_46Fast_distance_based_potential_force_calculator_10_calc_single_force_set(((struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *)__pyx_v_self), __pyx_v_index, __pyx_v_factor, __pyx_v_forces);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2051")'> 2051: </pre>
<pre id='line2051' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2052")'> 2052: </pre>
<pre id='line2052' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2053")'> 2053: #   TODO: generalise this based on compiled components</pre>
<pre id='line2053' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2054")'> 2054:     def _calc_single_force_set(self, int index, float factor, Out_array forces):</pre>
<pre id='line2054' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2054
 * 
 * #   TODO: generalise this based on compiled components
 *     def _calc_single_force_set(self, int index, float factor, Out_array forces):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         #TODO tidy this up a hack for the test suite
 *         cdef Distance_component* saved_component_list = self._compiled_components
 */

static PyObject *__pyx_pf_17shift_calculators_46Fast_distance_based_potential_force_calculator_10_calc_single_force_set(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *__pyx_v_self, int __pyx_v_index, float __pyx_v_factor, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces) {
  struct __pyx_t_17shift_calculators_Distance_component *__pyx_v_saved_component_list;
  int __pyx_v_saved_num_components;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calc_single_force_set", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2055")'> 2055:         #TODO tidy this up a hack for the test suite</pre>
<pre id='line2055' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2056")'> 2056:         cdef Distance_component* saved_component_list = self._compiled_components</pre>
<pre id='line2056' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2056
 *     def _calc_single_force_set(self, int index, float factor, Out_array forces):
 *         #TODO tidy this up a hack for the test suite
 *         cdef Distance_component* saved_component_list = self._compiled_components             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int saved_num_components = self._num_components
 * 
 */
  __pyx_t_1 = __pyx_v_self->_compiled_components;
  __pyx_v_saved_component_list = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2057")'> 2057:         cdef int saved_num_components = self._num_components</pre>
<pre id='line2057' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2057
 *         #TODO tidy this up a hack for the test suite
 *         cdef Distance_component* saved_component_list = self._compiled_components
 *         cdef int saved_num_components = self._num_components             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._num_components  = 1
 */
  __pyx_t_2 = __pyx_v_self->_num_components;
  __pyx_v_saved_num_components = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2058")'> 2058: </pre>
<pre id='line2058' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2059")'> 2059:         self._num_components  = 1</pre>
<pre id='line2059' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2059
 *         cdef int saved_num_components = self._num_components
 * 
 *         self._num_components  = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components = &saved_component_list[index]
 * 
 */
  __pyx_v_self->_num_components = 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2060")'> 2060:         self._compiled_components = &amp;saved_component_list[index]</pre>
<pre id='line2060' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2060
 * 
 *         self._num_components  = 1
 *         self._compiled_components = &saved_component_list[index]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._distance_calc_single_force_set(0,factor,forces)
 */
  __pyx_v_self->_compiled_components = (&(__pyx_v_saved_component_list[__pyx_v_index]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2061")'> 2061: </pre>
<pre id='line2061' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2062")'> 2062:         self._distance_calc_single_force_set(0,factor,forces)</pre>
<pre id='line2062' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2062
 *         self._compiled_components = &saved_component_list[index]
 * 
 *         self._distance_calc_single_force_set(0,factor,forces)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._compiled_components = saved_component_list
 */
  __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__distance_calc_single_force_set(__pyx_v_self, 0, __pyx_v_factor, __pyx_v_forces);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2063")'> 2063: </pre>
<pre id='line2063' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2064")'> 2064:         self._compiled_components = saved_component_list</pre>
<pre id='line2064' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2064
 *         self._distance_calc_single_force_set(0,factor,forces)
 * 
 *         self._compiled_components = saved_component_list             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components = saved_num_components
 * 
 */
  __pyx_v_self->_compiled_components = __pyx_v_saved_component_list;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2065")'> 2065:         self._num_components = saved_num_components</pre>
<pre id='line2065' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":2065
 * 
 *         self._compiled_components = saved_component_list
 *         self._num_components = saved_num_components             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_self->_num_components = __pyx_v_saved_num_components;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2066")'> 2066: </pre>
<pre id='line2066' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2067")'> 2067: </pre>
<pre id='line2067' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2068")'> 2068:     @cython.profile(False)</pre>
<pre id='line2068' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2069")'> 2069:     cdef inline Vec3 _xyz_distances(self, int target_atom, int distance_atom):</pre>
<pre id='line2069' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2069
 * 
 *     @cython.profile(False)
 *     cdef inline Vec3 _xyz_distances(self, int target_atom, int distance_atom):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3 target_pos, distant_pos
 * 
 */

static CYTHON_INLINE Vec3 __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__xyz_distances(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *__pyx_v_self, int __pyx_v_target_atom, int __pyx_v_distance_atom) {
  Vec3 __pyx_v_target_pos;
  Vec3 __pyx_v_distant_pos;
  Vec3 __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_xyz_distances", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2070")'> 2070:         cdef Vec3 target_pos, distant_pos</pre>
<pre id='line2070' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2071")'> 2071: </pre>
<pre id='line2071' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2072")'> 2072: </pre>
<pre id='line2072' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2073")'> 2073:         target_pos = self._simulation[0].atomPos(target_atom)</pre>
<pre id='line2073' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2073
 * 
 * 
 *         target_pos = self._simulation[0].atomPos(target_atom)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         distant_pos =   self._simulation[0].atomPos(distance_atom)
 * 
 */
  __pyx_v_target_pos = (__pyx_v_self->__pyx_base._simulation[0]).atomPos(__pyx_v_target_atom);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2074")'> 2074:         distant_pos =   self._simulation[0].atomPos(distance_atom)</pre>
<pre id='line2074' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2074
 * 
 *         target_pos = self._simulation[0].atomPos(target_atom)
 *         distant_pos =   self._simulation[0].atomPos(distance_atom)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         return target_pos - distant_pos
 */
  __pyx_v_distant_pos = (__pyx_v_self->__pyx_base._simulation[0]).atomPos(__pyx_v_distance_atom);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2075")'> 2075: </pre>
<pre id='line2075' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line2076")'> 2076:         return target_pos - distant_pos</pre>
<pre id='line2076' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":2076
 *         distant_pos =   self._simulation[0].atomPos(distance_atom)
 * 
 *         return target_pos - distant_pos             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     @cython.profile(False)
 */
  __pyx_r = (__pyx_v_target_pos - __pyx_v_distant_pos);
  goto __pyx_L0;

  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2077")'> 2077: </pre>
<pre id='line2077' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2078")'> 2078:     @cython.profile(False)</pre>
<pre id='line2078' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2079")'> 2079:     cdef inline float _sum_xyz_distances_2(self, int target_atom, int distance_atom):</pre>
<pre id='line2079' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2079
 * 
 *     @cython.profile(False)
 *     cdef inline float _sum_xyz_distances_2(self, int target_atom, int distance_atom):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3 target_pos, distant_pos, distance
 *         cdef float result =0.0
 */

static CYTHON_INLINE float __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__sum_xyz_distances_2(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *__pyx_v_self, int __pyx_v_target_atom, int __pyx_v_distance_atom) {
  Vec3 __pyx_v_target_pos;
  Vec3 __pyx_v_distant_pos;
  Vec3 __pyx_v_distance;
  float __pyx_v_result;
  int __pyx_v_i;
  float __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_sum_xyz_distances_2", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2080")'> 2080:         cdef Vec3 target_pos, distant_pos, distance</pre>
<pre id='line2080' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2081")'> 2081:         cdef float result =0.0</pre>
<pre id='line2081' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2081
 *     cdef inline float _sum_xyz_distances_2(self, int target_atom, int distance_atom):
 *         cdef Vec3 target_pos, distant_pos, distance
 *         cdef float result =0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int i
 * 
 */
  __pyx_v_result = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2082")'> 2082:         cdef int i</pre>
<pre id='line2082' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2083")'> 2083: </pre>
<pre id='line2083' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2084")'> 2084:         target_pos =   self._simulation[0].atomPos(target_atom)</pre>
<pre id='line2084' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2084
 *         cdef int i
 * 
 *         target_pos =   self._simulation[0].atomPos(target_atom)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         distant_pos =  self._simulation[0].atomPos(distance_atom)
 * 
 */
  __pyx_v_target_pos = (__pyx_v_self->__pyx_base._simulation[0]).atomPos(__pyx_v_target_atom);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2085")'> 2085:         distant_pos =  self._simulation[0].atomPos(distance_atom)</pre>
<pre id='line2085' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2085
 * 
 *         target_pos =   self._simulation[0].atomPos(target_atom)
 *         distant_pos =  self._simulation[0].atomPos(distance_atom)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         distance = Vec3(target_pos - distant_pos)
 */
  __pyx_v_distant_pos = (__pyx_v_self->__pyx_base._simulation[0]).atomPos(__pyx_v_distance_atom);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2086")'> 2086: </pre>
<pre id='line2086' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2087")'> 2087:         distance = Vec3(target_pos - distant_pos)</pre>
<pre id='line2087' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2087
 *         distant_pos =  self._simulation[0].atomPos(distance_atom)
 * 
 *         distance = Vec3(target_pos - distant_pos)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         for i in range(3):
 */
  __pyx_v_distance = Vec3((__pyx_v_target_pos - __pyx_v_distant_pos));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2088")'> 2088: </pre>
<pre id='line2088' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2089")'> 2089:         for i in range(3):</pre>
<pre id='line2089' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2089
 *         distance = Vec3(target_pos - distant_pos)
 * 
 *         for i in range(3):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             result += distance[i] * distance[i]
 * 
 */
  for (__pyx_t_1 = 0; __pyx_t_1 <code><</code> 3; __pyx_t_1+=1) {
    __pyx_v_i = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2090")'> 2090:             result += distance[i] * distance[i]</pre>
<pre id='line2090' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2090
 * 
 *         for i in range(3):
 *             result += distance[i] * distance[i]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         return result
 */
    __pyx_v_result = (__pyx_v_result + ((__pyx_v_distance[__pyx_v_i]) * (__pyx_v_distance[__pyx_v_i])));
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2091")'> 2091: </pre>
<pre id='line2091' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF28' onclick='toggleDiv("line2092")'> 2092:         return result</pre>
<pre id='line2092' class='code' style='background-color: #FFFF28'>
  /* "Cython_shift_calculator.pyx":2092
 *             result += distance[i] * distance[i]
 * 
 *         return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def _calc_single_force_factor(self, int index, float factor):
 */
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_46Fast_distance_based_potential_force_calculator_13_calc_single_force_factor(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_46Fast_distance_based_potential_force_calculator_13_calc_single_force_factor(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_index;
  float __pyx_v_factor;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calc_single_force_factor (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__index,&__pyx_n_s__factor,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__index)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__factor)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calc_single_force_factor", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2094; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_calc_single_force_factor") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2094; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_index = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_index == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2094; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_factor = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_factor == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2094; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calc_single_force_factor", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2094; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_distance_based_potential_force_calculator._calc_single_force_factor", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_46Fast_distance_based_potential_force_calculator_12_calc_single_force_factor(((struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *)__pyx_v_self), __pyx_v_index, __pyx_v_factor);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2093")'> 2093: </pre>
<pre id='line2093' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2094")'> 2094:     def _calc_single_force_factor(self, int index, float factor):</pre>
<pre id='line2094' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2094
 *         return result
 * 
 *     def _calc_single_force_factor(self, int index, float factor):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._cython_calc_single_force_factor(index, factor)
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_46Fast_distance_based_potential_force_calculator_12_calc_single_force_factor(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *__pyx_v_self, int __pyx_v_index, float __pyx_v_factor) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calc_single_force_factor", 0);
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line2095")'> 2095:         return self._cython_calc_single_force_factor(index, factor)</pre>
<pre id='line2095' class='code' style='background-color: #FFFF79'>
  /* "Cython_shift_calculator.pyx":2095
 * 
 *     def _calc_single_force_factor(self, int index, float factor):
 *         return self._cython_calc_single_force_factor(index, factor)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void _do_calc_components(self, int[:] component_to_result, float[:] force_factors, Out_array force):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__cython_calc_single_force_factor(__pyx_v_self, __pyx_v_index, __pyx_v_factor));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2095; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_distance_based_potential_force_calculator._calc_single_force_factor", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2096")'> 2096: </pre>
<pre id='line2096' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2097")'> 2097:     cdef void _do_calc_components(self, int[:] component_to_result, float[:] force_factors, Out_array force):</pre>
<pre id='line2097' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2097
 *         return self._cython_calc_single_force_factor(index, factor)
 * 
 *     cdef void _do_calc_components(self, int[:] component_to_result, float[:] force_factors, Out_array force):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int factor_index
 *         cdef int component_index
 */

static void __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__do_calc_components(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *__pyx_v_self, __Pyx_memviewslice __pyx_v_component_to_result, __Pyx_memviewslice __pyx_v_force_factors, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_force) {
  int __pyx_v_factor_index;
  int __pyx_v_component_index;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_do_calc_components", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2098")'> 2098:         cdef int factor_index</pre>
<pre id='line2098' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2099")'> 2099:         cdef int component_index</pre>
<pre id='line2099' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2100")'> 2100: </pre>
<pre id='line2100' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line2101")'> 2101:         for factor_index in range(len(self._active_components)):</pre>
<pre id='line2101' class='code' style='background-color: #FFFF79'>
  /* "Cython_shift_calculator.pyx":2101
 *         cdef int component_index
 * 
 *         for factor_index in range(len(self._active_components)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             component_index = self._active_components[factor_index]
 *             self._distance_calc_single_force_set(component_index,force_factors[component_to_result[factor_index]],force)
 */
  if (unlikely(!__pyx_v_self->__pyx_base._active_components.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}}
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->__pyx_base._active_components, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (__pyx_t_3 = 0; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_factor_index = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line2102")'> 2102:             component_index = self._active_components[factor_index]</pre>
<pre id='line2102' class='code' style='background-color: #FFFFaa'>
    /* "Cython_shift_calculator.pyx":2102
 * 
 *         for factor_index in range(len(self._active_components)):
 *             component_index = self._active_components[factor_index]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._distance_calc_single_force_set(component_index,force_factors[component_to_result[factor_index]],force)
 * 
 */
    if (unlikely(!__pyx_v_self->__pyx_base._active_components.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}}
    __pyx_t_4 = __pyx_v_factor_index;
    __pyx_v_component_index = (*((int *) ( /* dim=0 */ (__pyx_v_self->__pyx_base._active_components.data + __pyx_t_4 * __pyx_v_self->__pyx_base._active_components.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line2103")'> 2103:             self._distance_calc_single_force_set(component_index,force_factors[component_to_result[factor_index]],force)</pre>
<pre id='line2103' class='code' style='background-color: #FFFFb6'>
    /* "Cython_shift_calculator.pyx":2103
 *         for factor_index in range(len(self._active_components)):
 *             component_index = self._active_components[factor_index]
 *             self._distance_calc_single_force_set(component_index,force_factors[component_to_result[factor_index]],force)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #         for i in range(self._num_components):
 */
    __pyx_t_5 = __pyx_v_factor_index;
    __pyx_t_6 = (*((int *) ( /* dim=0 */ (__pyx_v_component_to_result.data + __pyx_t_5 * __pyx_v_component_to_result.strides[0]) )));
    __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__distance_calc_single_force_set(__pyx_v_self, __pyx_v_component_index, (*((float *) ( /* dim=0 */ (__pyx_v_force_factors.data + __pyx_t_6 * __pyx_v_force_factors.strides[0]) ))), __pyx_v_force);
  }

  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Fast_distance_based_potential_force_calculator._do_calc_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2104")'> 2104: </pre>
<pre id='line2104' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2105")'> 2105: #         for i in range(self._num_components):</pre>
<pre id='line2105' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2106")'> 2106: #             self._distance_calc_single_force_set(i,force_factors[component_to_result[i]],force)</pre>
<pre id='line2106' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2107")'> 2107: </pre>
<pre id='line2107' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2108")'> 2108: </pre>
<pre id='line2108' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2109")'> 2109:     @cython.profile(False)</pre>
<pre id='line2109' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2110")'> 2110:     cdef inline float _cython_calc_single_force_factor(self, int index, float factor):</pre>
<pre id='line2110' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2110
 * 
 *     @cython.profile(False)
 *     cdef inline float _cython_calc_single_force_factor(self, int index, float factor):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef target_distant_atom atom_ids
 * #        cdef coefficient_exponent coef_exp
 */

static CYTHON_INLINE float __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__cython_calc_single_force_factor(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *__pyx_v_self, int __pyx_v_index, float __pyx_v_factor) {
  float __pyx_v_exponent;
  float __pyx_v_full_factor;
  float __pyx_v_force_factor;
  float __pyx_v_ratio;
  float __pyx_v_pre_exponent;
  float __pyx_v_reduced_exponent;
  float __pyx_v_sum_xyz_distances_2;
  float __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_cython_calc_single_force_factor", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2111")'> 2111:         cdef target_distant_atom atom_ids</pre>
<pre id='line2111' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2112")'> 2112: #        cdef coefficient_exponent coef_exp</pre>
<pre id='line2112' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2113")'> 2113:         cdef float exponent</pre>
<pre id='line2113' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2114")'> 2114: </pre>
<pre id='line2114' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2115")'> 2115:         cdef float full_factor, force_factor</pre>
<pre id='line2115' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2116")'> 2116:         cdef float ratio, pre_exponent, reduced_exponent, sum_xyz_distances_2</pre>
<pre id='line2116' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2117")'> 2117: </pre>
<pre id='line2117' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2118")'> 2118: #        atom_ids = self._get_target_and_distant_atom_ids(index)</pre>
<pre id='line2118' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2119")'> 2119: </pre>
<pre id='line2119' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2120")'> 2120:         sum_xyz_distances_2 = self._sum_xyz_distances_2(self._compiled_components[index].remote_atom_1, self._compiled_components[index].remote_atom_2)</pre>
<pre id='line2120' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2120
 * #        atom_ids = self._get_target_and_distant_atom_ids(index)
 * 
 *         sum_xyz_distances_2 = self._sum_xyz_distances_2(self._compiled_components[index].remote_atom_1, self._compiled_components[index].remote_atom_2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #
 *         full_factor= factor *  self._compiled_components[index].coefficient
 */
  __pyx_v_sum_xyz_distances_2 = __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__sum_xyz_distances_2(__pyx_v_self, (__pyx_v_self->_compiled_components[__pyx_v_index]).remote_atom_1, (__pyx_v_self->_compiled_components[__pyx_v_index]).remote_atom_2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2121")'> 2121: #</pre>
<pre id='line2121' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2122")'> 2122:         full_factor= factor *  self._compiled_components[index].coefficient</pre>
<pre id='line2122' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2122
 *         sum_xyz_distances_2 = self._sum_xyz_distances_2(self._compiled_components[index].remote_atom_1, self._compiled_components[index].remote_atom_2)
 * #
 *         full_factor= factor *  self._compiled_components[index].coefficient             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         exponent =  self._compiled_components[index].exponent
 */
  __pyx_v_full_factor = (__pyx_v_factor * (__pyx_v_self->_compiled_components[__pyx_v_index]).coefficient);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2123")'> 2123: </pre>
<pre id='line2123' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2124")'> 2124:         exponent =  self._compiled_components[index].exponent</pre>
<pre id='line2124' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2124
 *         full_factor= factor *  self._compiled_components[index].coefficient
 * 
 *         exponent =  self._compiled_components[index].exponent             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if self._smoothed:
 *             ratio = sum_xyz_distances_2 / (self._cutoff**2)
 */
  __pyx_t_1 = (__pyx_v_self->_compiled_components[__pyx_v_index]).exponent;
  __pyx_v_exponent = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2125")'> 2125:         if self._smoothed:</pre>
<pre id='line2125' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2125
 * 
 *         exponent =  self._compiled_components[index].exponent
 *         if self._smoothed:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             ratio = sum_xyz_distances_2 / (self._cutoff**2)
 *             ratio =  ratio**4
 */
  if (__pyx_v_self->_smoothed) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2126")'> 2126:             ratio = sum_xyz_distances_2 / (self._cutoff**2)</pre>
<pre id='line2126' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2126
 *         exponent =  self._compiled_components[index].exponent
 *         if self._smoothed:
 *             ratio = sum_xyz_distances_2 / (self._cutoff**2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             ratio =  ratio**4
 *             pre_exponent = exponent - (exponent + 8.0) * ratio
 */
    __pyx_v_ratio = (__pyx_v_sum_xyz_distances_2 / powf(__pyx_v_self->_cutoff, 2.0));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2127")'> 2127:             ratio =  ratio**4</pre>
<pre id='line2127' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2127
 *         if self._smoothed:
 *             ratio = sum_xyz_distances_2 / (self._cutoff**2)
 *             ratio =  ratio**4             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             pre_exponent = exponent - (exponent + 8.0) * ratio
 *         else:
 */
    __pyx_v_ratio = powf(__pyx_v_ratio, 4.0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2128")'> 2128:             pre_exponent = exponent - (exponent + 8.0) * ratio</pre>
<pre id='line2128' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2128
 *             ratio = sum_xyz_distances_2 / (self._cutoff**2)
 *             ratio =  ratio**4
 *             pre_exponent = exponent - (exponent + 8.0) * ratio             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             pre_exponent = exponent
 */
    __pyx_v_pre_exponent = (__pyx_v_exponent - ((__pyx_v_exponent + 8.0) * __pyx_v_ratio));
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2129")'> 2129:         else:</pre>
<pre id='line2129' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2130")'> 2130:             pre_exponent = exponent</pre>
<pre id='line2130' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2130
 *             pre_exponent = exponent - (exponent + 8.0) * ratio
 *         else:
 *             pre_exponent = exponent             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         reduced_exponent = (exponent - 2.0) / 2
 */
    __pyx_v_pre_exponent = __pyx_v_exponent;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2131")'> 2131: </pre>
<pre id='line2131' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2132")'> 2132:         reduced_exponent = (exponent - 2.0) / 2</pre>
<pre id='line2132' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2132
 *             pre_exponent = exponent
 * 
 *         reduced_exponent = (exponent - 2.0) / 2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         force_factor = full_factor *  pre_exponent * sum_xyz_distances_2 ** reduced_exponent
 */
  __pyx_v_reduced_exponent = ((__pyx_v_exponent - 2.0) / 2.0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2133")'> 2133: </pre>
<pre id='line2133' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2134")'> 2134:         force_factor = full_factor *  pre_exponent * sum_xyz_distances_2 ** reduced_exponent</pre>
<pre id='line2134' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2134
 *         reduced_exponent = (exponent - 2.0) / 2
 * 
 *         force_factor = full_factor *  pre_exponent * sum_xyz_distances_2 ** reduced_exponent             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         return force_factor
 */
  __pyx_v_force_factor = ((__pyx_v_full_factor * __pyx_v_pre_exponent) * powf(__pyx_v_sum_xyz_distances_2, __pyx_v_reduced_exponent));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2135")'> 2135: </pre>
<pre id='line2135' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line2136")'> 2136:         return force_factor</pre>
<pre id='line2136' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":2136
 *         force_factor = full_factor *  pre_exponent * sum_xyz_distances_2 ** reduced_exponent
 * 
 *         return force_factor             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_r = __pyx_v_force_factor;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2137")'> 2137: </pre>
<pre id='line2137' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2138")'> 2138: </pre>
<pre id='line2138' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2139")'> 2139: </pre>
<pre id='line2139' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2140")'> 2140: </pre>
<pre id='line2140' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2141")'> 2141: </pre>
<pre id='line2141' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2142")'> 2142: #    def _calc_single_force_set(self, int index, float factor, object forces):</pre>
<pre id='line2142' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2143")'> 2143: #        self._cython_calc_single_force_set(index, factor, forces)</pre>
<pre id='line2143' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2144")'> 2144: </pre>
<pre id='line2144' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2145")'> 2145:     @cython.profile(False)</pre>
<pre id='line2145' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2146")'> 2146:     cdef inline void _distance_calc_single_force_set(self,int index, float factor, Out_array forces):</pre>
<pre id='line2146' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2146
 * 
 *     @cython.profile(False)
 *     cdef inline void _distance_calc_single_force_set(self,int index, float factor, Out_array forces):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #        cdef target_distant_atom atom_ids
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__distance_calc_single_force_set(struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *__pyx_v_self, int __pyx_v_index, float __pyx_v_factor, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces) {
  Vec3 __pyx_v_xyz_distances;
  float __pyx_v_force_factor;
  Vec3 __pyx_v_target_forces;
  Vec3 __pyx_v_distant_forces;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_distance_calc_single_force_set", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2147")'> 2147: </pre>
<pre id='line2147' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2148")'> 2148: #        cdef target_distant_atom atom_ids</pre>
<pre id='line2148' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2149")'> 2149:         cdef Vec3 xyz_distances</pre>
<pre id='line2149' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2150")'> 2150:         cdef float force_factor, distance</pre>
<pre id='line2150' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2151")'> 2151:         cdef Vec3 result</pre>
<pre id='line2151' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2152")'> 2152: </pre>
<pre id='line2152' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2153")'> 2153: #        atom_ids =  self._get_target_and_distant_atom_ids(index)</pre>
<pre id='line2153' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2154")'> 2154: #</pre>
<pre id='line2154' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2155")'> 2155: ##        print atom_ids.target_atom_id,atom_ids.distant_atom_id</pre>
<pre id='line2155' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2156")'> 2156:         xyz_distances  = self._xyz_distances(self._compiled_components[index].remote_atom_1,self._compiled_components[index].remote_atom_2)</pre>
<pre id='line2156' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2156
 * #
 * ##        print atom_ids.target_atom_id,atom_ids.distant_atom_id
 *         xyz_distances  = self._xyz_distances(self._compiled_components[index].remote_atom_1,self._compiled_components[index].remote_atom_2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         force_factor  = self._cython_calc_single_force_factor(index, factor)
 */
  __pyx_v_xyz_distances = __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__xyz_distances(__pyx_v_self, (__pyx_v_self->_compiled_components[__pyx_v_index]).remote_atom_1, (__pyx_v_self->_compiled_components[__pyx_v_index]).remote_atom_2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2157")'> 2157: </pre>
<pre id='line2157' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2158")'> 2158:         force_factor  = self._cython_calc_single_force_factor(index, factor)</pre>
<pre id='line2158' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2158
 *         xyz_distances  = self._xyz_distances(self._compiled_components[index].remote_atom_1,self._compiled_components[index].remote_atom_2)
 * 
 *         force_factor  = self._cython_calc_single_force_factor(index, factor)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Vec3 target_forces = xyz_distances
 */
  __pyx_v_force_factor = __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__cython_calc_single_force_factor(__pyx_v_self, __pyx_v_index, __pyx_v_factor);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2159")'> 2159: </pre>
<pre id='line2159' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2160")'> 2160:         cdef Vec3 target_forces = xyz_distances</pre>
<pre id='line2160' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2160
 *         force_factor  = self._cython_calc_single_force_factor(index, factor)
 * 
 *         cdef Vec3 target_forces = xyz_distances             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(target_forces, -force_factor)
 * 
 */
  __pyx_v_target_forces = __pyx_v_xyz_distances;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2161")'> 2161:         operator_times(target_forces, -force_factor)</pre>
<pre id='line2161' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2161
 * 
 *         cdef Vec3 target_forces = xyz_distances
 *         operator_times(target_forces, -force_factor)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Vec3 distant_forces = xyz_distances
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_target_forces, (-__pyx_v_force_factor));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2162")'> 2162: </pre>
<pre id='line2162' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2163")'> 2163:         cdef Vec3 distant_forces = xyz_distances</pre>
<pre id='line2163' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2163
 *         operator_times(target_forces, -force_factor)
 * 
 *         cdef Vec3 distant_forces = xyz_distances             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(distant_forces, force_factor)
 * #
 */
  __pyx_v_distant_forces = __pyx_v_xyz_distances;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2164")'> 2164:         operator_times(distant_forces, force_factor)</pre>
<pre id='line2164' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2164
 * 
 *         cdef Vec3 distant_forces = xyz_distances
 *         operator_times(distant_forces, force_factor)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #
 *         forces.add(self._compiled_components[index].remote_atom_1,target_forces)
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_distant_forces, __pyx_v_force_factor);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2165")'> 2165: #</pre>
<pre id='line2165' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2166")'> 2166:         forces.add(self._compiled_components[index].remote_atom_1,target_forces)</pre>
<pre id='line2166' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2166
 *         operator_times(distant_forces, force_factor)
 * #
 *         forces.add(self._compiled_components[index].remote_atom_1,target_forces)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         forces.add(self._compiled_components[index].remote_atom_2,distant_forces)
 * 
 */
  __pyx_f_17shift_calculators_9Out_array_add(__pyx_v_forces, (__pyx_v_self->_compiled_components[__pyx_v_index]).remote_atom_1, __pyx_v_target_forces);
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line2167")'> 2167:         forces.add(self._compiled_components[index].remote_atom_2,distant_forces)</pre>
<pre id='line2167' class='code' style='background-color: #FFFF6e'>
  /* "Cython_shift_calculator.pyx":2167
 * #
 *         forces.add(self._compiled_components[index].remote_atom_1,target_forces)
 *         forces.add(self._compiled_components[index].remote_atom_2,distant_forces)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_f_17shift_calculators_9Out_array_add(__pyx_v_forces, (__pyx_v_self->_compiled_components[__pyx_v_index]).remote_atom_2, __pyx_v_distant_forces);

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_32Fast_non_bonded_force_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_32Fast_non_bonded_force_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) > 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) > 0) && unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__cinit__", 0))) return -1;
  __pyx_r = __pyx_pf_17shift_calculators_32Fast_non_bonded_force_calculator___cinit__(((struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2168")'> 2168: </pre>
<pre id='line2168' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2169")'> 2169: </pre>
<pre id='line2169' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2170")'> 2170: </pre>
<pre id='line2170' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2171")'> 2171: </pre>
<pre id='line2171' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2172")'> 2172: </pre>
<pre id='line2172' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2173")'> 2173: cdef class Fast_non_bonded_force_calculator(Fast_distance_based_potential_force_calculator):</pre>
<pre id='line2173' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2173
 * 
 * 
 * cdef class Fast_non_bonded_force_calculator(Fast_distance_based_potential_force_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef float _nb_cutoff
 */
struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator {
  struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator __pyx_base;
  float _nb_cutoff;
  struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *_non_bonded_list;
  PyObject *_raw_target_data;
  struct __pyx_t_17shift_calculators_Non_bonded_target_component *_compiled_target_components;
  int _num_target_components;
  PyObject *_raw_remote_data;
  struct __pyx_t_17shift_calculators_Non_bonded_remote_atom_component *_compiled_remote_components;
  int _num_remote_components;
  PyObject *_raw_coefficient_data;
  struct __pyx_t_17shift_calculators_Nonbonded_coefficient_component *_compiled_coefficient_components;
  int _num_coefficient_components;
  int _component_offset;
};


/* "Cython_shift_calculator.pyx":2173
 * 
 * 
 * cdef class Fast_non_bonded_force_calculator(Fast_distance_based_potential_force_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef float _nb_cutoff
 */

struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_force_calculator {
  struct __pyx_vtabstruct_17shift_calculators_Fast_distance_based_potential_force_calculator __pyx_base;
  PyObject *(*_bytes_to_target_components)(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *, PyObject *);
  PyObject *(*_bytes_to_remote_components)(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *, PyObject *);
  PyObject *(*_bytes_to_nonbonded_coefficient_components)(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *, PyObject *);
  void (*_set_the_component)(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *, int, int, float, float);
  void (*_calc_one_component)(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *, int, int, __Pyx_memviewslice, __Pyx_memviewslice, struct __pyx_obj_17shift_calculators_Out_array *);
  void (*_cython_build_component)(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *, int, int);
};
static struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_force_calculator *__pyx_vtabptr_17shift_calculators_Fast_non_bonded_force_calculator;
static CYTHON_INLINE void __pyx_f_17shift_calculators_32Fast_non_bonded_force_calculator__set_the_component(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *, int, int, float, float);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2174")'> 2174: </pre>
<pre id='line2174' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2175")'> 2175:     cdef float _nb_cutoff</pre>
<pre id='line2175' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2176")'> 2176: </pre>
<pre id='line2176' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2177")'> 2177:     cdef Non_bonded_interaction_list _non_bonded_list</pre>
<pre id='line2177' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2178")'> 2178: </pre>
<pre id='line2178' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2179")'> 2179: </pre>
<pre id='line2179' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2180")'> 2180:     #TODO: can we use memory views here...</pre>
<pre id='line2180' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2181")'> 2181:     cdef object _raw_target_data</pre>
<pre id='line2181' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2182")'> 2182:     cdef Non_bonded_target_component* _compiled_target_components</pre>
<pre id='line2182' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2183")'> 2183:     cdef int _num_target_components</pre>
<pre id='line2183' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2184")'> 2184: </pre>
<pre id='line2184' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2185")'> 2185: </pre>
<pre id='line2185' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2186")'> 2186:     #TODO: can we use memory views here...</pre>
<pre id='line2186' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2187")'> 2187:     cdef object _raw_remote_data</pre>
<pre id='line2187' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2188")'> 2188:     cdef Non_bonded_remote_atom_component* _compiled_remote_components</pre>
<pre id='line2188' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2189")'> 2189:     cdef int _num_remote_components</pre>
<pre id='line2189' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2190")'> 2190: </pre>
<pre id='line2190' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2191")'> 2191:     cdef object _raw_coefficient_data</pre>
<pre id='line2191' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2192")'> 2192:     cdef Nonbonded_coefficient_component* _compiled_coefficient_components</pre>
<pre id='line2192' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2193")'> 2193:     cdef int _num_coefficient_components</pre>
<pre id='line2193' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2194")'> 2194: </pre>
<pre id='line2194' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2195")'> 2195:     cdef int _component_offset</pre>
<pre id='line2195' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2196")'> 2196: </pre>
<pre id='line2196' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2197")'> 2197:     def __cinit__(self):</pre>
<pre id='line2197' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2197
 *     cdef int _component_offset
 * 
 *     def __cinit__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._non_bonded_list = None
 *         self._compiled_target_components =  NULL
 */

static int __pyx_pf_17shift_calculators_32Fast_non_bonded_force_calculator___cinit__(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2198")'> 2198:         self._non_bonded_list = None</pre>
<pre id='line2198' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":2198
 * 
 *     def __cinit__(self):
 *         self._non_bonded_list = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_target_components =  NULL
 *         self._compiled_remote_components = NULL
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_non_bonded_list);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_non_bonded_list));
  __pyx_v_self->_non_bonded_list = ((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)Py_None);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2199")'> 2199:         self._compiled_target_components =  NULL</pre>
<pre id='line2199' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2199
 *     def __cinit__(self):
 *         self._non_bonded_list = None
 *         self._compiled_target_components =  NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_remote_components = NULL
 *         self._compiled_coefficient_components = NULL
 */
  __pyx_v_self->_compiled_target_components = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2200")'> 2200:         self._compiled_remote_components = NULL</pre>
<pre id='line2200' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2200
 *         self._non_bonded_list = None
 *         self._compiled_target_components =  NULL
 *         self._compiled_remote_components = NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_coefficient_components = NULL
 *         self._component_offset = 0
 */
  __pyx_v_self->_compiled_remote_components = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2201")'> 2201:         self._compiled_coefficient_components = NULL</pre>
<pre id='line2201' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2201
 *         self._compiled_target_components =  NULL
 *         self._compiled_remote_components = NULL
 *         self._compiled_coefficient_components = NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._component_offset = 0
 * 
 */
  __pyx_v_self->_compiled_coefficient_components = NULL;
</pre><pre class='line' style='background-color: #FFFF2e' onclick='toggleDiv("line2202")'> 2202:         self._component_offset = 0</pre>
<pre id='line2202' class='code' style='background-color: #FFFF2e'>
  /* "Cython_shift_calculator.pyx":2202
 *         self._compiled_remote_components = NULL
 *         self._compiled_coefficient_components = NULL
 *         self._component_offset = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __init__(self, bint smoothed, str name):
 */
  __pyx_v_self->_component_offset = 0;

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_32Fast_non_bonded_force_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_32Fast_non_bonded_force_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_smoothed;
  PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__smoothed,&__pyx_n_s__name,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__smoothed)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2204; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2204; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_smoothed = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_smoothed == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2204; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_name = ((PyObject*)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2204; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_non_bonded_force_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&PyString_Type), 1, "name", 1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_32Fast_non_bonded_force_calculator_2__init__(((struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *)__pyx_v_self), __pyx_v_smoothed, __pyx_v_name);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2203")'> 2203: </pre>
<pre id='line2203' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2204")'> 2204:     def __init__(self, bint smoothed, str name):</pre>
<pre id='line2204' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2204
 *         self._component_offset = 0
 * 
 *     def __init__(self, bint smoothed, str name):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         super(Fast_non_bonded_force_calculator, self).__init__(smoothed,name)
 *         global DEFAULT_NB_CUTOFF
 */

static int __pyx_pf_17shift_calculators_32Fast_non_bonded_force_calculator_2__init__(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *__pyx_v_self, int __pyx_v_smoothed, PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFF31' onclick='toggleDiv("line2205")'> 2205:         super(Fast_non_bonded_force_calculator, self).__init__(smoothed,name)</pre>
<pre id='line2205' class='code' style='background-color: #FFFF31'>
  /* "Cython_shift_calculator.pyx":2205
 * 
 *     def __init__(self, bint smoothed, str name):
 *         super(Fast_non_bonded_force_calculator, self).__init__(smoothed,name)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         global DEFAULT_NB_CUTOFF
 *         self._nb_cutoff = DEFAULT_NB_CUTOFF
 */
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Fast_non_bonded_force_calculator)));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Fast_non_bonded_force_calculator)));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Fast_non_bonded_force_calculator)));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_self));
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_super, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s____init__);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(__pyx_v_smoothed);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_name));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, ((PyObject *)__pyx_v_name));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_name));
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2206")'> 2206:         global DEFAULT_NB_CUTOFF</pre>
<pre id='line2206' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2207")'> 2207:         self._nb_cutoff = DEFAULT_NB_CUTOFF</pre>
<pre id='line2207' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2207
 *         super(Fast_non_bonded_force_calculator, self).__init__(smoothed,name)
 *         global DEFAULT_NB_CUTOFF
 *         self._nb_cutoff = DEFAULT_NB_CUTOFF             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components =  <code><</code>Distance_component*>malloc(sizeof(Distance_component))
 * 
 */
  __pyx_v_self->_nb_cutoff = __pyx_v_17shift_calculators_DEFAULT_NB_CUTOFF;
</pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line2208")'> 2208:         self._compiled_components =  &lt;Distance_component*&gt;malloc(sizeof(Distance_component))</pre>
<pre id='line2208' class='code' style='background-color: #FFFF96'>
  /* "Cython_shift_calculator.pyx":2208
 *         global DEFAULT_NB_CUTOFF
 *         self._nb_cutoff = DEFAULT_NB_CUTOFF
 *         self._compiled_components =  <code><</code>Distance_component*>malloc(sizeof(Distance_component))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #     todo free!!
 */
  __pyx_v_self->__pyx_base._compiled_components = ((struct __pyx_t_17shift_calculators_Distance_component *)malloc((sizeof(struct __pyx_t_17shift_calculators_Distance_component))));

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_non_bonded_force_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_32Fast_non_bonded_force_calculator_5set_verbose(PyObject *__pyx_v_self, PyObject *__pyx_v_on); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_32Fast_non_bonded_force_calculator_5set_verbose(PyObject *__pyx_v_self, PyObject *__pyx_v_on) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_verbose (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_32Fast_non_bonded_force_calculator_4set_verbose(((struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_on));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2209")'> 2209: </pre>
<pre id='line2209' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2210")'> 2210: #     todo free!!</pre>
<pre id='line2210' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2211")'> 2211:     def set_verbose(self,on):</pre>
<pre id='line2211' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2211
 * 
 * #     todo free!!
 *     def set_verbose(self,on):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._verbose = on
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_32Fast_non_bonded_force_calculator_4set_verbose(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *__pyx_v_self, PyObject *__pyx_v_on) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("set_verbose", 0);
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line2212")'> 2212:         self._verbose = on</pre>
<pre id='line2212' class='code' style='background-color: #FFFF6a'>
  /* "Cython_shift_calculator.pyx":2212
 * #     todo free!!
 *     def set_verbose(self,on):
 *         self._verbose = on             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     #TODO: use global version
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_v_on);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->__pyx_base.__pyx_base._verbose = __pyx_t_1;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_non_bonded_force_calculator.set_verbose", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2213")'> 2213: </pre>
<pre id='line2213' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2214")'> 2214:     #TODO: use global version</pre>
<pre id='line2214' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2215")'> 2215:     cdef _bytes_to_target_components(self,data):</pre>
<pre id='line2215' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2215
 * 
 *     #TODO: use global version
 *     cdef _bytes_to_target_components(self,data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._raw_target_data =  data
 * 
 */

static PyObject *__pyx_f_17shift_calculators_32Fast_non_bonded_force_calculator__bytes_to_target_components(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *__pyx_v_self, PyObject *__pyx_v_data) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_target_components", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2216")'> 2216:         self._raw_target_data =  data</pre>
<pre id='line2216' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":2216
 *     #TODO: use global version
 *     cdef _bytes_to_target_components(self,data):
 *         self._raw_target_data =  data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._compiled_target_components =  <code><</code>Non_bonded_target_component*> <code><</code>size_t> ctypes.addressof(data)
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_raw_target_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_raw_target_data);
  __pyx_v_self->_raw_target_data = __pyx_v_data;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2217")'> 2217: </pre>
<pre id='line2217' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line2218")'> 2218:         self._compiled_target_components =  &lt;Non_bonded_target_component*&gt; &lt;size_t&gt; ctypes.addressof(data)</pre>
<pre id='line2218' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":2218
 *         self._raw_target_data =  data
 * 
 *         self._compiled_target_components =  <code><</code>Non_bonded_target_component*> <code><</code>size_t> ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_target_components =  len(data)/ sizeof(Non_bonded_target_component)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_self->_compiled_target_components = ((struct __pyx_t_17shift_calculators_Non_bonded_target_component *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line2219")'> 2219:         self._num_target_components =  len(data)/ sizeof(Non_bonded_target_component)</pre>
<pre id='line2219' class='code' style='background-color: #FFFF73'>
  /* "Cython_shift_calculator.pyx":2219
 * 
 *         self._compiled_target_components =  <code><</code>Non_bonded_target_component*> <code><</code>size_t> ctypes.addressof(data)
 *         self._num_target_components =  len(data)/ sizeof(Non_bonded_target_component)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     #TODO: use global version
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_num_target_components = (__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Non_bonded_target_component)));

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_non_bonded_force_calculator._bytes_to_target_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2220")'> 2220: </pre>
<pre id='line2220' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2221")'> 2221:     #TODO: use global version</pre>
<pre id='line2221' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2222")'> 2222:     cdef _bytes_to_remote_components(self,data):</pre>
<pre id='line2222' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2222
 * 
 *     #TODO: use global version
 *     cdef _bytes_to_remote_components(self,data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._raw_remote_data =  data
 * 
 */

static PyObject *__pyx_f_17shift_calculators_32Fast_non_bonded_force_calculator__bytes_to_remote_components(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *__pyx_v_self, PyObject *__pyx_v_data) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_remote_components", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2223")'> 2223:         self._raw_remote_data =  data</pre>
<pre id='line2223' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":2223
 *     #TODO: use global version
 *     cdef _bytes_to_remote_components(self,data):
 *         self._raw_remote_data =  data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._compiled_remote_components =  <code><</code>Non_bonded_remote_atom_component*> <code><</code>size_t> ctypes.addressof(data)
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_raw_remote_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_raw_remote_data);
  __pyx_v_self->_raw_remote_data = __pyx_v_data;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2224")'> 2224: </pre>
<pre id='line2224' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line2225")'> 2225:         self._compiled_remote_components =  &lt;Non_bonded_remote_atom_component*&gt; &lt;size_t&gt; ctypes.addressof(data)</pre>
<pre id='line2225' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":2225
 *         self._raw_remote_data =  data
 * 
 *         self._compiled_remote_components =  <code><</code>Non_bonded_remote_atom_component*> <code><</code>size_t> ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_remote_components =  len(data)/ sizeof(Non_bonded_remote_atom_component)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_self->_compiled_remote_components = ((struct __pyx_t_17shift_calculators_Non_bonded_remote_atom_component *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line2226")'> 2226:         self._num_remote_components =  len(data)/ sizeof(Non_bonded_remote_atom_component)</pre>
<pre id='line2226' class='code' style='background-color: #FFFF73'>
  /* "Cython_shift_calculator.pyx":2226
 * 
 *         self._compiled_remote_components =  <code><</code>Non_bonded_remote_atom_component*> <code><</code>size_t> ctypes.addressof(data)
 *         self._num_remote_components =  len(data)/ sizeof(Non_bonded_remote_atom_component)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef _bytes_to_nonbonded_coefficient_components(self,data):
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_num_remote_components = (__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Non_bonded_remote_atom_component)));

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_non_bonded_force_calculator._bytes_to_remote_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2227")'> 2227: </pre>
<pre id='line2227' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2228")'> 2228:     cdef _bytes_to_nonbonded_coefficient_components(self,data):</pre>
<pre id='line2228' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2228
 *         self._num_remote_components =  len(data)/ sizeof(Non_bonded_remote_atom_component)
 * 
 *     cdef _bytes_to_nonbonded_coefficient_components(self,data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._raw_coefficient_data =  data
 * 
 */

static PyObject *__pyx_f_17shift_calculators_32Fast_non_bonded_force_calculator__bytes_to_nonbonded_coefficient_components(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *__pyx_v_self, PyObject *__pyx_v_data) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_nonbonded_coefficient_components", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2229")'> 2229:         self._raw_coefficient_data =  data</pre>
<pre id='line2229' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":2229
 * 
 *     cdef _bytes_to_nonbonded_coefficient_components(self,data):
 *         self._raw_coefficient_data =  data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._compiled_coefficient_components =  <code><</code>Nonbonded_coefficient_component*> <code><</code>size_t> ctypes.addressof(data)
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_raw_coefficient_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_raw_coefficient_data);
  __pyx_v_self->_raw_coefficient_data = __pyx_v_data;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2230")'> 2230: </pre>
<pre id='line2230' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line2231")'> 2231:         self._compiled_coefficient_components =  &lt;Nonbonded_coefficient_component*&gt; &lt;size_t&gt; ctypes.addressof(data)</pre>
<pre id='line2231' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":2231
 *         self._raw_coefficient_data =  data
 * 
 *         self._compiled_coefficient_components =  <code><</code>Nonbonded_coefficient_component*> <code><</code>size_t> ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_coefficient_components =  len(data)/ sizeof(Nonbonded_coefficient_component)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_self->_compiled_coefficient_components = ((struct __pyx_t_17shift_calculators_Nonbonded_coefficient_component *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line2232")'> 2232:         self._num_coefficient_components =  len(data)/ sizeof(Nonbonded_coefficient_component)</pre>
<pre id='line2232' class='code' style='background-color: #FFFF6e'>
  /* "Cython_shift_calculator.pyx":2232
 * 
 *         self._compiled_coefficient_components =  <code><</code>Nonbonded_coefficient_component*> <code><</code>size_t> ctypes.addressof(data)
 *         self._num_coefficient_components =  len(data)/ sizeof(Nonbonded_coefficient_component)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     #TODO: call super?
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_num_coefficient_components = (__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Nonbonded_coefficient_component)));

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_non_bonded_force_calculator._bytes_to_nonbonded_coefficient_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_32Fast_non_bonded_force_calculator_7_set_components(PyObject *__pyx_v_self, PyObject *__pyx_v_components); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_32Fast_non_bonded_force_calculator_7_set_components(PyObject *__pyx_v_self, PyObject *__pyx_v_components) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_components (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_32Fast_non_bonded_force_calculator_6_set_components(((struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_components));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2233")'> 2233: </pre>
<pre id='line2233' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2234")'> 2234:     #TODO: call super?</pre>
<pre id='line2234' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2235")'> 2235:     def _set_components(self, components):</pre>
<pre id='line2235' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2235
 * 
 *     #TODO: call super?
 *     def _set_components(self, components):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._simulation = <code><</code>Simulation*><code><</code>size_t>int(components['SIMU'].this)
 *         self._non_bonded_list =  components['NBLT']
 */

static PyObject *__pyx_pf_17shift_calculators_32Fast_non_bonded_force_calculator_6_set_components(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *__pyx_v_self, PyObject *__pyx_v_components) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_components", 0);
</pre><pre class='line' style='background-color: #FFFF39' onclick='toggleDiv("line2236")'> 2236:         self._simulation = &lt;Simulation*&gt;&lt;size_t&gt;int(components['SIMU'].this)</pre>
<pre id='line2236' class='code' style='background-color: #FFFF39'>
  /* "Cython_shift_calculator.pyx":2236
 *     #TODO: call super?
 *     def _set_components(self, components):
 *         self._simulation = <code><</code>Simulation*><code><</code>size_t>int(components['SIMU'].this)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._non_bonded_list =  components['NBLT']
 *         self._bytes_to_target_components(components['ATOM'])
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_components, ((PyObject *)__pyx_n_s__SIMU));<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__this);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_self->__pyx_base.__pyx_base._simulation = ((Simulation *)((size_t)__pyx_t_3));
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line2237")'> 2237:         self._non_bonded_list =  components['NBLT']</pre>
<pre id='line2237' class='code' style='background-color: #FFFF8d'>
  /* "Cython_shift_calculator.pyx":2237
 *     def _set_components(self, components):
 *         self._simulation = <code><</code>Simulation*><code><</code>size_t>int(components['SIMU'].this)
 *         self._non_bonded_list =  components['NBLT']             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._bytes_to_target_components(components['ATOM'])
 *         self._bytes_to_remote_components(components['NBRM'])
 */
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_components, ((PyObject *)__pyx_n_s__NBLT));<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2237; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_17shift_calculators_Non_bonded_interaction_list)))))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2237; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_non_bonded_list);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_non_bonded_list));
  __pyx_v_self->_non_bonded_list = ((struct __pyx_obj_17shift_calculators_Non_bonded_interaction_list *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line2238")'> 2238:         self._bytes_to_target_components(components['ATOM'])</pre>
<pre id='line2238' class='code' style='background-color: #FFFF96'>
  /* "Cython_shift_calculator.pyx":2238
 *         self._simulation = <code><</code>Simulation*><code><</code>size_t>int(components['SIMU'].this)
 *         self._non_bonded_list =  components['NBLT']
 *         self._bytes_to_target_components(components['ATOM'])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._bytes_to_remote_components(components['NBRM'])
 *         self._bytes_to_nonbonded_coefficient_components(components['COEF'])
 */
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_components, ((PyObject *)__pyx_n_s__ATOM));<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2238; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_1 = ((struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_force_calculator *)__pyx_v_self->__pyx_base.__pyx_base.__pyx_vtab)->_bytes_to_target_components(__pyx_v_self, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2238; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line2239")'> 2239:         self._bytes_to_remote_components(components['NBRM'])</pre>
<pre id='line2239' class='code' style='background-color: #FFFF96'>
  /* "Cython_shift_calculator.pyx":2239
 *         self._non_bonded_list =  components['NBLT']
 *         self._bytes_to_target_components(components['ATOM'])
 *         self._bytes_to_remote_components(components['NBRM'])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._bytes_to_nonbonded_coefficient_components(components['COEF'])
 *         if 'ACTI' in components:
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_components, ((PyObject *)__pyx_n_s__NBRM));<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = ((struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_force_calculator *)__pyx_v_self->__pyx_base.__pyx_base.__pyx_vtab)->_bytes_to_remote_components(__pyx_v_self, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line2240")'> 2240:         self._bytes_to_nonbonded_coefficient_components(components['COEF'])</pre>
<pre id='line2240' class='code' style='background-color: #FFFF96'>
  /* "Cython_shift_calculator.pyx":2240
 *         self._bytes_to_target_components(components['ATOM'])
 *         self._bytes_to_remote_components(components['NBRM'])
 *         self._bytes_to_nonbonded_coefficient_components(components['COEF'])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if 'ACTI' in components:
 *             self._active_components = components['ACTI']
 */
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_components, ((PyObject *)__pyx_n_s__COEF));<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_1 = ((struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_force_calculator *)__pyx_v_self->__pyx_base.__pyx_base.__pyx_vtab)->_bytes_to_nonbonded_coefficient_components(__pyx_v_self, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line2241")'> 2241:         if 'ACTI' in components:</pre>
<pre id='line2241' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":2241
 *         self._bytes_to_remote_components(components['NBRM'])
 *         self._bytes_to_nonbonded_coefficient_components(components['COEF'])
 *         if 'ACTI' in components:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._active_components = components['ACTI']
 *         self._component_offset = components['OFFS']
 */
  __pyx_t_4 = (__Pyx_<span class='py_c_api'>PySequence_Contains</span>(((PyObject *)__pyx_n_s__ACTI), __pyx_v_components, Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_4 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2241; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line2242")'> 2242:             self._active_components = components['ACTI']</pre>
<pre id='line2242' class='code' style='background-color: #FFFF8d'>
    /* "Cython_shift_calculator.pyx":2242
 *         self._bytes_to_nonbonded_coefficient_components(components['COEF'])
 *         if 'ACTI' in components:
 *             self._active_components = components['ACTI']             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._component_offset = components['OFFS']
 * 
 */
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_components, ((PyObject *)__pyx_n_s__ACTI));<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_1);
    if (unlikely(!__pyx_t_5.memview))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_XDEC_MEMVIEW(&__pyx_v_self->__pyx_base.__pyx_base._active_components, 0);
    __pyx_v_self->__pyx_base.__pyx_base._active_components = __pyx_t_5;
    __pyx_t_5.memview = NULL;
    __pyx_t_5.data = NULL;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line2243")'> 2243:         self._component_offset = components['OFFS']</pre>
<pre id='line2243' class='code' style='background-color: #FFFF4f'>
  /* "Cython_shift_calculator.pyx":2243
 *         if 'ACTI' in components:
 *             self._active_components = components['ACTI']
 *         self._component_offset = components['OFFS']             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline void _set_the_component(self, int target_atom_index,int remote_atom_index, float coefficient,float exponent):
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_components, ((PyObject *)__pyx_n_s__OFFS));<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_6 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_6 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_self->_component_offset = __pyx_t_6;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&__pyx_t_5, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_non_bonded_force_calculator._set_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2244")'> 2244: </pre>
<pre id='line2244' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2245")'> 2245:     cdef inline void _set_the_component(self, int target_atom_index,int remote_atom_index, float coefficient,float exponent):</pre>
<pre id='line2245' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2245
 *         self._component_offset = components['OFFS']
 * 
 *     cdef inline void _set_the_component(self, int target_atom_index,int remote_atom_index, float coefficient,float exponent):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components[0].target_atom =target_atom_index
 *         self._compiled_components[0].remote_atom_1 =target_atom_index
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_32Fast_non_bonded_force_calculator__set_the_component(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *__pyx_v_self, int __pyx_v_target_atom_index, int __pyx_v_remote_atom_index, float __pyx_v_coefficient, float __pyx_v_exponent) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_the_component", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2246")'> 2246:         self._compiled_components[0].target_atom =target_atom_index</pre>
<pre id='line2246' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2246
 * 
 *     cdef inline void _set_the_component(self, int target_atom_index,int remote_atom_index, float coefficient,float exponent):
 *         self._compiled_components[0].target_atom =target_atom_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components[0].remote_atom_1 =target_atom_index
 *         self._compiled_components[0].remote_atom_2 =remote_atom_index
 */
  (__pyx_v_self->__pyx_base._compiled_components[0]).target_atom = __pyx_v_target_atom_index;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2247")'> 2247:         self._compiled_components[0].remote_atom_1 =target_atom_index</pre>
<pre id='line2247' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2247
 *     cdef inline void _set_the_component(self, int target_atom_index,int remote_atom_index, float coefficient,float exponent):
 *         self._compiled_components[0].target_atom =target_atom_index
 *         self._compiled_components[0].remote_atom_1 =target_atom_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components[0].remote_atom_2 =remote_atom_index
 *         self._compiled_components[0].coefficient =coefficient
 */
  (__pyx_v_self->__pyx_base._compiled_components[0]).remote_atom_1 = __pyx_v_target_atom_index;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2248")'> 2248:         self._compiled_components[0].remote_atom_2 =remote_atom_index</pre>
<pre id='line2248' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2248
 *         self._compiled_components[0].target_atom =target_atom_index
 *         self._compiled_components[0].remote_atom_1 =target_atom_index
 *         self._compiled_components[0].remote_atom_2 =remote_atom_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components[0].coefficient =coefficient
 *         self._compiled_components[0].exponent =exponent
 */
  (__pyx_v_self->__pyx_base._compiled_components[0]).remote_atom_2 = __pyx_v_remote_atom_index;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2249")'> 2249:         self._compiled_components[0].coefficient =coefficient</pre>
<pre id='line2249' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2249
 *         self._compiled_components[0].remote_atom_1 =target_atom_index
 *         self._compiled_components[0].remote_atom_2 =remote_atom_index
 *         self._compiled_components[0].coefficient =coefficient             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components[0].exponent =exponent
 * 
 */
  (__pyx_v_self->__pyx_base._compiled_components[0]).coefficient = __pyx_v_coefficient;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line2250")'> 2250:         self._compiled_components[0].exponent =exponent</pre>
<pre id='line2250' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":2250
 *         self._compiled_components[0].remote_atom_2 =remote_atom_index
 *         self._compiled_components[0].coefficient =coefficient
 *         self._compiled_components[0].exponent =exponent             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  (__pyx_v_self->__pyx_base._compiled_components[0]).exponent = __pyx_v_exponent;

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2251")'> 2251: </pre>
<pre id='line2251' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2252")'> 2252: </pre>
<pre id='line2252' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2253")'> 2253: </pre>
<pre id='line2253' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2254")'> 2254:     cdef void _do_calc_components(self, int[:] component_to_result, float[:] force_factors, Out_array force):</pre>
<pre id='line2254' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2254
 * 
 * 
 *     cdef void _do_calc_components(self, int[:] component_to_result, float[:] force_factors, Out_array force):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */

static void __pyx_f_17shift_calculators_32Fast_non_bonded_force_calculator__do_calc_components(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *__pyx_v_self, __Pyx_memviewslice __pyx_v_component_to_result, __Pyx_memviewslice __pyx_v_force_factors, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_force) {
  int __pyx_v_factor_index;
  PyObject *__pyx_v_non_bonded_index = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_do_calc_components", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2255")'> 2255: </pre>
<pre id='line2255' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2256")'> 2256: </pre>
<pre id='line2256' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2257")'> 2257:         cdef int factor_index</pre>
<pre id='line2257' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2258")'> 2258: </pre>
<pre id='line2258' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line2259")'> 2259:         if self._active_components ==  None:</pre>
<pre id='line2259' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":2259
 *         cdef int factor_index
 * 
 *         if self._active_components ==  None:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for factor_index  in range(len(self._non_bonded_list)):
 *                 non_bonded_index  = factor_index
 */
  if (unlikely(!__pyx_v_self->__pyx_base.__pyx_base._active_components.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}}
  __pyx_t_1 = (((PyObject *) __pyx_v_self->__pyx_base.__pyx_base._active_components.memview) == Py_None);
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line2260")'> 2260:             for factor_index  in range(len(self._non_bonded_list)):</pre>
<pre id='line2260' class='code' style='background-color: #FFFF96'>
    /* "Cython_shift_calculator.pyx":2260
 * 
 *         if self._active_components ==  None:
 *             for factor_index  in range(len(self._non_bonded_list)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 non_bonded_index  = factor_index
 *                 self._calc_one_component(factor_index, non_bonded_index, component_to_result, force_factors, force)
 */
    __pyx_t_2 = ((PyObject *)__pyx_v_self->_non_bonded_list);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    for (__pyx_t_4 = 0; __pyx_t_4 <code><</code> __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_factor_index = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line2261")'> 2261:                 non_bonded_index  = factor_index</pre>
<pre id='line2261' class='code' style='background-color: #FFFF9f'>
      /* "Cython_shift_calculator.pyx":2261
 *         if self._active_components ==  None:
 *             for factor_index  in range(len(self._non_bonded_list)):
 *                 non_bonded_index  = factor_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._calc_one_component(factor_index, non_bonded_index, component_to_result, force_factors, force)
 *         else:
 */
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_factor_index);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_non_bonded_index);
      __pyx_v_non_bonded_index = __pyx_t_2;
      __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line2262")'> 2262:                 self._calc_one_component(factor_index, non_bonded_index, component_to_result, force_factors, force)</pre>
<pre id='line2262' class='code' style='background-color: #FFFF7f'>
      /* "Cython_shift_calculator.pyx":2262
 *             for factor_index  in range(len(self._non_bonded_list)):
 *                 non_bonded_index  = factor_index
 *                 self._calc_one_component(factor_index, non_bonded_index, component_to_result, force_factors, force)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             for factor_index  in range(self._active_components.shape[0]):
 */
      __pyx_t_5 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_non_bonded_index);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      ((struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_force_calculator *)__pyx_v_self->__pyx_base.__pyx_base.__pyx_vtab)->_calc_one_component(__pyx_v_self, __pyx_v_factor_index, __pyx_t_5, __pyx_v_component_to_result, __pyx_v_force_factors, __pyx_v_force);
    }
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2263")'> 2263:         else:</pre>
<pre id='line2263' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line2264")'> 2264:             for factor_index  in range(self._active_components.shape[0]):</pre>
<pre id='line2264' class='code' style='background-color: #FFFFaa'>
    /* "Cython_shift_calculator.pyx":2264
 *                 self._calc_one_component(factor_index, non_bonded_index, component_to_result, force_factors, force)
 *         else:
 *             for factor_index  in range(self._active_components.shape[0]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 non_bonded_index = self._active_components[factor_index]
 *                 self._calc_one_component(factor_index, non_bonded_index, component_to_result, force_factors, force)
 */
    if (unlikely(!__pyx_v_self->__pyx_base.__pyx_base._active_components.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}}
    __pyx_t_3 = (__pyx_v_self->__pyx_base.__pyx_base._active_components.shape[0]);
    for (__pyx_t_4 = 0; __pyx_t_4 <code><</code> __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_factor_index = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line2265")'> 2265:                 non_bonded_index = self._active_components[factor_index]</pre>
<pre id='line2265' class='code' style='background-color: #FFFF79'>
      /* "Cython_shift_calculator.pyx":2265
 *         else:
 *             for factor_index  in range(self._active_components.shape[0]):
 *                 non_bonded_index = self._active_components[factor_index]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 self._calc_one_component(factor_index, non_bonded_index, component_to_result, force_factors, force)
 * 
 */
      if (unlikely(!__pyx_v_self->__pyx_base.__pyx_base._active_components.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2265; __pyx_clineno = __LINE__; goto __pyx_L1_error;}}
      __pyx_t_5 = __pyx_v_factor_index;
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>((*((int *) ( /* dim=0 */ (__pyx_v_self->__pyx_base.__pyx_base._active_components.data + __pyx_t_5 * __pyx_v_self->__pyx_base.__pyx_base._active_components.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2265; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_non_bonded_index);
      __pyx_v_non_bonded_index = __pyx_t_2;
      __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line2266")'> 2266:                 self._calc_one_component(factor_index, non_bonded_index, component_to_result, force_factors, force)</pre>
<pre id='line2266' class='code' style='background-color: #FFFF66'>
      /* "Cython_shift_calculator.pyx":2266
 *             for factor_index  in range(self._active_components.shape[0]):
 *                 non_bonded_index = self._active_components[factor_index]
 *                 self._calc_one_component(factor_index, non_bonded_index, component_to_result, force_factors, force)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void _calc_one_component(self, int factor_index, int non_bonded_index, int[:] component_to_result, float[:] force_factors, Out_array force):
 */
      __pyx_t_6 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_non_bonded_index);<span class='error_goto'> if (unlikely((__pyx_t_6 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      ((struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_force_calculator *)__pyx_v_self->__pyx_base.__pyx_base.__pyx_vtab)->_calc_one_component(__pyx_v_self, __pyx_v_factor_index, __pyx_t_6, __pyx_v_component_to_result, __pyx_v_force_factors, __pyx_v_force);
    }
  }
  __pyx_L3:;

  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Fast_non_bonded_force_calculator._do_calc_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_non_bonded_index);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2267")'> 2267: </pre>
<pre id='line2267' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2268")'> 2268:     cdef void _calc_one_component(self, int factor_index, int non_bonded_index, int[:] component_to_result, float[:] force_factors, Out_array force):</pre>
<pre id='line2268' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2268
 *                 self._calc_one_component(factor_index, non_bonded_index, component_to_result, force_factors, force)
 * 
 *     cdef void _calc_one_component(self, int factor_index, int non_bonded_index, int[:] component_to_result, float[:] force_factors, Out_array force):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef double start_time = 0.0
 *         cdef double end_time = 0.0
 */

static void __pyx_f_17shift_calculators_32Fast_non_bonded_force_calculator__calc_one_component(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *__pyx_v_self, CYTHON_UNUSED int __pyx_v_factor_index, int __pyx_v_non_bonded_index, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_component_to_result, __Pyx_memviewslice __pyx_v_force_factors, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_force) {
  CYTHON_UNUSED double __pyx_v_start_time;
  CYTHON_UNUSED double __pyx_v_end_time;
  struct __pyx_t_17shift_calculators_Component_index_pair *__pyx_v_non_bonded_pair;
  int __pyx_v_target_component_index;
  int __pyx_v_remote_component_index;
  int __pyx_v_target_index;
  int __pyx_v_remote_index;
  float __pyx_v_distance;
  int __pyx_v_component_offset;
  long __pyx_v_i;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calc_one_component", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2269")'> 2269:         cdef double start_time = 0.0</pre>
<pre id='line2269' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2269
 * 
 *     cdef void _calc_one_component(self, int factor_index, int non_bonded_index, int[:] component_to_result, float[:] force_factors, Out_array force):
 *         cdef double start_time = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef double end_time = 0.0
 * 
 */
  __pyx_v_start_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2270")'> 2270:         cdef double end_time = 0.0</pre>
<pre id='line2270' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2270
 *     cdef void _calc_one_component(self, int factor_index, int non_bonded_index, int[:] component_to_result, float[:] force_factors, Out_array force):
 *         cdef double start_time = 0.0
 *         cdef double end_time = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Component_index_pair* non_bonded_pair
 */
  __pyx_v_end_time = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2271")'> 2271: </pre>
<pre id='line2271' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2272")'> 2272:         cdef Component_index_pair* non_bonded_pair</pre>
<pre id='line2272' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2273")'> 2273: </pre>
<pre id='line2273' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2274")'> 2274:         cdef int target_component_index</pre>
<pre id='line2274' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2275")'> 2275:         cdef int remote_component_index</pre>
<pre id='line2275' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2276")'> 2276: </pre>
<pre id='line2276' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2277")'> 2277:         cdef int target_index</pre>
<pre id='line2277' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2278")'> 2278:         cdef int remote_index</pre>
<pre id='line2278' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2279")'> 2279: </pre>
<pre id='line2279' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2280")'> 2280:         cdef float distance</pre>
<pre id='line2280' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2281")'> 2281:         non_bonded_pair  =  self._non_bonded_list.get(non_bonded_index)</pre>
<pre id='line2281' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2281
 * 
 *         cdef float distance
 *         non_bonded_pair  =  self._non_bonded_list.get(non_bonded_index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         target_component_index = non_bonded_pair[0].target_index
 */
  __pyx_v_non_bonded_pair = __pyx_f_17shift_calculators_27Non_bonded_interaction_list_get(__pyx_v_self->_non_bonded_list, __pyx_v_non_bonded_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2282")'> 2282: </pre>
<pre id='line2282' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2283")'> 2283:         target_component_index = non_bonded_pair[0].target_index</pre>
<pre id='line2283' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2283
 *         non_bonded_pair  =  self._non_bonded_list.get(non_bonded_index)
 * 
 *         target_component_index = non_bonded_pair[0].target_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         remote_component_index = non_bonded_pair[0].remote_index
 *         component_offset = self._component_offset + non_bonded_pair[0].component_index
 */
  __pyx_t_1 = (__pyx_v_non_bonded_pair[0]).target_index;
  __pyx_v_target_component_index = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2284")'> 2284:         remote_component_index = non_bonded_pair[0].remote_index</pre>
<pre id='line2284' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2284
 * 
 *         target_component_index = non_bonded_pair[0].target_index
 *         remote_component_index = non_bonded_pair[0].remote_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         component_offset = self._component_offset + non_bonded_pair[0].component_index
 * 
 */
  __pyx_t_1 = (__pyx_v_non_bonded_pair[0]).remote_index;
  __pyx_v_remote_component_index = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2285")'> 2285:         component_offset = self._component_offset + non_bonded_pair[0].component_index</pre>
<pre id='line2285' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2285
 *         target_component_index = non_bonded_pair[0].target_index
 *         remote_component_index = non_bonded_pair[0].remote_index
 *         component_offset = self._component_offset + non_bonded_pair[0].component_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         target_index  = self._compiled_target_components[target_component_index].target_atom_id
 */
  __pyx_v_component_offset = (__pyx_v_self->_component_offset + (__pyx_v_non_bonded_pair[0]).component_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2286")'> 2286: </pre>
<pre id='line2286' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2287")'> 2287:         target_index  = self._compiled_target_components[target_component_index].target_atom_id</pre>
<pre id='line2287' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2287
 *         component_offset = self._component_offset + non_bonded_pair[0].component_index
 * 
 *         target_index  = self._compiled_target_components[target_component_index].target_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         remote_index = self._compiled_remote_components[remote_component_index].remote_atom_id
 *         distance = calc_distance_simulation(self._simulation, target_index, remote_index)
 */
  __pyx_t_1 = (__pyx_v_self->_compiled_target_components[__pyx_v_target_component_index]).target_atom_id;
  __pyx_v_target_index = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2288")'> 2288:         remote_index = self._compiled_remote_components[remote_component_index].remote_atom_id</pre>
<pre id='line2288' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2288
 * 
 *         target_index  = self._compiled_target_components[target_component_index].target_atom_id
 *         remote_index = self._compiled_remote_components[remote_component_index].remote_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         distance = calc_distance_simulation(self._simulation, target_index, remote_index)
 *         if distance <code><</code> self._nb_cutoff:
 */
  __pyx_t_1 = (__pyx_v_self->_compiled_remote_components[__pyx_v_remote_component_index]).remote_atom_id;
  __pyx_v_remote_index = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2289")'> 2289:         distance = calc_distance_simulation(self._simulation, target_index, remote_index)</pre>
<pre id='line2289' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2289
 *         target_index  = self._compiled_target_components[target_component_index].target_atom_id
 *         remote_index = self._compiled_remote_components[remote_component_index].remote_atom_id
 *         distance = calc_distance_simulation(self._simulation, target_index, remote_index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if distance <code><</code> self._nb_cutoff:
 *             for i in range(2):
 */
  __pyx_v_distance = __pyx_f_17shift_calculators_calc_distance_simulation(__pyx_v_self->__pyx_base.__pyx_base._simulation, __pyx_v_target_index, __pyx_v_remote_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2290")'> 2290:         if distance &lt; self._nb_cutoff:</pre>
<pre id='line2290' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2290
 *         remote_index = self._compiled_remote_components[remote_component_index].remote_atom_id
 *         distance = calc_distance_simulation(self._simulation, target_index, remote_index)
 *         if distance <code><</code> self._nb_cutoff:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             for i in range(2):
 *                     self._cython_build_component(non_bonded_index, i)
 */
  __pyx_t_2 = (__pyx_v_distance <code><</code> __pyx_v_self->_nb_cutoff);
  if (__pyx_t_2) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2291")'> 2291:             for i in range(2):</pre>
<pre id='line2291' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2291
 *         distance = calc_distance_simulation(self._simulation, target_index, remote_index)
 *         if distance <code><</code> self._nb_cutoff:
 *             for i in range(2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     self._cython_build_component(non_bonded_index, i)
 *                     self._distance_calc_single_force_set(0, force_factors[component_offset] , force)
 */
    for (__pyx_t_3 = 0; __pyx_t_3 <code><</code> 2; __pyx_t_3+=1) {
      __pyx_v_i = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2292")'> 2292:                     self._cython_build_component(non_bonded_index, i)</pre>
<pre id='line2292' class='code' style='background-color: #FFFFff'>
      /* "Cython_shift_calculator.pyx":2292
 *         if distance <code><</code> self._nb_cutoff:
 *             for i in range(2):
 *                     self._cython_build_component(non_bonded_index, i)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     self._distance_calc_single_force_set(0, force_factors[component_offset] , force)
 * 
 */
      ((struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_force_calculator *)__pyx_v_self->__pyx_base.__pyx_base.__pyx_vtab)->_cython_build_component(__pyx_v_self, __pyx_v_non_bonded_index, __pyx_v_i);
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line2293")'> 2293:                     self._distance_calc_single_force_set(0, force_factors[component_offset] , force)</pre>
<pre id='line2293' class='code' style='background-color: #FFFF3b'>
      /* "Cython_shift_calculator.pyx":2293
 *             for i in range(2):
 *                     self._cython_build_component(non_bonded_index, i)
 *                     self._distance_calc_single_force_set(0, force_factors[component_offset] , force)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def  _build_component(self, non_bonded_index, i):
 */
      __pyx_t_1 = __pyx_v_component_offset;
      __pyx_f_17shift_calculators_46Fast_distance_based_potential_force_calculator__distance_calc_single_force_set(((struct __pyx_obj_17shift_calculators_Fast_distance_based_potential_force_calculator *)__pyx_v_self), 0, (*((float *) ( /* dim=0 */ (__pyx_v_force_factors.data + __pyx_t_1 * __pyx_v_force_factors.strides[0]) ))), __pyx_v_force);
    }
    goto __pyx_L3;
  }
  __pyx_L3:;

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_32Fast_non_bonded_force_calculator_9_build_component(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_32Fast_non_bonded_force_calculator_9_build_component(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_non_bonded_index = 0;
  PyObject *__pyx_v_i = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_build_component (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__non_bonded_index,&__pyx_n_s__i,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__non_bonded_index)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__i)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_build_component", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2295; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_build_component") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2295; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_non_bonded_index = values[0];
    __pyx_v_i = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_build_component", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2295; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_non_bonded_force_calculator._build_component", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_32Fast_non_bonded_force_calculator_8_build_component(((struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *)__pyx_v_self), __pyx_v_non_bonded_index, __pyx_v_i);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2294")'> 2294: </pre>
<pre id='line2294' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2295")'> 2295:     def  _build_component(self, non_bonded_index, i):</pre>
<pre id='line2295' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2295
 *                     self._distance_calc_single_force_set(0, force_factors[component_offset] , force)
 * 
 *     def  _build_component(self, non_bonded_index, i):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._cython_build_component(non_bonded_index, i)
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_32Fast_non_bonded_force_calculator_8_build_component(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *__pyx_v_self, PyObject *__pyx_v_non_bonded_index, PyObject *__pyx_v_i) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_build_component", 0);
</pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line2296")'> 2296:         self._cython_build_component(non_bonded_index, i)</pre>
<pre id='line2296' class='code' style='background-color: #FFFF4b'>
  /* "Cython_shift_calculator.pyx":2296
 * 
 *     def  _build_component(self, non_bonded_index, i):
 *         self._cython_build_component(non_bonded_index, i)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void  _cython_build_component(self, int non_bonded_index, int i):
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_non_bonded_index);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2296; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_i);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2296; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  ((struct __pyx_vtabstruct_17shift_calculators_Fast_non_bonded_force_calculator *)__pyx_v_self->__pyx_base.__pyx_base.__pyx_vtab)->_cython_build_component(__pyx_v_self, __pyx_t_1, __pyx_t_2);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_non_bonded_force_calculator._build_component", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2297")'> 2297: </pre>
<pre id='line2297' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2298")'> 2298:     cdef void  _cython_build_component(self, int non_bonded_index, int i):</pre>
<pre id='line2298' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2298
 *         self._cython_build_component(non_bonded_index, i)
 * 
 *     cdef void  _cython_build_component(self, int non_bonded_index, int i):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Component_index_pair* non_bonded_pair
 * 
 */

static void __pyx_f_17shift_calculators_32Fast_non_bonded_force_calculator__cython_build_component(struct __pyx_obj_17shift_calculators_Fast_non_bonded_force_calculator *__pyx_v_self, int __pyx_v_non_bonded_index, int __pyx_v_i) {
  struct __pyx_t_17shift_calculators_Component_index_pair *__pyx_v_non_bonded_pair;
  int __pyx_v_target_component_index;
  int __pyx_v_remote_component_index;
  int __pyx_v_target_index;
  int __pyx_v_remote_index;
  int __pyx_v_chem_type_id;
  CYTHON_UNUSED float __pyx_v_default_smoothing_factor;
  int __pyx_v_atom_1_coefficent_offset;
  float __pyx_v_coefficient;
  float __pyx_v_exponent;
  struct __pyx_t_17shift_calculators_Nonbonded_coefficient_component *__pyx_v_coefficient_component;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_cython_build_component", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2299")'> 2299:         cdef Component_index_pair* non_bonded_pair</pre>
<pre id='line2299' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2300")'> 2300: </pre>
<pre id='line2300' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2301")'> 2301:         cdef int target_component_index</pre>
<pre id='line2301' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2302")'> 2302:         cdef int remote_component_index</pre>
<pre id='line2302' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2303")'> 2303: </pre>
<pre id='line2303' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2304")'> 2304:         cdef int target_index</pre>
<pre id='line2304' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2305")'> 2305:         cdef int remote_index</pre>
<pre id='line2305' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2306")'> 2306: </pre>
<pre id='line2306' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2307")'> 2307:         cdef float distance</pre>
<pre id='line2307' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2308")'> 2308: </pre>
<pre id='line2308' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2309")'> 2309:         cdef int chem_type_id</pre>
<pre id='line2309' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2310")'> 2310: </pre>
<pre id='line2310' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2311")'> 2311:         cdef float default_smoothing_factor = self._smoothing_factor</pre>
<pre id='line2311' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2311
 *         cdef int chem_type_id
 * 
 *         cdef float default_smoothing_factor = self._smoothing_factor             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef float smoothing_factor
 * 
 */
  __pyx_t_1 = __pyx_v_self->__pyx_base._smoothing_factor;
  __pyx_v_default_smoothing_factor = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2312")'> 2312:         cdef float smoothing_factor</pre>
<pre id='line2312' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2313")'> 2313: </pre>
<pre id='line2313' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2314")'> 2314:         cdef float ratio</pre>
<pre id='line2314' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2315")'> 2315: </pre>
<pre id='line2315' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2316")'> 2316: </pre>
<pre id='line2316' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2317")'> 2317:         cdef int atom_1_coefficent_offset</pre>
<pre id='line2317' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2318")'> 2318: </pre>
<pre id='line2318' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2319")'> 2319:         cdef float coefficient,exponent</pre>
<pre id='line2319' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2320")'> 2320: </pre>
<pre id='line2320' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2321")'> 2321:         cdef Nonbonded_coefficient_component* coefficent_component</pre>
<pre id='line2321' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2322")'> 2322:         cdef bint result</pre>
<pre id='line2322' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2323")'> 2323: </pre>
<pre id='line2323' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2324")'> 2324:         non_bonded_pair  =  self._non_bonded_list.get(non_bonded_index)</pre>
<pre id='line2324' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2324
 *         cdef bint result
 * 
 *         non_bonded_pair  =  self._non_bonded_list.get(non_bonded_index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         target_component_index = non_bonded_pair[0].target_index
 */
  __pyx_v_non_bonded_pair = __pyx_f_17shift_calculators_27Non_bonded_interaction_list_get(__pyx_v_self->_non_bonded_list, __pyx_v_non_bonded_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2325")'> 2325: </pre>
<pre id='line2325' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2326")'> 2326:         target_component_index = non_bonded_pair[0].target_index</pre>
<pre id='line2326' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2326
 *         non_bonded_pair  =  self._non_bonded_list.get(non_bonded_index)
 * 
 *         target_component_index = non_bonded_pair[0].target_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         remote_component_index = non_bonded_pair[0].remote_index
 * 
 */
  __pyx_t_2 = (__pyx_v_non_bonded_pair[0]).target_index;
  __pyx_v_target_component_index = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2327")'> 2327:         remote_component_index = non_bonded_pair[0].remote_index</pre>
<pre id='line2327' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2327
 * 
 *         target_component_index = non_bonded_pair[0].target_index
 *         remote_component_index = non_bonded_pair[0].remote_index             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         target_index  = self._compiled_target_components[target_component_index].target_atom_id
 */
  __pyx_t_2 = (__pyx_v_non_bonded_pair[0]).remote_index;
  __pyx_v_remote_component_index = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2328")'> 2328: </pre>
<pre id='line2328' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2329")'> 2329:         target_index  = self._compiled_target_components[target_component_index].target_atom_id</pre>
<pre id='line2329' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2329
 *         remote_component_index = non_bonded_pair[0].remote_index
 * 
 *         target_index  = self._compiled_target_components[target_component_index].target_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         remote_index = self._compiled_remote_components[remote_component_index].remote_atom_id
 *         atom_1_coefficent_offset = self._compiled_target_components[target_component_index].atom_type_id
 */
  __pyx_t_2 = (__pyx_v_self->_compiled_target_components[__pyx_v_target_component_index]).target_atom_id;
  __pyx_v_target_index = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2330")'> 2330:         remote_index = self._compiled_remote_components[remote_component_index].remote_atom_id</pre>
<pre id='line2330' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2330
 * 
 *         target_index  = self._compiled_target_components[target_component_index].target_atom_id
 *         remote_index = self._compiled_remote_components[remote_component_index].remote_atom_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         atom_1_coefficent_offset = self._compiled_target_components[target_component_index].atom_type_id
 * 
 */
  __pyx_t_2 = (__pyx_v_self->_compiled_remote_components[__pyx_v_remote_component_index]).remote_atom_id;
  __pyx_v_remote_index = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2331")'> 2331:         atom_1_coefficent_offset = self._compiled_target_components[target_component_index].atom_type_id</pre>
<pre id='line2331' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2331
 *         target_index  = self._compiled_target_components[target_component_index].target_atom_id
 *         remote_index = self._compiled_remote_components[remote_component_index].remote_atom_id
 *         atom_1_coefficent_offset = self._compiled_target_components[target_component_index].atom_type_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         chem_type_id = self._compiled_remote_components[remote_component_index].chem_type[i]
 */
  __pyx_t_2 = (__pyx_v_self->_compiled_target_components[__pyx_v_target_component_index]).atom_type_id;
  __pyx_v_atom_1_coefficent_offset = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2332")'> 2332: </pre>
<pre id='line2332' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2333")'> 2333:         chem_type_id = self._compiled_remote_components[remote_component_index].chem_type[i]</pre>
<pre id='line2333' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2333
 *         atom_1_coefficent_offset = self._compiled_target_components[target_component_index].atom_type_id
 * 
 *         chem_type_id = self._compiled_remote_components[remote_component_index].chem_type[i]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         coefficient_component = &self._compiled_coefficient_components[chem_type_id]
 */
  __pyx_v_chem_type_id = ((__pyx_v_self->_compiled_remote_components[__pyx_v_remote_component_index]).chem_type[__pyx_v_i]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2334")'> 2334: </pre>
<pre id='line2334' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2335")'> 2335:         coefficient_component = &amp;self._compiled_coefficient_components[chem_type_id]</pre>
<pre id='line2335' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2335
 *         chem_type_id = self._compiled_remote_components[remote_component_index].chem_type[i]
 * 
 *         coefficient_component = &self._compiled_coefficient_components[chem_type_id]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         exponent = coefficient_component[0].exponent
 */
  __pyx_v_coefficient_component = (&(__pyx_v_self->_compiled_coefficient_components[__pyx_v_chem_type_id]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2336")'> 2336: </pre>
<pre id='line2336' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2337")'> 2337:         exponent = coefficient_component[0].exponent</pre>
<pre id='line2337' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2337
 *         coefficient_component = &self._compiled_coefficient_components[chem_type_id]
 * 
 *         exponent = coefficient_component[0].exponent             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         coefficient  = coefficient_component[0].coefficients[atom_1_coefficent_offset]
 */
  __pyx_t_1 = (__pyx_v_coefficient_component[0]).exponent;
  __pyx_v_exponent = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2338")'> 2338: </pre>
<pre id='line2338' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2339")'> 2339:         coefficient  = coefficient_component[0].coefficients[atom_1_coefficent_offset]</pre>
<pre id='line2339' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2339
 *         exponent = coefficient_component[0].exponent
 * 
 *         coefficient  = coefficient_component[0].coefficients[atom_1_coefficent_offset]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._set_the_component(target_index,remote_index,coefficient,exponent)
 */
  __pyx_v_coefficient = ((__pyx_v_coefficient_component[0]).coefficients[__pyx_v_atom_1_coefficent_offset]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2340")'> 2340: </pre>
<pre id='line2340' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2341")'> 2341:         self._set_the_component(target_index,remote_index,coefficient,exponent)</pre>
<pre id='line2341' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":2341
 *         coefficient  = coefficient_component[0].coefficients[atom_1_coefficent_offset]
 * 
 *         self._set_the_component(target_index,remote_index,coefficient,exponent)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_f_17shift_calculators_32Fast_non_bonded_force_calculator__set_the_component(__pyx_v_self, __pyx_v_target_index, __pyx_v_remote_index, __pyx_v_coefficient, __pyx_v_exponent);

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_30Fast_dihedral_force_calculator_1_bytes_to_components(PyObject *__pyx_v_self, PyObject *__pyx_v_data); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_30Fast_dihedral_force_calculator_1_bytes_to_components(PyObject *__pyx_v_self, PyObject *__pyx_v_data) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_components (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_30Fast_dihedral_force_calculator__bytes_to_components(((struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_data));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2342")'> 2342: </pre>
<pre id='line2342' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2343")'> 2343: </pre>
<pre id='line2343' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2344")'> 2344: </pre>
<pre id='line2344' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2345")'> 2345: cdef class Fast_dihedral_force_calculator(Base_force_calculator):</pre>
<pre id='line2345' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2345
 * 
 * 
 * cdef class Fast_dihedral_force_calculator(Base_force_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef Dihedral_component* _compiled_components
 */
struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator {
  struct __pyx_obj_17shift_calculators_Base_force_calculator __pyx_base;
  struct __pyx_t_17shift_calculators_Dihedral_component *_compiled_components;
  int _num_components;
  PyObject *raw_data;
};


/* "Cython_shift_calculator.pyx":2345
 * 
 * 
 * cdef class Fast_dihedral_force_calculator(Base_force_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef Dihedral_component* _compiled_components
 */

struct __pyx_vtabstruct_17shift_calculators_Fast_dihedral_force_calculator {
  struct __pyx_vtabstruct_17shift_calculators_Base_force_calculator __pyx_base;
  struct __pyx_t_17shift_calculators_dihedral_ids (*_get_dihedral_atom_ids)(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *, int);
  struct __pyx_t_17shift_calculators_dihedral_parameters (*_get_parameters)(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *, int);
  float (*_get_coefficient)(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *, int);
  float (*_cython_calc_single_force_factor)(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *, int);
  void (*_dihedral_calc_single_force_set)(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *, int, float, struct __pyx_obj_17shift_calculators_Out_array *);
};
static struct __pyx_vtabstruct_17shift_calculators_Fast_dihedral_force_calculator *__pyx_vtabptr_17shift_calculators_Fast_dihedral_force_calculator;
static CYTHON_INLINE struct __pyx_t_17shift_calculators_dihedral_ids __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__get_dihedral_atom_ids(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *, int);
static CYTHON_INLINE struct __pyx_t_17shift_calculators_dihedral_parameters __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__get_parameters(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *, int);
static CYTHON_INLINE float __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__get_coefficient(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *, int);
static CYTHON_INLINE float __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__cython_calc_single_force_factor(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *, int);
static CYTHON_INLINE void __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__dihedral_calc_single_force_set(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *, int, float, struct __pyx_obj_17shift_calculators_Out_array *);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2346")'> 2346: </pre>
<pre id='line2346' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2347")'> 2347:     cdef Dihedral_component* _compiled_components</pre>
<pre id='line2347' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2348")'> 2348:     cdef int _num_components</pre>
<pre id='line2348' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2349")'> 2349:     cdef object raw_data</pre>
<pre id='line2349' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2350")'> 2350: </pre>
<pre id='line2350' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2351")'> 2351:     def _bytes_to_components(self, data):</pre>
<pre id='line2351' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2351
 *     cdef object raw_data
 * 
 *     def _bytes_to_components(self, data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.raw_data =  data
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_30Fast_dihedral_force_calculator__bytes_to_components(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *__pyx_v_self, PyObject *__pyx_v_data) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_components", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2352")'> 2352:         self.raw_data =  data</pre>
<pre id='line2352' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":2352
 * 
 *     def _bytes_to_components(self, data):
 *         self.raw_data =  data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._compiled_components =  <code><</code>Dihedral_component*> <code><</code>size_t> ctypes.addressof(data)
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->raw_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->raw_data);
  __pyx_v_self->raw_data = __pyx_v_data;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2353")'> 2353: </pre>
<pre id='line2353' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line2354")'> 2354:         self._compiled_components =  &lt;Dihedral_component*&gt; &lt;size_t&gt; ctypes.addressof(data)</pre>
<pre id='line2354' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":2354
 *         self.raw_data =  data
 * 
 *         self._compiled_components =  <code><</code>Dihedral_component*> <code><</code>size_t> ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components =  len(data)/ sizeof(Dihedral_component)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_self->_compiled_components = ((struct __pyx_t_17shift_calculators_Dihedral_component *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line2355")'> 2355:         self._num_components =  len(data)/ sizeof(Dihedral_component)</pre>
<pre id='line2355' class='code' style='background-color: #FFFF4b'>
  /* "Cython_shift_calculator.pyx":2355
 * 
 *         self._compiled_components =  <code><</code>Dihedral_component*> <code><</code>size_t> ctypes.addressof(data)
 *         self._num_components =  len(data)/ sizeof(Dihedral_component)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2355; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_num_components = (__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Dihedral_component)));

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_dihedral_force_calculator._bytes_to_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_30Fast_dihedral_force_calculator_3__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_30Fast_dihedral_force_calculator_3__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) > 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) > 0) && unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__cinit__", 0))) return -1;
  __pyx_r = __pyx_pf_17shift_calculators_30Fast_dihedral_force_calculator_2__cinit__(((struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2356")'> 2356: </pre>
<pre id='line2356' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2357")'> 2357: </pre>
<pre id='line2357' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2358")'> 2358:     def __cinit__(self):</pre>
<pre id='line2358' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2358
 * 
 * 
 *     def __cinit__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components = NULL
 *         self._num_components = 0
 */

static int __pyx_pf_17shift_calculators_30Fast_dihedral_force_calculator_2__cinit__(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2359")'> 2359:         self._compiled_components = NULL</pre>
<pre id='line2359' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2359
 * 
 *     def __cinit__(self):
 *         self._compiled_components = NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components = 0
 * 
 */
  __pyx_v_self->_compiled_components = NULL;
</pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line2360")'> 2360:         self._num_components = 0</pre>
<pre id='line2360' class='code' style='background-color: #FFFF4b'>
  /* "Cython_shift_calculator.pyx":2360
 *     def __cinit__(self):
 *         self._compiled_components = NULL
 *         self._num_components = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __init__(self,name="not set"):
 */
  __pyx_v_self->_num_components = 0;

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_30Fast_dihedral_force_calculator_5__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_30Fast_dihedral_force_calculator_5__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__name,0};
    PyObject* values[1] = {0};
    values[0] = ((PyObject *)__pyx_kp_s_30);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2362; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_name = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 0, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2362; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_dihedral_force_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_30Fast_dihedral_force_calculator_4__init__(((struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *)__pyx_v_self), __pyx_v_name);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2361")'> 2361: </pre>
<pre id='line2361' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2362")'> 2362:     def __init__(self,name="not set"):</pre>
<pre id='line2362' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2362
 *         self._num_components = 0
 * 
 *     def __init__(self,name="not set"):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         Base_force_calculator.__init__(self,name=name)
 *         self.raw_data =  None
 */

static int __pyx_pf_17shift_calculators_30Fast_dihedral_force_calculator_4__init__(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *__pyx_v_self, PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line2363")'> 2363:         Base_force_calculator.__init__(self,name=name)</pre>
<pre id='line2363' class='code' style='background-color: #FFFF3e'>
  /* "Cython_shift_calculator.pyx":2363
 * 
 *     def __init__(self,name="not set"):
 *         Base_force_calculator.__init__(self,name=name)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.raw_data =  None
 * 
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Base_force_calculator)), __pyx_n_s____init__);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_self));
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, ((PyObject *)__pyx_n_s__name), __pyx_v_name) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), ((PyObject *)__pyx_t_3));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF86' onclick='toggleDiv("line2364")'> 2364:         self.raw_data =  None</pre>
<pre id='line2364' class='code' style='background-color: #FFFF86'>
  /* "Cython_shift_calculator.pyx":2364
 *     def __init__(self,name="not set"):
 *         Base_force_calculator.__init__(self,name=name)
 *         self.raw_data =  None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->raw_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->raw_data);
  __pyx_v_self->raw_data = Py_None;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_dihedral_force_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2365")'> 2365: </pre>
<pre id='line2365' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2366")'> 2366: </pre>
<pre id='line2366' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2367")'> 2367: </pre>
<pre id='line2367' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2368")'> 2368: #     TODO: remove this is no longer needed</pre>
<pre id='line2368' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2369")'> 2369:     @cython.profile(False)</pre>
<pre id='line2369' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2370")'> 2370:     cdef inline dihedral_ids _get_dihedral_atom_ids(self, int index):</pre>
<pre id='line2370' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2370
 * #     TODO: remove this is no longer needed
 *     @cython.profile(False)
 *     cdef inline dihedral_ids _get_dihedral_atom_ids(self, int index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef dihedral_ids result
 * 
 */

static CYTHON_INLINE struct __pyx_t_17shift_calculators_dihedral_ids __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__get_dihedral_atom_ids(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *__pyx_v_self, int __pyx_v_index) {
  struct __pyx_t_17shift_calculators_dihedral_ids __pyx_v_result;
  struct __pyx_t_17shift_calculators_dihedral_ids __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_get_dihedral_atom_ids", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2371")'> 2371:         cdef dihedral_ids result</pre>
<pre id='line2371' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2372")'> 2372: </pre>
<pre id='line2372' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2373")'> 2373:         result.atom_id_1 = self._compiled_components[index].dihedral_atoms[0]</pre>
<pre id='line2373' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2373
 *         cdef dihedral_ids result
 * 
 *         result.atom_id_1 = self._compiled_components[index].dihedral_atoms[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.atom_id_2 = self._compiled_components[index].dihedral_atoms[1]
 *         result.atom_id_3 = self._compiled_components[index].dihedral_atoms[2]
 */
  __pyx_v_result.atom_id_1 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).dihedral_atoms[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2374")'> 2374:         result.atom_id_2 = self._compiled_components[index].dihedral_atoms[1]</pre>
<pre id='line2374' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2374
 * 
 *         result.atom_id_1 = self._compiled_components[index].dihedral_atoms[0]
 *         result.atom_id_2 = self._compiled_components[index].dihedral_atoms[1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.atom_id_3 = self._compiled_components[index].dihedral_atoms[2]
 *         result.atom_id_4 = self._compiled_components[index].dihedral_atoms[3]
 */
  __pyx_v_result.atom_id_2 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).dihedral_atoms[1]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2375")'> 2375:         result.atom_id_3 = self._compiled_components[index].dihedral_atoms[2]</pre>
<pre id='line2375' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2375
 *         result.atom_id_1 = self._compiled_components[index].dihedral_atoms[0]
 *         result.atom_id_2 = self._compiled_components[index].dihedral_atoms[1]
 *         result.atom_id_3 = self._compiled_components[index].dihedral_atoms[2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.atom_id_4 = self._compiled_components[index].dihedral_atoms[3]
 * 
 */
  __pyx_v_result.atom_id_3 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).dihedral_atoms[2]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2376")'> 2376:         result.atom_id_4 = self._compiled_components[index].dihedral_atoms[3]</pre>
<pre id='line2376' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2376
 *         result.atom_id_2 = self._compiled_components[index].dihedral_atoms[1]
 *         result.atom_id_3 = self._compiled_components[index].dihedral_atoms[2]
 *         result.atom_id_4 = self._compiled_components[index].dihedral_atoms[3]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         return result
 */
  __pyx_v_result.atom_id_4 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).dihedral_atoms[3]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2377")'> 2377: </pre>
<pre id='line2377' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line2378")'> 2378:         return result</pre>
<pre id='line2378' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":2378
 *         result.atom_id_4 = self._compiled_components[index].dihedral_atoms[3]
 * 
 *         return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     #TODO: remove this an correct order of parameters!
 */
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;

  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2379")'> 2379: </pre>
<pre id='line2379' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2380")'> 2380:     #TODO: remove this an correct order of parameters!</pre>
<pre id='line2380' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2381")'> 2381:     @cython.profile(False)</pre>
<pre id='line2381' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2382")'> 2382:     cdef inline dihedral_parameters _get_parameters(self, int index):</pre>
<pre id='line2382' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2382
 *     #TODO: remove this an correct order of parameters!
 *     @cython.profile(False)
 *     cdef inline dihedral_parameters _get_parameters(self, int index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef dihedral_parameters result
 */

static CYTHON_INLINE struct __pyx_t_17shift_calculators_dihedral_parameters __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__get_parameters(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *__pyx_v_self, int __pyx_v_index) {
  struct __pyx_t_17shift_calculators_dihedral_parameters __pyx_v_result;
  struct __pyx_t_17shift_calculators_dihedral_parameters __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_get_parameters", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2383")'> 2383: </pre>
<pre id='line2383' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2384")'> 2384:         cdef dihedral_parameters result</pre>
<pre id='line2384' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2385")'> 2385: </pre>
<pre id='line2385' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2386")'> 2386:         result.param_0 = self._compiled_components[index].parameters[0]</pre>
<pre id='line2386' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2386
 *         cdef dihedral_parameters result
 * 
 *         result.param_0 = self._compiled_components[index].parameters[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.param_1 = self._compiled_components[index].parameters[3]
 *         result.param_2 = self._compiled_components[index].parameters[1]
 */
  __pyx_v_result.param_0 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).parameters[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2387")'> 2387:         result.param_1 = self._compiled_components[index].parameters[3]</pre>
<pre id='line2387' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2387
 * 
 *         result.param_0 = self._compiled_components[index].parameters[0]
 *         result.param_1 = self._compiled_components[index].parameters[3]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.param_2 = self._compiled_components[index].parameters[1]
 *         result.param_3 = self._compiled_components[index].parameters[4]
 */
  __pyx_v_result.param_1 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).parameters[3]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2388")'> 2388:         result.param_2 = self._compiled_components[index].parameters[1]</pre>
<pre id='line2388' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2388
 *         result.param_0 = self._compiled_components[index].parameters[0]
 *         result.param_1 = self._compiled_components[index].parameters[3]
 *         result.param_2 = self._compiled_components[index].parameters[1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.param_3 = self._compiled_components[index].parameters[4]
 *         result.param_4 = self._compiled_components[index].parameters[2]
 */
  __pyx_v_result.param_2 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).parameters[1]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2389")'> 2389:         result.param_3 = self._compiled_components[index].parameters[4]</pre>
<pre id='line2389' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2389
 *         result.param_1 = self._compiled_components[index].parameters[3]
 *         result.param_2 = self._compiled_components[index].parameters[1]
 *         result.param_3 = self._compiled_components[index].parameters[4]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.param_4 = self._compiled_components[index].parameters[2]
 * 
 */
  __pyx_v_result.param_3 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).parameters[4]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2390")'> 2390:         result.param_4 = self._compiled_components[index].parameters[2]</pre>
<pre id='line2390' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2390
 *         result.param_2 = self._compiled_components[index].parameters[1]
 *         result.param_3 = self._compiled_components[index].parameters[4]
 *         result.param_4 = self._compiled_components[index].parameters[2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_result.param_4 = ((__pyx_v_self->_compiled_components[__pyx_v_index]).parameters[2]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2391")'> 2391: </pre>
<pre id='line2391' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2392")'> 2392: </pre>
<pre id='line2392' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2393")'> 2393: </pre>
<pre id='line2393' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2394")'> 2394: </pre>
<pre id='line2394' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line2395")'> 2395:         return result</pre>
<pre id='line2395' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":2395
 * 
 * 
 *         return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     @cython.profile(False)
 */
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;

  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2396")'> 2396: </pre>
<pre id='line2396' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2397")'> 2397:     @cython.profile(False)</pre>
<pre id='line2397' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2398")'> 2398:     cdef inline float _get_coefficient(self, int index):</pre>
<pre id='line2398' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2398
 * 
 *     @cython.profile(False)
 *     cdef inline float _get_coefficient(self, int index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._compiled_components[index].coefficient
 * 
 */

static CYTHON_INLINE float __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__get_coefficient(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *__pyx_v_self, int __pyx_v_index) {
  float __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_get_coefficient", 0);
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line2399")'> 2399:         return self._compiled_components[index].coefficient</pre>
<pre id='line2399' class='code' style='background-color: #FFFF66'>
  /* "Cython_shift_calculator.pyx":2399
 *     @cython.profile(False)
 *     cdef inline float _get_coefficient(self, int index):
 *         return self._compiled_components[index].coefficient             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #    TODO make this consistent with the distance forces factor
 */
  __pyx_r = (__pyx_v_self->_compiled_components[__pyx_v_index]).coefficient;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_30Fast_dihedral_force_calculator_7_calc_single_force_factor(PyObject *__pyx_v_self, PyObject *__pyx_arg_index); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_30Fast_dihedral_force_calculator_7_calc_single_force_factor(PyObject *__pyx_v_self, PyObject *__pyx_arg_index) {
  int __pyx_v_index;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calc_single_force_factor (wrapper)", 0);
  assert(__pyx_arg_index); {
    __pyx_v_index = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_arg_index);<span class='error_goto'> if (unlikely((__pyx_v_index == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2402; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_dihedral_force_calculator._calc_single_force_factor", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_30Fast_dihedral_force_calculator_6_calc_single_force_factor(((struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *)__pyx_v_self), ((int)__pyx_v_index));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2400")'> 2400: </pre>
<pre id='line2400' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2401")'> 2401: #    TODO make this consistent with the distance forces factor</pre>
<pre id='line2401' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2402")'> 2402:     def _calc_single_force_factor(self, int index):</pre>
<pre id='line2402' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2402
 * 
 * #    TODO make this consistent with the distance forces factor
 *     def _calc_single_force_factor(self, int index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return self._cython_calc_single_force_factor(index)
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_30Fast_dihedral_force_calculator_6_calc_single_force_factor(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *__pyx_v_self, int __pyx_v_index) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calc_single_force_factor", 0);
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line2403")'> 2403:         return self._cython_calc_single_force_factor(index)</pre>
<pre id='line2403' class='code' style='background-color: #FFFF79'>
  /* "Cython_shift_calculator.pyx":2403
 * #    TODO make this consistent with the distance forces factor
 *     def _calc_single_force_factor(self, int index):
 *         return self._cython_calc_single_force_factor(index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void _do_calc_components(self, int[:] component_to_result, float[:] force_factors, Out_array force):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__cython_calc_single_force_factor(__pyx_v_self, __pyx_v_index));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2403; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_dihedral_force_calculator._calc_single_force_factor", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2404")'> 2404: </pre>
<pre id='line2404' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2405")'> 2405:     cdef void _do_calc_components(self, int[:] component_to_result, float[:] force_factors, Out_array force):</pre>
<pre id='line2405' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2405
 *         return self._cython_calc_single_force_factor(index)
 * 
 *     cdef void _do_calc_components(self, int[:] component_to_result, float[:] force_factors, Out_array force):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int factor_index
 *         cdef int component_index
 */

static void __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__do_calc_components(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *__pyx_v_self, __Pyx_memviewslice __pyx_v_component_to_result, __Pyx_memviewslice __pyx_v_force_factors, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_force) {
  int __pyx_v_factor_index;
  int __pyx_v_component_index;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_do_calc_components", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2406")'> 2406:         cdef int factor_index</pre>
<pre id='line2406' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2407")'> 2407:         cdef int component_index</pre>
<pre id='line2407' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2408")'> 2408: </pre>
<pre id='line2408' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line2409")'> 2409:         for factor_index in range(len(self._active_components)):</pre>
<pre id='line2409' class='code' style='background-color: #FFFF79'>
  /* "Cython_shift_calculator.pyx":2409
 *         cdef int component_index
 * 
 *         for factor_index in range(len(self._active_components)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             component_index = self._active_components[factor_index]
 *             self._dihedral_calc_single_force_set(component_index,force_factors[component_to_result[factor_index]],force)
 */
  if (unlikely(!__pyx_v_self->__pyx_base._active_components.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2409; __pyx_clineno = __LINE__; goto __pyx_L1_error;}}
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->__pyx_base._active_components, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2409; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2409; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (__pyx_t_3 = 0; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_factor_index = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line2410")'> 2410:             component_index = self._active_components[factor_index]</pre>
<pre id='line2410' class='code' style='background-color: #FFFFaa'>
    /* "Cython_shift_calculator.pyx":2410
 * 
 *         for factor_index in range(len(self._active_components)):
 *             component_index = self._active_components[factor_index]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._dihedral_calc_single_force_set(component_index,force_factors[component_to_result[factor_index]],force)
 * 
 */
    if (unlikely(!__pyx_v_self->__pyx_base._active_components.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}}
    __pyx_t_4 = __pyx_v_factor_index;
    __pyx_v_component_index = (*((int *) ( /* dim=0 */ (__pyx_v_self->__pyx_base._active_components.data + __pyx_t_4 * __pyx_v_self->__pyx_base._active_components.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line2411")'> 2411:             self._dihedral_calc_single_force_set(component_index,force_factors[component_to_result[factor_index]],force)</pre>
<pre id='line2411' class='code' style='background-color: #FFFFb6'>
    /* "Cython_shift_calculator.pyx":2411
 *         for factor_index in range(len(self._active_components)):
 *             component_index = self._active_components[factor_index]
 *             self._dihedral_calc_single_force_set(component_index,force_factors[component_to_result[factor_index]],force)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
    __pyx_t_5 = __pyx_v_factor_index;
    __pyx_t_6 = (*((int *) ( /* dim=0 */ (__pyx_v_component_to_result.data + __pyx_t_5 * __pyx_v_component_to_result.strides[0]) )));
    __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__dihedral_calc_single_force_set(__pyx_v_self, __pyx_v_component_index, (*((float *) ( /* dim=0 */ (__pyx_v_force_factors.data + __pyx_t_6 * __pyx_v_force_factors.strides[0]) ))), __pyx_v_force);
  }

  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Fast_dihedral_force_calculator._do_calc_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2412")'> 2412: </pre>
<pre id='line2412' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2413")'> 2413: </pre>
<pre id='line2413' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2414")'> 2414: </pre>
<pre id='line2414' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2415")'> 2415:     cdef inline float _cython_calc_single_force_factor(self, int index):</pre>
<pre id='line2415' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2415
 * 
 * 
 *     cdef inline float _cython_calc_single_force_factor(self, int index):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef dihedral_ids dihedral_atom_ids
 */

static CYTHON_INLINE float __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__cython_calc_single_force_factor(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *__pyx_v_self, int __pyx_v_index) {
  struct __pyx_t_17shift_calculators_dihedral_ids __pyx_v_dihedral_atom_ids;
  struct __pyx_t_17shift_calculators_dihedral_parameters __pyx_v_params;
  float __pyx_v_angle;
  float __pyx_v_result;
  float __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_cython_calc_single_force_factor", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2416")'> 2416: </pre>
<pre id='line2416' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2417")'> 2417:         cdef dihedral_ids dihedral_atom_ids</pre>
<pre id='line2417' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2418")'> 2418:         cdef dihedral_parameters params</pre>
<pre id='line2418' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2419")'> 2419: </pre>
<pre id='line2419' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2420")'> 2420:         cdef float angle,result</pre>
<pre id='line2420' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2421")'> 2421: </pre>
<pre id='line2421' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2422")'> 2422: </pre>
<pre id='line2422' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2423")'> 2423:         dihedral_atom_ids  = dihedral_atom_ids= self._get_dihedral_atom_ids(index)</pre>
<pre id='line2423' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2423
 * 
 * 
 *         dihedral_atom_ids  = dihedral_atom_ids= self._get_dihedral_atom_ids(index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         params = self._get_parameters(index)
 */
  __pyx_t_1 = __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__get_dihedral_atom_ids(__pyx_v_self, __pyx_v_index);
  __pyx_v_dihedral_atom_ids = __pyx_t_1;
  __pyx_v_dihedral_atom_ids = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2424")'> 2424: </pre>
<pre id='line2424' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2425")'> 2425:         params = self._get_parameters(index)</pre>
<pre id='line2425' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2425
 *         dihedral_atom_ids  = dihedral_atom_ids= self._get_dihedral_atom_ids(index)
 * 
 *         params = self._get_parameters(index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         angle = calc_dihedral_angle_simulation(self._simulation, dihedral_atom_ids)
 */
  __pyx_v_params = __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__get_parameters(__pyx_v_self, __pyx_v_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2426")'> 2426: </pre>
<pre id='line2426' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2427")'> 2427:         angle = calc_dihedral_angle_simulation(self._simulation, dihedral_atom_ids)</pre>
<pre id='line2427' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2427
 *         params = self._get_parameters(index)
 * 
 *         angle = calc_dihedral_angle_simulation(self._simulation, dihedral_atom_ids)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         result = -3.0 * params.param_0 * sin(3.0 * angle + params.param_1) - \
 */
  __pyx_v_angle = __pyx_f_17shift_calculators_calc_dihedral_angle_simulation(__pyx_v_self->__pyx_base._simulation, __pyx_v_dihedral_atom_ids);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2428")'> 2428: </pre>
<pre id='line2428' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2429")'> 2429:         result = -3.0 * params.param_0 * sin(3.0 * angle + params.param_1) - \</pre>
<pre id='line2429' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2430")'> 2430:                         params.param_2 * sin(angle + params.param_3)</pre>
<pre id='line2430' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2430
 * 
 *         result = -3.0 * params.param_0 * sin(3.0 * angle + params.param_1) - \
 *                         params.param_2 * sin(angle + params.param_3)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return result
 * 
 */
  __pyx_v_result = (((-3.0 * __pyx_v_params.param_0) * sin(((3.0 * __pyx_v_angle) + __pyx_v_params.param_1))) - (__pyx_v_params.param_2 * sin((__pyx_v_angle + __pyx_v_params.param_3))));
</pre><pre class='line' style='background-color: #FFFF22' onclick='toggleDiv("line2431")'> 2431:         return result</pre>
<pre id='line2431' class='code' style='background-color: #FFFF22'>
  /* "Cython_shift_calculator.pyx":2431
 *         result = -3.0 * params.param_0 * sin(3.0 * angle + params.param_1) - \
 *                         params.param_2 * sin(angle + params.param_3)
 *         return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_30Fast_dihedral_force_calculator_9_calc_single_force_set(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_30Fast_dihedral_force_calculator_9_calc_single_force_set(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_index;
  float __pyx_v_factor;
  struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calc_single_force_set (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__index,&__pyx_n_s__factor,&__pyx_n_s__forces,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__index)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__factor)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calc_single_force_set", 1, 3, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2435; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__forces)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calc_single_force_set", 1, 3, 3, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2435; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_calc_single_force_set") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2435; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_index = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_index == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2435; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_factor = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_factor == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2435; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_forces = ((struct __pyx_obj_17shift_calculators_Out_array *)values[2]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calc_single_force_set", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2435; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_dihedral_force_calculator._calc_single_force_set", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_forces), __pyx_ptype_17shift_calculators_Out_array, 1, "forces", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2435; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_30Fast_dihedral_force_calculator_8_calc_single_force_set(((struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *)__pyx_v_self), __pyx_v_index, __pyx_v_factor, __pyx_v_forces);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2432")'> 2432: </pre>
<pre id='line2432' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2433")'> 2433: </pre>
<pre id='line2433' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2434")'> 2434: </pre>
<pre id='line2434' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2435")'> 2435:     def _calc_single_force_set(self, int index, float factor, Out_array forces):</pre>
<pre id='line2435' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2435
 * 
 * 
 *     def _calc_single_force_set(self, int index, float factor, Out_array forces):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         #TODO tidy this up a hack for the test suite
 *         cdef Dihedral_component* saved_component_list = self._compiled_components
 */

static PyObject *__pyx_pf_17shift_calculators_30Fast_dihedral_force_calculator_8_calc_single_force_set(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *__pyx_v_self, int __pyx_v_index, float __pyx_v_factor, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces) {
  struct __pyx_t_17shift_calculators_Dihedral_component *__pyx_v_saved_component_list;
  int __pyx_v_saved_num_components;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calc_single_force_set", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2436")'> 2436:         #TODO tidy this up a hack for the test suite</pre>
<pre id='line2436' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2437")'> 2437:         cdef Dihedral_component* saved_component_list = self._compiled_components</pre>
<pre id='line2437' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2437
 *     def _calc_single_force_set(self, int index, float factor, Out_array forces):
 *         #TODO tidy this up a hack for the test suite
 *         cdef Dihedral_component* saved_component_list = self._compiled_components             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int saved_num_components = self._num_components
 * 
 */
  __pyx_t_1 = __pyx_v_self->_compiled_components;
  __pyx_v_saved_component_list = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2438")'> 2438:         cdef int saved_num_components = self._num_components</pre>
<pre id='line2438' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2438
 *         #TODO tidy this up a hack for the test suite
 *         cdef Dihedral_component* saved_component_list = self._compiled_components
 *         cdef int saved_num_components = self._num_components             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._num_components  = 1
 */
  __pyx_t_2 = __pyx_v_self->_num_components;
  __pyx_v_saved_num_components = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2439")'> 2439: </pre>
<pre id='line2439' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2440")'> 2440:         self._num_components  = 1</pre>
<pre id='line2440' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2440
 *         cdef int saved_num_components = self._num_components
 * 
 *         self._num_components  = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components = &saved_component_list[index]
 * 
 */
  __pyx_v_self->_num_components = 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2441")'> 2441:         self._compiled_components = &amp;saved_component_list[index]</pre>
<pre id='line2441' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2441
 * 
 *         self._num_components  = 1
 *         self._compiled_components = &saved_component_list[index]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._dihedral_calc_single_force_set(0,factor,forces)
 */
  __pyx_v_self->_compiled_components = (&(__pyx_v_saved_component_list[__pyx_v_index]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2442")'> 2442: </pre>
<pre id='line2442' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2443")'> 2443:         self._dihedral_calc_single_force_set(0,factor,forces)</pre>
<pre id='line2443' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2443
 *         self._compiled_components = &saved_component_list[index]
 * 
 *         self._dihedral_calc_single_force_set(0,factor,forces)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._compiled_components = saved_component_list
 */
  __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__dihedral_calc_single_force_set(__pyx_v_self, 0, __pyx_v_factor, __pyx_v_forces);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2444")'> 2444: </pre>
<pre id='line2444' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2445")'> 2445:         self._compiled_components = saved_component_list</pre>
<pre id='line2445' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2445
 *         self._dihedral_calc_single_force_set(0,factor,forces)
 * 
 *         self._compiled_components = saved_component_list             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components = saved_num_components
 * 
 */
  __pyx_v_self->_compiled_components = __pyx_v_saved_component_list;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2446")'> 2446:         self._num_components = saved_num_components</pre>
<pre id='line2446' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":2446
 * 
 *         self._compiled_components = saved_component_list
 *         self._num_components = saved_num_components             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_self->_num_components = __pyx_v_saved_num_components;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2447")'> 2447: </pre>
<pre id='line2447' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2448")'> 2448: </pre>
<pre id='line2448' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2449")'> 2449:     cdef inline void _dihedral_calc_single_force_set(self, int index, float factor, Out_array forces):</pre>
<pre id='line2449' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2449
 * 
 * 
 *     cdef inline void _dihedral_calc_single_force_set(self, int index, float factor, Out_array forces):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3 r1, r2, r4, temp
 *         cdef Vec3 n1, n2
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__dihedral_calc_single_force_set(struct __pyx_obj_17shift_calculators_Fast_dihedral_force_calculator *__pyx_v_self, int __pyx_v_index, float __pyx_v_factor, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces) {
  Vec3 __pyx_v_r1;
  Vec3 __pyx_v_r2;
  Vec3 __pyx_v_r4;
  Vec3 __pyx_v_n1;
  Vec3 __pyx_v_n2;
  float __pyx_v_weight;
  float __pyx_v_factor_1;
  float __pyx_v_factor_2;
  float __pyx_v_factor_3;
  Vec3 __pyx_v_F2;
  Vec3 __pyx_v_F3;
  float __pyx_v_dihedral_factor;
  struct __pyx_t_17shift_calculators_dihedral_ids __pyx_v_atom_ids;
  float __pyx_v_r2_length;
  float __pyx_v_r2_length_2;
  Vec3 __pyx_v_v1;
  Vec3 __pyx_v_v2;
  Vec3 __pyx_v_v3;
  Vec3 __pyx_v_v4;
  Vec3 __pyx_v_r3;
  Vec3 __pyx_v_F1;
  Vec3 __pyx_v_F4;
  Vec3 __pyx_v_T1;
  Vec3 __pyx_v_T2;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_dihedral_calc_single_force_set", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2450")'> 2450:         cdef Vec3 r1, r2, r4, temp</pre>
<pre id='line2450' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2451")'> 2451:         cdef Vec3 n1, n2</pre>
<pre id='line2451' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2452")'> 2452:         cdef float weight</pre>
<pre id='line2452' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2453")'> 2453:         cdef float factor_1, factor_2, factor_3</pre>
<pre id='line2453' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2454")'> 2454:         cdef Vec3 F2, F3,</pre>
<pre id='line2454' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2455")'> 2455:         cdef Vec3 T3, T4</pre>
<pre id='line2455' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2456")'> 2456: </pre>
<pre id='line2456' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2457")'> 2457:         cdef float dihedral_factor = self._cython_calc_single_force_factor(index)</pre>
<pre id='line2457' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2457
 *         cdef Vec3 T3, T4
 * 
 *         cdef float dihedral_factor = self._cython_calc_single_force_factor(index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef dihedral_ids atom_ids = self._get_dihedral_atom_ids(index)
 * 
 */
  __pyx_v_dihedral_factor = __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__cython_calc_single_force_factor(__pyx_v_self, __pyx_v_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2458")'> 2458:         cdef dihedral_ids atom_ids = self._get_dihedral_atom_ids(index)</pre>
<pre id='line2458' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2458
 * 
 *         cdef float dihedral_factor = self._cython_calc_single_force_factor(index)
 *         cdef dihedral_ids atom_ids = self._get_dihedral_atom_ids(index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef float r2_length, r2_length_2
 */
  __pyx_v_atom_ids = __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__get_dihedral_atom_ids(__pyx_v_self, __pyx_v_index);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2459")'> 2459: </pre>
<pre id='line2459' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2460")'> 2460:         cdef float r2_length, r2_length_2</pre>
<pre id='line2460' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2461")'> 2461: </pre>
<pre id='line2461' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2462")'> 2462:         v1 = self._simulation[0].atomPos(atom_ids.atom_id_1)</pre>
<pre id='line2462' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2462
 *         cdef float r2_length, r2_length_2
 * 
 *         v1 = self._simulation[0].atomPos(atom_ids.atom_id_1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         v2 = self._simulation[0].atomPos(atom_ids.atom_id_2)
 *         v3 = self._simulation[0].atomPos(atom_ids.atom_id_3)
 */
  __pyx_v_v1 = (__pyx_v_self->__pyx_base._simulation[0]).atomPos(__pyx_v_atom_ids.atom_id_1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2463")'> 2463:         v2 = self._simulation[0].atomPos(atom_ids.atom_id_2)</pre>
<pre id='line2463' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2463
 * 
 *         v1 = self._simulation[0].atomPos(atom_ids.atom_id_1)
 *         v2 = self._simulation[0].atomPos(atom_ids.atom_id_2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         v3 = self._simulation[0].atomPos(atom_ids.atom_id_3)
 *         v4 = self._simulation[0].atomPos(atom_ids.atom_id_4)
 */
  __pyx_v_v2 = (__pyx_v_self->__pyx_base._simulation[0]).atomPos(__pyx_v_atom_ids.atom_id_2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2464")'> 2464:         v3 = self._simulation[0].atomPos(atom_ids.atom_id_3)</pre>
<pre id='line2464' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2464
 *         v1 = self._simulation[0].atomPos(atom_ids.atom_id_1)
 *         v2 = self._simulation[0].atomPos(atom_ids.atom_id_2)
 *         v3 = self._simulation[0].atomPos(atom_ids.atom_id_3)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         v4 = self._simulation[0].atomPos(atom_ids.atom_id_4)
 * 
 */
  __pyx_v_v3 = (__pyx_v_self->__pyx_base._simulation[0]).atomPos(__pyx_v_atom_ids.atom_id_3);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2465")'> 2465:         v4 = self._simulation[0].atomPos(atom_ids.atom_id_4)</pre>
<pre id='line2465' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2465
 *         v2 = self._simulation[0].atomPos(atom_ids.atom_id_2)
 *         v3 = self._simulation[0].atomPos(atom_ids.atom_id_3)
 *         v4 = self._simulation[0].atomPos(atom_ids.atom_id_4)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         r1 = v1 - v2
 */
  __pyx_v_v4 = (__pyx_v_self->__pyx_base._simulation[0]).atomPos(__pyx_v_atom_ids.atom_id_4);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2466")'> 2466: </pre>
<pre id='line2466' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2467")'> 2467:         r1 = v1 - v2</pre>
<pre id='line2467' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2467
 *         v4 = self._simulation[0].atomPos(atom_ids.atom_id_4)
 * 
 *         r1 = v1 - v2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         r2 = v3 - v2
 * 
 */
  __pyx_v_r1 = (__pyx_v_v1 - __pyx_v_v2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2468")'> 2468:         r2 = v3 - v2</pre>
<pre id='line2468' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2468
 * 
 *         r1 = v1 - v2
 *         r2 = v3 - v2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Vec3 r3 = r2
 */
  __pyx_v_r2 = (__pyx_v_v3 - __pyx_v_v2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2469")'> 2469: </pre>
<pre id='line2469' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2470")'> 2470:         cdef Vec3 r3 = r2</pre>
<pre id='line2470' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2470
 *         r2 = v3 - v2
 * 
 *         cdef Vec3 r3 = r2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(r3, -1)
 * 
 */
  __pyx_v_r3 = __pyx_v_r2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2471")'> 2471:         operator_times(r3, -1)</pre>
<pre id='line2471' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2471
 * 
 *         cdef Vec3 r3 = r2
 *         operator_times(r3, -1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         r4 = v4 - v3
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_r3, -1.0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2472")'> 2472: </pre>
<pre id='line2472' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2473")'> 2473:         r4 = v4 - v3</pre>
<pre id='line2473' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2473
 *         operator_times(r3, -1)
 * 
 *         r4 = v4 - v3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #        print vec3_as_tuple(r1), vec3_as_tuple(r2), vec3_as_tuple(r3), vec3_as_tuple(r4)
 */
  __pyx_v_r4 = (__pyx_v_v4 - __pyx_v_v3);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2474")'> 2474: </pre>
<pre id='line2474' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2475")'> 2475: #        print vec3_as_tuple(r1), vec3_as_tuple(r2), vec3_as_tuple(r3), vec3_as_tuple(r4)</pre>
<pre id='line2475' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2476")'> 2476: </pre>
<pre id='line2476' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2477")'> 2477:         # compute normal vector to plane containing v1, v2, and v3</pre>
<pre id='line2477' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2478")'> 2478:         n1 = cross(r1, r2)</pre>
<pre id='line2478' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2478
 * 
 *         # compute normal vector to plane containing v1, v2, and v3
 *         n1 = cross(r1, r2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         # compute normal vector to plane containing v2, v3, and v4
 *         n2 = cross(r3, r4)
 */
  __pyx_v_n1 = cross(__pyx_v_r1, __pyx_v_r2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2479")'> 2479:         # compute normal vector to plane containing v2, v3, and v4</pre>
<pre id='line2479' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2480")'> 2480:         n2 = cross(r3, r4)</pre>
<pre id='line2480' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2480
 *         n1 = cross(r1, r2)
 *         # compute normal vector to plane containing v2, v3, and v4
 *         n2 = cross(r3, r4)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         r2_length = calc_distance_simulation(self._simulation, atom_ids.atom_id_2,atom_ids.atom_id_3)
 */
  __pyx_v_n2 = cross(__pyx_v_r3, __pyx_v_r4);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2481")'> 2481: </pre>
<pre id='line2481' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2482")'> 2482:         r2_length = calc_distance_simulation(self._simulation, atom_ids.atom_id_2,atom_ids.atom_id_3)</pre>
<pre id='line2482' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2482
 *         n2 = cross(r3, r4)
 * 
 *         r2_length = calc_distance_simulation(self._simulation, atom_ids.atom_id_2,atom_ids.atom_id_3)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         r2_length_2 = r2_length*r2_length
 * 
 */
  __pyx_v_r2_length = __pyx_f_17shift_calculators_calc_distance_simulation(__pyx_v_self->__pyx_base._simulation, __pyx_v_atom_ids.atom_id_2, __pyx_v_atom_ids.atom_id_3);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2483")'> 2483:         r2_length_2 = r2_length*r2_length</pre>
<pre id='line2483' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2483
 * 
 *         r2_length = calc_distance_simulation(self._simulation, atom_ids.atom_id_2,atom_ids.atom_id_3)
 *         r2_length_2 = r2_length*r2_length             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_r2_length_2 = (__pyx_v_r2_length * __pyx_v_r2_length);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2484")'> 2484: </pre>
<pre id='line2484' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2485")'> 2485: </pre>
<pre id='line2485' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2486")'> 2486:         weight = factor * self._get_coefficient(index)</pre>
<pre id='line2486' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2486
 * 
 * 
 *         weight = factor * self._get_coefficient(index)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_v_weight = (__pyx_v_factor * __pyx_f_17shift_calculators_30Fast_dihedral_force_calculator__get_coefficient(__pyx_v_self, __pyx_v_index));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2487")'> 2487: </pre>
<pre id='line2487' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2488")'> 2488: </pre>
<pre id='line2488' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2489")'> 2489: </pre>
<pre id='line2489' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2490")'> 2490: #        // force calculation according to Bekker, Berendsen and van Gunsteren (1995),</pre>
<pre id='line2490' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2491")'> 2491: #        // Journal of Computational Chemistry 16, pp. 527-533:</pre>
<pre id='line2491' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2492")'> 2492: ##        // Force and virial of torsional-angle-dependent potentials.</pre>
<pre id='line2492' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2493")'> 2493:         factor_1 = dihedral_factor * r2_length</pre>
<pre id='line2493' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2493
 * #        // Journal of Computational Chemistry 16, pp. 527-533:
 * ##        // Force and virial of torsional-angle-dependent potentials.
 *         factor_1 = dihedral_factor * r2_length             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Vec3 F1 = n1
 */
  __pyx_v_factor_1 = (__pyx_v_dihedral_factor * __pyx_v_r2_length);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2494")'> 2494: </pre>
<pre id='line2494' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2495")'> 2495:         cdef Vec3 F1 = n1</pre>
<pre id='line2495' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2495
 *         factor_1 = dihedral_factor * r2_length
 * 
 *         cdef Vec3 F1 = n1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(F1, (-factor_1 / norm(n1)**2))
 * 
 */
  __pyx_v_F1 = __pyx_v_n1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2496")'> 2496:         operator_times(F1, (-factor_1 / norm(n1)**2))</pre>
<pre id='line2496' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2496
 * 
 *         cdef Vec3 F1 = n1
 *         operator_times(F1, (-factor_1 / norm(n1)**2))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Vec3 F4 = n2
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_F1, ((-__pyx_v_factor_1) / powf(norm(__pyx_v_n1), 2.0)));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2497")'> 2497: </pre>
<pre id='line2497' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2498")'> 2498:         cdef Vec3 F4 = n2</pre>
<pre id='line2498' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2498
 *         operator_times(F1, (-factor_1 / norm(n1)**2))
 * 
 *         cdef Vec3 F4 = n2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(F4, ( factor_1 / norm(n2)**2))
 * 
 */
  __pyx_v_F4 = __pyx_v_n2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2499")'> 2499:         operator_times(F4, ( factor_1 / norm(n2)**2))</pre>
<pre id='line2499' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2499
 * 
 *         cdef Vec3 F4 = n2
 *         operator_times(F4, ( factor_1 / norm(n2)**2))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         factor_2 = dot(r1, r2) / r2_length_2
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_F4, (__pyx_v_factor_1 / powf(norm(__pyx_v_n2), 2.0)));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2500")'> 2500: </pre>
<pre id='line2500' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2501")'> 2501:         factor_2 = dot(r1, r2) / r2_length_2</pre>
<pre id='line2501' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2501
 *         operator_times(F4, ( factor_1 / norm(n2)**2))
 * 
 *         factor_2 = dot(r1, r2) / r2_length_2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         factor_3 = dot(r3, r4) / r2_length_2
 * 
 */
  __pyx_v_factor_2 = (dot(__pyx_v_r1, __pyx_v_r2) / __pyx_v_r2_length_2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2502")'> 2502:         factor_3 = dot(r3, r4) / r2_length_2</pre>
<pre id='line2502' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2502
 * 
 *         factor_2 = dot(r1, r2) / r2_length_2
 *         factor_3 = dot(r3, r4) / r2_length_2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Vec3 T1 = F1
 */
  __pyx_v_factor_3 = (dot(__pyx_v_r3, __pyx_v_r4) / __pyx_v_r2_length_2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2503")'> 2503: </pre>
<pre id='line2503' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2504")'> 2504:         cdef Vec3 T1 = F1</pre>
<pre id='line2504' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2504
 *         factor_3 = dot(r3, r4) / r2_length_2
 * 
 *         cdef Vec3 T1 = F1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(T1,  (factor_2-1))
 * 
 */
  __pyx_v_T1 = __pyx_v_F1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2505")'> 2505:         operator_times(T1,  (factor_2-1))</pre>
<pre id='line2505' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2505
 * 
 *         cdef Vec3 T1 = F1
 *         operator_times(T1,  (factor_2-1))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Vec3 T2 = F4
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_T1, (__pyx_v_factor_2 - 1.0));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2506")'> 2506: </pre>
<pre id='line2506' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2507")'> 2507:         cdef Vec3 T2 = F4</pre>
<pre id='line2507' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2507
 *         operator_times(T1,  (factor_2-1))
 * 
 *         cdef Vec3 T2 = F4             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(T2,  -factor_3)
 * 
 */
  __pyx_v_T2 = __pyx_v_F4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2508")'> 2508:         operator_times(T2,  -factor_3)</pre>
<pre id='line2508' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2508
 * 
 *         cdef Vec3 T2 = F4
 *         operator_times(T2,  -factor_3)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         F2 = T1 + T2
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_T2, (-__pyx_v_factor_3));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2509")'> 2509: </pre>
<pre id='line2509' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2510")'> 2510:         F2 = T1 + T2</pre>
<pre id='line2510' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2510
 *         operator_times(T2,  -factor_3)
 * 
 *         F2 = T1 + T2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         T1 = F1
 */
  __pyx_v_F2 = (__pyx_v_T1 + __pyx_v_T2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2511")'> 2511: </pre>
<pre id='line2511' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2512")'> 2512:         T1 = F1</pre>
<pre id='line2512' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2512
 *         F2 = T1 + T2
 * 
 *         T1 = F1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(T1,  -factor_2)
 * 
 */
  __pyx_v_T1 = __pyx_v_F1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2513")'> 2513:         operator_times(T1,  -factor_2)</pre>
<pre id='line2513' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2513
 * 
 *         T1 = F1
 *         operator_times(T1,  -factor_2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         T2 = F4
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_T1, (-__pyx_v_factor_2));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2514")'> 2514: </pre>
<pre id='line2514' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2515")'> 2515:         T2 = F4</pre>
<pre id='line2515' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2515
 *         operator_times(T1,  -factor_2)
 * 
 *         T2 = F4             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(T2, (factor_3 -1))
 * 
 */
  __pyx_v_T2 = __pyx_v_F4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2516")'> 2516:         operator_times(T2, (factor_3 -1))</pre>
<pre id='line2516' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2516
 * 
 *         T2 = F4
 *         operator_times(T2, (factor_3 -1))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         F3 = T1 + T2
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_T2, (__pyx_v_factor_3 - 1.0));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2517")'> 2517: </pre>
<pre id='line2517' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2518")'> 2518:         F3 = T1 + T2</pre>
<pre id='line2518' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2518
 *         operator_times(T2, (factor_3 -1))
 * 
 *         F3 = T1 + T2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #        print vec3_as_tuple(F1), vec3_as_tuple(F2), vec3_as_tuple(F3), vec3_as_tuple(F4)
 */
  __pyx_v_F3 = (__pyx_v_T1 + __pyx_v_T2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2519")'> 2519: </pre>
<pre id='line2519' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2520")'> 2520: #        print vec3_as_tuple(F1), vec3_as_tuple(F2), vec3_as_tuple(F3), vec3_as_tuple(F4)</pre>
<pre id='line2520' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2521")'> 2521: #        // assign forces</pre>
<pre id='line2521' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2522")'> 2522: #        force_triplet_1 = self._get_or_make_target_force_triplet(forces, atom_ids.atom_id_1)</pre>
<pre id='line2522' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2523")'> 2523: #        force_triplet_2 = self._get_or_make_target_force_triplet(forces, atom_ids.atom_id_2)</pre>
<pre id='line2523' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2524")'> 2524: #        force_triplet_3 = self._get_or_make_target_force_triplet(forces, atom_ids.atom_id_3)</pre>
<pre id='line2524' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2525")'> 2525: #        force_triplet_4 = self._get_or_make_target_force_triplet(forces, atom_ids.atom_id_4)</pre>
<pre id='line2525' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2526")'> 2526: </pre>
<pre id='line2526' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2527")'> 2527:         operator_times(F1, weight)</pre>
<pre id='line2527' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2527
 * #        force_triplet_4 = self._get_or_make_target_force_triplet(forces, atom_ids.atom_id_4)
 * 
 *         operator_times(F1, weight)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(F2, weight)
 *         operator_times(F3, weight)
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_F1, __pyx_v_weight);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2528")'> 2528:         operator_times(F2, weight)</pre>
<pre id='line2528' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2528
 * 
 *         operator_times(F1, weight)
 *         operator_times(F2, weight)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(F3, weight)
 *         operator_times(F4, weight)
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_F2, __pyx_v_weight);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2529")'> 2529:         operator_times(F3, weight)</pre>
<pre id='line2529' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2529
 *         operator_times(F1, weight)
 *         operator_times(F2, weight)
 *         operator_times(F3, weight)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(F4, weight)
 * 
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_F3, __pyx_v_weight);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2530")'> 2530:         operator_times(F4, weight)</pre>
<pre id='line2530' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2530
 *         operator_times(F2, weight)
 *         operator_times(F3, weight)
 *         operator_times(F4, weight)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         forces.add(atom_ids.atom_id_1,F1)
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_F4, __pyx_v_weight);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2531")'> 2531: </pre>
<pre id='line2531' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2532")'> 2532:         forces.add(atom_ids.atom_id_1,F1)</pre>
<pre id='line2532' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2532
 *         operator_times(F4, weight)
 * 
 *         forces.add(atom_ids.atom_id_1,F1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         forces.add(atom_ids.atom_id_2,F2)
 *         forces.add(atom_ids.atom_id_3,F3)
 */
  __pyx_f_17shift_calculators_9Out_array_add(__pyx_v_forces, __pyx_v_atom_ids.atom_id_1, __pyx_v_F1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2533")'> 2533:         forces.add(atom_ids.atom_id_2,F2)</pre>
<pre id='line2533' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2533
 * 
 *         forces.add(atom_ids.atom_id_1,F1)
 *         forces.add(atom_ids.atom_id_2,F2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         forces.add(atom_ids.atom_id_3,F3)
 *         forces.add(atom_ids.atom_id_4,F4)
 */
  __pyx_f_17shift_calculators_9Out_array_add(__pyx_v_forces, __pyx_v_atom_ids.atom_id_2, __pyx_v_F2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2534")'> 2534:         forces.add(atom_ids.atom_id_3,F3)</pre>
<pre id='line2534' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2534
 *         forces.add(atom_ids.atom_id_1,F1)
 *         forces.add(atom_ids.atom_id_2,F2)
 *         forces.add(atom_ids.atom_id_3,F3)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         forces.add(atom_ids.atom_id_4,F4)
 * 
 */
  __pyx_f_17shift_calculators_9Out_array_add(__pyx_v_forces, __pyx_v_atom_ids.atom_id_3, __pyx_v_F3);
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line2535")'> 2535:         forces.add(atom_ids.atom_id_4,F4)</pre>
<pre id='line2535' class='code' style='background-color: #FFFF6e'>
  /* "Cython_shift_calculator.pyx":2535
 *         forces.add(atom_ids.atom_id_2,F2)
 *         forces.add(atom_ids.atom_id_3,F3)
 *         forces.add(atom_ids.atom_id_4,F4)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_f_17shift_calculators_9Out_array_add(__pyx_v_forces, __pyx_v_atom_ids.atom_id_4, __pyx_v_F4);

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_26Fast_ring_force_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_26Fast_ring_force_calculator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) > 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) > 0) && unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__cinit__", 0))) return -1;
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_force_calculator___cinit__(((struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *)__pyx_v_self));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2536")'> 2536: </pre>
<pre id='line2536' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2537")'> 2537: </pre>
<pre id='line2537' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2538")'> 2538: cdef struct Ring_target_component:</pre>
<pre id='line2538' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2538
 * 
 * 
 * cdef struct Ring_target_component:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *       int target_atom_id
 *       int atom_type_id
 */
struct __pyx_t_17shift_calculators_Ring_target_component {
  int target_atom_id;
  int atom_type_id;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2539")'> 2539:       int target_atom_id</pre>
<pre id='line2539' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2540")'> 2540:       int atom_type_id</pre>
<pre id='line2540' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2541")'> 2541: </pre>
<pre id='line2541' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2542")'> 2542: cdef struct Ring_component:</pre>
<pre id='line2542' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2542
 *       int atom_type_id
 * 
 * cdef struct Ring_component:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     int ring_id
 *     int num_atoms
 */
struct __pyx_t_17shift_calculators_Ring_component {
  int ring_id;
  int num_atoms;
  int atom_ids[6];
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2543")'> 2543:     int ring_id</pre>
<pre id='line2543' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2544")'> 2544:     int num_atoms</pre>
<pre id='line2544' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2545")'> 2545:     int[6] atom_ids</pre>
<pre id='line2545' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2546")'> 2546: </pre>
<pre id='line2546' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2547")'> 2547: #cdef int RING_ATOM_IDS = 1</pre>
<pre id='line2547' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2548")'> 2548: cdef class Fast_ring_force_calculator(Base_force_calculator):</pre>
<pre id='line2548' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2548
 * 
 * #cdef int RING_ATOM_IDS = 1
 * cdef class Fast_ring_force_calculator(Base_force_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator {
  struct __pyx_obj_17shift_calculators_Base_force_calculator __pyx_base;
  struct __pyx_obj_17shift_calculators_Vec3_list *_centre_cache;
  struct __pyx_obj_17shift_calculators_Vec3_list *_normal_cache;
  struct __pyx_t_17shift_calculators_Ring_target_component *_compiled_components;
  int _num_components;
  struct __pyx_t_17shift_calculators_Ring_component *_compiled_ring_components;
  int _num_ring_components;
  PyObject *_raw_ring_component_data;
  PyObject *raw_data;
  struct __pyx_obj_17shift_calculators_Coef_components *_compiled_coef_components;
};


/* "Cython_shift_calculator.pyx":2548
 * 
 * #cdef int RING_ATOM_IDS = 1
 * cdef class Fast_ring_force_calculator(Base_force_calculator):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */

struct __pyx_vtabstruct_17shift_calculators_Fast_ring_force_calculator {
  struct __pyx_vtabstruct_17shift_calculators_Base_force_calculator __pyx_base;
  void (*_bytes_to_ring_components)(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *, PyObject *);
  Vec3 *(*_get_ring_normal)(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *, int);
  Vec3 *(*_get_ring_centre)(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *, int);
  void (*_ring_calc_single_force_set)(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *, int, float, struct __pyx_obj_17shift_calculators_Out_array *);
  void (*_calculate_single_ring_forces)(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *, int, int, struct __pyx_t_17shift_calculators_Coef_component *, float, struct __pyx_obj_17shift_calculators_Out_array *);
  void (*_build_cython_force_terms)(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *, int, int, struct __pyx_t_17shift_calculators_Ring_force_sub_terms &);
  void (*_cython_calc_target_atom_forces)(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *, int, float, struct __pyx_t_17shift_calculators_Ring_force_sub_terms &, struct __pyx_obj_17shift_calculators_Out_array *);
  void (*_cython_calculate_ring_forces)(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *, int, int, float, struct __pyx_t_17shift_calculators_Ring_force_sub_terms, struct __pyx_obj_17shift_calculators_Out_array *);
};
static struct __pyx_vtabstruct_17shift_calculators_Fast_ring_force_calculator *__pyx_vtabptr_17shift_calculators_Fast_ring_force_calculator;
static CYTHON_INLINE Vec3 *__pyx_f_17shift_calculators_26Fast_ring_force_calculator__get_ring_normal(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *, int);
static CYTHON_INLINE Vec3 *__pyx_f_17shift_calculators_26Fast_ring_force_calculator__get_ring_centre(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *, int);
static CYTHON_INLINE void __pyx_f_17shift_calculators_26Fast_ring_force_calculator__ring_calc_single_force_set(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *, int, float, struct __pyx_obj_17shift_calculators_Out_array *);
static CYTHON_INLINE void __pyx_f_17shift_calculators_26Fast_ring_force_calculator__build_cython_force_terms(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *, int, int, struct __pyx_t_17shift_calculators_Ring_force_sub_terms &);
static CYTHON_INLINE void __pyx_f_17shift_calculators_26Fast_ring_force_calculator__cython_calc_target_atom_forces(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *, int, float, struct __pyx_t_17shift_calculators_Ring_force_sub_terms &, struct __pyx_obj_17shift_calculators_Out_array *);
static CYTHON_INLINE void __pyx_f_17shift_calculators_26Fast_ring_force_calculator__cython_calculate_ring_forces(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *, int, int, float, struct __pyx_t_17shift_calculators_Ring_force_sub_terms, struct __pyx_obj_17shift_calculators_Out_array *);

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2549")'> 2549: </pre>
<pre id='line2549' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2550")'> 2550: </pre>
<pre id='line2550' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2551")'> 2551:     cdef Vec3_list _centre_cache</pre>
<pre id='line2551' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2552")'> 2552:     cdef Vec3_list _normal_cache</pre>
<pre id='line2552' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2553")'> 2553: </pre>
<pre id='line2553' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2554")'> 2554:     cdef Ring_target_component* _compiled_components</pre>
<pre id='line2554' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2555")'> 2555:     cdef int _num_components</pre>
<pre id='line2555' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2556")'> 2556: </pre>
<pre id='line2556' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2557")'> 2557:     cdef Ring_component* _compiled_ring_components</pre>
<pre id='line2557' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2558")'> 2558:     cdef int _num_ring_components</pre>
<pre id='line2558' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2559")'> 2559:     cdef object _raw_ring_component_data</pre>
<pre id='line2559' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2560")'> 2560: </pre>
<pre id='line2560' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2561")'> 2561:     cdef object raw_data</pre>
<pre id='line2561' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2562")'> 2562: </pre>
<pre id='line2562' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2563")'> 2563:     cdef Coef_components _compiled_coef_components</pre>
<pre id='line2563' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2564")'> 2564: </pre>
<pre id='line2564' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2565")'> 2565: </pre>
<pre id='line2565' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2566")'> 2566:     def __cinit__(self):</pre>
<pre id='line2566' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2566
 * 
 * 
 *     def __cinit__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.raw_data =  None
 *         self._compiled_components = NULL
 */

static int __pyx_pf_17shift_calculators_26Fast_ring_force_calculator___cinit__(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__cinit__", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2567")'> 2567:         self.raw_data =  None</pre>
<pre id='line2567' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":2567
 * 
 *     def __cinit__(self):
 *         self.raw_data =  None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components = NULL
 *         self._num_components = 0
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->raw_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->raw_data);
  __pyx_v_self->raw_data = Py_None;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2568")'> 2568:         self._compiled_components = NULL</pre>
<pre id='line2568' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2568
 *     def __cinit__(self):
 *         self.raw_data =  None
 *         self._compiled_components = NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components = 0
 * 
 */
  __pyx_v_self->_compiled_components = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2569")'> 2569:         self._num_components = 0</pre>
<pre id='line2569' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2569
 *         self.raw_data =  None
 *         self._compiled_components = NULL
 *         self._num_components = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._raw_ring_component_data = None
 */
  __pyx_v_self->_num_components = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2570")'> 2570: </pre>
<pre id='line2570' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2571")'> 2571:         self._raw_ring_component_data = None</pre>
<pre id='line2571' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":2571
 *         self._num_components = 0
 * 
 *         self._raw_ring_component_data = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_ring_components = NULL
 *         self._num_ring_components = 0
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_raw_ring_component_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_raw_ring_component_data);
  __pyx_v_self->_raw_ring_component_data = Py_None;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2572")'> 2572:         self._compiled_ring_components = NULL</pre>
<pre id='line2572' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2572
 * 
 *         self._raw_ring_component_data = None
 *         self._compiled_ring_components = NULL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_ring_components = 0
 * 
 */
  __pyx_v_self->_compiled_ring_components = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2573")'> 2573:         self._num_ring_components = 0</pre>
<pre id='line2573' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2573
 *         self._raw_ring_component_data = None
 *         self._compiled_ring_components = NULL
 *         self._num_ring_components = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         #note this is not a raw array of structs it's a compiled python class
 */
  __pyx_v_self->_num_ring_components = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2574")'> 2574: </pre>
<pre id='line2574' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2575")'> 2575:         #note this is not a raw array of structs it's a compiled python class</pre>
<pre id='line2575' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2576")'> 2576:         self._compiled_coef_components = None</pre>
<pre id='line2576' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":2576
 * 
 *         #note this is not a raw array of structs it's a compiled python class
 *         self._compiled_coef_components = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._centre_cache = None
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_compiled_coef_components);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_compiled_coef_components));
  __pyx_v_self->_compiled_coef_components = ((struct __pyx_obj_17shift_calculators_Coef_components *)Py_None);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2577")'> 2577: </pre>
<pre id='line2577' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2578")'> 2578:         self._centre_cache = None</pre>
<pre id='line2578' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":2578
 *         self._compiled_coef_components = None
 * 
 *         self._centre_cache = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._normal_cache = None
 * 
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_centre_cache);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_centre_cache));
  __pyx_v_self->_centre_cache = ((struct __pyx_obj_17shift_calculators_Vec3_list *)Py_None);
</pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line2579")'> 2579:         self._normal_cache = None</pre>
<pre id='line2579' class='code' style='background-color: #FFFF46'>
  /* "Cython_shift_calculator.pyx":2579
 * 
 *         self._centre_cache = None
 *         self._normal_cache = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def __init__(self,name="not set"):
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_normal_cache);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_normal_cache));
  __pyx_v_self->_normal_cache = ((struct __pyx_obj_17shift_calculators_Vec3_list *)Py_None);

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_17shift_calculators_26Fast_ring_force_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_17shift_calculators_26Fast_ring_force_calculator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_name = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__name,0};
    PyObject* values[1] = {0};
    values[0] = ((PyObject *)__pyx_kp_s_30);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__name);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2581; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_name = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 0, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2581; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_force_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_force_calculator_2__init__(((struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *)__pyx_v_self), __pyx_v_name);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2580")'> 2580: </pre>
<pre id='line2580' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2581")'> 2581:     def __init__(self,name="not set"):</pre>
<pre id='line2581' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2581
 *         self._normal_cache = None
 * 
 *     def __init__(self,name="not set"):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         super(Fast_ring_force_calculator, self).__init__(name=name)
 * 
 */

static int __pyx_pf_17shift_calculators_26Fast_ring_force_calculator_2__init__(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, PyObject *__pyx_v_name) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__init__", 0);
</pre><pre class='line' style='background-color: #FFFF2d' onclick='toggleDiv("line2582")'> 2582:         super(Fast_ring_force_calculator, self).__init__(name=name)</pre>
<pre id='line2582' class='code' style='background-color: #FFFF2d'>
  /* "Cython_shift_calculator.pyx":2582
 * 
 *     def __init__(self,name="not set"):
 *         super(Fast_ring_force_calculator, self).__init__(name=name)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def _bytes_to_components(self, data):
 */
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2582; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Fast_ring_force_calculator)));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Fast_ring_force_calculator)));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Fast_ring_force_calculator)));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_self));
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_super, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2582; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s____init__);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2582; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2582; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, ((PyObject *)__pyx_n_s__name), __pyx_v_name) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2582; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), ((PyObject *)__pyx_t_2));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2582; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_force_calculator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_5_bytes_to_components(PyObject *__pyx_v_self, PyObject *__pyx_v_data); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_5_bytes_to_components(PyObject *__pyx_v_self, PyObject *__pyx_v_data) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_components (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_force_calculator_4_bytes_to_components(((struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_data));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2583")'> 2583: </pre>
<pre id='line2583' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2584")'> 2584:     def _bytes_to_components(self, data):</pre>
<pre id='line2584' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2584
 *         super(Fast_ring_force_calculator, self).__init__(name=name)
 * 
 *     def _bytes_to_components(self, data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self.raw_data =  data
 *         self._compiled_components =  <code><</code>Ring_target_component*> <code><</code>size_t> ctypes.addressof(data)
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_ring_force_calculator_4_bytes_to_components(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, PyObject *__pyx_v_data) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_components", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2585")'> 2585:         self.raw_data =  data</pre>
<pre id='line2585' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":2585
 * 
 *     def _bytes_to_components(self, data):
 *         self.raw_data =  data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_components =  <code><</code>Ring_target_component*> <code><</code>size_t> ctypes.addressof(data)
 *         self._num_components =  len(data)/ sizeof(Ring_target_component)
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->raw_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->raw_data);
  __pyx_v_self->raw_data = __pyx_v_data;
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line2586")'> 2586:         self._compiled_components =  &lt;Ring_target_component*&gt; &lt;size_t&gt; ctypes.addressof(data)</pre>
<pre id='line2586' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":2586
 *     def _bytes_to_components(self, data):
 *         self.raw_data =  data
 *         self._compiled_components =  <code><</code>Ring_target_component*> <code><</code>size_t> ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_components =  len(data)/ sizeof(Ring_target_component)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2586; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2586; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2586; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2586; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2586; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_self->_compiled_components = ((struct __pyx_t_17shift_calculators_Ring_target_component *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line2587")'> 2587:         self._num_components =  len(data)/ sizeof(Ring_target_component)</pre>
<pre id='line2587' class='code' style='background-color: #FFFF73'>
  /* "Cython_shift_calculator.pyx":2587
 *         self.raw_data =  data
 *         self._compiled_components =  <code><</code>Ring_target_component*> <code><</code>size_t> ctypes.addressof(data)
 *         self._num_components =  len(data)/ sizeof(Ring_target_component)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void _bytes_to_ring_components(self, data):
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2587; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_num_components = (__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Ring_target_component)));

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_force_calculator._bytes_to_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2588")'> 2588: </pre>
<pre id='line2588' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2589")'> 2589:     cdef void _bytes_to_ring_components(self, data):</pre>
<pre id='line2589' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2589
 *         self._num_components =  len(data)/ sizeof(Ring_target_component)
 * 
 *     cdef void _bytes_to_ring_components(self, data):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._raw_ring_component_data =  data
 *         self._compiled_ring_components =  <code><</code>Ring_component*> <code><</code>size_t> ctypes.addressof(data)
 */

static void __pyx_f_17shift_calculators_26Fast_ring_force_calculator__bytes_to_ring_components(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, PyObject *__pyx_v_data) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_bytes_to_ring_components", 0);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2590")'> 2590:         self._raw_ring_component_data =  data</pre>
<pre id='line2590' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":2590
 * 
 *     cdef void _bytes_to_ring_components(self, data):
 *         self._raw_ring_component_data =  data             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_ring_components =  <code><</code>Ring_component*> <code><</code>size_t> ctypes.addressof(data)
 *         self._num_ring_components =  len(data)/ sizeof(Ring_component)
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_raw_ring_component_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self->_raw_ring_component_data);
  __pyx_v_self->_raw_ring_component_data = __pyx_v_data;
</pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line2591")'> 2591:         self._compiled_ring_components =  &lt;Ring_component*&gt; &lt;size_t&gt; ctypes.addressof(data)</pre>
<pre id='line2591' class='code' style='background-color: #FFFF3b'>
  /* "Cython_shift_calculator.pyx":2591
 *     cdef void _bytes_to_ring_components(self, data):
 *         self._raw_ring_component_data =  data
 *         self._compiled_ring_components =  <code><</code>Ring_component*> <code><</code>size_t> ctypes.addressof(data)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._num_ring_components =  len(data)/ sizeof(Ring_component)
 * 
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__ctypes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2591; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__addressof);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2591; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2591; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_data);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2591; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsSize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_4 == (size_t)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2591; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_self->_compiled_ring_components = ((struct __pyx_t_17shift_calculators_Ring_component *)((size_t)__pyx_t_4));
</pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line2592")'> 2592:         self._num_ring_components =  len(data)/ sizeof(Ring_component)</pre>
<pre id='line2592' class='code' style='background-color: #FFFF30'>
  /* "Cython_shift_calculator.pyx":2592
 *         self._raw_ring_component_data =  data
 *         self._compiled_ring_components =  <code><</code>Ring_component*> <code><</code>size_t> ctypes.addressof(data)
 *         self._num_ring_components =  len(data)/ sizeof(Ring_component)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2592; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self->_num_ring_components = (__pyx_t_5 / (sizeof(struct __pyx_t_17shift_calculators_Ring_component)));

  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Fast_ring_force_calculator._bytes_to_ring_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_7_set_coef_components(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_7_set_coef_components(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_coef_components = 0;
  PyObject *__pyx_v_components = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_coef_components (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__coef_components,&__pyx_n_s__components,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__coef_components)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__components)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_set_coef_components", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2595; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_set_coef_components") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2595; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_coef_components = values[0];
    __pyx_v_components = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_set_coef_components", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2595; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_force_calculator._set_coef_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_force_calculator_6_set_coef_components(((struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *)__pyx_v_self), __pyx_v_coef_components, __pyx_v_components);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2593")'> 2593: </pre>
<pre id='line2593' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2594")'> 2594: </pre>
<pre id='line2594' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2595")'> 2595:     def _set_coef_components(self,coef_components, components):</pre>
<pre id='line2595' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2595
 * 
 * 
 *     def _set_coef_components(self,coef_components, components):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._compiled_coef_components = Coef_components(coef_components, components)
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_ring_force_calculator_6_set_coef_components(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, PyObject *__pyx_v_coef_components, PyObject *__pyx_v_components) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_coef_components", 0);
</pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line2596")'> 2596:         self._compiled_coef_components = Coef_components(coef_components, components)</pre>
<pre id='line2596' class='code' style='background-color: #FFFF4d'>
  /* "Cython_shift_calculator.pyx":2596
 * 
 *     def _set_coef_components(self,coef_components, components):
 *         self._compiled_coef_components = Coef_components(coef_components, components)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def _set_ring_components(self,ring_components):
 */
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2596; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_coef_components);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_coef_components);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_coef_components);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_components);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_components);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_components);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Coef_components)), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2596; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_compiled_coef_components);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_compiled_coef_components));
  __pyx_v_self->_compiled_coef_components = ((struct __pyx_obj_17shift_calculators_Coef_components *)__pyx_t_2);
  __pyx_t_2 = 0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_force_calculator._set_coef_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_9_set_ring_components(PyObject *__pyx_v_self, PyObject *__pyx_v_ring_components); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_9_set_ring_components(PyObject *__pyx_v_self, PyObject *__pyx_v_ring_components) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_ring_components (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_force_calculator_8_set_ring_components(((struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_ring_components));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2597")'> 2597: </pre>
<pre id='line2597' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2598")'> 2598:     def _set_ring_components(self,ring_components):</pre>
<pre id='line2598' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2598
 *         self._compiled_coef_components = Coef_components(coef_components, components)
 * 
 *     def _set_ring_components(self,ring_components):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self. _bytes_to_ring_components(ring_components)
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_ring_force_calculator_8_set_ring_components(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, PyObject *__pyx_v_ring_components) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_ring_components", 0);
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line2599")'> 2599:         self. _bytes_to_ring_components(ring_components)</pre>
<pre id='line2599' class='code' style='background-color: #FFFFc4'>
  /* "Cython_shift_calculator.pyx":2599
 * 
 *     def _set_ring_components(self,ring_components):
 *         self. _bytes_to_ring_components(ring_components)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  ((struct __pyx_vtabstruct_17shift_calculators_Fast_ring_force_calculator *)__pyx_v_self->__pyx_base.__pyx_vtab)->_bytes_to_ring_components(__pyx_v_self, __pyx_v_ring_components);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_11_set_normal_cache(PyObject *__pyx_v_self, PyObject *__pyx_v_normals); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_11_set_normal_cache(PyObject *__pyx_v_self, PyObject *__pyx_v_normals) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_normal_cache (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_force_calculator_10_set_normal_cache(((struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_normals));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2600")'> 2600: </pre>
<pre id='line2600' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2601")'> 2601: </pre>
<pre id='line2601' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2602")'> 2602: </pre>
<pre id='line2602' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2603")'> 2603:     def _set_normal_cache(self,normals):</pre>
<pre id='line2603' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2603
 * 
 * 
 *     def _set_normal_cache(self,normals):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._normal_cache = <code><</code>Vec3_list> normals
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_ring_force_calculator_10_set_normal_cache(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, PyObject *__pyx_v_normals) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_normal_cache", 0);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line2604")'> 2604:         self._normal_cache = &lt;Vec3_list&gt; normals</pre>
<pre id='line2604' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":2604
 * 
 *     def _set_normal_cache(self,normals):
 *         self._normal_cache = <code><</code>Vec3_list> normals             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def _set_centre_cache(self,centres):
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)((struct __pyx_obj_17shift_calculators_Vec3_list *)__pyx_v_normals)));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_normals);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_normal_cache);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_normal_cache));
  __pyx_v_self->_normal_cache = ((struct __pyx_obj_17shift_calculators_Vec3_list *)__pyx_v_normals);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_13_set_centre_cache(PyObject *__pyx_v_self, PyObject *__pyx_v_centres); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_13_set_centre_cache(PyObject *__pyx_v_self, PyObject *__pyx_v_centres) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_centre_cache (wrapper)", 0);
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_force_calculator_12_set_centre_cache(((struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *)__pyx_v_self), ((PyObject *)__pyx_v_centres));
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2605")'> 2605: </pre>
<pre id='line2605' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2606")'> 2606:     def _set_centre_cache(self,centres):</pre>
<pre id='line2606' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2606
 *         self._normal_cache = <code><</code>Vec3_list> normals
 * 
 *     def _set_centre_cache(self,centres):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._centre_cache = <code><</code>Vec3_list> centres
 * 
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_ring_force_calculator_12_set_centre_cache(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, PyObject *__pyx_v_centres) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_set_centre_cache", 0);
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line2607")'> 2607:         self._centre_cache = &lt;Vec3_list&gt; centres</pre>
<pre id='line2607' class='code' style='background-color: #FFFFb6'>
  /* "Cython_shift_calculator.pyx":2607
 * 
 *     def _set_centre_cache(self,centres):
 *         self._centre_cache = <code><</code>Vec3_list> centres             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)((struct __pyx_obj_17shift_calculators_Vec3_list *)__pyx_v_centres)));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_centres);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_self->_centre_cache);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self->_centre_cache));
  __pyx_v_self->_centre_cache = ((struct __pyx_obj_17shift_calculators_Vec3_list *)__pyx_v_centres);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2608")'> 2608: </pre>
<pre id='line2608' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2609")'> 2609: </pre>
<pre id='line2609' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2610")'> 2610:     @cython.profile(False)</pre>
<pre id='line2610' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2611")'> 2611:     cdef inline Vec3* _get_ring_normal(self, int ring_id):</pre>
<pre id='line2611' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2611
 * 
 *     @cython.profile(False)
 *     cdef inline Vec3* _get_ring_normal(self, int ring_id):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return  self._normal_cache.get(ring_id)
 * 
 */

static CYTHON_INLINE Vec3 *__pyx_f_17shift_calculators_26Fast_ring_force_calculator__get_ring_normal(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, int __pyx_v_ring_id) {
  Vec3 *__pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_get_ring_normal", 0);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line2612")'> 2612:         return  self._normal_cache.get(ring_id)</pre>
<pre id='line2612' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":2612
 *     @cython.profile(False)
 *     cdef inline Vec3* _get_ring_normal(self, int ring_id):
 *         return  self._normal_cache.get(ring_id)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     @cython.profile(False)
 */
  __pyx_r = __pyx_f_17shift_calculators_9Vec3_list_get(__pyx_v_self->_normal_cache, __pyx_v_ring_id);
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2613")'> 2613: </pre>
<pre id='line2613' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2614")'> 2614:     @cython.profile(False)</pre>
<pre id='line2614' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2615")'> 2615:     cdef inline Vec3* _get_ring_centre(self, int ring_id):</pre>
<pre id='line2615' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2615
 * 
 *     @cython.profile(False)
 *     cdef inline Vec3* _get_ring_centre(self, int ring_id):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return  self._centre_cache.get(ring_id)
 * 
 */

static CYTHON_INLINE Vec3 *__pyx_f_17shift_calculators_26Fast_ring_force_calculator__get_ring_centre(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, int __pyx_v_ring_id) {
  Vec3 *__pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_get_ring_centre", 0);
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line2616")'> 2616:         return  self._centre_cache.get(ring_id)</pre>
<pre id='line2616' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":2616
 *     @cython.profile(False)
 *     cdef inline Vec3* _get_ring_centre(self, int ring_id):
 *         return  self._centre_cache.get(ring_id)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_r = __pyx_f_17shift_calculators_9Vec3_list_get(__pyx_v_self->_centre_cache, __pyx_v_ring_id);
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2617")'> 2617: </pre>
<pre id='line2617' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2618")'> 2618: </pre>
<pre id='line2618' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2619")'> 2619: #    @cython.profile(False)</pre>
<pre id='line2619' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2620")'> 2620: #    cdef inline target_type _get_target_and_type(self,int index):</pre>
<pre id='line2620' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2621")'> 2621: #        component = self._get_component(index)</pre>
<pre id='line2621' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2622")'> 2622: ##        TODO: this needs to contain better names a union?</pre>
<pre id='line2622' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2623")'> 2623: #        cdef target_type result</pre>
<pre id='line2623' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2624")'> 2624: #        result.target_atom_id = component[0]</pre>
<pre id='line2624' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2625")'> 2625: #        result.atom_type_id = component[1]</pre>
<pre id='line2625' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2626")'> 2626: #</pre>
<pre id='line2626' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2627")'> 2627: #        return result#</pre>
<pre id='line2627' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2628")'> 2628: </pre>
<pre id='line2628' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2629")'> 2629: </pre>
<pre id='line2629' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2630")'> 2630:     cdef inline void _do_calc_components(self, int[:] component_to_result, float[:] force_factors, Out_array force):</pre>
<pre id='line2630' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2630
 * 
 * 
 *     cdef inline void _do_calc_components(self, int[:] component_to_result, float[:] force_factors, Out_array force):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int factor_index
 *         cdef int component_index
 */

static void __pyx_f_17shift_calculators_26Fast_ring_force_calculator__do_calc_components(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, __Pyx_memviewslice __pyx_v_component_to_result, __Pyx_memviewslice __pyx_v_force_factors, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_force) {
  int __pyx_v_factor_index;
  int __pyx_v_component_index;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_do_calc_components", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2631")'> 2631:         cdef int factor_index</pre>
<pre id='line2631' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2632")'> 2632:         cdef int component_index</pre>
<pre id='line2632' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2633")'> 2633: </pre>
<pre id='line2633' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line2634")'> 2634:         for factor_index in range(len(self._active_components)):</pre>
<pre id='line2634' class='code' style='background-color: #FFFF79'>
  /* "Cython_shift_calculator.pyx":2634
 *         cdef int component_index
 * 
 *         for factor_index in range(len(self._active_components)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             component_index = self._active_components[factor_index]
 *             self._ring_calc_single_force_set(component_index,force_factors[component_to_result[factor_index]],force)
 */
  if (unlikely(!__pyx_v_self->__pyx_base._active_components.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2634; __pyx_clineno = __LINE__; goto __pyx_L1_error;}}
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->__pyx_base._active_components, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2634; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2634; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (__pyx_t_3 = 0; __pyx_t_3 <code><</code> __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_factor_index = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line2635")'> 2635:             component_index = self._active_components[factor_index]</pre>
<pre id='line2635' class='code' style='background-color: #FFFFaa'>
    /* "Cython_shift_calculator.pyx":2635
 * 
 *         for factor_index in range(len(self._active_components)):
 *             component_index = self._active_components[factor_index]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._ring_calc_single_force_set(component_index,force_factors[component_to_result[factor_index]],force)
 * 
 */
    if (unlikely(!__pyx_v_self->__pyx_base._active_components.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2635; __pyx_clineno = __LINE__; goto __pyx_L1_error;}}
    __pyx_t_4 = __pyx_v_factor_index;
    __pyx_v_component_index = (*((int *) ( /* dim=0 */ (__pyx_v_self->__pyx_base._active_components.data + __pyx_t_4 * __pyx_v_self->__pyx_base._active_components.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line2636")'> 2636:             self._ring_calc_single_force_set(component_index,force_factors[component_to_result[factor_index]],force)</pre>
<pre id='line2636' class='code' style='background-color: #FFFFb6'>
    /* "Cython_shift_calculator.pyx":2636
 *         for factor_index in range(len(self._active_components)):
 *             component_index = self._active_components[factor_index]
 *             self._ring_calc_single_force_set(component_index,force_factors[component_to_result[factor_index]],force)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline void _ring_calc_single_force_set(self,  int index, float force_factor, Out_array forces):
 */
    __pyx_t_5 = __pyx_v_factor_index;
    __pyx_t_6 = (*((int *) ( /* dim=0 */ (__pyx_v_component_to_result.data + __pyx_t_5 * __pyx_v_component_to_result.strides[0]) )));
    __pyx_f_17shift_calculators_26Fast_ring_force_calculator__ring_calc_single_force_set(__pyx_v_self, __pyx_v_component_index, (*((float *) ( /* dim=0 */ (__pyx_v_force_factors.data + __pyx_t_6 * __pyx_v_force_factors.strides[0]) ))), __pyx_v_force);
  }

  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("shift_calculators.Fast_ring_force_calculator._do_calc_components", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2637")'> 2637: </pre>
<pre id='line2637' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2638")'> 2638:     cdef inline void _ring_calc_single_force_set(self,  int index, float force_factor, Out_array forces):</pre>
<pre id='line2638' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2638
 *             self._ring_calc_single_force_set(component_index,force_factors[component_to_result[factor_index]],force)
 * 
 *     cdef inline void _ring_calc_single_force_set(self,  int index, float force_factor, Out_array forces):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef int atom_type_id  = self._compiled_components[index].atom_type_id
 *         cdef Component_Offsets* coeff_offset =  self._compiled_coef_components.get_id_offsets(atom_type_id)
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_26Fast_ring_force_calculator__ring_calc_single_force_set(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, int __pyx_v_index, float __pyx_v_force_factor, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces) {
  int __pyx_v_atom_type_id;
  struct __pyx_t_17shift_calculators_Component_Offsets *__pyx_v_coeff_offset;
  struct __pyx_t_17shift_calculators_Coef_component *__pyx_v_coef_component;
  int __pyx_v_coef_offset;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_ring_calc_single_force_set", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2639")'> 2639:         cdef int atom_type_id  = self._compiled_components[index].atom_type_id</pre>
<pre id='line2639' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2639
 * 
 *     cdef inline void _ring_calc_single_force_set(self,  int index, float force_factor, Out_array forces):
 *         cdef int atom_type_id  = self._compiled_components[index].atom_type_id             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Component_Offsets* coeff_offset =  self._compiled_coef_components.get_id_offsets(atom_type_id)
 *         cdef Coef_component* coef_component
 */
  __pyx_t_1 = (__pyx_v_self->_compiled_components[__pyx_v_index]).atom_type_id;
  __pyx_v_atom_type_id = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2640")'> 2640:         cdef Component_Offsets* coeff_offset =  self._compiled_coef_components.get_id_offsets(atom_type_id)</pre>
<pre id='line2640' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2640
 *     cdef inline void _ring_calc_single_force_set(self,  int index, float force_factor, Out_array forces):
 *         cdef int atom_type_id  = self._compiled_components[index].atom_type_id
 *         cdef Component_Offsets* coeff_offset =  self._compiled_coef_components.get_id_offsets(atom_type_id)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Coef_component* coef_component
 * 
 */
  __pyx_v_coeff_offset = __pyx_f_17shift_calculators_15Coef_components_get_id_offsets(__pyx_v_self->_compiled_coef_components, __pyx_v_atom_type_id);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2641")'> 2641:         cdef Coef_component* coef_component</pre>
<pre id='line2641' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2642")'> 2642: </pre>
<pre id='line2642' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2643")'> 2643:         for coef_offset in range(coeff_offset[0].offset,coeff_offset[0].offset+coeff_offset[0].length):</pre>
<pre id='line2643' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2643
 *         cdef Coef_component* coef_component
 * 
 *         for coef_offset in range(coeff_offset[0].offset,coeff_offset[0].offset+coeff_offset[0].length):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #           TODO: remove magic numbers or add structs
 *             coef_component = self._compiled_coef_components.get_component(coef_offset)
 */
  __pyx_t_1 = ((__pyx_v_coeff_offset[0]).offset + (__pyx_v_coeff_offset[0]).length);
  for (__pyx_t_2 = (__pyx_v_coeff_offset[0]).offset; __pyx_t_2 <code><</code> __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_coef_offset = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2644")'> 2644: #           TODO: remove magic numbers or add structs</pre>
<pre id='line2644' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2645")'> 2645:             coef_component = self._compiled_coef_components.get_component(coef_offset)</pre>
<pre id='line2645' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2645
 *         for coef_offset in range(coeff_offset[0].offset,coeff_offset[0].offset+coeff_offset[0].length):
 * #           TODO: remove magic numbers or add structs
 *             coef_component = self._compiled_coef_components.get_component(coef_offset)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self._calculate_single_ring_forces(self._compiled_components[index].target_atom_id, self._compiled_components[index].atom_type_id, coef_component, force_factor, forces)
 * 
 */
    __pyx_v_coef_component = __pyx_f_17shift_calculators_15Coef_components_get_component(__pyx_v_self->_compiled_coef_components, __pyx_v_coef_offset);
</pre><pre class='line' style='background-color: #FFFF18' onclick='toggleDiv("line2646")'> 2646:             self._calculate_single_ring_forces(self._compiled_components[index].target_atom_id, self._compiled_components[index].atom_type_id, coef_component, force_factor, forces)</pre>
<pre id='line2646' class='code' style='background-color: #FFFF18'>
    /* "Cython_shift_calculator.pyx":2646
 * #           TODO: remove magic numbers or add structs
 *             coef_component = self._compiled_coef_components.get_component(coef_offset)
 *             self._calculate_single_ring_forces(self._compiled_components[index].target_atom_id, self._compiled_components[index].atom_type_id, coef_component, force_factor, forces)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def _calculate_ring_forces(self, int atom_type_id, int ring_id, float force_factor, Python_ring_force_sub_terms python_sub_terms,Out_array forces):
 */
    ((struct __pyx_vtabstruct_17shift_calculators_Fast_ring_force_calculator *)__pyx_v_self->__pyx_base.__pyx_vtab)->_calculate_single_ring_forces(__pyx_v_self, (__pyx_v_self->_compiled_components[__pyx_v_index]).target_atom_id, (__pyx_v_self->_compiled_components[__pyx_v_index]).atom_type_id, __pyx_v_coef_component, __pyx_v_force_factor, __pyx_v_forces);
  }

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_15_calculate_ring_forces(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_15_calculate_ring_forces(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_atom_type_id;
  int __pyx_v_ring_id;
  float __pyx_v_force_factor;
  struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms *__pyx_v_python_sub_terms = 0;
  struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calculate_ring_forces (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__atom_type_id,&__pyx_n_s__ring_id,&__pyx_n_s__force_factor,&__pyx_n_s__python_sub_terms,&__pyx_n_s__forces,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__atom_type_id)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__ring_id)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calculate_ring_forces", 1, 5, 5, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2648; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__force_factor)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calculate_ring_forces", 1, 5, 5, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2648; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__python_sub_terms)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calculate_ring_forces", 1, 5, 5, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2648; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__forces)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calculate_ring_forces", 1, 5, 5, 4);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2648; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_calculate_ring_forces") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2648; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 5) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
    }
    __pyx_v_atom_type_id = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_atom_type_id == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2648; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_ring_id = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_ring_id == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2648; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_force_factor = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_force_factor == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2648; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_python_sub_terms = ((struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms *)values[3]);
    __pyx_v_forces = ((struct __pyx_obj_17shift_calculators_Out_array *)values[4]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calculate_ring_forces", 1, 5, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2648; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_force_calculator._calculate_ring_forces", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_python_sub_terms), __pyx_ptype_17shift_calculators_Python_ring_force_sub_terms, 1, "python_sub_terms", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2648; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_forces), __pyx_ptype_17shift_calculators_Out_array, 1, "forces", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2648; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_force_calculator_14_calculate_ring_forces(((struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *)__pyx_v_self), __pyx_v_atom_type_id, __pyx_v_ring_id, __pyx_v_force_factor, __pyx_v_python_sub_terms, __pyx_v_forces);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2647")'> 2647: </pre>
<pre id='line2647' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2648")'> 2648:     def _calculate_ring_forces(self, int atom_type_id, int ring_id, float force_factor, Python_ring_force_sub_terms python_sub_terms,Out_array forces):</pre>
<pre id='line2648' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2648
 *             self._calculate_single_ring_forces(self._compiled_components[index].target_atom_id, self._compiled_components[index].atom_type_id, coef_component, force_factor, forces)
 * 
 *     def _calculate_ring_forces(self, int atom_type_id, int ring_id, float force_factor, Python_ring_force_sub_terms python_sub_terms,Out_array forces):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Ring_force_sub_terms  terms  =  python_sub_terms.get_terms()
 *         self._cython_calculate_ring_forces(atom_type_id, ring_id, force_factor, terms, forces)
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_ring_force_calculator_14_calculate_ring_forces(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, int __pyx_v_atom_type_id, int __pyx_v_ring_id, float __pyx_v_force_factor, struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms *__pyx_v_python_sub_terms, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces) {
  struct __pyx_t_17shift_calculators_Ring_force_sub_terms __pyx_v_terms;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calculate_ring_forces", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2649")'> 2649:         cdef Ring_force_sub_terms  terms  =  python_sub_terms.get_terms()</pre>
<pre id='line2649' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2649
 * 
 *     def _calculate_ring_forces(self, int atom_type_id, int ring_id, float force_factor, Python_ring_force_sub_terms python_sub_terms,Out_array forces):
 *         cdef Ring_force_sub_terms  terms  =  python_sub_terms.get_terms()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._cython_calculate_ring_forces(atom_type_id, ring_id, force_factor, terms, forces)
 * 
 */
  __pyx_v_terms = ((struct __pyx_vtabstruct_17shift_calculators_Python_ring_force_sub_terms *)__pyx_v_python_sub_terms->__pyx_vtab)->get_terms(__pyx_v_python_sub_terms);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2650")'> 2650:         self._cython_calculate_ring_forces(atom_type_id, ring_id, force_factor, terms, forces)</pre>
<pre id='line2650' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":2650
 *     def _calculate_ring_forces(self, int atom_type_id, int ring_id, float force_factor, Python_ring_force_sub_terms python_sub_terms,Out_array forces):
 *         cdef Ring_force_sub_terms  terms  =  python_sub_terms.get_terms()
 *         self._cython_calculate_ring_forces(atom_type_id, ring_id, force_factor, terms, forces)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef void _calculate_single_ring_forces(self, int target_atom_id, int atom_type_id, Coef_component* coef_component, float force_factor,Out_array forces):
 */
  __pyx_f_17shift_calculators_26Fast_ring_force_calculator__cython_calculate_ring_forces(__pyx_v_self, __pyx_v_atom_type_id, __pyx_v_ring_id, __pyx_v_force_factor, __pyx_v_terms, __pyx_v_forces);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2651")'> 2651: </pre>
<pre id='line2651' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2652")'> 2652:     cdef void _calculate_single_ring_forces(self, int target_atom_id, int atom_type_id, Coef_component* coef_component, float force_factor,Out_array forces):</pre>
<pre id='line2652' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2652
 *         self._cython_calculate_ring_forces(atom_type_id, ring_id, force_factor, terms, forces)
 * 
 *     cdef void _calculate_single_ring_forces(self, int target_atom_id, int atom_type_id, Coef_component* coef_component, float force_factor,Out_array forces):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Ring_force_sub_terms force_terms
 */

static void __pyx_f_17shift_calculators_26Fast_ring_force_calculator__calculate_single_ring_forces(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, int __pyx_v_target_atom_id, int __pyx_v_atom_type_id, struct __pyx_t_17shift_calculators_Coef_component *__pyx_v_coef_component, float __pyx_v_force_factor, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces) {
  struct __pyx_t_17shift_calculators_Ring_force_sub_terms __pyx_v_force_terms;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calculate_single_ring_forces", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2653")'> 2653: </pre>
<pre id='line2653' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2654")'> 2654:         cdef Ring_force_sub_terms force_terms</pre>
<pre id='line2654' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2655")'> 2655:         self._build_cython_force_terms(target_atom_id, coef_component.ring_id, force_terms)</pre>
<pre id='line2655' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2655
 * 
 *         cdef Ring_force_sub_terms force_terms
 *         self._build_cython_force_terms(target_atom_id, coef_component.ring_id, force_terms)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         self._cython_calc_target_atom_forces(target_atom_id, force_factor * coef_component.coefficient, force_terms, forces)
 */
  __pyx_f_17shift_calculators_26Fast_ring_force_calculator__build_cython_force_terms(__pyx_v_self, __pyx_v_target_atom_id, __pyx_v_coef_component->ring_id, __pyx_v_force_terms);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2656")'> 2656: </pre>
<pre id='line2656' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2657")'> 2657:         self._cython_calc_target_atom_forces(target_atom_id, force_factor * coef_component.coefficient, force_terms, forces)</pre>
<pre id='line2657' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2657
 *         self._build_cython_force_terms(target_atom_id, coef_component.ring_id, force_terms)
 * 
 *         self._cython_calc_target_atom_forces(target_atom_id, force_factor * coef_component.coefficient, force_terms, forces)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #        #            #TODO: this is not how camshift does it, it uses the sum of the two ring normals
 */
  __pyx_f_17shift_calculators_26Fast_ring_force_calculator__cython_calc_target_atom_forces(__pyx_v_self, __pyx_v_target_atom_id, (__pyx_v_force_factor * __pyx_v_coef_component->coefficient), __pyx_v_force_terms, __pyx_v_forces);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2658")'> 2658: </pre>
<pre id='line2658' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2659")'> 2659: #        #            #TODO: this is not how camshift does it, it uses the sum of the two ring normals</pre>
<pre id='line2659' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF28' onclick='toggleDiv("line2660")'> 2660:         self._cython_calculate_ring_forces(atom_type_id, coef_component.ring_id, force_factor * coef_component.coefficient, force_terms, forces)</pre>
<pre id='line2660' class='code' style='background-color: #FFFF28'>
  /* "Cython_shift_calculator.pyx":2660
 * 
 * #        #            #TODO: this is not how camshift does it, it uses the sum of the two ring normals
 *         self._cython_calculate_ring_forces(atom_type_id, coef_component.ring_id, force_factor * coef_component.coefficient, force_terms, forces)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     def _build_force_terms(self, int target_atom_id, int ring_id):
 */
  __pyx_f_17shift_calculators_26Fast_ring_force_calculator__cython_calculate_ring_forces(__pyx_v_self, __pyx_v_atom_type_id, __pyx_v_coef_component->ring_id, (__pyx_v_force_factor * __pyx_v_coef_component->coefficient), __pyx_v_force_terms, __pyx_v_forces);

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_17_build_force_terms(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_17_build_force_terms(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_target_atom_id;
  int __pyx_v_ring_id;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_build_force_terms (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__target_atom_id,&__pyx_n_s__ring_id,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__target_atom_id)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__ring_id)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_build_force_terms", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2662; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_build_force_terms") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2662; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_target_atom_id = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_target_atom_id == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2662; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_ring_id = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_ring_id == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2662; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_build_force_terms", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2662; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_force_calculator._build_force_terms", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_force_calculator_16_build_force_terms(((struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *)__pyx_v_self), __pyx_v_target_atom_id, __pyx_v_ring_id);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2661")'> 2661: </pre>
<pre id='line2661' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2662")'> 2662:     def _build_force_terms(self, int target_atom_id, int ring_id):</pre>
<pre id='line2662' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2662
 *         self._cython_calculate_ring_forces(atom_type_id, coef_component.ring_id, force_factor * coef_component.coefficient, force_terms, forces)
 * 
 *     def _build_force_terms(self, int target_atom_id, int ring_id):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Ring_force_sub_terms terms
 *         self._build_cython_force_terms(target_atom_id, ring_id, terms)
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_ring_force_calculator_16_build_force_terms(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, int __pyx_v_target_atom_id, int __pyx_v_ring_id) {
  struct __pyx_t_17shift_calculators_Ring_force_sub_terms __pyx_v_terms;
  struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms *__pyx_v_result = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_build_force_terms", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2663")'> 2663:         cdef Ring_force_sub_terms terms</pre>
<pre id='line2663' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2664")'> 2664:         self._build_cython_force_terms(target_atom_id, ring_id, terms)</pre>
<pre id='line2664' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2664
 *     def _build_force_terms(self, int target_atom_id, int ring_id):
 *         cdef Ring_force_sub_terms terms
 *         self._build_cython_force_terms(target_atom_id, ring_id, terms)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result  = Python_ring_force_sub_terms()
 *         result.setup(terms)
 */
  __pyx_f_17shift_calculators_26Fast_ring_force_calculator__build_cython_force_terms(__pyx_v_self, __pyx_v_target_atom_id, __pyx_v_ring_id, __pyx_v_terms);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line2665")'> 2665:         result  = Python_ring_force_sub_terms()</pre>
<pre id='line2665' class='code' style='background-color: #FFFFaa'>
  /* "Cython_shift_calculator.pyx":2665
 *         cdef Ring_force_sub_terms terms
 *         self._build_cython_force_terms(target_atom_id, ring_id, terms)
 *         result  = Python_ring_force_sub_terms()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.setup(terms)
 *         return result
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)__pyx_ptype_17shift_calculators_Python_ring_force_sub_terms)), ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2665; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_v_result = ((struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line2666")'> 2666:         result.setup(terms)</pre>
<pre id='line2666' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":2666
 *         self._build_cython_force_terms(target_atom_id, ring_id, terms)
 *         result  = Python_ring_force_sub_terms()
 *         result.setup(terms)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return result
 * 
 */
  __pyx_t_1 = ((struct __pyx_vtabstruct_17shift_calculators_Python_ring_force_sub_terms *)__pyx_v_result->__pyx_vtab)->setup(__pyx_v_result, __pyx_v_terms);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2666; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line2667")'> 2667:         return result</pre>
<pre id='line2667' class='code' style='background-color: #FFFF8d'>
  /* "Cython_shift_calculator.pyx":2667
 *         result  = Python_ring_force_sub_terms()
 *         result.setup(terms)
 *         return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline void _build_cython_force_terms(self, int target_atom_id, int ring_id, Ring_force_sub_terms& result):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_result));
  __pyx_r = ((PyObject *)__pyx_v_result);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_force_calculator._build_force_terms", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_result);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2668")'> 2668: </pre>
<pre id='line2668' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2669")'> 2669:     cdef inline void _build_cython_force_terms(self, int target_atom_id, int ring_id, Ring_force_sub_terms&amp; result):</pre>
<pre id='line2669' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2669
 *         return result
 * 
 *     cdef inline void _build_cython_force_terms(self, int target_atom_id, int ring_id, Ring_force_sub_terms& result):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3 target_atom_pos  = self._simulation[0].atomPos(target_atom_id)
 * 
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_26Fast_ring_force_calculator__build_cython_force_terms(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, int __pyx_v_target_atom_id, int __pyx_v_ring_id, struct __pyx_t_17shift_calculators_Ring_force_sub_terms &__pyx_v_result) {
  Vec3 __pyx_v_target_atom_pos;
  Vec3 __pyx_v_ring_centre;
  Vec3 *__pyx_v_ring_normal;
  Vec3 __pyx_v_d;
  float __pyx_v_dL;
  float __pyx_v_dL2;
  float __pyx_v_dL4;
  float __pyx_v_dL3;
  float __pyx_v_dL6;
  float __pyx_v_nL;
  float __pyx_v_nL2;
  float __pyx_v_dLnL;
  float __pyx_v_dL3nL3;
  float __pyx_v_dn;
  float __pyx_v_dn2;
  float __pyx_v_u;
  float __pyx_v_gradUQ_factor;
  Vec3 __pyx_v_scaled_d;
  Vec3 __pyx_v_scaled_normal;
  Vec3 __pyx_v_gradUQ;
  float __pyx_v_gradVQ_factor;
  Vec3 __pyx_v_gradVQ;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_build_cython_force_terms", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2670")'> 2670:         cdef Vec3 target_atom_pos  = self._simulation[0].atomPos(target_atom_id)</pre>
<pre id='line2670' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2670
 * 
 *     cdef inline void _build_cython_force_terms(self, int target_atom_id, int ring_id, Ring_force_sub_terms& result):
 *         cdef Vec3 target_atom_pos  = self._simulation[0].atomPos(target_atom_id)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Vec3 ring_centre = self._get_ring_centre(ring_id)[0]
 */
  __pyx_v_target_atom_pos = (__pyx_v_self->__pyx_base._simulation[0]).atomPos(__pyx_v_target_atom_id);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2671")'> 2671: </pre>
<pre id='line2671' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2672")'> 2672:         cdef Vec3 ring_centre = self._get_ring_centre(ring_id)[0]</pre>
<pre id='line2672' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2672
 *         cdef Vec3 target_atom_pos  = self._simulation[0].atomPos(target_atom_id)
 * 
 *         cdef Vec3 ring_centre = self._get_ring_centre(ring_id)[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3* ring_normal = self._get_ring_normal(ring_id)
 * 
 */
  __pyx_v_ring_centre = (__pyx_f_17shift_calculators_26Fast_ring_force_calculator__get_ring_centre(__pyx_v_self, __pyx_v_ring_id)[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2673")'> 2673:         cdef Vec3* ring_normal = self._get_ring_normal(ring_id)</pre>
<pre id='line2673' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2673
 * 
 *         cdef Vec3 ring_centre = self._get_ring_centre(ring_id)[0]
 *         cdef Vec3* ring_normal = self._get_ring_normal(ring_id)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         # distance vector between atom of interest and ring center
 */
  __pyx_v_ring_normal = __pyx_f_17shift_calculators_26Fast_ring_force_calculator__get_ring_normal(__pyx_v_self, __pyx_v_ring_id);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2674")'> 2674: </pre>
<pre id='line2674' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2675")'> 2675:         # distance vector between atom of interest and ring center</pre>
<pre id='line2675' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2676")'> 2676:         cdef Vec3 d = target_atom_pos - ring_centre</pre>
<pre id='line2676' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2676
 * 
 *         # distance vector between atom of interest and ring center
 *         cdef Vec3 d = target_atom_pos - ring_centre             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef float dL = norm(d)
 * 
 */
  __pyx_v_d = (__pyx_v_target_atom_pos - __pyx_v_ring_centre);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2677")'> 2677:         cdef float dL = norm(d)</pre>
<pre id='line2677' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2677
 *         # distance vector between atom of interest and ring center
 *         cdef Vec3 d = target_atom_pos - ring_centre
 *         cdef float dL = norm(d)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         # squared distance of atom of interest from ring center
 */
  __pyx_v_dL = norm(__pyx_v_d);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2678")'> 2678: </pre>
<pre id='line2678' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2679")'> 2679:         # squared distance of atom of interest from ring center</pre>
<pre id='line2679' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2680")'> 2680:         cdef float dL2 = dot(d, d) #            if (dL2 &lt; 0.5) cout &lt;&lt; "CAMSHIFT WARNING: Distance between atom and center of ring alarmingly small at " &lt;&lt; sqrt(dL2) &lt;&lt; " Angstrom!" &lt;&lt; endl;</pre>
<pre id='line2680' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2680
 * 
 *         # squared distance of atom of interest from ring center
 *         cdef float dL2 = dot(d, d) #            if (dL2 <code><</code> 0.5) cout <code><</code><code><</code> "CAMSHIFT WARNING: Distance between atom and center of ring alarmingly small at " <code><</code><code><</code> sqrt(dL2) <code><</code><code><</code> " Angstrom!" <code><</code><code><</code> endl;             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         # calculate terms resulting from differentiating energy function with respect to query and ring atom coordinates
 */
  __pyx_v_dL2 = dot(__pyx_v_d, __pyx_v_d);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2681")'> 2681: </pre>
<pre id='line2681' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2682")'> 2682:         # calculate terms resulting from differentiating energy function with respect to query and ring atom coordinates</pre>
<pre id='line2682' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2683")'> 2683:         cdef float dL4 = dL ** 4</pre>
<pre id='line2683' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2683
 * 
 *         # calculate terms resulting from differentiating energy function with respect to query and ring atom coordinates
 *         cdef float dL4 = dL ** 4             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef float dL3 = dL ** 3
 *         cdef float dL6 = dL3 ** 2
 */
  __pyx_v_dL4 = powf(__pyx_v_dL, 4.0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2684")'> 2684:         cdef float dL3 = dL ** 3</pre>
<pre id='line2684' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2684
 *         # calculate terms resulting from differentiating energy function with respect to query and ring atom coordinates
 *         cdef float dL4 = dL ** 4
 *         cdef float dL3 = dL ** 3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef float dL6 = dL3 ** 2
 * 
 */
  __pyx_v_dL3 = powf(__pyx_v_dL, 3.0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2685")'> 2685:         cdef float dL6 = dL3 ** 2</pre>
<pre id='line2685' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2685
 *         cdef float dL4 = dL ** 4
 *         cdef float dL3 = dL ** 3
 *         cdef float dL6 = dL3 ** 2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef float nL = norm(ring_normal[0])
 */
  __pyx_v_dL6 = powf(__pyx_v_dL3, 2.0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2686")'> 2686: </pre>
<pre id='line2686' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2687")'> 2687:         cdef float nL = norm(ring_normal[0])</pre>
<pre id='line2687' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2687
 *         cdef float dL6 = dL3 ** 2
 * 
 *         cdef float nL = norm(ring_normal[0])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef float nL2 = nL ** 2
 *         cdef float dLnL = dL * nL
 */
  __pyx_v_nL = norm((__pyx_v_ring_normal[0]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2688")'> 2688:         cdef float nL2 = nL ** 2</pre>
<pre id='line2688' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2688
 * 
 *         cdef float nL = norm(ring_normal[0])
 *         cdef float nL2 = nL ** 2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef float dLnL = dL * nL
 *         cdef float dL3nL3 = dL3 * nL2 * nL
 */
  __pyx_v_nL2 = powf(__pyx_v_nL, 2.0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2689")'> 2689:         cdef float dLnL = dL * nL</pre>
<pre id='line2689' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2689
 *         cdef float nL = norm(ring_normal[0])
 *         cdef float nL2 = nL ** 2
 *         cdef float dLnL = dL * nL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef float dL3nL3 = dL3 * nL2 * nL
 * 
 */
  __pyx_v_dLnL = (__pyx_v_dL * __pyx_v_nL);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2690")'> 2690:         cdef float dL3nL3 = dL3 * nL2 * nL</pre>
<pre id='line2690' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2690
 *         cdef float nL2 = nL ** 2
 *         cdef float dLnL = dL * nL
 *         cdef float dL3nL3 = dL3 * nL2 * nL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef float dn = dot(d, ring_normal[0])
 */
  __pyx_v_dL3nL3 = ((__pyx_v_dL3 * __pyx_v_nL2) * __pyx_v_nL);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2691")'> 2691: </pre>
<pre id='line2691' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2692")'> 2692:         cdef float dn = dot(d, ring_normal[0])</pre>
<pre id='line2692' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2692
 *         cdef float dL3nL3 = dL3 * nL2 * nL
 * 
 *         cdef float dn = dot(d, ring_normal[0])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef float dn2 = dn ** 2
 * 
 */
  __pyx_v_dn = dot(__pyx_v_d, (__pyx_v_ring_normal[0]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2693")'> 2693:         cdef float dn2 = dn ** 2</pre>
<pre id='line2693' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2693
 * 
 *         cdef float dn = dot(d, ring_normal[0])
 *         cdef float dn2 = dn ** 2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef float u = 1.0 - 3.0 * dn2 / (dL2 * nL2)
 */
  __pyx_v_dn2 = powf(__pyx_v_dn, 2.0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2694")'> 2694: </pre>
<pre id='line2694' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2695")'> 2695:         cdef float u = 1.0 - 3.0 * dn2 / (dL2 * nL2)</pre>
<pre id='line2695' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2695
 *         cdef float dn2 = dn ** 2
 * 
 *         cdef float u = 1.0 - 3.0 * dn2 / (dL2 * nL2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef float gradUQ_factor = -6.0 * dn / (dL4 * nL2)
 */
  __pyx_v_u = (1.0 - ((3.0 * __pyx_v_dn2) / (__pyx_v_dL2 * __pyx_v_nL2)));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2696")'> 2696: </pre>
<pre id='line2696' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2697")'> 2697:         cdef float gradUQ_factor = -6.0 * dn / (dL4 * nL2)</pre>
<pre id='line2697' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2697
 *         cdef float u = 1.0 - 3.0 * dn2 / (dL2 * nL2)
 * 
 *         cdef float gradUQ_factor = -6.0 * dn / (dL4 * nL2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         #TODO: remove temporarys and operator_mu;t#
 */
  __pyx_v_gradUQ_factor = ((-6.0 * __pyx_v_dn) / (__pyx_v_dL4 * __pyx_v_nL2));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2698")'> 2698: </pre>
<pre id='line2698' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2699")'> 2699:         #TODO: remove temporarys and operator_mu;t#</pre>
<pre id='line2699' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2700")'> 2700:         cdef Vec3 scaled_d =  d</pre>
<pre id='line2700' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2700
 * 
 *         #TODO: remove temporarys and operator_mu;t#
 *         cdef Vec3 scaled_d =  d             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(scaled_d,dn)
 *         cdef Vec3 scaled_normal = ring_normal[0]
 */
  __pyx_v_scaled_d = __pyx_v_d;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2701")'> 2701:         operator_times(scaled_d,dn)</pre>
<pre id='line2701' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2701
 *         #TODO: remove temporarys and operator_mu;t#
 *         cdef Vec3 scaled_d =  d
 *         operator_times(scaled_d,dn)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3 scaled_normal = ring_normal[0]
 *         operator_times(scaled_normal,dL2)
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_scaled_d, __pyx_v_dn);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2702")'> 2702:         cdef Vec3 scaled_normal = ring_normal[0]</pre>
<pre id='line2702' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2702
 *         cdef Vec3 scaled_d =  d
 *         operator_times(scaled_d,dn)
 *         cdef Vec3 scaled_normal = ring_normal[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(scaled_normal,dL2)
 * 
 */
  __pyx_v_scaled_normal = (__pyx_v_ring_normal[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2703")'> 2703:         operator_times(scaled_normal,dL2)</pre>
<pre id='line2703' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2703
 *         operator_times(scaled_d,dn)
 *         cdef Vec3 scaled_normal = ring_normal[0]
 *         operator_times(scaled_normal,dL2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         cdef Vec3 gradUQ = scaled_normal - scaled_d
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_scaled_normal, __pyx_v_dL2);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2704")'> 2704: </pre>
<pre id='line2704' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2705")'> 2705:         cdef Vec3 gradUQ = scaled_normal - scaled_d</pre>
<pre id='line2705' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2705
 *         operator_times(scaled_normal,dL2)
 * 
 *         cdef Vec3 gradUQ = scaled_normal - scaled_d             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(gradUQ,gradUQ_factor)
 * 
 */
  __pyx_v_gradUQ = (__pyx_v_scaled_normal - __pyx_v_scaled_d);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2706")'> 2706:         operator_times(gradUQ,gradUQ_factor)</pre>
<pre id='line2706' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2706
 * 
 *         cdef Vec3 gradUQ = scaled_normal - scaled_d
 *         operator_times(gradUQ,gradUQ_factor)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_gradUQ, __pyx_v_gradUQ_factor);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2707")'> 2707: </pre>
<pre id='line2707' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2708")'> 2708: </pre>
<pre id='line2708' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2709")'> 2709:         cdef float gradVQ_factor = 3.0 * dL</pre>
<pre id='line2709' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2709
 * 
 * 
 *         cdef float gradVQ_factor = 3.0 * dL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Vec3 gradVQ = d
 *         operator_times(gradVQ,gradVQ_factor)
 */
  __pyx_v_gradVQ_factor = (3.0 * __pyx_v_dL);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2710")'> 2710:         cdef Vec3 gradVQ = d</pre>
<pre id='line2710' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2710
 * 
 *         cdef float gradVQ_factor = 3.0 * dL
 *         cdef Vec3 gradVQ = d             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         operator_times(gradVQ,gradVQ_factor)
 * 
 */
  __pyx_v_gradVQ = __pyx_v_d;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2711")'> 2711:         operator_times(gradVQ,gradVQ_factor)</pre>
<pre id='line2711' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2711
 *         cdef float gradVQ_factor = 3.0 * dL
 *         cdef Vec3 gradVQ = d
 *         operator_times(gradVQ,gradVQ_factor)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         result.dL3nL3 = dL3nL3
 */
  __pyx_f_17shift_calculators_operator_times(__pyx_v_gradVQ, __pyx_v_gradVQ_factor);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2712")'> 2712: </pre>
<pre id='line2712' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2713")'> 2713:         result.dL3nL3 = dL3nL3</pre>
<pre id='line2713' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2713
 *         operator_times(gradVQ,gradVQ_factor)
 * 
 *         result.dL3nL3 = dL3nL3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.dLnL =dLnL
 *         result.dn = dn
 */
  __pyx_v_result.dL3nL3 = __pyx_v_dL3nL3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2714")'> 2714:         result.dLnL =dLnL</pre>
<pre id='line2714' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2714
 * 
 *         result.dL3nL3 = dL3nL3
 *         result.dLnL =dLnL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.dn = dn
 *         result.dL = dL
 */
  __pyx_v_result.dLnL = __pyx_v_dLnL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2715")'> 2715:         result.dn = dn</pre>
<pre id='line2715' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2715
 *         result.dL3nL3 = dL3nL3
 *         result.dLnL =dLnL
 *         result.dn = dn             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.dL = dL
 *         result.nL = nL
 */
  __pyx_v_result.dn = __pyx_v_dn;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2716")'> 2716:         result.dL = dL</pre>
<pre id='line2716' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2716
 *         result.dLnL =dLnL
 *         result.dn = dn
 *         result.dL = dL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.nL = nL
 *         result.d = d
 */
  __pyx_v_result.dL = __pyx_v_dL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2717")'> 2717:         result.nL = nL</pre>
<pre id='line2717' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2717
 *         result.dn = dn
 *         result.dL = dL
 *         result.nL = nL             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.d = d
 *         result.gradUQ = gradUQ
 */
  __pyx_v_result.nL = __pyx_v_nL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2718")'> 2718:         result.d = d</pre>
<pre id='line2718' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2718
 *         result.dL = dL
 *         result.nL = nL
 *         result.d = d             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.gradUQ = gradUQ
 *         result.dL3 =dL3
 */
  __pyx_v_result.d = __pyx_v_d;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2719")'> 2719:         result.gradUQ = gradUQ</pre>
<pre id='line2719' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2719
 *         result.nL = nL
 *         result.d = d
 *         result.gradUQ = gradUQ             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.dL3 =dL3
 *         result.u  = u
 */
  __pyx_v_result.gradUQ = __pyx_v_gradUQ;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2720")'> 2720:         result.dL3 =dL3</pre>
<pre id='line2720' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2720
 *         result.d = d
 *         result.gradUQ = gradUQ
 *         result.dL3 =dL3             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.u  = u
 *         result.gradVQ = gradVQ
 */
  __pyx_v_result.dL3 = __pyx_v_dL3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2721")'> 2721:         result.u  = u</pre>
<pre id='line2721' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2721
 *         result.gradUQ = gradUQ
 *         result.dL3 =dL3
 *         result.u  = u             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.gradVQ = gradVQ
 *         result.dL6 = dL6
 */
  __pyx_v_result.u = __pyx_v_u;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2722")'> 2722:         result.gradVQ = gradVQ</pre>
<pre id='line2722' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2722
 *         result.dL3 =dL3
 *         result.u  = u
 *         result.gradVQ = gradVQ             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.dL6 = dL6
 *         result.ring_normal =  ring_normal[0]
 */
  __pyx_v_result.gradVQ = __pyx_v_gradVQ;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2723")'> 2723:         result.dL6 = dL6</pre>
<pre id='line2723' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2723
 *         result.u  = u
 *         result.gradVQ = gradVQ
 *         result.dL6 = dL6             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.ring_normal =  ring_normal[0]
 * 
 */
  __pyx_v_result.dL6 = __pyx_v_dL6;
</pre><pre class='line' style='background-color: #FFFF1e' onclick='toggleDiv("line2724")'> 2724:         result.ring_normal =  ring_normal[0]</pre>
<pre id='line2724' class='code' style='background-color: #FFFF1e'>
  /* "Cython_shift_calculator.pyx":2724
 *         result.gradVQ = gradVQ
 *         result.dL6 = dL6
 *         result.ring_normal =  ring_normal[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #        return  dL3, u, dL6, ring_normal,  atom_type_id, coefficient, d, factor, dn, dL3nL3, dL, nL, dLnL
 */
  __pyx_v_result.ring_normal = (__pyx_v_ring_normal[0]);

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_19_calc_target_atom_forces(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_17shift_calculators_26Fast_ring_force_calculator_19_calc_target_atom_forces(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_target_atom_id;
  float __pyx_v_force_factor;
  struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms *__pyx_v_python_sub_terms = 0;
  struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calc_target_atom_forces (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__target_atom_id,&__pyx_n_s__force_factor,&__pyx_n_s__python_sub_terms,&__pyx_n_s__forces,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__target_atom_id)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__force_factor)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calc_target_atom_forces", 1, 4, 4, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2729; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__python_sub_terms)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calc_target_atom_forces", 1, 4, 4, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2729; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__forces)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calc_target_atom_forces", 1, 4, 4, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2729; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_calc_target_atom_forces") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2729; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_target_atom_id = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_target_atom_id == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2729; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_force_factor = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_force_factor == (float)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2729; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_python_sub_terms = ((struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms *)values[2]);
    __pyx_v_forces = ((struct __pyx_obj_17shift_calculators_Out_array *)values[3]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_calc_target_atom_forces", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2729; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("shift_calculators.Fast_ring_force_calculator._calc_target_atom_forces", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_python_sub_terms), __pyx_ptype_17shift_calculators_Python_ring_force_sub_terms, 1, "python_sub_terms", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2729; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_forces), __pyx_ptype_17shift_calculators_Out_array, 1, "forces", 0)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2729; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_17shift_calculators_26Fast_ring_force_calculator_18_calc_target_atom_forces(((struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *)__pyx_v_self), __pyx_v_target_atom_id, __pyx_v_force_factor, __pyx_v_python_sub_terms, __pyx_v_forces);
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2725")'> 2725: </pre>
<pre id='line2725' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2726")'> 2726: #        return  dL3, u, dL6, ring_normal,  atom_type_id, coefficient, d, factor, dn, dL3nL3, dL, nL, dLnL</pre>
<pre id='line2726' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2727")'> 2727: ##    ---</pre>
<pre id='line2727' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2728")'> 2728: #</pre>
<pre id='line2728' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2729")'> 2729:     def _calc_target_atom_forces(self, int target_atom_id, float force_factor, Python_ring_force_sub_terms python_sub_terms, Out_array forces):</pre>
<pre id='line2729' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2729
 * ##    ---
 * #
 *     def _calc_target_atom_forces(self, int target_atom_id, float force_factor, Python_ring_force_sub_terms python_sub_terms, Out_array forces):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef Ring_force_sub_terms  terms  =  python_sub_terms.get_terms()
 *         self._cython_calc_target_atom_forces(target_atom_id, force_factor, terms, forces)
 */

static PyObject *__pyx_pf_17shift_calculators_26Fast_ring_force_calculator_18_calc_target_atom_forces(struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, int __pyx_v_target_atom_id, float __pyx_v_force_factor, struct __pyx_obj_17shift_calculators_Python_ring_force_sub_terms *__pyx_v_python_sub_terms, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces) {
  struct __pyx_t_17shift_calculators_Ring_force_sub_terms __pyx_v_terms;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_calc_target_atom_forces", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2730")'> 2730:         cdef Ring_force_sub_terms  terms  =  python_sub_terms.get_terms()</pre>
<pre id='line2730' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2730
 * #
 *     def _calc_target_atom_forces(self, int target_atom_id, float force_factor, Python_ring_force_sub_terms python_sub_terms, Out_array forces):
 *         cdef Ring_force_sub_terms  terms  =  python_sub_terms.get_terms()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         self._cython_calc_target_atom_forces(target_atom_id, force_factor, terms, forces)
 * 
 */
  __pyx_v_terms = ((struct __pyx_vtabstruct_17shift_calculators_Python_ring_force_sub_terms *)__pyx_v_python_sub_terms->__pyx_vtab)->get_terms(__pyx_v_python_sub_terms);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line2731")'> 2731:         self._cython_calc_target_atom_forces(target_atom_id, force_factor, terms, forces)</pre>
<pre id='line2731' class='code' style='background-color: #FFFFd4'>
  /* "Cython_shift_calculator.pyx":2731
 *     def _calc_target_atom_forces(self, int target_atom_id, float force_factor, Python_ring_force_sub_terms python_sub_terms, Out_array forces):
 *         cdef Ring_force_sub_terms  terms  =  python_sub_terms.get_terms()
 *         self._cython_calc_target_atom_forces(target_atom_id, force_factor, terms, forces)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     cdef inline void _cython_calc_target_atom_forces(self, int target_atom_id, float force_factor, Ring_force_sub_terms& sub_terms, Out_array forces):
 */
  __pyx_f_17shift_calculators_26Fast_ring_force_calculator__cython_calc_target_atom_forces(__pyx_v_self, __pyx_v_target_atom_id, __pyx_v_force_factor, __pyx_v_terms, __pyx_v_forces);

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2732")'> 2732: </pre>
<pre id='line2732' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2733")'> 2733:     cdef inline void _cython_calc_target_atom_forces(self, int target_atom_id, float force_factor, Ring_force_sub_terms&amp; sub_terms, Out_array forces):</pre>
<pre id='line2733' class='code' style='background-color: #FFFFff'>
/* "Cython_shift_calculator.pyx":2733
 *         self._cython_calc_target_atom_forces(target_atom_id, force_factor, terms, forces)
 * 
 *     cdef inline void _cython_calc_target_atom_forces(self, int target_atom_id, float force_factor, Ring_force_sub_terms& sub_terms, Out_array forces):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cdef object target_force_triplet
 *         cdef int axis
 */

static CYTHON_INLINE void __pyx_f_17shift_calculators_26Fast_ring_force_calculator__cython_calc_target_atom_forces(CYTHON_UNUSED struct __pyx_obj_17shift_calculators_Fast_ring_force_calculator *__pyx_v_self, int __pyx_v_target_atom_id, float __pyx_v_force_factor, struct __pyx_t_17shift_calculators_Ring_force_sub_terms &__pyx_v_sub_terms, struct __pyx_obj_17shift_calculators_Out_array *__pyx_v_forces) {
  int __pyx_v_axis;
  float __pyx_v_term1;
  Vec3 __pyx_v_result;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("_cython_calc_target_atom_forces", 0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2734")'> 2734:         cdef object target_force_triplet</pre>
<pre id='line2734' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2735")'> 2735:         cdef int axis</pre>
<pre id='line2735' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2736")'> 2736: #        target_force_triplet = self._get_or_make_target_force_triplet(forces, target_atom_id)</pre>
<pre id='line2736' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2737")'> 2737: #</pre>
<pre id='line2737' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2738")'> 2738: #        # update forces on query atom</pre>
<pre id='line2738' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2739")'> 2739:         cdef float term1</pre>
<pre id='line2739' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2740")'> 2740:         cdef Vec3 result</pre>
<pre id='line2740' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2741")'> 2741:         for axis in range(3):</pre>
<pre id='line2741' class='code' style='background-color: #FFFFff'>
  /* "Cython_shift_calculator.pyx":2741
 *         cdef float term1
 *         cdef Vec3 result
 *         for axis in range(3):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             #TODO: report this as a bug it produces an un initialized reference
 *             term1= (sub_terms.gradUQ[axis] * sub_terms.dL3 - sub_terms.u * sub_terms.gradVQ[axis])
 */
  for (__pyx_t_1 = 0; __pyx_t_1 <code><</code> 3; __pyx_t_1+=1) {
    __pyx_v_axis = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2742")'> 2742:             #TODO: report this as a bug it produces an un initialized reference</pre>
<pre id='line2742' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2743")'> 2743:             term1= (sub_terms.gradUQ[axis] * sub_terms.dL3 - sub_terms.u * sub_terms.gradVQ[axis])</pre>
<pre id='line2743' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2743
 *         for axis in range(3):
 *             #TODO: report this as a bug it produces an un initialized reference
 *             term1= (sub_terms.gradUQ[axis] * sub_terms.dL3 - sub_terms.u * sub_terms.gradVQ[axis])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             result[axis] = -force_factor * term1 / sub_terms.dL6
 * 
 */
    __pyx_v_term1 = (((__pyx_v_sub_terms.gradUQ[__pyx_v_axis]) * __pyx_v_sub_terms.dL3) - (__pyx_v_sub_terms.u * (__pyx_v_sub_terms.gradVQ[__pyx_v_axis])));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2744")'> 2744:             result[axis] = -force_factor * term1 / sub_terms.dL6</pre>
<pre id='line2744' class='code' style='background-color: #FFFFff'>
    /* "Cython_shift_calculator.pyx":2744
 *             #TODO: report this as a bug it produces an un initialized reference
 *             term1= (sub_terms.gradUQ[axis] * sub_terms.dL3 - sub_terms.u * sub_terms.gradVQ[axis])
 *             result[axis] = -force_factor * term1 / sub_terms.dL6             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         forces.add(target_atom_id, result)
 */
    (__pyx_v_result[__pyx_v_axis]) = (((-__pyx_v_force_factor) * __pyx_v_term1) / __pyx_v_sub_terms.dL6);
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2745")'> 2745: </pre>
<pre id='line2745' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line2746")'> 2746:         forces.add(target_atom_id, result)</pre>
<pre id='line2746' class='code' style='background-color: #FFFFe7'>
  /* "Cython_shift_calculator.pyx":2746
 *             result[axis] = -force_factor * term1 / sub_terms.dL6
 * 
 *         forces.add(target_atom_id, result)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * #             *  / sub_terms.dL6
 * #
 */
  __pyx_f_17shift_calculators_9Out_array_add(__pyx_v_forces, __pyx_v_target_atom_id, __pyx_v_result);

  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2747")'> 2747: #             *  / sub_terms.dL6</pre>
